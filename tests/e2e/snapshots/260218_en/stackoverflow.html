



    <html itemscope itemtype="https://schema.org/QAPage"  class="html__responsive " lang="en">

        <head>
            
            <title>java - Why is processing a sorted array faster than processing an unsorted array? - Stack Overflow</title>
            
<link rel="shortcut icon" href="https://stackoverflow.com/Content/Sites/stackoverflow/Img/favicon.ico?v=ec617d715196">
<link rel="apple-touch-icon" href="https://stackoverflow.com/Content/Sites/stackoverflow/Img/apple-touch-icon.png?v=c78bd457575a">
<link rel="image_src" href="https://stackoverflow.com/Content/Sites/stackoverflow/Img/apple-touch-icon.png?v=c78bd457575a"> 
    <link rel="search" type="application/opensearchdescription+xml" title="Stack Overflow" href="/opensearch.xml">
        <link rel="canonical" href="https://stackoverflow.com/questions/11227809/why-is-processing-a-sorted-array-faster-than-processing-an-unsorted-array" />
    <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, minimum-scale=1.0">
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://stackoverflow.com/questions/11227809/why-is-processing-a-sorted-array-faster-than-processing-an-unsorted-array" />
    <meta property="og:site_name" content="Stack Overflow" />
    <meta property="og:image" content="https://stackoverflow.com/Content/Sites/stackoverflow/Img/apple-touch-icon@2.png?v=73d79a89bded" />
        <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "WebSite",
      "@id": "https://stackoverflow.com/#website",
      "name": "Stack Overflow",
      "url": "https://stackoverflow.com",
      "image": "https://stackoverflow.com/Content/Sites/stackoverflow/Img/apple-touch-icon@2.png?v=73d79a89bded",
      "publisher": {
        "@id": "https://stackoverflow.com/#organization"
      }
    },
    {
      "@type": "Organization",
      "@id": "https://stackoverflow.com/#organization",
      "name": "Stack Overflow",
      "url": "https://stackoverflow.com",
      "logo": "https://stackoverflow.com/Content/Sites/stackoverflow/Img/logo.png?v=e47b208316da",
      "sameAs": [
        "https://stackoverflow.co/",
        "https://www.facebook.com/officialstackoverflow/",
        "https://x.com/stackoverflow",
        "https://www.linkedin.com/company/stack-overflow",
        "https://www.youtube.com/c/StackOverflowOfficial",
        "https://twitter.com/stackoverflow"
      ],
      "contactPoint": [
        {
          "@type": "ContactPoint",
          "contactType": "Customer support",
          "url": "https://stackoverflow.com/contact"
        },
        {
          "@type": "ContactPoint",
          "contactType": "Stack Ads",
          "url": "https://stackoverflow.co/advertising/"
        },
        {
          "@type": "ContactPoint",
          "contactType": "Stack Internal",
          "url": "https://stackoverflow.co/teams/"
        },
        {
          "@type": "ContactPoint",
          "contactType": "Stack Data Licensing",
          "url": "https://stackoverflow.co/api-solutions/"
        }
      ],
      "description": "Q\u0026A for professional and enthusiast programmers"
    }
  ]
}
</script>
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:domain" content="stackoverflow.com" />
    <meta name="twitter:title" property="og:title" content="Why is processing a sorted array faster than processing an unsorted array?" />
    <meta name="twitter:description" property="og:description" content="In this C&#x2B;&#x2B; code, sorting the data (before the timed region) makes the primary loop ~6x faster:&#xA;#include &amp;lt;algorithm&amp;gt;&#xA;#include &amp;lt;ctime&amp;gt;&#xA;#include &amp;lt;iostream&amp;gt;&#xA;&#xA;int main()&#xA;{&#xA;    // Gene..." />

    
<meta itemprop="name" content="Why is processing a sorted array faster than processing an unsorted array?" />
<meta itemprop="description" content="In this C&#x2B;&#x2B; code, sorting the data (before the timed region) makes the primary loop ~6x faster:&#xA;#include &amp;lt;algorithm&amp;gt;&#xA;#include &amp;lt;ctime&amp;gt;&#xA;#include &amp;lt;iostream&amp;gt;&#xA;&#xA;int main()&#xA;{&#xA;    // Gene..." />
<meta itemprop="image" content="https://stackoverflow.com/Content/Sites/stackoverflow/Img/apple-touch-icon@2.png?v=73d79a89bded" />
<meta itemprop="primaryImageOfPage" content="https://stackoverflow.com/Content/Sites/stackoverflow/Img/apple-touch-icon@2.png?v=73d79a89bded" />
<meta itemprop="url" content="https://stackoverflow.com/questions/11227809/why-is-processing-a-sorted-array-faster-than-processing-an-unsorted-array" />
    <meta itemprop="isPartOf" content="https://stackoverflow.com/#website" />
    <meta itemprop="publisher" content="https://stackoverflow.com/#organization" />



            <script id="webpack-public-path" type="text/uri-list">https://stackoverflow.com/Content/</script>
            <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
            <script defer src="https://stackoverflow.com/Content/Js/third-party/npm/@stackoverflow/stacks/dist/js/stacks.min.js?v=c7bcc7a1b4fd"></script>
            <script src="https://stackoverflow.com/Content/Js/stub.en.js?v=550dc403c85a"></script>

            <link rel="stylesheet" type="text/css" href="https://stackoverflow.com/Content/Shared/stacks.css?v=b2264ccf0463">
            <link rel="stylesheet" type="text/css" href="https://stackoverflow.com/Content/Sites/stackoverflow/primary.css?v=0f1d8a3e6ba6">


            
            <link rel="alternate" type="application/atom+xml" title="Feed for question &#x27;Why is processing a sorted array faster than processing an unsorted array?&#x27;" href="/feeds/question/11227809">
<script defer src="https://stackoverflow.com/Content/Js/misc/copy.en.js?v=56d80b082861"></script><script type="application/json" data-role="module-args" data-module-name="entry-points/misc/copy.mod">{"sortType":4,"numberOfVisibleAnswers":26,"trackQuestions":true,"trackArticles":false,"userReputation":0,"userReputationBand":0,"sendPrizmEvent":false,"sendAEHEvent":true}</script><script>
    StackExchange.ready(function () {

                StackExchange.using("snippets", function () {
                    StackExchange.snippets.initSnippetRenderer();
                });
                
        StackExchange.using("postValidation", function () {
            StackExchange.postValidation.initOnBlurAndSubmit($('#post-form'), 2, 'answer');
        });


        StackExchange.question.init({showAnswerHelp:true,showTrendingSortLaunchPopover:false,showTrendingSortPostLaunchPopover:false,totalCommentCount:13,shownCommentCount:5,enableTables:true,questionId:11227809});

        styleCode();

                StackExchange.realtime.subscribeToQuestion('1', '11227809');
                StackExchange.using("gps", function () { StackExchange.gps.trackOutboundClicks('#content', '.js-post-body'); });


    });
</script>

                
                
                
            <link rel="stylesheet" type="text/css" href="https://stackoverflow.com/Content/Shared/Channels/channels.css?v=2c98e83b4da0">

            
            

            


            <script type="application/json" data-role="module-args" data-module-name="args/options.mod">{"options":{"locale":"en","serverTime":1771427630,"routeName":"Questions/Show","stackAuthUrl":"https://stackauth.com","networkMetaHostname":"meta.stackexchange.com","site":{"name":"Stack Overflow","description":"Q\u0026A for professional and enthusiast programmers","isNoticesTabEnabled":true,"enableNewTagCreationWarning":true,"insertSpaceAfterNameTabCompletion":false,"id":1,"cookieDomain":".stackoverflow.com","childUrl":"https://meta.stackoverflow.com","negativeVoteScoreFloor":null,"enableSocialMediaInSharePopup":true,"protocol":"https"},"user":{"fkey":"d09ecbbe5140a7c1439a7e4020cdd7d76b52d28795a889bb24233842877804f3","tid":"377ef13b-b420-493e-a46e-7fba7cc42545","rep":0,"isAnonymous":true,"isAnonymousNetworkWide":true},"events":{"postType":{"question":1},"postEditionSection":{"title":1,"body":2,"tags":3}}}}</script>
<script type="application/json" data-role="module-args" data-module-name="args/settings.mod">{"settings":{"userMessaging":{"showNewFeatureNotice":true},"flags":{"allowRetractingFlags":true,"allowRetractingCommentFlags":true},"mentions":{"maxNumUsersInDropdown":50},"search":{},"image":{"maxImageUploadSizeInBytes":10485760,"maxImageUploadSizeInBytesAnimatedGif":2097152},"markdown":{"enableTables":true},"paths":{"jQueryUIJSPath":"https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.0/jquery-ui.min.js","jQueryUICSSPath":"https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.0/themes/smoothness/jquery-ui.css"},"auth":{"oauthInPopup":true},"api":{"oneTrustDataLicensingApiConfigId":"019c4e40-2b18-7d09-b854-450af38a31c8"},"subscriptions":{"defaultFreemiumMaxTrueUpSeats":50,"defaultBasicMaxTrueUpSeats":250,"defaultMaxTrueUpSeats":1000},"tags":{},"comments":{},"accounts":{"currentPasswordRequiredForChangingStackIdPassword":true},"intercom":{"appId":"inf0secd"},"questions":{"enableSavesFeature":true,"questionTitleLengthStartLiveWarningChars":50,"maxTitleSize":150,"enableQuestionTitleLengthLiveWarning":true},"snippets":{"renderDomain":"stacksnippets.net","stacksEditorSnippetsEnabledFor":{"Metadata":{"Name":"SnippetSettings.StacksEditorSnippetsEnabledFor","Filter":0},"AppliedFilter":0,"IsNobody":false,"All":true,"Anonymous":false,"LoggedIn":false,"ChannelsMembers":false,"Moderators":false,"Employees":false,"Developers":false,"TeamAdmins":false,"AccountIds":[],"ExcludedAccountIds":[],"Serialization":"All"},"snippetsEnabled":true},"elections":{"opaVoteResultsBaseUrl":"https://www.opavote.com/results/"},"site":{"enableImageHttps":true,"stacksEditorPreviewEnabled":true,"enableUserHovercards":true,"forceHttpsImages":true,"styleCode":true,"allowImageUploads":true},"questionLinkTitleReplacement":{"maxNumberOfSitesProcessed":10,"maxReplacementsPerSite":20},"legal":{"useCustomConsent":false,"oneTrustTCFConfigId":"c3d9f1e3-55f3-4eba-b268-46cee4c6789c"}}}</script>
<script>StackExchange.init();</script>

            <script>
                StackExchange.using.setCacheBreakers({"Js/adops.en.js":"6da43f5e0a84","Js/ask.en.js":"","Js/begin-edit-event.en.js":"dd955babf04d","Js/events.en.js":"","Js/explore-qlist.en.js":"ee2a4f8c3992","Js/full-anon.en.js":"4a9e6a68c7e3","Js/full.en.js":"a00c99ce5b6e","Js/highlightjs-loader.en.js":"41dd0ff14471","Js/inline-tag-editing.en.js":"8517756a2cb6","Js/keyboard-shortcuts.en.js":"c255a5a5979b","Js/markdown-it-loader.en.js":"9e901e1e3a2c","Js/mentions-transpiled.en.js":"adcf85e61d88","Js/moderator.en.js":"37ee6843a392","Js/postCollections-transpiled.en.js":"27fabb0f4bf8","Js/post-validation.en.js":"44d59ccfc490","Js/question-editor.en.js":"","Js/review-v2-transpiled.en.js":"e327edff3102","Js/revisions.en.js":"9dd135bb585f","Js/stacks-editor.en.js":"a3675cbc720e","Js/tageditor.en.js":"5b8f289d02ef","Js/tageditornew.en.js":"8a29c1ec524c","Js/tagsuggestions.en.js":"c54b483b692e","Js/wmd.en.js":"e65961906f11","Js/snippet-javascript-codemirror.en.js":"ede55efa5a37"});
                StackExchange.using("gps", function() {
                        StackExchange.gps.init(false);
                });
            </script>
            <noscript id="noscript-css"><style>body, .s-topbar { margin-top: 1.9em }</style></noscript>
            
        <script type="text/javascript">var abp;</script>
        <script type="text/javascript" src="/px.js?ch=1"></script>
        <script type="text/javascript" src="/px.js?ch=2"></script>

        </head>

    <body class="question-page unified-theme">
        
<div id="signup-modal-container"></div>
<script type="application/json" data-role="module-args" data-module-name="islands/signup-modal/index.mod">{"ContainerElementId":"signup-modal-container","FKey":"d09ecbbe5140a7c1439a7e4020cdd7d76b52d28795a889bb24233842877804f3","TriggerEvent":"signupModalShow","OauthInPopup":true,"ReturnUrl":"https://stackoverflow.com/questions/11227809/why-is-processing-a-sorted-array-faster-than-processing-an-unsorted-array","ReturnUrlForPopup":"https://stackoverflow.com/users/after-signup/oauth-only","SiteName":"Stack Overflow","SiteLogoPath":"https://stackoverflow.com/Content/Sites/stackoverflow/Img/icon-48.png?v=b7e36f88ff92","AuthProviders":["Google","GitHub"],"ParentSiteUrl":"","IsInitiallyVisible":false}</script>
<script defer src="https://stackoverflow.com/Content/Js/webpack-chunks/svelte.en.js?v=e94edf603d8c"></script><script defer src="https://stackoverflow.com/Content/Js/webpack-chunks/stacks-svelte.en.js?v=fdea6766026e"></script><script defer src="https://stackoverflow.com/Content/Js/webpack-chunks/9366.en.js?v=c8d4e4e64bf3"></script><script defer src="https://stackoverflow.com/Content/Js/islands/signup-modal.en.js?v=2f60105e1755"></script>

<script defer>
    dispatchEvent(new CustomEvent("openSignupModal"));
</script>
    
    

    <div id="one-tap-container"></div>
<script type="application/json" data-role="module-args" data-module-name="islands/one-tap/index.mod">{"ContainerElementId":"one-tap-container","FKey":"d09ecbbe5140a7c1439a7e4020cdd7d76b52d28795a889bb24233842877804f3","GoogleClientId":"717762328687-iludtf96g1hinl76e4lc1b9a82g457nn.apps.googleusercontent.com","Autoselect":false,"ReturnUrl":"https%253a%252f%252fstackoverflow.com%252fquestions%252f11227809%252fwhy-is-processing-a-sorted-array-faster-than-processing-an-unsorted-array"}</script><script defer src="https://stackoverflow.com/Content/Js/webpack-chunks/svelte.en.js?v=e94edf603d8c"></script><script defer src="https://stackoverflow.com/Content/Js/islands/one-tap.en.js?v=fd64ec49bac4"></script>

    <div id="notify-container"></div>
    <div id="custom-header"></div>
        

<header class="s-topbar ps-fixed t0 l0 js-top-bar">
    <a href="#content" class="s-topbar--skip-link">Skip to main content</a>
	<div class="s-topbar--container">
			<a href="#" class="s-topbar--menu-btn js-left-sidebar-toggle" aria-haspopup="true" aria-controls="left-sidebar" aria-expanded="false"><span></span></a>
			<div class="topbar-dialog leftnav-dialog js-leftnav-dialog dno">
				<div class="left-sidebar js-unpinned-left-sidebar" data-can-be="left-sidebar" data-is-here-when="sm"></div>
			</div>
                <a href="https://stackoverflow.com" class="s-topbar--logo js-gps-track"
		   data-gps-track="top_nav.click({is_current:false, location:2, destination:8}); homelogo_nav.click({location:2})">
					<span class="-img _glyph">Stack Overflow</span>
				</a>



			<ol class="s-navigation fw-nowrap ai-center" role="presentation">

					<li class="md:d-none">
						<a href="https://stackoverflow.co/" class="s-navigation--item js-gps-track"
				   data-gps-track="top_nav.products.click({location:2, destination:7})"
				   data-ga="[&quot;top navigation&quot;,&quot;about menu click&quot;,null,null,null]">
							<span class="s-navigation--item-text" data-text="About">About</span>
						</a>
					</li>
                
                <li>
                    <button
                        class="s-navigation--item js-gps-track sm:d-none"
                        type="button"
                        aria-controls="products-popover"
                        aria-expanded="false"
                        data-controller="s-popover"
                        data-action="s-popover#toggle"
                        data-s-popover-toggle-class="is-selected"
                        data-gps-track="top_nav.products.click({location:2, destination:1})"
                        data-ga="[&quot;top navigation&quot;,&quot;products menu click&quot;,null,null,null]">
                        <span class="s-navigation--item-text" data-text="Products">Products</span>
                    </button>
                </li>
                
					<li class="md:d-none">
						<a href="https://stackoverflow.co/internal/" class="s-navigation--item js-gps-track"
				   data-gps-track="top_nav.products.click({location:2, destination:7})"
				   data-ga="[&quot;top navigation&quot;,&quot;learn more - teams&quot;,null,null,null]">
							<span class="s-navigation--item-text" data-text="For Teams">For Teams</span>
						</a>
					</li>
                
                
            </ol>
			<div class="s-popover ws2 mtn2 p0"
			 id="products-popover"
			 role="menu"
			 aria-hidden="true">
				<div class="s-popover--arrow"></div>
				<ol class="list-reset s-anchors s-anchors__inherit">
					<li class="m6">
						<a href="https://stackoverflow.co/internal/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=top-nav&utm_content=stack-overflow-for-teams" class="bar-sm p6 d-block h:bg-black-225 js-gps-track"
					   data-gps-track="top_nav.products.click({location:2, destination:3})"
					   data-ga="[&quot;top navigation&quot;,&quot;teams submenu click&quot;,null,null,null]">
							<span class="fs-body1 d-block">Stack Internal</span>
							<span class="fs-caption d-block fc-black-400">Implement a knowledge platform layer to power your enterprise and AI tools.</span>
						</a>
					</li>
					<li class="m6">
						<a href="https://stackoverflow.co/data-licensing/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=top-nav&utm_content=overflow-api" class="bar-sm p6 d-block h:bg-black-225 js-gps-track"
					   data-gps-track="top_nav.products.click({location:2, destination:11})"
					   data-ga="[&quot;top navigation&quot;,&quot;overflowapi submenu click&quot;,null,null,null]">
						 	<span class="fs-body1 d-block">Stack Data Licensing</span>
							<span class="fs-caption d-block fc-black-400">Get access to top-class technical expertise with trusted &amp; attributed content.</span>
						 </a>
					</li>
					<li class="m6">
						<a href="https://stackoverflow.co/advertising/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=top-nav&utm_content=stack-overflow-advertising" class="bar-sm p6 d-block h:bg-black-225 js-gps-track"
					   data-gps-track="top_nav.products.click({location:2, destination:6})"
					   data-ga="[&quot;top navigation&quot;,&quot;advertising submenu click&quot;,null,null,null]">
							<span class="fs-body1 d-block">Stack Ads</span>
							<span class="fs-caption d-block fc-black-400">Connect your brand to the world&#x2019;s most trusted technologist communities.</span>
						</a>
					</li>
					<li class="bt bc-black-200 py6 px6 bbr-md">
						<a href="https://stackoverflow.blog/releases/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=top-nav&utm_content=releases" class="bar-sm p6 d-block h:bg-black-225 js-gps-track"
					   data-gps-track="top_nav.products.click({location:2, destination:13})"
					   data-ga="[&quot;top navigation&quot;,&quot;labs submenu click&quot;,null,null,null]">
						 	<span class="fs-body1 d-block">Releases</span>
							<span class="fs-caption d-block fc-black-400">Keep up-to-date on features we add to Stack Overflow and Stack Internal.</span>
						 </a>
					</li>
					<li class="bg-black-100 bt bc-black-200 py6 px6 bbr-md">
						<a href="https://stackoverflow.co/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=top-nav&utm_content=about-the-company" class="fc-black-400 d-block py6 px6 h:fc-black-600"
					   data-ga="[&quot;top navigation&quot;,&quot;about submenu click&quot;,null,null,null]">About the company</a>

						<a href="https://stackoverflow.blog/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=top-nav&utm_content=blog" class="fc-black-400 d-block py6 px6 h:fc-black-600"
					   data-ga="[&quot;top navigation&quot;,&quot;blog submenu click&quot;,null,null,null]">Visit the blog</a>
					</li>
				</ol>
			</div>


		        <form id="search" role="search" action=/search class="s-topbar--searchbar js-searchbar " autocomplete="off">
                        <div class="s-topbar--searchbar--input-group">
                            <input name="q"
                                   type="text"
                                   role="combobox"
                                   placeholder="Search&#x2026;"
                                   value=""
                                   autocomplete="off"
                                   maxlength="240"
                                   class="s-input s-input__search js-search-field wmn1 "
                                   aria-label="Search"
                                   aria-controls="top-search" 
                                   data-controller="s-popover"
                                   data-action="focus->s-popover#show"
                                   data-s-popover-placement="bottom-start" />
                            <svg aria-hidden="true" class="s-input-icon s-input-icon__search svg-icon iconSearch" width="18" height="18"  viewBox="0 0 18 18"><path  d="m18 16.5-5.14-5.18h-.35a7 7 0 1 0-1.19 1.19v.35L16.5 18zM12 7A5 5 0 1 1 2 7a5 5 0 0 1 10 0"/></svg>
                            <div class="s-popover p0 wmx100 wmn4 sm:wmn-initial js-top-search-popover" id="top-search" role="menu">
    <div class="s-popover--arrow"></div>
    <div class="s-popover--content">
        <div class="js-spinner p24 d-flex ai-center jc-center d-none">
            <div class="s-spinner s-spinner__sm fc-orange-400">
                <div class="v-visible-sr">Loading&#x2026;</div>
            </div>
        </div>

        <span class="v-visible-sr js-screen-reader-info"></span>
        <div class="js-ac-results overflow-y-auto hmx3 d-none"></div>

        <div class="js-search-hints" aria-describedby="Tips for searching"></div>
    </div>
</div>
                        </div>
                </form>
		

<nav class="h100 ml-auto overflow-x-auto pr12" aria-label="Topbar">
    <ol class="s-topbar--content">
    
    
    
        <li class="js-topbar-dialog-corral">
                

    <div class="topbar-dialog siteSwitcher-dialog dno" role="menu">
        <div class="header fw-wrap">
            <h3 class="flex--item">
                <a href="https://stackoverflow.com">current community</a>
            </h3>
            <div class="flex--item fl1">
                <div class="ai-center d-flex jc-end">
                    <button
                        class="js-close-button s-btn s-btn__muted p0 ml8 d-none sm:d-block"
                        type="button"
                        aria-label="Close"
                    >
                        <svg aria-hidden="true" class="svg-icon iconClear" width="18" height="18"  viewBox="0 0 18 18"><path  d="M15 4.41 13.59 3 9 7.59 4.41 3 3 4.41 7.59 9 3 13.59 4.41 15 9 10.41 13.59 15 15 13.59 10.41 9z"/></svg>
                    </button>
                </div>
            </div>
        </div>
        <div class="modal-content bg-blue-200 current-site-container">
            <ul class="current-site">
                    <li class="d-flex">
                            <div class="fl1">
                <a href="https://stackoverflow.com"  
       class="current-site-link d-flex gx8 site-link js-gps-track"
       data-id="1"
       data-gps-track="site_switcher.click({ item_type:3 })">
        <div class="favicon favicon-stackoverflow site-icon flex--item" title="Stack Overflow"></div>
        <span class="flex--item fl1">
            Stack Overflow
        </span>
    </a>

    </div>
    <div class="related-links">
            <a href="https://stackoverflow.com/help" class="js-gps-track" data-gps-track="site_switcher.click({ item_type:14 })">help</a>
            <a href="https://chat.stackoverflow.com/?tab=explore" class="js-gps-track" data-gps-track="site_switcher.click({ item_type:6 })">chat</a>
    </div>

                    </li>
                    <li class="related-site d-flex">
                            <div class="L-shaped-icon-container">
        <span class="L-shaped-icon"></span>
    </div>

                            <a href="https://meta.stackoverflow.com"  
       class="s-block-link px16 d-flex gx8 site-link js-gps-track"
       data-id="552"
       data-gps-track="site.switch({ target_site:552, item_type:3 }),site_switcher.click({ item_type:4 })">
        <div class="favicon favicon-stackoverflowmeta site-icon flex--item" title="Meta Stack Overflow"></div>
        <span class="flex--item fl1">
            Meta Stack Overflow
        </span>
    </a>

                    </li>
            </ul>
        </div>

        <div class="header" id="your-communities-header">
            <h3>
your communities            </h3>

        </div>
        <div class="modal-content" id="your-communities-section">

                <div class="call-to-login">
<a href="https://stackoverflow.com/users/signup?ssrc=site_switcher&amp;returnurl=https%3a%2f%2fstackoverflow.com%2fquestions%2f11227809%2fwhy-is-processing-a-sorted-array-faster-than-processing-an-unsorted-array" class="login-link js-gps-track" data-gps-track="site_switcher.click({ item_type:10 })">Sign up</a> or <a href="https://stackoverflow.com/users/login?ssrc=site_switcher&amp;returnurl=https%3a%2f%2fstackoverflow.com%2fquestions%2f11227809%2fwhy-is-processing-a-sorted-array-faster-than-processing-an-unsorted-array" class="login-link js-gps-track" data-gps-track="site_switcher.click({ item_type:11 })">log in</a> to customize your list.                </div>
        </div>

        <div class="header">
            <h3><a href="https://stackexchange.com/sites">more stack exchange communities</a>
            </h3>
            <a href="https://stackoverflow.blog" class="float-right">company blog</a>
        </div>
        <div class="modal-content">
                <div class="child-content"></div>
        </div>        
    </div>

        </li>
    
            <li><button class="s-topbar--item s-btn s-btn__icon s-btn__muted d-none sm:d-inline-flex js-searchbar-trigger" aria-label="Search" aria-haspopup="true" aria-controls="search" title="Click to show search"><svg aria-hidden="true" class="svg-icon iconSearch" width="18" height="18"  viewBox="0 0 18 18"><path  d="m18 16.5-5.14-5.18h-.35a7 7 0 1 0-1.19 1.19v.35L16.5 18zM12 7A5 5 0 1 1 2 7a5 5 0 0 1 10 0"/></svg></button></li>
                        <li>
                            <a href="https://stackoverflow.com/users/login?ssrc=head&returnurl=https%3a%2f%2fstackoverflow.com%2fquestions%2f11227809%2fwhy-is-processing-a-sorted-array-faster-than-processing-an-unsorted-array" class="s-topbar--item s-topbar--item__unset s-btn s-btn__outlined ws-nowrap js-gps-track" rel="nofollow"
                               data-gps-track="login.click" data-ga="[&quot;top navigation&quot;,&quot;login button click&quot;,null,null,null]">Log in</a>
                        </li>
                        <li><a href="https://stackoverflow.com/users/signup?ssrc=head&returnurl=https%3a%2f%2fstackoverflow.com%2fquestions%2f11227809%2fwhy-is-processing-a-sorted-array-faster-than-processing-an-unsorted-array" class="s-topbar--item s-topbar--item__unset ml4 s-btn s-btn__filled ws-nowrap js-signup-button js-gps-track" rel="nofollow" data-gps-track="signup.topbar.click" data-ga="[&quot;sign up&quot;,&quot;Sign Up Navigation&quot;,&quot;Header&quot;,null,null]">Sign up</a></li>
    </ol>
</nav>


	</div>
</header>

	<script>
		StackExchange.ready(function () { StackExchange.topbar.init(); });
		StackExchange.scrollPadding.setPaddingTop(50, 10); 
	</script>





    <div class="container">
            <script defer src="https://stackoverflow.com/Content/Js/sprinkles/left-nav-events.en.js?v=2ac13fd60bf6"></script>    


    <div id="homepage-wizard-container"></div>
<script type="application/json" data-role="module-args" data-module-name="islands/homepage-wizard/index.mod">{"ContainerElementId":"homepage-wizard-container","FKey":"d09ecbbe5140a7c1439a7e4020cdd7d76b52d28795a889bb24233842877804f3","Tags":["javascript","python","java","c#","php","android","html","jquery","c++","css","ios","sql","mysql","r","reactjs","node.js","arrays","c","asp.net","json","python-3.x",".net","ruby-on-rails","sql-server","swift","django","angular","objective-c","excel","pandas","angularjs","regex","typescript","ruby","linux","ajax","iphone","vba","xml","laravel","spring","asp.net-mvc","database","wordpress","string","flutter","postgresql","mongodb","wpf","windows","xcode","amazon-web-services","bash","git","oracle-database","spring-boot","dataframe","azure","firebase","list","multithreading","docker","vb.net","react-native","eclipse","algorithm","powershell","macos","visual-studio","numpy","image","forms","scala","function","vue.js","performance","twitter-bootstrap","selenium","winforms","kotlin","loops","dart","express","sqlite","hibernate","matlab","python-2.7","shell","rest","apache","entity-framework","android-studio","csv","maven","linq","qt","dictionary","unit-testing","asp.net-core","facebook","apache-spark","tensorflow","file","swing","class","unity-game-engine","sorting","date","authentication","go","symfony","t-sql","opencv","matplotlib",".htaccess","google-chrome","for-loop","datetime","codeigniter","perl","http","validation","sockets","google-maps","object","uitableview","xaml","oop","visual-studio-code","if-statement","cordova","ubuntu","web-services","email","android-layout","github","spring-mvc","elasticsearch","kubernetes","selenium-webdriver","ms-access","ggplot2","user-interface","parsing","pointers","google-sheets","c++11","security","machine-learning","google-apps-script","ruby-on-rails-3","templates","flask","nginx","variables","exception","sql-server-2008","gradle","debugging","tkinter","delphi","listview","jpa","asynchronous","haskell","web-scraping","jsp","pdf","ssl","amazon-s3","google-cloud-platform","testing","xamarin","jenkins","wcf","batch-file","generics","npm","ionic-framework","network-programming","unix","recursion","google-app-engine","mongoose","visual-studio-2010",".net-core","android-fragments","assembly","animation","math","svg","rust","session","intellij-idea","hadoop","join","curl","winapi","django-models","laravel-5","next.js","url","heroku","http-redirect","tomcat","inheritance","google-cloud-firestore","webpack","gcc","swiftui","image-processing","keras","asp.net-mvc-4","logging","dom","matrix","pyspark","actionscript-3","button","post","optimization","firebase-realtime-database","cocoa","jquery-ui","xpath","iis","web","d3.js","javafx","firefox","xslt","internet-explorer","caching","select","asp.net-mvc-3","opengl","events","asp.net-web-api","plot","dplyr","encryption","magento","stored-procedures","search","amazon-ec2","ruby-on-rails-4","memory","multidimensional-array","canvas","audio","random","jsf","vector","redux","cookies","input","facebook-graph-api","flash","indexing","xamarin.forms","arraylist","ipad","cocoa-touch","data-structures","video","model-view-controller","azure-devops","serialization","apache-kafka","jdbc","razor","awk","woocommerce","routes","mod-rewrite","servlets","excel-formula","beautifulsoup","filter","iframe","docker-compose","design-patterns","aws-lambda","text","visual-c++","django-rest-framework","cakephp","mobile","android-intent","struct","react-hooks","methods","groovy","mvvm","lambda","ssh","time","checkbox","ecmascript-6","grails","installation","google-chrome-extension","cmake","sharepoint","shiny","spring-security","jakarta-ee","plsql","android-recyclerview","core-data","types","sed","meteor","android-activity","bootstrap-4","activerecord","websocket","replace","graph","group-by","scikit-learn","vim","file-upload","boost","junit","memory-management","sass","async-await","import","deep-learning","error-handling","eloquent","dynamic","dependency-injection","soap","silverlight","layout","apache-spark-sql","charts","deployment","browser","gridview","svn","while-loop","google-bigquery","vuejs2","highcharts","dll","ffmpeg","view","foreach","makefile","plugins","redis","c#-4.0","reporting-services","jupyter-notebook","unicode","merge","reflection","https","server","google-maps-api-3","twitter","oauth-2.0","extjs","terminal","axios","pip","split","cmd","encoding","pytorch","django-views","collections","database-design","hash","netbeans","automation","ember.js","data-binding","build","tcp","pdo","sqlalchemy","apache-flex","entity-framework-core","concurrency","command-line","spring-data-jpa","printing","react-redux","java-8","lua","html-table","neo4j","ansible","service","jestjs","mysqli","enums","parameters","flexbox","material-ui","promise","module","visual-studio-2012","outlook","web-applications","uwp","firebase-authentication","webview","jquery-mobile","utf-8","datatable","python-requests","parallel-processing","colors","drop-down-menu","scipy","tfs","scroll","hive","count","syntax","ms-word","twitter-bootstrap-3","ssis","fonts","rxjs","constructor","file-io","google-analytics","paypal","three.js","powerbi","graphql","cassandra","discord","graphics","compiler-errors","gwt","react-router","socket.io","backbone.js","solr","memory-leaks","url-rewriting","datatables","nlp","terraform","oauth","datagridview","drupal","zend-framework","oracle11g","knockout.js","triggers","interface","neural-network","django-forms","casting","angular-material","jmeter","linked-list","google-api","path","timer","django-templates","arduino","orm","windows-phone-7","directory","proxy","parse-platform","visual-studio-2015","cron","conditional-statements","push-notification","functional-programming","primefaces","pagination","model","jar","xamarin.android","hyperlink","uiview","vbscript","visual-studio-2013","google-cloud-functions","azure-active-directory","gitlab","jwt","download","swift3","sql-server-2005","rspec","process","pygame","configuration","properties","callback","combobox","windows-phone-8","linux-kernel","safari","scrapy","emacs","permissions","x86","clojure","scripting","raspberry-pi","scope","io","azure-functions","compilation","expo","responsive-design","mongodb-query","nhibernate","angularjs-directive","reference","bluetooth","binding","request","architecture","dns","playframework","pyqt","3d","version-control","discord.js","doctrine-orm","package","f#","rubygems","get","sql-server-2012","autocomplete","tree","datepicker","openssl","kendo-ui","jackson","yii","controller","grep","nested","xamarin.ios","static","null","transactions","statistics","datagrid","active-directory","uiviewcontroller","dockerfile","webforms","sas","discord.py","computer-vision","phpmyadmin","notifications","duplicates","pycharm","mocking","youtube","yaml","nullpointerexception","menu","blazor","sum","plotly","bitmap","visual-studio-2008","asp.net-mvc-5","floating-point","css-selectors","yii2","stl","android-listview","electron","jsf-2","time-series","cryptography","ant","hashmap","character-encoding","msbuild","stream","asp.net-core-mvc","sdk","google-drive-api","jboss","selenium-chromedriver","joomla","devise","navigation","cuda","cors","frontend","anaconda","background","binary","multiprocessing","pyqt5","camera","iterator","linq-to-sql","mariadb","onclick","android-jetpack-compose","ios7","microsoft-graph-api","android-asynctask","rabbitmq","tabs","amazon-dynamodb","environment-variables","laravel-4","uicollectionview","insert","linker","coldfusion","xsd","console","continuous-integration","upload","textview","ftp","opengl-es","macros","operating-system","mockito","localization","formatting","xml-parsing","json.net","type-conversion","vuejs3","data.table","kivy","timestamp","integer","calendar","segmentation-fault","android-ndk","prolog","char","drag-and-drop","crash","jasmine","automated-tests","azure-pipelines","dependencies","geometry","fortran","android-gradle-plugin","itext","sprite-kit","mfc","header","attributes","nosql","format","firebase-cloud-messaging","nuxt.js","odoo","db2","jquery-plugins","event-handling","julia","jenkins-pipeline","leaflet","annotations","flutter-layout","keyboard","nestjs","postman","arm","textbox","stripe-payments","visual-studio-2017","gulp","libgdx","uikit","synchronization","timezone","azure-web-app-service","dom-events","wso2","google-sheets-formula","xampp","crystal-reports","namespaces","aggregation-framework","android-emulator","uiscrollview","jvm","swagger","sequelize.js","com","chart.js","snowflake-cloud-data-platform","subprocess","geolocation","webdriver","html5-canvas","garbage-collection","sql-update","centos","dialog","concatenation","numbers","widget","qml","tuples","set","java-stream","mapreduce","ionic2","smtp","windows-10","rotation","android-edittext","nuget","modal-dialog","spring-data","radio-button","doctrine","http-headers","grid","lucene","sonarqube","xmlhttprequest","listbox","initialization","switch-statement","internationalization","components","boolean","apache-camel","google-play","gdb","serial-port","ios5","return","ldap","youtube-api","pivot","eclipse-plugin","latex","frameworks","tags","containers","c++17","github-actions","subquery","embedded","dataset","foreign-keys","asp-classic","label","uinavigationcontroller","delegates","copy","google-cloud-storage","struts2","migration","protractor","base64","uibutton","find","queue","sql-server-2008-r2","arguments","composer-php","append","jaxb","stack","tailwind-css","zip","cucumber","autolayout","ide","entity-framework-6","iteration","popup","r-markdown","windows-7","vb6","airflow","g++","clang","ssl-certificate","hover","jqgrid","range","gmail"],"TriggerEvent":"homepageWizardShow","OauthInPopup":true,"ReturnUrl":"https://stackoverflow.com","ReturnUrlForPopup":"https://stackoverflow.com/users/after-signup/oauth-only","ThemePreferenceFlags":0}</script><script defer src="https://stackoverflow.com/Content/Js/webpack-chunks/svelte.en.js?v=e94edf603d8c"></script><script defer src="https://stackoverflow.com/Content/Js/webpack-chunks/stacks-svelte.en.js?v=fdea6766026e"></script><script defer src="https://stackoverflow.com/Content/Js/webpack-chunks/stacks-svelte-labs.en.js?v=68ceaee5e6e4"></script><script defer src="https://stackoverflow.com/Content/Js/webpack-chunks/1130.en.js?v=8bb363934465"></script><script defer src="https://stackoverflow.com/Content/Js/webpack-chunks/89.en.js?v=30b0d7500f94"></script><script defer src="https://stackoverflow.com/Content/Js/webpack-chunks/316.en.js?v=2109fa72f6e3"></script><script defer src="https://stackoverflow.com/Content/Js/webpack-chunks/6122.en.js?v=d80cfb92f185"></script><script defer src="https://stackoverflow.com/Content/Js/webpack-chunks/8167.en.js?v=d157e568935a"></script><script defer src="https://stackoverflow.com/Content/Js/webpack-chunks/9366.en.js?v=c8d4e4e64bf3"></script><script defer src="https://stackoverflow.com/Content/Js/webpack-chunks/9001.en.js?v=3a153d433746"></script><script defer src="https://stackoverflow.com/Content/Js/islands/homepage-wizard.en.js?v=634a8a250cd2"></script>
<div id="left-sidebar" data-is-here-when="md lg" class="left-sidebar js-pinned-left-sidebar ps-relative">
    <div class="left-sidebar--sticky-container js-sticky-leftnav">
        <nav aria-label="Primary">
            <ol class="nav-links">
                <li>
                    <ol class="nav-links">
                        

<li class="ps-relative"  aria-current="false">


    <a
    href="/"
    class="s-block-link pl8 js-homepage-wizard-link js-gps-track nav-links--link -link__with-icon"
    
    data-gps-track="top_nav.click({is_current: false, location:2, destination:8,  has_activity_notification:False});home_nav.click({location:2})"
    aria-controls=" "
    data-controller="  "
    data-s-popover-placement="right"
    data-left-nav-events-navigation-destination-value=""
    data-left-nav-events-navigation-location-value=""
    data-left-nav-events-navigation-activity-notification-value=""
    data-action=""
    aria-current="false"
    data-s-popover-auto-show="true" data-s-popover-hide-on-outside-click="never"
    >
        <div class="d-flex ai-center">
<svg aria-hidden="true" class="svg-icon iconHome" width="18" height="18"  viewBox="0 0 18 18"><path  d="M15 10v5a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-5H0l9-9 9 9zm-8 1v6h4v-6z"/></svg>                <span class="-link--channel-name pl8">Home</span>

        </div>
    </a>
</li>









                        

<li class="ps-relative  youarehere"  aria-current="true">


    <a id="nav-questions"
    href="/questions"
    class="s-block-link pl8 js-gps-track nav-links--link -link__with-icon"
    
    data-gps-track="top_nav.click({is_current: true, location:2, destination:1,  has_activity_notification:False})"
    aria-controls=" "
    data-controller="  "
    data-s-popover-placement="right"
    data-left-nav-events-navigation-destination-value=""
    data-left-nav-events-navigation-location-value=""
    data-left-nav-events-navigation-activity-notification-value=""
    data-action=""
    aria-current="false"
    data-s-popover-auto-show="true" data-s-popover-hide-on-outside-click="never"
    >
        <div class="d-flex ai-center">
<svg aria-hidden="true" class="svg-icon iconQuestion" width="18" height="18"  viewBox="0 0 18 18"><path  d="m4 15-3 3V4c0-1.1.9-2 2-2h12c1.09 0 2 .91 2 2v9c0 1.09-.91 2-2 2zm7.75-3.97c.72-.83.98-1.86.98-2.94 0-1.65-.7-3.22-2.3-3.83a4.4 4.4 0 0 0-3.02 0 3.8 3.8 0 0 0-2.32 3.83q0 1.93 1.03 3a3.8 3.8 0 0 0 2.85 1.07q.94 0 1.71-.34.97.66 1.06.7.34.2.7.3l.59-1.13a5 5 0 0 1-1.28-.66m-1.27-.9a5 5 0 0 0-1.5-.8l-.45.9q.5.18.98.5-.3.1-.65.11-.92 0-1.52-.68c-.86-1-.86-3.12 0-4.11.8-.9 2.35-.9 3.15 0 .9 1.01.86 3.03-.01 4.08"/></svg>                <span class="-link--channel-name pl8">Questions</span>

        </div>
    </a>
</li>









                            

<li class="ps-relative"  aria-current="false">


    <a id="nav-askstack"
    href="https://stackoverflow.com/ai-assist"
    class="s-block-link h32 pl8 ai-center js-disable-askstack-new-link js-gps-track nav-links--link -link__with-icon"
    
    data-gps-track="top_nav.click({is_current: false, location:2, destination:33,  has_activity_notification:False})"
    aria-controls=" "
    data-controller="  "
    data-s-popover-placement="right"
    data-left-nav-events-navigation-destination-value=""
    data-left-nav-events-navigation-location-value=""
    data-left-nav-events-navigation-activity-notification-value=""
    data-action=""
    aria-current="false"
    data-s-popover-auto-show="true" data-s-popover-hide-on-outside-click="never"
    >
        <div class="d-flex ai-center">
<div class="d-flex ai-center mln8 mrn8 myn8 bg-purple-400 baw3 bas-solid bc-purple-200 bar-circle fc-white p4"><svg aria-hidden="true" class="fc-white bg-transparent h18 w18 svg-icon iconAnswerAI" width="18" height="18"  viewBox="0 0 18 18"><path  d="M15 1a2 2 0 0 1 2 2v14l-3-3H3c-1.09 0-2-.91-2-2V3c0-1.09.91-2 2-2zM8.2 4.13a.2.2 0 0 0-.37 0l-.57 1.31a3.5 3.5 0 0 1-1.82 1.82l-1.3.57a.2.2 0 0 0 0 .36l1.3.57c.82.35 1.47 1 1.82 1.82l.57 1.3c.07.17.3.17.36 0l.57-1.3a3.5 3.5 0 0 1 1.82-1.82l1.3-.57a.2.2 0 0 0 0-.36l-1.3-.57a3.5 3.5 0 0 1-1.82-1.82zm4.9-1.07a.1.1 0 0 0-.2 0l-.28.66c-.17.4-.5.73-.9.9l-.66.29a.1.1 0 0 0 0 .18l.66.29c.4.17.73.5.9.9l.29.66a.1.1 0 0 0 .18 0l.29-.66c.17-.4.5-.73.9-.9l.66-.29a.1.1 0 0 0 0-.18l-.66-.29c-.4-.17-.73-.5-.9-.9z"/></svg></div>                <span class="-link--channel-name pl8">AI Assist</span>

        </div>
    </a>
</li>





    <script>
        $('.js-disable-askstack-new-link').on("click", function(e) {
            StackExchange.helpers.toggleAccountPreferenceFlags(4194304, true);
            return true;
        });
    </script>




                        

<li class="ps-relative"  aria-current="false">


    <a
    href="/tags"
    class="s-block-link pl8 js-gps-track nav-links--link -link__with-icon"
    
    data-gps-track="top_nav.click({is_current: false, location:2, destination:2,  has_activity_notification:False})"
    aria-controls=" "
    data-controller="  "
    data-s-popover-placement="right"
    data-left-nav-events-navigation-destination-value=""
    data-left-nav-events-navigation-location-value=""
    data-left-nav-events-navigation-activity-notification-value=""
    data-action=""
    aria-current="false"
    data-s-popover-auto-show="true" data-s-popover-hide-on-outside-click="never"
    >
        <div class="d-flex ai-center">
<svg aria-hidden="true" class="svg-icon iconTags" width="18" height="18"  viewBox="0 0 18 18"><path  d="M9.24 1a3 3 0 0 0-2.12.88l-5.7 5.7a2 2 0 0 0-.38 2.31 3 3 0 0 1 .67-1.01l6-6A3 3 0 0 1 9.83 2H14a3 3 0 0 1 .79.1A2 2 0 0 0 13 1z" opacity=".4"/><path  d="M9.83 3a2 2 0 0 0-1.42.59l-6 6a2 2 0 0 0 0 2.82L6.6 16.6a2 2 0 0 0 2.82 0l6-6A2 2 0 0 0 16 9.17V5a2 2 0 0 0-2-2zM12 9a2 2 0 1 1 0-4 2 2 0 0 1 0 4"/></svg>                <span class="-link--channel-name pl8">Tags</span>

        </div>
    </a>
</li>









                        <li class="pb24"></li>

            

<li class="ps-relative"  aria-current="false">


    <a id="nav-challenges"
    href="/beta/challenges"
    class="s-block-link h32 pl8 ai-center js-disable-challenges-new-link js-gps-track nav-links--link -link__with-icon"
    
    data-gps-track="top_nav.click({is_current: false, location:2, destination:32,  has_activity_notification:False})"
    aria-controls=" "
    data-controller="  "
    data-s-popover-placement="right"
    data-left-nav-events-navigation-destination-value=""
    data-left-nav-events-navigation-location-value=""
    data-left-nav-events-navigation-activity-notification-value=""
    data-action=""
    aria-current="false"
    data-s-popover-auto-show="true" data-s-popover-hide-on-outside-click="never"
    >
        <div class="d-flex ai-center">
<svg aria-hidden="true" class="svg-icon iconPeak" width="18" height="18"  viewBox="0 0 18 18"><path  d="M10.5 3.5 8 7.25l2 2.25L8.5 11l-3-3.5L1 14h16z"/></svg>                <span class="-link--channel-name pl8">Challenges</span>

        </div>
    </a>
</li>




    <script>
        $('.js-disable-challenges-new-link').on("click", function(e) {
            StackExchange.helpers.toggleAccountPreferenceFlags(1048576, true);
            return true;
        });
    </script>




                            <li class="ps-relative">
                                <a id="nav-chat"
                                href=https://chat.stackoverflow.com/?tab=explore
                                class="s-block-link pl8 ai-center js-disable-chat-new-link js-ch-popover-controller js-gps-track nav-links--link -link__with-icon"
                                aria-expanded="true"
                                aria-current="false"
                                data-gps-track="chat.click({ is_registered:false, rep_bucket:'new', origin:'Stack Overflow' })"
                                data-controller=" "
                                >
                                    <div class="d-flex ai-center">
                                        <div class="d-flex ai-center mln8 mrn8 myn8 bg-purple-400 baw3 bas-solid bc-purple-200 bar-circle fc-white p4"><svg aria-hidden="true" class="fc-white bg-transparent  svg-icon iconChatTest" width="18" height="18"  viewBox="0 0 18 16"><path d="M17 3C17 1.89543 16.1046 1 15 1H7C5.89543 1 5 1.89543 5 3V5C5 6.10457 5.89543 7 7 7H15C16.1046 7 17 6.10457 17 5V3ZM7 3H15V5H7V3Z" /><path d="M17 10C17 8.89543 16.1046 8 15 8H7C5.89543 8 5 8.89543 5 10V14C5 15.1046 5.89543 16 7 16H15C16.1046 16 17 15.1046 17 14V10ZM7 10H15V14H7V10Z" /><path d="M1 9C1 8.44771 1.44772 8 2 8H3C3.55228 8 4 8.44772 4 9V10C4 10.5523 3.55228 11 3 11H2C1.44772 11 1 10.5523 1 10V9Z" /><path d="M2 1C1.44772 1 1 1.44772 1 2V3C1 3.55228 1.44772 4 2 4H3C3.55228 4 4 3.55228 4 3V2C4 1.44772 3.55228 1 3 1H2Z" /></svg></div>
                                    </div>
                                    <span class="-link--channel-name pl8">Chat</span>
                                   </a>
                            </li>

                            

<li class="ps-relative"  aria-current="false">


    <a id="nav-articles"
    href="https://stackoverflow.blog/contributed?utm_medium=referral&amp;utm_source=stackoverflow-community&amp;utm_campaign=so-blog&amp;utm_content=experiment-articles"
    class="s-block-link h32 pl8 js-disable-articles-new-link js-gps-track nav-links--link -link__with-icon"
    
    data-gps-track="top_nav.click({is_current: false, location:2, destination:13,  has_activity_notification:False})"
    aria-controls=" "
    data-controller="  "
    data-s-popover-placement="right"
    data-left-nav-events-navigation-destination-value=""
    data-left-nav-events-navigation-location-value=""
    data-left-nav-events-navigation-activity-notification-value=""
    data-action=""
    aria-current="false"
    data-s-popover-auto-show="true" data-s-popover-hide-on-outside-click="never"
    >
        <div class="d-flex ai-center">
<svg aria-hidden="true" class="svg-icon iconDocumentAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="M5 3a2 2 0 0 0-2 2v10c0 1.1.9 2 2 2h7a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2zm2 3a1 1 0 1 1-2 0 1 1 0 0 1 2 0m-2 4.5c0-.28.22-.5.5-.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5m.5 1.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1 0-1M5 14.5c0-.28.22-.5.5-.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5"/><path  d="M5.9 2h6.35A2.75 2.75 0 0 1 15 4.75v9.35c.62-.6 1-1.43 1-2.35v-7.5C16 2.45 14.54 1 12.75 1h-4.5c-.92 0-1.75.38-2.35 1" opacity=".4"/></svg>                <span class="-link--channel-name pl8">Articles</span>

        </div>
    </a>
</li>








                        

<li class="ps-relative"  aria-current="false">


    <a id="nav-users"
    href="/users"
    class="s-block-link pl8 js-gps-track nav-links--link -link__with-icon"
    
    data-gps-track="top_nav.click({is_current: false, location:2, destination:3,  has_activity_notification:False})"
    aria-controls=" "
    data-controller="  "
    data-s-popover-placement="right"
    data-left-nav-events-navigation-destination-value=""
    data-left-nav-events-navigation-location-value=""
    data-left-nav-events-navigation-activity-notification-value=""
    data-action=""
    aria-current="false"
    data-s-popover-auto-show="true" data-s-popover-hide-on-outside-click="never"
    >
        <div class="d-flex ai-center">
<svg aria-hidden="true" class="svg-icon iconPeople" width="18" height="18"  viewBox="0 0 18 18"><path  d="M17 14c0 .44-.45 1-1 1H9a1 1 0 0 1-1-1H2c-.54 0-1-.56-1-1 0-2.63 3-4 3-4s.23-.4 0-1c-.84-.62-1.06-.59-1-3s1.37-3 2.5-3 2.44.58 2.5 3-.16 2.38-1 3c-.23.59 0 1 0 1s1.55.71 2.42 2.09c.78-.72 1.58-1.1 1.58-1.1s.23-.4 0-1c-.84-.61-1.06-.58-1-3s1.37-3 2.5-3 2.44.59 2.5 3c.05 2.42-.16 2.39-1 3-.23.6 0 1 0 1s3 1.38 3 4"/></svg>                <span class="-link--channel-name pl8">Users</span>

        </div>
    </a>
</li>









                        <li class="pb24"></li>



                            

<li class="ps-relative"  aria-current="false">


    <a id="nav-companies"
    href="https://stackoverflow.com/jobs/companies?so_medium=stackoverflow&amp;so_source=SiteNav"
    class="s-block-link pl8 js-gps-track nav-links--link -link__with-icon"
    
    data-gps-track="top_nav.click({is_current: false, location:2, destination:12,  has_activity_notification:False})"
    aria-controls=" "
    data-controller="  "
    data-s-popover-placement="right"
    data-left-nav-events-navigation-destination-value=""
    data-left-nav-events-navigation-location-value=""
    data-left-nav-events-navigation-activity-notification-value=""
    data-action=""
    aria-current="false"
    data-s-popover-auto-show="true" data-s-popover-hide-on-outside-click="never"
    >
        <div class="d-flex ai-center">
<svg aria-hidden="true" class="svg-icon iconIndustry" width="18" height="18"  viewBox="0 0 18 18"><path  d="M10 16v-4H8v4H2V4c0-1.1.9-2 2-2h6c1.09 0 2 .91 2 2v2h2c1.09 0 2 .91 2 2v8zM4 4v2h2V4zm0 4v2h2V8zm4-4v2h2V4zm0 4v2h2V8zm-4 4v2h2v-2zm8 0v2h2v-2zm0-4v2h2V8z"/></svg>                <span class="-link--channel-name pl8">Companies</span>

        </div>
    </a>
</li>








                            <li class="ml8 mt32 mb4">
                                <div class="d-flex jc-space-between ai-center">
                                    <a
                                    class="s-link d-flex fl-grow1 fc-black-400 h:fc-black-600 fs-fine"
                                    href="javascript:void(0)"
                                    role="button"
                                    aria-controls="popover-discover-collectives"
                                    data-controller="s-popover"
                                    data-action="s-popover#toggle"
                                    data-s-popover-placement="top"
                                    data-s-popover-toggle-class="is-selected"
                                    data-gps-track="top_nav.click({is_current:false, location:2, destination:17})"
                                    >
                                        <div class="flex--item fl-grow1 tt-uppercase fc-black-600 fw-bold">Collectives</div>
                                        <div class="flex--item px12 js-collectives-navcta-toggle">
                                            <svg aria-hidden="true" class="svg-icon iconPlusSm" width="14" height="14"  viewBox="0 0 14 14"><path  d="M8 2H6v4H2v2h4v4h2V8h4V6H8z"/></svg>
                                        </div>
                                    </a>
                                </div>

                            </li>
                                <li class="ps-relative js-collectives-navcta-toggle">
                                    <p class="fs-fine pr8 pl8 pt4 fc-black-400">
                                        Communities for your favorite technologies.  <a href="/collectives-all" class="s-link s-link__grayscale s-link__underlined fw-bold">Explore all Collectives</a>
                                    </p>
                                </li>
                    </ol>
                </li>

                

        

<li class="js-freemium-cta ps-relative mt32 mb8">


    <div class="fs-fine tt-uppercase fc-black-600 fw-bold ml8 mt16 mb8">Stack Internal</div>

    <div class="px8 pt12 pb4 mb12 fc-medium overflow-hidden">        
        <svg aira-hidden="true" class="svg-icon d-block w100 h-auto mb12" height="19" viewBox="0 0 140 19" width="140"><path d="m69.5 6.48047-4.667 4.66603-2.333-2.33302v-2.33301l2.333 2.33301 4.667-4.66602z"/><path d="m72.4971 1.14648c.8282.00028 1.5.67274 1.5 1.50098v11.50004l.0029 1.5918-.0039.1162c-.0819 1.1463-1.3924 1.7776-2.3399 1.1269l-.0937-.0693-3.4561-2.7656h-8.5986v-1.4981h-1.5019v-10.00194c0-.77642.5906-1.41508 1.3466-1.49219l.1534-.00879zm-12.9912 11.50102h9.1269l.4102.3291 3.457 2.7656-.0029-1.5918v-11.50294h-12.9912z"/><path d="m90.5 16.647h16.5v1.5h-18v-17.995145h1.5z"/><path d="m97 15.147h-5v-8.00003h5zm-3.5-1.5h2v-5.00003h-2z"/><path d="m102.494 3.64209h1.506v11.50491h-5v-13.00003h3.494zm-1.994 10.00491h2v-10.00003h-2z"/><path d="m34.9473 6.76648-1.3789 1.38769-1.378-1.38769 1.378-1.3877z"/><path d="m35.2119 1.11023c.4614.00007.9048.18196 1.2324.50684l7.1387 7.08007-1.0605 1.06153 1.0615 1.06053-5.5957 5.6836c-.6762.6868-1.7803.6979-2.4697.0244l-6.9913-6.83201c-.3369-.32927-.5273-.78082-.5273-1.25195v-5.78711c0-.85366.6922-1.5459 1.5459-1.5459zm-5.666 1.5c-.0252 0-.0459.02067-.0459.0459v5.78711c0 .06722.0272.13168.0752.17871l6.9922 6.83205c.0985.096.256.095.3525-.003l5.6035-5.69331-7.1357-7.07519c-.0467-.04625-.11-.0722-.1758-.07227z"/><path d="m11.9995 6.24072v9.23828c-.0003.8629-.6558 1.5736-1.4961 1.6592l-.1709.0088h-8.80473v-1.5h8.80473c.0921-.0002.1667-.0759.167-.168v-9.33203h-3.64263v-3.5h-5.19043c-.09187.00032-.1666.07514-.16699.16699v12.83304h-1.49999932v-12.83304c.00039166-.92028.74669232-1.66667 1.66698932-1.66699h5.33008z"/><path d="m9.21039 13.647h-6.20996v-1.5h6.20996z"/><path d="m9.21039 10.647h-6.20996v-1.50003h6.20996z"/><path d="m5.21625 7.64697h-2.21582v-1.5h2.21582z"/><path d="m124.417 1.22765c1.305-1.3049487 3.422-1.3050445 4.728 0 .739.73976 1.059 1.74043.96 2.70605.966-.09884 1.967.22211 2.707.96191 1.305 1.30543 1.306 3.42196 0 4.72754l-6.668 6.66895 1.332 1.332c.292.2928.292.7677 0 1.0606-.293.2927-.768.2928-1.061 0l-1.509-1.5088c-.488-.4881-.488-1.2794 0-1.7676l6.846-6.84569c.719-.7198.718-1.88681-.001-2.60645-.72-.71944-1.887-.71944-2.606 0l-5.52 5.51954c-.293.2927-.768.2928-1.061 0-.292-.2928-.292-.7676 0-1.0606l5.52-5.51949c.719-.71968.719-1.8867 0-2.60644-.72-.71944-1.887-.71944-2.606 0l-7.198 7.19726c-.293.29274-.767.29262-1.06 0-.293-.29287-.293-.76764 0-1.06054z"/><path d="m126.277 3.088c.293-.29232.768-.29236 1.061 0 .293.29274.292.76761 0 1.06054l-5.44 5.43946c-.704.705-.703 1.8489.001 2.5537.705.7043 1.848.7045 2.553 0l5.439-5.43945c.293-.29255.768-.29278 1.061 0 .292.29278.292.76776 0 1.06055l-5.439 5.4395c-1.291 1.2902-3.383 1.2901-4.674 0-1.291-1.2907-1.292-3.3841-.001-4.67485z"/></svg>
        
        <p class="fs-fine">
            Stack Overflow for Teams is now called <strong>Stack Internal</strong>. Bring the best of human thought and AI automation together at your work.
        </p>
        <a href="https://stackoverflowteams.com/teams/create/free/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=side-bar&utm_content=explore-teams"
           class="w100 s-btn s-btn__filled s-btn__xs js-gps-track pt8 pr7 pb6 pl7"
           data-gps-track="teams.create.left-sidenav.click({ Action: 6 })"
           data-ga="[&quot;teams left navigation - anonymous&quot;,&quot;left nav free cta&quot;,&quot;stackoverflow.com/teams/create/free&quot;,null,null]">Try for free</a>
        <a href="https://stackoverflow.co/internal/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=side-bar&utm_content=explore-teams"
           class="w100 s-btn s-btn__muted s-btn__xs mt1 js-gps-track"
           data-gps-track="teams.create.left-sidenav.click({ Action: 5 })"
           data-ga="[&quot;teams left navigation - anonymous&quot;,&quot;left nav free cta&quot;,&quot;stackoverflow.com/teams&quot;,null,null]">Learn more</a>
    </div>
</li>


    <li class="d-flex ai-center jc-space-between ml8 mt32 mb8 js-create-team-cta d-none">

        <a href="javascript:void(0)"
            class="s-link d-flex fl-grow1 fc-black-400 h:fc-black-600 fs-fine js-gps-track"
            role="button"
            aria-controls="popover-teams-create-cta"
            data-controller="s-popover"
            data-action="s-popover#toggle"
            data-s-popover-placement="bottom-start"
            data-s-popover-toggle-class="is-selected"
            data-gps-track="teams.create.left-sidenav.click({ Action: ShowInfo })"
            data-ga="[&quot;teams left navigation - anonymous&quot;,&quot;left nav show teams info&quot;,null,null,null]"
         >
            <div class="flex--item fl-grow1 fc-black-600 fw-bold tt-uppercase">Stack Internal</div>
            <div class="flex--item px12">
                <svg aria-hidden="true" class="svg-icon iconPlusSm" width="14" height="14"  viewBox="0 0 14 14"><path  d="M8 2H6v4H2v2h4v4h2V8h4V6H8z"/></svg>
            </div>
        </a>
    </li>
    <li class="ps-relative js-create-team-cta d-none">
        <p class="fs-fine pr8 pl8 pb4 fc-black-400">
            Bring the best of human thought and AI automation together at your work.
            <a href="https://stackoverflow.co/internal/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=side-bar&utm_content=explore-teams-compact" class="s-link s-link__grayscale s-link__underlined fw-bold">Learn more</a>
        </p>
    </li> 

            </ol>
        </nav>
    </div>


        <div class="s-popover ws2" id="popover-discover-collectives" role="menu">
            <div class="s-popover--arrow"></div>
            <div>
                <svg aria-hidden="true" class="fc-orange-400 float-right ml24 svg-spot spotCollective" width="48" height="48"  viewBox="0 0 48 48"><path  d="M25.5 7a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5M14 18.25c0-.69.56-1.25 1.25-1.25h22.5c.69 0 1.25.56 1.25 1.25V37.5a1 1 0 0 1-1.6.8l-4.07-3.05a1.3 1.3 0 0 0-.75-.25H15.25c-.69 0-1.25-.56-1.25-1.25zM7 24.5a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0M25.5 48a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5M48 24.5a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0" opacity=".2"/><path  d="M21 3.5a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0M24.5 2a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3M0 23.5a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0M3.5 22a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3M21 44.5a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0m3.5-1.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3m20-23a3.5 3.5 0 1 0 0 7 3.5 3.5 0 0 0 0-7M43 23.5a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0m-23.23-3.14a1 1 0 0 1-.13 1.4l-2.08 1.74 2.08 1.73a1 1 0 1 1-1.28 1.54l-2.42-2.02a1.63 1.63 0 0 1 0-2.5l2.42-2.02a1 1 0 0 1 1.4.13m7.6 1.41a1 1 0 1 1 1.28-1.54l2.42 2.02c.78.65.78 1.85 0 2.5l-2.42 2.02a1 1 0 1 1-1.28-1.54l2.08-1.73zM24.12 18a1 1 0 0 1 .87 1.12l-1 8a1 1 0 1 1-1.98-.24l1-8a1 1 0 0 1 1.11-.87M12.25 13C11.01 13 10 14 10 15.25v15.5c0 1.24 1 2.25 2.25 2.25h17.33q.09 0 .15.05l4.07 3.05a2 2 0 0 0 3.2-1.6V15.25c0-1.24-1-2.25-2.25-2.25zM12 15.25q.02-.23.25-.25h22.5q.23.02.25.25V34.5l-4.07-3.05q-.6-.45-1.35-.45H12.25a.25.25 0 0 1-.25-.25zm7.24-10.68a1 1 0 1 0-.48-1.94A22 22 0 0 0 2.91 17.7a1 1 0 1 0 1.92.58 20 20 0 0 1 14.4-13.72m11.06-1.65a1 1 0 0 0-.58 1.92c6.45 1.92 11.54 7 13.46 13.46a1 1 0 1 0 1.92-.58 22 22 0 0 0-14.8-14.8M4.57 28.76a1 1 0 0 0-1.94.48 22 22 0 0 0 16.13 16.13 1 1 0 1 0 .48-1.94A20 20 0 0 1 4.57 28.76m40.8.48a1 1 0 1 0-1.94-.48 20 20 0 0 1-13.72 14.41 1 1 0 0 0 .58 1.92 22 22 0 0 0 15.08-15.85"/></svg>
                <h5 class="pt4 fw-bold">Collectives on Stack Overflow</h5>
                <p class="my16 fs-caption fc-black-500">Find centralized, trusted content and collaborate around the technologies you use most.</p>
                <a href="/collectives"
                class="js-gps-track s-btn s-btn__filled s-btn__xs"
                data-gps-track="top_nav.click({is_current:false, location:2, destination:18})">
                    Learn more about Collectives
                </a>
            </div>
        </div>

        <div class="s-popover ws2"
        id="popover-teams-create-cta"
        role="menu"
        aria-hidden="true">
            <div class="s-popover--arrow"></div>

            <div class="ps-relative overflow-hidden">
                <p class="mb2"><strong>Stack Internal</strong></p>
                <p class="mb12 fs-caption fc-black-400">Knowledge at work</p>
                <p class="mb12 fs-caption fc-black-500">Bring the best of human thought and AI automation together at your work.</p>
                <a href="https://stackoverflow.co/internal/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=side-bar&utm_content=explore-teams-compact-popover"
                class="js-gps-track s-btn s-btn__filled s-btn__xs"
                data-gps-track="teams.create.left-sidenav.click({ Action: CtaClick })"
                data-ga="[&quot;teams left navigation - anonymous&quot;,&quot;left nav cta&quot;,&quot;stackoverflow.com/teams&quot;,null,null]">
                    Explore Stack Internal
                </a>
            </div>

            <div class="ps-absolute t8 r8">
                <svg aria-hidden="true" class="fc-orange-400 svg-spot spotPeople" width="48" height="48"  viewBox="0 0 48 48"><path  d="M13.5 28a4.5 4.5 0 1 0 0-9 4.5 4.5 0 0 0 0 9M7 30a1 1 0 0 1 1-1h11a1 1 0 0 1 1 1v5h11v-5a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v10a2 2 0 0 1-2 2H33v5a1 1 0 0 1-1 1H20a1 1 0 0 1-1-1v-5H8a1 1 0 0 1-1-1zm25-6.5a4.5 4.5 0 1 0 9 0 4.5 4.5 0 0 0-9 0M24.5 34a4.5 4.5 0 1 0 0-9 4.5 4.5 0 0 0 0 9" opacity=".2"/><path  d="M16.4 26.08A6 6 0 1 0 7.53 26C5.64 26.06 4 27.52 4 29.45V40a1 1 0 0 0 1 1h9a1 1 0 1 0 0-2h-4v-7a1 1 0 1 0-2 0v7H6v-9.55c0-.73.67-1.45 1.64-1.45H16a1 1 0 0 0 .4-1.92M12 18a4 4 0 1 1 0 8 4 4 0 0 1 0-8m16.47 14a6 6 0 1 0-8.94 0A3.6 3.6 0 0 0 16 35.5V46a1 1 0 0 0 1 1h14a1 1 0 0 0 1-1V35.5c0-1.94-1.64-3.42-3.53-3.5M20 28a4 4 0 1 1 8 0 4 4 0 0 1-8 0m-.3 6h8.6c1 0 1.7.75 1.7 1.5V45h-2v-7a1 1 0 1 0-2 0v7h-4v-7a1 1 0 1 0-2 0v7h-2v-9.5c0-.75.7-1.5 1.7-1.5M42 22c0 1.54-.58 2.94-1.53 4A3.5 3.5 0 0 1 44 29.45V40a1 1 0 0 1-1 1h-9a1 1 0 1 1 0-2h4v-7a1 1 0 1 1 2 0v7h2v-9.55A1.5 1.5 0 0 0 40.48 28H32a1 1 0 0 1-.4-1.92A6 6 0 1 1 42 22m-2 0a4 4 0 1 0-8 0 4 4 0 0 0 8 0"/><g  opacity=".35"><path d="M17 10a1 1 0 011-1h12a1 1 0 110 2H18a1 1 0 01-1-1m1-5a1 1 0 100 2h12a1 1 0 100-2zM14 1a1 1 0 00-1 1v12a1 1 0 001 1h5.09l4.2 4.2a1 1 0 001.46-.04l3.7-4.16H34a1 1 0 001-1V2a1 1 0 00-1-1zm1 12V3h18v10h-5a1 1 0 00-.75.34l-3.3 3.7-3.74-3.75a1 1 0 00-.71-.29z"/></g></svg>
            </div>
        </div>




</div>



        <div id="content" class="snippet-hidden">

            



<div itemprop="mainEntity" itemscope itemtype="https://schema.org/Question">
    <link itemprop="image" href="https://stackoverflow.com/Content/Sites/stackoverflow/Img/apple-touch-icon.png?v=c78bd457575a">

    <div class="inner-content clearfix">
        

            <div id="question-header" class="d-flex sm:fd-column">
                        <h1 itemprop="name" class="fs-headline1 ow-anywhere mb8 flex--item fl1"><a href="/questions/11227809/why-is-processing-a-sorted-array-faster-than-processing-an-unsorted-array" class="question-hyperlink">Why is processing a sorted array faster than processing an unsorted array?</a></h1>

                <div class="ml12 aside-cta flex--item sm:ml0 sm:mb12 sm:order-first d-flex jc-end">

                        <div class="ml12 aside-cta flex--item print:d-none">
                                <a href="/questions/ask" class="ws-nowrap s-btn s-btn__filled">
        Ask Question
    </a>

                        </div>
                </div>
            </div>
                <div class="d-flex fw-wrap pb8 mb16 bb bc-black-200">
                        <div class="flex--item ws-nowrap mr16 mb8" title="2012-06-27 13:51:36Z">
                            <span class="fc-black-400 mr2">Asked</span>
                            <time itemprop="dateCreated"
                                  datetime="2012-06-27 13:51:36Z">13 years, 7 months ago</time>
                        </div>
                        <div class="flex--item ws-nowrap mr16 mb8">
                            <span class="fc-black-400 mr2">Modified</span>
                            <a href="?lastactivity" class="s-link s-link__inherit"
                               title="2026-01-05 02:31:42Z">1 month ago</a>
                        </div>
                        <div class="flex--item ws-nowrap mb8"
                             title="Viewed 1,969,057 times">
                            <span class="fc-black-400 mr2">Viewed</span>
                            2.0m times
                        </div>
                </div>



            <div id="mainbar" role="main" aria-label="question and answers">
                
<div class="question js-question" data-questionid="11227809" data-position-on-page="0"
     data-score="27519"
     data-author-username="GManNickG"
     data-should-show-copy-button="True"
     data-se-share-sheet-license-name="CC BY-SA 4.0"
     data-author-reputation="506673" 
     data-is-edited="True"
     id="question">
    <style>
    </style>
<div class="js-zone-container zone-container-main">
    <div id="dfp-tlb" class="everyonelovesstackoverflow everyoneloves__top-leaderboard everyoneloves__leaderboard"></div>
		<div class="js-report-ad-button-container " style="width: 728px"></div>
</div>

    <div class="post-layout ">
            <div class="votecell post-layout--left">
                
<div class="js-voting-container d-flex jc-center fd-column ai-center gs4 fc-black-300" data-post-id="11227809" data-referrer="None">
        <button class="js-vote-up-btn flex--item s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
                id="upvote-btn-11227809"
                data-controller="s-tooltip"
                data-s-tooltip-placement="right"
                title="This question shows research effort; it is useful and clear"
                aria-pressed="false"
                aria-label="Up vote"
                data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
                data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">
            <svg aria-hidden="true" class="svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg>
        </button>
        <input type="hidden" id="voteUpHash" value="70:3:31e,16:e2f18ffbf176d5f0,10:1771427630,16:d84524632e606d7b,8:11227809,156b168330598a5f700f861f2f66a48c2aed386e63dc1b16293d405384ed2c01" />
        <div class="js-vote-count flex--item d-flex fd-column ai-center fc-theme-body-font fw-bold fs-subheading py4"
             itemprop="upvoteCount"
             data-value="27519">
27519        </div>
        <button
            class="js-vote-down-btn js-vote-down-question flex--item mb8 s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
            id=downvote-btn-11227809
            title="This question does not show any research effort; it is unclear or not useful"
            aria-pressed="false"
            aria-label="Down vote"
            data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
            data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">

            <svg aria-hidden="true" class="svg-icon iconArrowDown" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 6h16l-8 8z"/></svg>
        </button>
        <input type="hidden" id="voteDownHash" value="70:3:31e,16:ffdbca23177d8bc4,10:1771427630,16:300d0b1d12646401,8:11227809,1c3db9ecdddcdaa1c4252e007578930985cc8438d0fc323684a2cb16161ae1e1" />


        
<button class="js-saves-btn s-btn s-btn__unset c-pointer py4"
        type="button"
        id="saves-btn-11227809"
        data-controller="s-tooltip"
        data-s-tooltip-placement="right"
        data-s-popover-placement=""
        title="Save this question."
        data-is-saved="false"
        aria-label="Save"
        data-post-id="11227809"
        data-post-type-id="1"
        data-user-privilege-for-post-click="0"
        aria-controls=""
        data-s-popover-auto-show="false"
>
    <svg aria-hidden="true" class="fc-theme-primary-400 js-saves-btn-selected d-none svg-icon iconBookmark" width="18" height="18"  viewBox="0 0 18 18"><path  d="M3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
    <svg aria-hidden="true" class="js-saves-btn-unselected svg-icon iconBookmarkAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m9 10.6 4 2.66V3H5v10.26zM3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
</button>








    
    <a class="js-post-issue flex--item s-btn s-btn__unset c-pointer py6 mx-auto" href="/posts/11227809/timeline" data-shortcut="T" data-ks-title="timeline" data-controller="s-tooltip" data-s-tooltip-placement="right" title="Show activity on this post." aria-label="Timeline"><svg aria-hidden="true" class="mln2 mr0 svg-icon iconHistory" width="19" height="18"  viewBox="0 0 19 18"><path  d="M3 9a8 8 0 1 1 3.73 6.77L8.2 14.3A6 6 0 1 0 5 9l3.01-.01-4 4-4-4zm7-4h1.01L11 9.36l3.22 2.1-.6.93L10 10z"/></svg></a>

</div>

            </div>

        
<div class="postcell post-layout--right">

    
    <div class="s-prose js-post-body" itemprop="text">
                
<p>In this C++ code, sorting the data (<em>before</em> the timed region) makes the primary loop ~6x faster:</p>
<pre class="lang-cpp prettyprint-override"><code>#include &lt;algorithm&gt;
#include &lt;ctime&gt;
#include &lt;iostream&gt;

int main()
{
    // Generate data
    const unsigned arraySize = 32768;
    int data[arraySize];

    for (unsigned c = 0; c &lt; arraySize; ++c)
        data[c] = std::rand() % 256;

    // !!! With this, the next loop runs faster.
    std::sort(data, data + arraySize);

    // Test
    clock_t start = clock();
    long long sum = 0;
    for (unsigned i = 0; i &lt; 100000; ++i)
    {
        for (unsigned c = 0; c &lt; arraySize; ++c)
        {   // Primary loop.
            if (data[c] &gt;= 128)
                sum += data[c];
        }
    }

    double elapsedTime = static_cast&lt;double&gt;(clock()-start) / CLOCKS_PER_SEC;

    std::cout &lt;&lt; elapsedTime &lt;&lt; '\n';
    std::cout &lt;&lt; &quot;sum = &quot; &lt;&lt; sum &lt;&lt; '\n';
}
</code></pre>
<ul>
<li>Without <code>std::sort(data, data + arraySize);</code>, the code runs in 11.54 seconds.</li>
<li>With the sorted data, the code runs in 1.93 seconds.</li>
</ul>
<p>(Sorting itself takes more time than this one pass over the array, so it's not actually worth doing if we needed to calculate this for an unknown array.)</p>
<hr />
<p>Initially, I thought this might be just a language or compiler anomaly, so I tried Java:</p>
<pre class="lang-java prettyprint-override"><code>import java.util.Arrays;
import java.util.Random;

public class Main
{
    public static void main(String[] args)
    {
        // Generate data
        int arraySize = 32768;
        int data[] = new int[arraySize];

        Random rnd = new Random(0);
        for (int c = 0; c &lt; arraySize; ++c)
            data[c] = rnd.nextInt() % 256;

        // !!! With this, the next loop runs faster
        Arrays.sort(data);

        // Test
        long start = System.nanoTime();
        long sum = 0;
        for (int i = 0; i &lt; 100000; ++i)
        {
            for (int c = 0; c &lt; arraySize; ++c)
            {   // Primary loop.
                if (data[c] &gt;= 128)
                    sum += data[c];
            }
        }

        System.out.println((System.nanoTime() - start) / 1000000000.0);
        System.out.println(&quot;sum = &quot; + sum);
    }
}
</code></pre>
<p>With a similar but less extreme result.</p>
<hr />
<p>My first thought was that sorting brings the data into the <a href="https://en.wikipedia.org/wiki/CPU_cache" rel="noreferrer">cache</a>, but that's silly because the array was just generated.</p>
<ul>
<li>What is going on?</li>
<li>Why is processing a sorted array faster than processing an unsorted array?</li>
</ul>
<p>The code is summing up some independent terms, so the order should not matter.</p>
<hr />
<h2>Related / follow-up Q&amp;As with more modern C++ compilers</h2>
<ul>
<li><a href="https://stackoverflow.com/q/66521344">Why is processing an unsorted array the same speed as processing a sorted array with modern x86-64 clang?</a> - <strong>modern C++ compilers auto-vectorize the loop</strong>, especially when SSE4.1 or AVX2 is available.  This avoids any data-dependent branching so performance isn't data-dependent.</li>
<li><a href="https://stackoverflow.com/q/28875325">gcc optimization flag -O3 makes code slower than -O2</a> - branchless scalar with <code>cmov</code> can result in a longer dependency chain (especially when GCC chooses poorly), creating a latency bottleneck that makes it slower than branchy asm for the sorted case.</li>
</ul>
    </div>

            <div class="mt24 mb12">
                <div class="post-taglist d-flex gs4 gsy fd-column">
                    <div class="d-flex ps-relative fw-wrap">
                        
                        <ul class='ml0 list-ls-none js-post-tag-list-wrapper d-inline'><li class='d-inline mr4 js-post-tag-list-item'><a href="/questions/tagged/java" class="s-tag post-tag" title="show questions tagged &#39;java&#39;" aria-label="show questions tagged &#39;java&#39;" rel="tag" aria-labelledby="tag-java-tooltip-container" data-tag-menu-origin="Unknown">java</a></li><li class='d-inline mr4 js-post-tag-list-item'><a href="/questions/tagged/c%2b%2b" class="s-tag post-tag" title="show questions tagged &#39;c++&#39;" aria-label="show questions tagged &#39;c++&#39;" rel="tag" aria-labelledby="tag-c++-tooltip-container" data-tag-menu-origin="Unknown">c++</a></li><li class='d-inline mr4 js-post-tag-list-item'><a href="/questions/tagged/performance" class="s-tag post-tag" title="show questions tagged &#39;performance&#39;" aria-label="show questions tagged &#39;performance&#39;" rel="tag" aria-labelledby="tag-performance-tooltip-container" data-tag-menu-origin="Unknown">performance</a></li><li class='d-inline mr4 js-post-tag-list-item'><a href="/questions/tagged/cpu-architecture" class="s-tag post-tag" title="show questions tagged &#39;cpu-architecture&#39;" aria-label="show questions tagged &#39;cpu-architecture&#39;" rel="tag" aria-labelledby="tag-cpu-architecture-tooltip-container" data-tag-menu-origin="Unknown">cpu-architecture</a></li><li class='d-inline mr4 js-post-tag-list-item'><a href="/questions/tagged/branch-prediction" class="s-tag post-tag" title="show questions tagged &#39;branch-prediction&#39;" aria-label="show questions tagged &#39;branch-prediction&#39;" rel="tag" aria-labelledby="tag-branch-prediction-tooltip-container" data-tag-menu-origin="Unknown">branch-prediction</a></li></ul>
                    </div>
                </div>
            </div>

    <div class="mb0 ">
        <div class="mt16 d-flex gs8 gsy fw-wrap jc-end ai-start pt4 mb16">
            <div class="flex--item mr16 fl1 w96">
                


<div class="js-post-menu pt2" data-post-id="11227809" data-post-type-id="1">

    <div class="d-flex gs8 s-anchors s-anchors__muted fw-wrap">

        <div class="flex--item">
            <a href="/q/11227809"
               rel="nofollow"
               itemprop="url"
               class="js-share-link js-gps-track"
               title="Short permalink to this question"
               data-gps-track="post.click({ item: 2, priv: 0, post_type: 1 })"
               data-controller="se-share-sheet"
               data-se-share-sheet-title="Share a link to this question"
               data-se-share-sheet-subtitle=""
               data-se-share-sheet-post-type="question"
               data-se-share-sheet-social="facebook twitter devto"
               data-se-share-sheet-location="1"
               data-se-share-sheet-license-url="https%3a%2f%2fcreativecommons.org%2flicenses%2fby-sa%2f4.0%2f"
               data-se-share-sheet-license-name="CC BY-SA 4.0"
               data-s-popover-placement="bottom-start">Share</a>
        </div>


                    <div class="flex--item">
                        <a href="/posts/11227809/edit" class="js-suggest-edit-post js-gps-track" data-gps-track="post.click({ item: 6, priv: 0, post_type: 1 })" title="">Improve this question</a>
                    </div>

                <div class="flex--item">
                    <button type="button"
                            id="btnFollowPost-11227809" class="s-btn s-btn__link js-follow-post js-follow-question js-gps-track"
                            data-gps-track="post.click({ item: 14, priv: 0, post_type: 1 })"
                            data-controller="s-tooltip " data-s-tooltip-placement="bottom"
                            data-s-popover-placement="bottom" aria-controls=""
                            title="Follow this question to receive notifications">
                        Follow
                        <input type="hidden" id="voteFollowHash" value="70:3:31e,16:de660622111813d9,10:1771427630,16:8e90d051c3cbca4c,8:11227809,34ec7c05944b9d060260b56ab5a955bd6b9e7633c4bbb3811421ec3e4481ace3" />
                    </button>
                </div>






    </div>
    <div class="js-menu-popup-container"></div>
</div>
            </div>

                <div class="post-signature flex--item">
<div class="user-info user-hover ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            <a href="/posts/11227809/revisions" title="show all edits to this post"
                         class="js-gps-track"
                         data-gps-track="post.click({ item: 4, priv: 0, post_type: 1 })">edited <span title='2025-05-23 14:23:04Z' class='relativetime'>May 23, 2025 at 14:23</span></a>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/224132/peter-cordes"><div class="gravatar-wrapper-32"><img src="https://i.sstatic.net/N4ivW.png?s=64" alt="Peter Cordes&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/224132/peter-cordes" dir="auto">Peter Cordes</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 379,441" dir="ltr">379k</span><span title="52 gold badges" aria-hidden="true"><span class="badge1"></span><span class="badgecount">52</span></span><span class="v-visible-sr">52 gold badges</span><span title="754 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">754</span></span><span class="v-visible-sr">754 silver badges</span><span title="1k bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">1k</span></span><span class="v-visible-sr">1k bronze badges</span>
        </div>
    </div>
</div>
                </div>

                <div class="post-signature owner flex--item">
                    <div class="user-info user-hover ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            asked <span title='2012-06-27 13:51:36Z' class='relativetime'>Jun 27, 2012 at 13:51</span>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/87234/gmannickg"><div class="gravatar-wrapper-32"><img src="https://i.sstatic.net/FkjBe.png?s=64" alt="GManNickG&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <a href="/users/87234/gmannickg" itemprop="url" dir="auto">GManNickG</a><meta itemprop="name" content="GManNickG"/>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 506,673" dir="ltr">507k</span><span title="56 gold badges" aria-hidden="true"><span class="badge1"></span><span class="badgecount">56</span></span><span class="v-visible-sr">56 gold badges</span><span title="505 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">505</span></span><span class="v-visible-sr">505 silver badges</span><span title="551 bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">551</span></span><span class="v-visible-sr">551 bronze badges</span>
        </div>
    </div>
</div>


                </div>
        </div>
    </div>
    
</div>




            

<span class="d-none" itemprop="commentCount">13</span>
	<div class="post-layout--right js-post-comments-component" data-has-opted-out="False">
        <div id="comments-11227809" class="comments js-comments-container bt bc-black-200 mt12 " data-post-id="11227809" data-min-length="15">
            <ul class="comments-list js-comments-list"
                    data-remaining-comments-count="8"
                    data-canpost="false"
                    data-cansee="true"
                    data-comments-unavailable="false"
                    data-addlink-disabled="true">

                        <li id="comment-87601479" itemprop="comment" itemscope itemtype="https://schema.org/Comment" class="comment js-comment " data-comment-id="87601479" data-comment-owner-id="5649936" data-comment-score="165">
        <div class="js-comment-actions comment-actions">
            <div class="comment-score js-comment-score js-comment-edit-hide">
                    <span title="number of &#x27;useful comment&#x27; votes received"
                            class="supernova">165</span>
            </div>
        </div>
        <div class="comment-text  js-comment-text-and-form">
            <div class="comment-body js-comment-edit-hide">
                
                <span class="comment-copy" itemprop="text">Another observation is that you don&#39;t need to sort the array, but you just need to partition it with the value 128. Sorting is n*log(n), whereas partitioning is just linear. Basically it is just one run of the quick sort partitioning step with the pivot chosen to be 128. Unfortunately in C++ there is just nth_element function, which partition by position, not by value.</span>
                
                <div class="d-inline-flex ai-center" itemprop="author" itemscope itemtype="https://schema.org/Person">
                    <div class="d-none" itemprop="name">&#x160;imon Hrabec</div>
&ndash;&nbsp;
                        <a href="/users/5649936/%c5%a0imon-hrabec"
                           title="924 reputation"
                           class="comment-user"
                           itemprop="url">&#x160;imon Hrabec</a>
                </div>
                <div class="d-none" itemprop="datePublished">2018-05-11 12:45:08 &#x2B;00:00</div>
                <span class="comment-date" dir="ltr">
                    <span class="v-visible-sr">Commented</span>
                    <span title='2018-05-11 12:45:08Z, License: CC BY-SA 4.0' class='relativetime-clean'>May 11, 2018 at 12:45</span>
                </span>
            </div>
        </div>
    </li>
    <li id="comment-113534273" itemprop="comment" itemscope itemtype="https://schema.org/Comment" class="comment js-comment " data-comment-id="113534273" data-comment-owner-id="58668" data-comment-score="69">
        <div class="js-comment-actions comment-actions">
            <div class="comment-score js-comment-score js-comment-edit-hide">
                    <span title="number of &#x27;useful comment&#x27; votes received"
                            class="supernova">69</span>
            </div>
        </div>
        <div class="comment-text  js-comment-text-and-form">
            <div class="comment-body js-comment-edit-hide">
                
                <span class="comment-copy" itemprop="text">@screwnut here&#39;s an experiment which would show that partitioning is sufficient: create an unsorted but partitioned array with otherwise random contents. Measure time. Sort it. Measure time again. The two measurements should be basically indistinguishable. (Experiment 2: create a random array. Measure time. Partition it. Measure time again. You should see the same speed-up as sorting. You could roll the two experiments into one.)</span>
                
                <div class="d-inline-flex ai-center" itemprop="author" itemscope itemtype="https://schema.org/Person">
                    <div class="d-none" itemprop="name">Jonas K&#xF6;lker</div>
&ndash;&nbsp;
                        <a href="/users/58668/jonas-k%c3%b6lker"
                           title="7,837 reputation"
                           class="comment-user"
                           itemprop="url">Jonas K&#xF6;lker</a>
                </div>
                <div class="d-none" itemprop="datePublished">2020-10-05 08:26:16 &#x2B;00:00</div>
                <span class="comment-date" dir="ltr">
                    <span class="v-visible-sr">Commented</span>
                    <span title='2020-10-05 08:26:16Z, License: CC BY-SA 4.0' class='relativetime-clean'>Oct 5, 2020 at 8:26</span>
                </span>
            </div>
        </div>
    </li>
    <li id="comment-118229765" itemprop="comment" itemscope itemtype="https://schema.org/Comment" class="comment js-comment " data-comment-id="118229765" data-comment-owner-id="80869" data-comment-score="63">
        <div class="js-comment-actions comment-actions">
            <div class="comment-score js-comment-score js-comment-edit-hide">
                    <span title="number of &#x27;useful comment&#x27; votes received"
                            class="supernova">63</span>
            </div>
        </div>
        <div class="comment-text  js-comment-text-and-form">
            <div class="comment-body js-comment-edit-hide">
                
                <span class="comment-copy" itemprop="text">Btw. on Apple M1 the code runs in 17 sec unsorted, and in 7 sec sorted, so the branch prediction penalty isn&#39;t that bad on risc architecture.</span>
                
                <div class="d-inline-flex ai-center" itemprop="author" itemscope itemtype="https://schema.org/Person">
                    <div class="d-none" itemprop="name">Piotr Czapla</div>
&ndash;&nbsp;
                        <a href="/users/80869/piotr-czapla"
                           title="26,758 reputation"
                           class="comment-user"
                           itemprop="url">Piotr Czapla</a>
                </div>
                <div class="d-none" itemprop="datePublished">2021-03-31 09:07:05 &#x2B;00:00</div>
                <span class="comment-date" dir="ltr">
                    <span class="v-visible-sr">Commented</span>
                    <span title='2021-03-31 09:07:05Z, License: CC BY-SA 4.0' class='relativetime-clean'>Mar 31, 2021 at 9:07</span>
                </span>
            </div>
        </div>
    </li>
    <li id="comment-118610990" itemprop="comment" itemscope itemtype="https://schema.org/Comment" class="comment js-comment " data-comment-id="118610990" data-comment-owner-id="224132" data-comment-score="54">
        <div class="js-comment-actions comment-actions">
            <div class="comment-score js-comment-score js-comment-edit-hide">
                    <span title="number of &#x27;useful comment&#x27; votes received"
                            class="supernova">54</span>
            </div>
        </div>
        <div class="comment-text  js-comment-text-and-form">
            <div class="comment-body js-comment-edit-hide">
                
                <span class="comment-copy" itemprop="text">@RomanYavorskyi: It depends on the compiler.  If they make branchless asm for this specific test (e.g. as part of vectorizing with SIMD like in <a href="https://stackoverflow.com/q/66521344">Why is processing an unsorted array the same speed as processing a sorted array with modern x86-64 clang?</a>, or just with scalar <code>cmov</code> (<a href="https://stackoverflow.com/q/28875325">gcc optimization flag -O3 makes code slower than -O2</a>), then sorted or not doesn&#39;t matter.  But unpredictable branches are still a very real thing when it&#39;s not as simple as counting, so it would be insane to delete this question.</span>
                
                <div class="d-inline-flex ai-center" itemprop="author" itemscope itemtype="https://schema.org/Person">
                    <div class="d-none" itemprop="name">Peter Cordes</div>
&ndash;&nbsp;
                        <a href="/users/224132/peter-cordes"
                           title="379,441 reputation"
                           class="comment-user"
                           itemprop="url">Peter Cordes</a>
                </div>
                <div class="d-none" itemprop="datePublished">2021-04-15 06:31:27 &#x2B;00:00</div>
                <span class="comment-date" dir="ltr">
                    <span class="v-visible-sr">Commented</span>
                    <span title='2021-04-15 06:31:27Z, License: CC BY-SA 4.0' class='relativetime-clean'>Apr 15, 2021 at 6:31</span>
                </span>
                        <span title="this comment was edited 2 times">
                            <svg aria-hidden="true" class="va-text-bottom o50 svg-icon iconPencilSm" width="14" height="14"  viewBox="0 0 14 14"><path fill="#F1B600" d="m2 10.12 6.37-6.43 1.88 1.88L3.88 12H2z"/><path fill="#E87C87" d="m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0"/></svg>
                        </span>
            </div>
        </div>
    </li>
    <li id="comment-118611283" itemprop="comment" itemscope itemtype="https://schema.org/Comment" class="comment js-comment " data-comment-id="118611283" data-comment-owner-id="224132" data-comment-score="38">
        <div class="js-comment-actions comment-actions">
            <div class="comment-score js-comment-score js-comment-edit-hide">
                    <span title="number of &#x27;useful comment&#x27; votes received"
                            class="supernova">38</span>
            </div>
        </div>
        <div class="comment-text  js-comment-text-and-form">
            <div class="comment-body js-comment-edit-hide">
                
                <span class="comment-copy" itemprop="text">@screwnut: To be fair, though, it still wouldn&#39;t be worth partitioning first, because partitioning requires conditional copying or swapping based on the same <code>array[i] &gt; 128</code> compare.  (Unless you&#39;re going to be counting multiple times, and you want to partition the bulk of an array so it&#39;s still fast, only mispredicting in an unpartitioned part after some appends or modifications).  If you can get the compiler to do it, ideally just vectorize with SIMD, or at least use branchless scalar if the data is unpredictable.  (See previous comment for links.)</span>
                
                <div class="d-inline-flex ai-center" itemprop="author" itemscope itemtype="https://schema.org/Person">
                    <div class="d-none" itemprop="name">Peter Cordes</div>
&ndash;&nbsp;
                        <a href="/users/224132/peter-cordes"
                           title="379,441 reputation"
                           class="comment-user"
                           itemprop="url">Peter Cordes</a>
                </div>
                <div class="d-none" itemprop="datePublished">2021-04-15 06:46:53 &#x2B;00:00</div>
                <span class="comment-date" dir="ltr">
                    <span class="v-visible-sr">Commented</span>
                    <span title='2021-04-15 06:46:53Z, License: CC BY-SA 4.0' class='relativetime-clean'>Apr 15, 2021 at 6:46</span>
                </span>
            </div>
        </div>
    </li>

            </ul>
	    </div>

        <div id="comments-link-11227809" data-rep=1 data-anon=true>
                    <a
                        class="js-add-link comments-link dno"
                        title="Use comments to ask for more information or suggest improvements. Avoid answering questions in comments."
                        
                        href="#"
                        role="button"
                        data-show-first-time-commenting="False">
                        
                    </a>
                <span class="js-link-separator dno">&nbsp;|&nbsp;</span>
            <a
                class="js-show-link comments-link "
                title="Expand to show all comments on this post"
                href=#
                onclick=""
                role="button">
                Show <b>8</b> more comments
            </a>
        </div>         
    </div>

    </div>

</div>


<div class="js-zone-container zone-container-responsive">
    <div id="dfp-isb" class="everyonelovesstackoverflow everyoneloves__inline-sidebar mx-auto"></div>
		<div class="js-report-ad-button-container mx-auto" style="width: 300px"></div>
</div>



                <div id="answers" class="">
                        <a name="tab-top"></a>
                        <div id="answers-header">
                            <div class="answers-subheader d-flex ai-center mb8">
                                <div class="flex--item fl1">
                                    <h2 class="mb0" data-answercount="26">
26 Answers                                        <span style="display:none;" itemprop="answerCount">26</span>
                                    </h2>
                                </div>
                                <div class="flex--item">
                                        

<div class="d-flex g4 gsx ai-center sm:fd-column sm:ai-start">
    <div class="d-flex fd-column ai-end sm:ai-start">
        <label class="flex--item fs-caption" for="answer-sort-dropdown-select-menu">
            Sorted by:
        </label>
        <a 
            class="js-sort-preference-change s-link flex--item fs-fine d-none"
            data-value="ScoreDesc"
            href="/questions/11227809/why-is-processing-a-sorted-array-faster-than-processing-an-unsorted-array?answertab=scoredesc#tab-top"
        >
            Reset to default
        </a>
    </div>
    <div class="flex--item s-select">
        <select id="answer-sort-dropdown-select-menu">
                    <option
                        value=scoredesc
                        selected=selected
                    >
                        Highest score (default)
                    </option>
                    <option
                        value=trending
                    >
                        Trending (recent votes count more)
                    </option>
                    <option
                        value=modifieddesc
                    >
                        Date modified (newest first)
                    </option>
                    <option
                        value=createdasc
                    >
                        Date created (oldest first)
                    </option>
        </select>
    </div>
</div>


                                </div>
                            </div>


                                

                        </div>
                                        
<a name="11227902"></a>
<div id="answer-11227902" class="answer js-answer accepted-answer js-accepted-answer " data-answerid="11227902"
     data-parentid="11227809" data-score="35265" data-position-on-page="1"
     data-highest-scored="1"
     data-question-has-accepted-highest-score="1"
     data-author-username="Mysticial"
     data-author-reputation="473173"
     data-should-show-copy-button=True
     data-se-share-sheet-license-name="CC BY-SA 4.0"
     data-is-edited="True"
      itemprop="acceptedAnswer"
     itemscope itemtype="https://schema.org/Answer">
        <div class="post-layout ">
                <div class="votecell post-layout--left">
                    
<div class="js-voting-container d-flex jc-center fd-column ai-center gs4 fc-black-300" data-post-id="11227902" data-referrer="None">
        <button class="js-vote-up-btn flex--item s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
                id="upvote-btn-11227902"
                data-controller="s-tooltip"
                data-s-tooltip-placement="right"
                title="This answer is useful"
                aria-pressed="false"
                aria-label="Up vote"
                data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
                data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">
            <svg aria-hidden="true" class="svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg>
        </button>
        <input type="hidden" id="voteUpHash" value="70:3:31e,16:fbb15a820e87afc6,10:1771427630,16:849590781d00faf0,8:11227902,6cd0bbec2c80c97e77e18c290e397a9fcd7f828c80b22cc8bc6cb6683af80dd8" />
        <div class="js-vote-count flex--item d-flex fd-column ai-center fc-theme-body-font fw-bold fs-subheading py4"
             itemprop="upvoteCount"
             data-value="35265">
35265        </div>
        <button
            class="js-vote-down-btn flex--item mb8 s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
            id=downvote-btn-11227902
            title="This answer is not useful"
            aria-pressed="false"
            aria-label="Down vote"
            data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
            data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">

            <svg aria-hidden="true" class="svg-icon iconArrowDown" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 6h16l-8 8z"/></svg>
        </button>
        <input type="hidden" id="voteDownHash" value="70:3:31e,16:70b109859c5584bc,10:1771427630,16:aad973834820fdc2,8:11227902,7a70fedaeabe3d8f6777386246199fb53b67292ca8d7dc2cc9ee859e1af48d81" />


        
<button class="js-saves-btn s-btn s-btn__unset c-pointer py4"
        type="button"
        id="saves-btn-11227902"
        data-controller="s-tooltip"
        data-s-tooltip-placement="right"
        data-s-popover-placement=""
        title="Save this answer."
        data-is-saved="false"
        aria-label="Save"
        data-post-id="11227902"
        data-post-type-id="2"
        data-user-privilege-for-post-click="0"
        aria-controls=""
        data-s-popover-auto-show="false"
>
    <svg aria-hidden="true" class="fc-theme-primary-400 js-saves-btn-selected d-none svg-icon iconBookmark" width="18" height="18"  viewBox="0 0 18 18"><path  d="M3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
    <svg aria-hidden="true" class="js-saves-btn-unselected svg-icon iconBookmarkAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m9 10.6 4 2.66V3H5v10.26zM3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
</button>







            <div class="js-accepted-answer-indicator flex--item fc-green-400 py6 mtn8" data-s-tooltip-placement="right" title="Loading when this answer was accepted&#x2026;" tabindex="0" role="note" aria-label="Accepted">
                <div class="ta-center">
                    <svg aria-hidden="true" class="svg-icon iconCheckmarkLg" width="36" height="36"  viewBox="0 0 36 36"><path  d="m6 14 8 8L30 6v8L14 30l-8-8z"/></svg>
                </div>
            </div>
            
<div class="js-bounty-award-container flex--item py4">

    <div class="d-flex fd-column gs4 ai-center">

            <div class="js-bounty-award flex--item s-badge s-badge__bounty s-badge__sm as-center"
                 title="This answer has been awarded bounties worth 2200 reputation by Ry-, rebeliagamer, TLama, nicael, zessx, Oleksandr Pyrohov, TwoStraws, RamenChef, Baum mit Augen, Community and 3 more users" data-controller="s-tooltip" data-s-tooltip-placement="right">
                +2200
            </div>

    </div>
</div>


    
    <a class="js-post-issue flex--item s-btn s-btn__unset c-pointer py6 mx-auto" href="/posts/11227902/timeline" data-shortcut="T" data-ks-title="timeline" data-controller="s-tooltip" data-s-tooltip-placement="right" title="Show activity on this post." aria-label="Timeline"><svg aria-hidden="true" class="mln2 mr0 svg-icon iconHistory" width="19" height="18"  viewBox="0 0 19 18"><path  d="M3 9a8 8 0 1 1 3.73 6.77L8.2 14.3A6 6 0 1 0 5 9l3.01-.01-4 4-4-4zm7-4h1.01L11 9.36l3.22 2.1-.6.93L10 10z"/></svg></a>

</div>

                </div>

            

<div class="answercell post-layout--right">
    


    <div class="s-prose js-post-body" itemprop="text">
<p><strong>You are a victim of <a href="https://en.wikipedia.org/wiki/Branch_predictor" rel="noreferrer">branch prediction</a> fail.</strong></p>
<hr />
<h2>What is Branch Prediction?</h2>
<p>Consider a railroad junction:</p>
<p><a href="https://commons.wikimedia.org/wiki/File:Entroncamento_do_Transpraia.JPG" rel="noreferrer"><img src="https://i.sstatic.net/muxnt.jpg" alt="Image showing a railroad junction" /></a>
<sub><a href="https://commons.wikimedia.org/wiki/File:Entroncamento_do_Transpraia.JPG" rel="noreferrer">Image</a> by Mecanismo, via Wikimedia Commons. Used under the <a href="https://creativecommons.org/licenses/by-sa/3.0/deed.en" rel="noreferrer">CC-By-SA 3.0</a> license.</sub></p>
<p>Now for the sake of argument, suppose this is back in the 1800s - before long-distance or radio communication.</p>
<p>You are a blind operator of a junction and you hear a train coming. You have no idea which way it is supposed to go. You stop the train to ask the driver which direction they want. And then you set the switch appropriately.</p>
<p><em>Trains are heavy and have a lot of inertia, so they take forever to start up and slow down.</em></p>
<p>Is there a better way? You guess which direction the train will go!</p>
<ul>
<li>If you guessed right, it continues on.</li>
<li>If you guessed wrong, the driver will stop, back up, and yell at you to flip the switch. Then it can restart down the other path.</li>
</ul>
<p><strong>If you guess right every time</strong>, the train will never have to stop.<br />
<strong>If you guess wrong too often</strong>, the train will spend a lot of time stopping, backing up, and restarting.</p>
<hr />
<p><strong>Consider an if-statement:</strong> At the processor level, it is a branch instruction:</p>
<p><img src="https://i.sstatic.net/pyfwC.png" alt="if(x &gt;= 128) compiles into a jump-if-less-than processor instruction." /></p>
<p>You are a processor and you see a branch. You have no idea which way it will go. What do you do? You halt execution and wait until the previous instructions are complete. Then you continue down the correct path.</p>
<p><em>Modern processors are complicated and have long pipelines. This means they take forever to &quot;warm up&quot; and &quot;slow down&quot;.</em></p>
<p>Is there a better way? You guess which direction the branch will go!</p>
<ul>
<li>If you guessed right, you continue executing.</li>
<li>If you guessed wrong, you need to flush the pipeline and roll back to the branch. Then you can restart down the other path.</li>
</ul>
<p><strong>If you guess right every time</strong>, the execution will never have to stop.<br />
<strong>If you guess wrong too often</strong>, you spend a lot of time stalling, rolling back, and restarting.</p>
<hr />
<p>This is branch prediction. I admit it's not the best analogy since the train could just signal the direction with a flag. But in computers, the processor doesn't know which direction a branch will go until the last moment.</p>
<p>How would you strategically guess to minimize the number of times that the train must back up and go down the other path? You look at the past history! If the train goes left 99% of the time, then you guess left. If it alternates, then you alternate your guesses. If it goes one way every three times, you guess the same...</p>
<p><em><strong>In other words, you try to identify a pattern and follow it.</strong></em> This is more or less how branch predictors work.</p>
<p>Most applications have well-behaved branches. Therefore, modern branch predictors will typically achieve &gt;90% hit rates. But when faced with unpredictable branches with no recognizable patterns, branch predictors are virtually useless.</p>
<p>Further reading: <a href="https://en.wikipedia.org/wiki/Branch_predictor" rel="noreferrer">&quot;Branch predictor&quot; article on Wikipedia</a>.</p>
<hr />
<h2>As hinted from above, the culprit is this if-statement:</h2>
<pre><code>if (data[c] &gt;= 128)
    sum += data[c];
</code></pre>
<p>Notice that the data is evenly distributed between 0 and 255. When the data is sorted, roughly the first half of the iterations will not enter the if-statement. After that, they will all enter the if-statement.</p>
<p>This is very friendly to the branch predictor since the branch consecutively goes the same direction many times. Even a simple saturating counter will correctly predict the branch except for the few iterations after it switches direction.</p>
<p><strong>Quick visualization:</strong></p>
<pre class="lang-none prettyprint-override"><code>T = branch taken
N = branch not taken

data[] = 0, 1, 2, 3, 4, ... 126, 127, 128, 129, 130, ... 250, 251, 252, ...
branch = N  N  N  N  N  ...   N    N    T    T    T  ...   T    T    T  ...

       = NNNNNNNNNNNN ... NNNNNNNTTTTTTTTT ... TTTTTTTTTT  (easy to predict)
</code></pre>
<p>However, when the data is completely random, the branch predictor is rendered useless, because it can't predict random data. Thus there will probably be around 50% misprediction (no better than random guessing).</p>
<pre class="lang-none prettyprint-override"><code>data[] = 226, 185, 125, 158, 198, 144, 217, 79, 202, 118,  14, 150, 177, 182, ...
branch =   T,   T,   N,   T,   T,   T,   T,  N,   T,   N,   N,   T,   T,   T  ...

       = TTNTTTTNTNNTTT ...   (completely random - impossible to predict)
</code></pre>
<hr />
<p><strong>What can be done?</strong></p>
<p>If the compiler isn't able to optimize the branch into a conditional move, you can try some hacks if you are willing to sacrifice readability for performance.</p>
<p>Replace:</p>
<pre><code>if (data[c] &gt;= 128)
    sum += data[c];
</code></pre>
<p>with:</p>
<pre><code>int t = (data[c] - 128) &gt;&gt; 31;
sum += ~t &amp; data[c];
</code></pre>
<p>This eliminates the branch and replaces it with some bitwise operations.</p>
<p><sub>(Note that this hack is not strictly equivalent to the original if-statement. But in this case, it's valid for all the input values of <code>data[]</code>.)</sub></p>
<p><strong>Benchmarks: Core i7 920 @ 3.5 GHz</strong></p>
<p>C++ - Visual Studio 2010 - x64 Release</p>
<div class="s-table-container"><table class="s-table">
<thead>
<tr>
<th>Scenario</th>
<th>Time (seconds)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Branching - Random data</td>
<td>11.777</td>
</tr>
<tr>
<td>Branching - Sorted data</td>
<td>2.352</td>
</tr>
<tr>
<td>Branchless - Random data</td>
<td>2.564</td>
</tr>
<tr>
<td>Branchless - Sorted data</td>
<td>2.587</td>
</tr>
</tbody>
</table></div>
<p>Java - NetBeans 7.1.1 JDK 7 - x64</p>
<div class="s-table-container"><table class="s-table">
<thead>
<tr>
<th>Scenario</th>
<th>Time (seconds)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Branching - Random data</td>
<td>10.93293813</td>
</tr>
<tr>
<td>Branching - Sorted data</td>
<td>5.643797077</td>
</tr>
<tr>
<td>Branchless - Random data</td>
<td>3.113581453</td>
</tr>
<tr>
<td>Branchless - Sorted data</td>
<td>3.186068823</td>
</tr>
</tbody>
</table></div>
<p>Observations:</p>
<ul>
<li><strong>With the Branch:</strong> There is a huge difference between the sorted and unsorted data.</li>
<li><strong>With the Hack:</strong> There is no difference between sorted and unsorted data.</li>
<li>In the C++ case, the hack is actually a tad slower than with the branch when the data is sorted.</li>
</ul>
<p>A general rule of thumb is to avoid data-dependent branching in critical loops (such as in this example).</p>
<hr />
<p><strong>Update:</strong></p>
<ul>
<li><p>GCC 4.6.1 with <code>-O3</code> or <code>-ftree-vectorize</code> on x64 is able to generate a conditional move, so there is no difference between the sorted and unsorted data - both are fast.  This is called &quot;if-conversion&quot; (to branchless) and is necessary for vectorization but also sometimes good for scalar.</p>
<p>(Or somewhat fast: for the already-sorted case, <code>cmov</code> can be slower especially if GCC puts it on the critical path instead of just <code>add</code>, especially on Intel before Broadwell where <code>cmov</code> has 2-cycle latency: <em><a href="https://stackoverflow.com/questions/28875325/gcc-optimization-flag-o3-makes-code-slower-than-o2">gcc optimization flag -O3 makes code slower than -O2</a></em>)</p>
</li>
<li><p>VC++ 2010 is unable to generate conditional moves for this branch even under <code>/Ox</code>.</p>
</li>
<li><p><a href="https://en.wikipedia.org/wiki/Intel_C++_Compiler" rel="noreferrer">Intel C++ Compiler</a> (ICC) 11 does something miraculous. It <a href="https://en.wikipedia.org/wiki/Loop_interchange" rel="noreferrer">interchanges the two loops</a>, thereby hoisting the unpredictable branch to the outer loop. Not only is it immune to the mispredictions, it's also twice as fast as whatever VC++ and GCC can generate! In other words, ICC took advantage of the test-loop to defeat the benchmark...</p>
</li>
<li><p>If you give the Intel compiler the branchless code, it just outright vectorizes it... and is just as fast as with the branch (with the loop interchange).</p>
</li>
</ul>
<ul>
<li>Clang also vectorizes the <code>if()</code> version, as will GCC 5 and later with <code>-O3</code>, even though it takes quite a few instructions to sign-extend to the 64-bit sum on x86 without SSE4 or AVX2.  (<code>-march=x86-64-v2</code> or <code>v3</code>).  See <em><a href="https://stackoverflow.com/questions/66521344/why-is-processing-an-unsorted-array-the-same-speed-as-processing-a-sorted-array">Why is processing an unsorted array the same speed as processing a sorted array with modern x86-64 clang?</a></em></li>
</ul>
<p>This goes to show that even mature modern compilers can vary wildly in their ability to optimize code...</p>
    </div>
    <div class="mt24">
        <div class="d-flex fw-wrap ai-start jc-end gs8 gsy">

            <time itemprop="dateCreated" datetime="2012-06-27 13:56:42Z"></time>
            <div class="flex--item mr16" style="flex: 1 1 100px;">
                


<div class="js-post-menu pt2" data-post-id="11227902" data-post-type-id="2">

    <div class="d-flex gs8 s-anchors s-anchors__muted fw-wrap">

        <div class="flex--item">
            <a href="/a/11227902"
               rel="nofollow"
               itemprop="url"
               class="js-share-link js-gps-track"
               title="Short permalink to this answer"
               data-gps-track="post.click({ item: 2, priv: 0, post_type: 2 })"
               data-controller="se-share-sheet"
               data-se-share-sheet-title="Share a link to this answer"
               data-se-share-sheet-subtitle=""
               data-se-share-sheet-post-type="answer"
               data-se-share-sheet-social="facebook twitter devto"
               data-se-share-sheet-location="2"
               data-se-share-sheet-license-url="https%3a%2f%2fcreativecommons.org%2flicenses%2fby-sa%2f4.0%2f"
               data-se-share-sheet-license-name="CC BY-SA 4.0"
               data-s-popover-placement="bottom-start">Share</a>
        </div>


                    <div class="flex--item">
                        <a href="/posts/11227902/edit" class="js-suggest-edit-post js-gps-track" data-gps-track="post.click({ item: 6, priv: 0, post_type: 2 })" title="">Improve this answer</a>
                    </div>

                <div class="flex--item">
                    <button type="button"
                            id="btnFollowPost-11227902" class="s-btn s-btn__link js-follow-post js-follow-answer js-gps-track"
                            data-gps-track="post.click({ item: 14, priv: 0, post_type: 2 })"
                            data-controller="s-tooltip " data-s-tooltip-placement="bottom"
                            data-s-popover-placement="bottom" aria-controls=""
                            title="Follow this answer to receive notifications">
                        Follow
                        <input type="hidden" id="voteFollowHash" value="70:3:31e,16:131f199aa225a76f,10:1771427630,16:0145ac06486fa165,8:11227902,bbb81297e13ceeca8fff6c511de5f588ed0c234a676c6bc920c1050cc6e63fa9" />
                    </button>
                </div>






    </div>
    <div class="js-menu-popup-container"></div>
</div>
            </div>
            <div class="post-signature flex--item fl0">
<div class="user-info user-hover ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            <a href="/posts/11227902/revisions" title="show all edits to this post"
                         class="js-gps-track"
                         data-gps-track="post.click({ item: 4, priv: 0, post_type: 2 })">edited <span title='2024-03-04 17:37:13Z' class='relativetime'>Mar 4, 2024 at 17:37</span></a>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/224132/peter-cordes"><div class="gravatar-wrapper-32"><img src="https://i.sstatic.net/N4ivW.png?s=64" alt="Peter Cordes&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/224132/peter-cordes" dir="auto">Peter Cordes</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 379,441" dir="ltr">379k</span><span title="52 gold badges" aria-hidden="true"><span class="badge1"></span><span class="badgecount">52</span></span><span class="v-visible-sr">52 gold badges</span><span title="754 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">754</span></span><span class="v-visible-sr">754 silver badges</span><span title="1k bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">1k</span></span><span class="v-visible-sr">1k bronze badges</span>
        </div>
    </div>
</div>
            </div>


                <div class="post-signature flex--item fl0">
                    <div class="user-info user-hover ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            answered <span title='2012-06-27 13:56:42Z' class='relativetime'>Jun 27, 2012 at 13:56</span>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/922184/mysticial"><div class="gravatar-wrapper-32"><img src="https://i.sstatic.net/h7WDB.jpg?s=64" alt="Mysticial&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <a href="/users/922184/mysticial" itemprop="url" dir="auto">Mysticial</a><meta itemprop="name" content="Mysticial"/>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 473,173" dir="ltr">473k</span><span title="46 gold badges" aria-hidden="true"><span class="badge1"></span><span class="badgecount">46</span></span><span class="v-visible-sr">46 gold badges</span><span title="343 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">343</span></span><span class="v-visible-sr">343 silver badges</span><span title="337 bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">337</span></span><span class="v-visible-sr">337 bronze badges</span>
        </div>
    </div>
</div>


                </div>
        </div>
        
    
    </div>
    
</div>




                

    <div class="post-layout--right">
<script defer src="https://stackoverflow.com/Content/Js/sprinkles/you-can-comment-banner.en.js?v=e9cab84582af"></script>                    <div
                        class="lg:mt8 bg-purple-100 p8 my8 bc-purple-400 ba bar-sm d-flex ai-center js-you-can-comment-banner-anon">
                        <svg aria-hidden="true" class="mr8 fc-purple-400 svg-icon iconAlertCircleSm" width="14" height="14"  viewBox="0 0 14 14"><path  d="M7 13c-3.23 0-6-2.74-6-6 0-3.23 2.74-6 6-6 3.27 0 6 2.73 6 6s-2.73 6-6 6M6 3v5h2V3zm0 6v2h2V9z"/></svg>
                        <div class="fl-grow1">
                            Sign up to request clarification or add additional context in comments.
                        </div>
        
                        <button
                            class="s-modal--close s-btn__xs s-btn__icon bg-purple-100 bc-purple-400 bar-sm ba baw0 h:bg-purple-200 c-pointer js-clear-you-can-comment-banner-anon">
                            <svg aria-hidden="true" class="svg-icon iconClearSm" width="14" height="14"  viewBox="0 0 14 14"><path  d="M12 3.41 10.59 2 7 5.59 3.41 2 2 3.41 5.59 7 2 10.59 3.41 12 7 8.41 10.59 12 12 10.59 8.41 7z"/></svg>
                        </button>
                    </div>
        

<div id="follow-ups-container-11227902">
    <!--[--><div class="mt16"><div class="mb8 d-flex ai-center g8 c-pointer" role="button" tabindex="0"><h2 class="mb0">23 Comments</h2> <!--[--><!--[--><!----><svg aria-hidden="true" class="svg-icon iconArrowDownAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m16.01 7.43-1.4-1.41L9 11.6 3.42 6l-1.4 1.42 7 7z"/></svg><!----><!--]--><!--]--></div> <div class="mb12"><!--[!--><button type="button" class="s-btn s-btn__muted s-btn__outlined w100 d-flex ai-center p8" data-so-test="parent-answer-11227902"><!--[!--><!--]--> <div class="flex--item ml8"><p class="mb0">Add a comment</p></div></button><!--]--></div> <!--[--><div role="list"><!--[--><div id="follow-up-111173010" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/4416169/matias-chara" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://www.gravatar.com/avatar/1f9445f16c5d039c8f125fd41171e9c9?s=48&amp;d=identicon&amp;r=PG&amp;f=y&amp;so-version=2" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Matias Chara</div> <div class="s-user-card--awards"><!--[--><a href="/users/4416169/matias-chara" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Matias Chara</a><!--]--> <a class="comment-link" href="#comment111173010_11227902"><time title="2020-07-12T23:52:48.26Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->wait a second, doesnt shifting negative values to the right yield implementation-defined values? int t = (data[c] - 128) &gt;&gt; 31; sum += ~t &amp; data[c];<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2020-07-12T23:52:48.26Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-111173010"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">67</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-111173010"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-111173010" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-111173010"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-111173010" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-113860806" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/774575/mins" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://i.sstatic.net/MlqFo.png?s=64" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">mins</div> <div class="s-user-card--awards"><!--[--><a href="/users/774575/mins" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">mins</a><!--]--> <a class="comment-link" href="#comment113860806_11227902"><time title="2020-10-16T14:04:41.163Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[--><span class="o50" title="Edited 1 time"><!----><svg aria-hidden="true" class="svg-icon iconPencilSm" width="14" height="14"  viewBox="0 0 14 14"><path fill="#F1B600" d="m2 10.12 6.37-6.43 1.88 1.88L3.88 12H2z"/><path fill="#E87C87" d="m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0"/></svg><!----><!----></span><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->Incidently branch prediction failure can also be <a href="https://eprint.iacr.org/2006/288.pdf" rel="nofollow noreferrer">exploited by a program to obtain crypto keys being used by another program</a> on the same CPU core.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2020-10-16T14:04:41.163Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-113860806"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">96</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-113860806"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-113860806" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-113860806"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-113860806" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-115951193" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/899213/raphael" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://www.gravatar.com/avatar/1cecebaf65cdd9a8351fdda654e5bdac?s=48&amp;d=identicon&amp;r=PG" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Raphael</div> <div class="s-user-card--awards"><!--[--><a href="/users/899213/raphael" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Raphael</a><!--]--> <a class="comment-link" href="#comment115951193_11227902"><time title="2021-01-05T15:51:22.51Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->@Mycotina, I&#39;m no expert, but what I understand is: the processor needs multiple steps to execute a single instruction (fetching, decoding, etc) -- this is called &quot;instruction pipelining&quot; -- so, as an optimization, it will fetch multiple instructions at once and &quot;warm up&quot; the next instructions while executing the current one. If the wrong branch is chosen, the instructions being &quot;warmed up&quot; in the pipeline must be discarded, so that the instructions on the right branch can be put into the pipeline instead.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2021-01-05T15:51:22.51Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-115951193"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">61</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-115951193"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-115951193" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-115951193"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-115951193" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-116023390" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/1322972/whozcraig" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://i.sstatic.net/aD0dF.jpg?s=64" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">WhozCraig</div> <div class="s-user-card--awards"><!--[--><a href="/users/1322972/whozcraig" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">WhozCraig</a><!--]--> <a class="comment-link" href="#comment116023390_11227902"><time title="2021-01-08T02:03:57.737Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->@Mycotina It&#39;s easier to understand when you think of the instruction pipeline cache as tracks, the train (with cars) as the instructions, and the indicator of whether you go left or right by some dude at the END of the train; not the beginning. By the time you see him to know you&#39;ve guessed right, not only is it too late to switch things, the pipeline ahead is already populated, but in the wrong direction. If you guessed wrong the predicted pipeline needs to be thrown out (derail the train; drag it back before the switch house, put it back on the tracks, and send it the other way).<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2021-01-08T02:03:57.737Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-116023390"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">39</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-116023390"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-116023390" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-116023390"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-116023390" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-117675227" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/8132066/tom" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://www.gravatar.com/avatar/e935e7c928e9eb139122eeceab4088ca?s=48&amp;d=identicon&amp;r=PG" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Tom</div> <div class="s-user-card--awards"><!--[--><a href="/users/8132066/tom" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Tom</a><!--]--> <a class="comment-link" href="#comment117675227_11227902"><time title="2021-03-10T14:47:44.147Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->@C.Binair Primarily it&#39;s runtime, i.e. processor predicts branches while executing the code. The processor also remembers previous results and use that to predict next jump. However, compiler can provide some initial hints for branch prediction while compiling - search for &quot;likely&quot; and &quot;unlikely&quot; attributes. So you could say the answer is kinda both, but runtime is when it actually happens.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2021-03-10T14:47:44.147Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-117675227"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">29</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-117675227"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-117675227" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-117675227"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-117675227" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><!--]--></div> <!--[--><div class="d-flex g8 my8"><!--[--><button class="s-link s-btn__muted s-btn__outlined comments-link" data-so-test="parent-answer-11227902">Add a comment</button> <!--[--><span>|</span><!--]--><!--]--> <!--[--><button class="s-link s-btn__muted s-btn__outlined comments-link">Show 18 more comments</button><!--]--></div><!--]--><!----><!--]--> <!--[!--><!--]--></div><!--]-->
</div>

<script type="application/json" data-role="module-args" data-module-name="islands/follow-ups/index.mod">{"replies":[{"id":111173010,"user":{"userId":4416169,"isDeleted":false,"displayName":"Matias Chara","url":"/users/4416169/matias-chara","profileImageUrl":"https://www.gravatar.com/avatar/1f9445f16c5d039c8f125fd41171e9c9?s=48\u0026d=identicon\u0026r=PG\u0026f=y\u0026so-version=2","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"MatiasChara","noSpacesUserName":"MatiasChara","reputationDisplayText":"0"},"postedAt":"2020-07-12T23:52:48.26Z","postedAtRelative":"Over a year ago","body":"wait a second, doesnt shifting negative values to the right yield implementation-defined values? int t = (data[c] - 128) \u003E\u003E 31;\nsum \u002B= ~t \u0026 data[c];","htmlBody":"wait a second, doesnt shifting negative values to the right yield implementation-defined values? int t = (data[c] - 128) \u0026gt;\u0026gt; 31; sum \u002B= ~t \u0026amp; data[c];","score":67,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":113565282,"user":{"userId":493759,"isDeleted":false,"displayName":"Agoston Horvath","url":"/users/493759/agoston-horvath","profileImageUrl":"https://www.gravatar.com/avatar/c28651cc42b824155c6bc9a15a300fd8?s=48\u0026d=identicon\u0026r=PG","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"AgostonHorvath","noSpacesUserName":"AgostonHorvath","reputationDisplayText":"0"},"postedAt":"2020-10-06T08:37:45.017Z","postedAtRelative":"Over a year ago","body":"@MatiasChara it\u0027s really hidden, see https://en.wikipedia.org/wiki/Bitwise_operations_in_C#Right_shift_%3E%3E ; \u0022however most compilers will perform an arithmetic shift, causing the blank to be filled with the sign bit of the left operand\u0022. I guess it\u0027s a de-facto standard by now.","htmlBody":"@MatiasChara it\u0026#39;s really hidden, see \u003Ca href=\u0022https://en.wikipedia.org/wiki/Bitwise_operations_in_C#Right_shift_%3E%3E\u0022 rel=\u0022nofollow noreferrer\u0022\u003Een.wikipedia.org/wiki/\u0026hellip;\u003C/a\u003E ; \u0026quot;however most compilers will perform an arithmetic shift, causing the blank to be filled with the sign bit of the left operand\u0026quot;. I guess it\u0026#39;s a de-facto standard by now.","score":8,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false},{"id":113860806,"user":{"userId":774575,"isDeleted":false,"displayName":"mins","url":"/users/774575/mins","profileImageUrl":"https://i.sstatic.net/MlqFo.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"mins","noSpacesUserName":"mins","reputationDisplayText":"0"},"postedAt":"2020-10-16T14:04:41.163Z","postedAtRelative":"Over a year ago","body":"Incidently branch prediction failure can also be [exploited by a program to obtain crypto keys being used by another program](https://eprint.iacr.org/2006/288.pdf) on the same CPU core.","htmlBody":"Incidently branch prediction failure can also be \u003Ca href=\u0022https://eprint.iacr.org/2006/288.pdf\u0022 rel=\u0022nofollow noreferrer\u0022\u003Eexploited by a program to obtain crypto keys being used by another program\u003C/a\u003E on the same CPU core.","score":96,"editCount":1,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":115259910,"user":{"userId":8736053,"isDeleted":false,"displayName":"Mycotina","url":"/users/8736053/mycotina","profileImageUrl":"https://www.gravatar.com/avatar/2ac22521f9cdf3a0e14f029eaa59b1b3?s=48\u0026d=identicon\u0026r=PG\u0026f=y\u0026so-version=2","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"Mycotina","noSpacesUserName":"Mycotina","reputationDisplayText":"0"},"postedAt":"2020-12-08T09:26:56.447Z","postedAtRelative":"Over a year ago","body":"I have a hard time understanding the explanation. Because, even with branch predictor, isn\u0027t the computer still need to know if it guessed right or wrong in the end? Because if not, how will it know if it should do the rollback? And for knowing if it is right or wrong, isn\u0027t we need to compute the result of the if condition nonetheless? Which in the end, will consume the same resource without branch prediction, or even slower because we need to correct mistakes?","htmlBody":"I have a hard time understanding the explanation. Because, even with branch predictor, isn\u0026#39;t the computer still need to know if it guessed right or wrong in the end? Because if not, how will it know if it should do the rollback? And for knowing if it is right or wrong, isn\u0026#39;t we need to compute the result of the if condition nonetheless? Which in the end, will consume the same resource without branch prediction, or even slower because we need to correct mistakes?","score":9,"editCount":1,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false},{"id":115951193,"user":{"userId":899213,"isDeleted":false,"displayName":"Raphael","url":"/users/899213/raphael","profileImageUrl":"https://www.gravatar.com/avatar/1cecebaf65cdd9a8351fdda654e5bdac?s=48\u0026d=identicon\u0026r=PG","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"Raphael","noSpacesUserName":"Raphael","reputationDisplayText":"0"},"postedAt":"2021-01-05T15:51:22.51Z","postedAtRelative":"Over a year ago","body":"@Mycotina, I\u0027m no expert, but what I understand is: the processor needs multiple steps to execute a single instruction (fetching, decoding, etc) -- this is called \u0022instruction pipelining\u0022 -- so, as an optimization, it will fetch multiple instructions at once and \u0022warm up\u0022 the next instructions while executing the current one. If the wrong branch is chosen, the instructions being \u0022warmed up\u0022 in the pipeline must be discarded, so that the instructions on the right branch can be put into the pipeline instead.","htmlBody":"@Mycotina, I\u0026#39;m no expert, but what I understand is: the processor needs multiple steps to execute a single instruction (fetching, decoding, etc) -- this is called \u0026quot;instruction pipelining\u0026quot; -- so, as an optimization, it will fetch multiple instructions at once and \u0026quot;warm up\u0026quot; the next instructions while executing the current one. If the wrong branch is chosen, the instructions being \u0026quot;warmed up\u0026quot; in the pipeline must be discarded, so that the instructions on the right branch can be put into the pipeline instead.","score":61,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":116023390,"user":{"userId":1322972,"isDeleted":false,"displayName":"WhozCraig","url":"/users/1322972/whozcraig","profileImageUrl":"https://i.sstatic.net/aD0dF.jpg?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"WhozCraig","noSpacesUserName":"WhozCraig","reputationDisplayText":"0"},"postedAt":"2021-01-08T02:03:57.737Z","postedAtRelative":"Over a year ago","body":"@Mycotina It\u0027s easier to understand when you think of the instruction pipeline cache as tracks, the train (with cars) as the instructions, and the indicator of whether you go left or right by some dude at the END of the train; not the beginning. By the time you see him to know you\u0027ve guessed right, not only is it too late to switch things, the pipeline ahead is already populated, but in the wrong direction. If you guessed wrong the predicted pipeline needs to be thrown out (derail the train; drag it back before the switch house, put it back on the tracks, and send it the other way).","htmlBody":"@Mycotina It\u0026#39;s easier to understand when you think of the instruction pipeline cache as tracks, the train (with cars) as the instructions, and the indicator of whether you go left or right by some dude at the END of the train; not the beginning. By the time you see him to know you\u0026#39;ve guessed right, not only is it too late to switch things, the pipeline ahead is already populated, but in the wrong direction. If you guessed wrong the predicted pipeline needs to be thrown out (derail the train; drag it back before the switch house, put it back on the tracks, and send it the other way).","score":39,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":117493367,"user":{"userId":10220019,"isDeleted":false,"displayName":"C. Binair","url":"/users/10220019/c-binair","profileImageUrl":"https://www.gravatar.com/avatar/416186bf27551ca0a54ec1828c7da14f?s=48\u0026d=identicon\u0026r=PG\u0026f=y\u0026so-version=2","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"C.Binair","noSpacesUserName":"C.Binair","reputationDisplayText":"0"},"postedAt":"2021-03-03T16:21:19.527Z","postedAtRelative":"Over a year ago","body":"I hope this question is simple, but I\u0027m confused. The prediction is that made during runtime or already when compiling?","htmlBody":"I hope this question is simple, but I\u0026#39;m confused. The prediction is that made during runtime or already when compiling?","score":8,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false},{"id":117675227,"user":{"userId":8132066,"isDeleted":false,"displayName":"Tom","url":"/users/8132066/tom","profileImageUrl":"https://www.gravatar.com/avatar/e935e7c928e9eb139122eeceab4088ca?s=48\u0026d=identicon\u0026r=PG","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"Tom","noSpacesUserName":"Tom","reputationDisplayText":"0"},"postedAt":"2021-03-10T14:47:44.147Z","postedAtRelative":"Over a year ago","body":"@C.Binair Primarily it\u0027s runtime, i.e. processor predicts branches while executing the code. The processor also remembers previous results and use that to predict next jump. However, compiler can provide some initial hints for branch prediction while compiling - search for \u0022likely\u0022 and \u0022unlikely\u0022 attributes. So you could say the answer is kinda both, but runtime is when it actually happens.","htmlBody":"@C.Binair Primarily it\u0026#39;s runtime, i.e. processor predicts branches while executing the code. The processor also remembers previous results and use that to predict next jump. However, compiler can provide some initial hints for branch prediction while compiling - search for \u0026quot;likely\u0026quot; and \u0026quot;unlikely\u0026quot; attributes. So you could say the answer is kinda both, but runtime is when it actually happens.","score":29,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":120093110,"user":{"userId":224132,"isDeleted":false,"displayName":"Peter Cordes","url":"/users/224132/peter-cordes","profileImageUrl":"https://i.sstatic.net/N4ivW.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"PeterCordes","noSpacesUserName":"PeterCordes","reputationDisplayText":"0"},"postedAt":"2021-06-12T00:53:38.797Z","postedAtRelative":"Over a year ago","body":"@Tom: Not exactly.  Most ISAs don\u0027t have any mechanism for the compiler to actually provide branch hints to the CPU.  \u0060likely\u0060/\u0060unlikely\u0060 macros mostly just affect decision to use cmov (branchless) vs. actually branching, and to lay out the asm so the expected case has fewer taken branches.  (i.e. the fast path can get fetched contiguously in wide chunks by the pipeline.)  [Is there a compiler hint for GCC to force branch prediction to always go a certain way?](https://stackoverflow.com/a/30136196), and [this](https://stackoverflow.com/a/31133787/224132) is an example of actual x86 code-gen.","htmlBody":"@Tom: Not exactly.  Most ISAs don\u0026#39;t have any mechanism for the compiler to actually provide branch hints to the CPU.  \u003Ccode\u003Elikely\u003C/code\u003E/\u003Ccode\u003Eunlikely\u003C/code\u003E macros mostly just affect decision to use cmov (branchless) vs. actually branching, and to lay out the asm so the expected case has fewer taken branches.  (i.e. the fast path can get fetched contiguously in wide chunks by the pipeline.)  \u003Ca href=\u0022https://stackoverflow.com/a/30136196\u0022\u003EIs there a compiler hint for GCC to force branch prediction to always go a certain way?\u003C/a\u003E, and \u003Ca href=\u0022https://stackoverflow.com/a/31133787/224132\u0022\u003Ethis\u003C/a\u003E is an example of actual x86 code-gen.","score":6,"editCount":1,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false},{"id":121713611,"user":{"userId":1329652,"isDeleted":false,"displayName":"Kuba hasn\u0027t forgotten Monica","url":"/users/1329652/kuba-hasnt-forgotten-monica","profileImageUrl":"https://www.gravatar.com/avatar/57c81285e699cf8942f89d787e756a10?s=48\u0026d=identicon\u0026r=PG\u0026f=y\u0026so-version=2","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"Kubahasn\u0026#39;tforgottenMonica","noSpacesUserName":"Kubahasn\u0027tforgottenMonica","reputationDisplayText":"0"},"postedAt":"2021-08-21T04:24:34.7Z","postedAtRelative":"Over a year ago","body":"@C.Binair The prediction is made at runtime, and it costs millions of transistors per core to implement it. And multiple Ph.D. dissertations worth of work :) Modern branch predictors are marvels of engineering, to the point that the Eiffel Tower starts looking minuscule. They are hidden from the view, but they are largely responsible for the performance of modern processors. Turn branch prediction off (e.g. by writing code that slams the predictor and makes it useless), and an i7 3GHz core is like a cheap ARM Arduino...","htmlBody":"@C.Binair The prediction is made at runtime, and it costs millions of transistors per core to implement it. And multiple Ph.D. dissertations worth of work :) Modern branch predictors are marvels of engineering, to the point that the Eiffel Tower starts looking minuscule. They are hidden from the view, but they are largely responsible for the performance of modern processors. Turn branch prediction off (e.g. by writing code that slams the predictor and makes it useless), and an i7 3GHz core is like a cheap ARM Arduino...","score":7,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false},{"id":137034101,"user":{"userId":3764804,"isDeleted":false,"displayName":"BullyWiiPlaza","url":"/users/3764804/bullywiiplaza","profileImageUrl":"https://i.sstatic.net/fZQON.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"BullyWiiPlaza","noSpacesUserName":"BullyWiiPlaza","reputationDisplayText":"0"},"postedAt":"2023-12-28T23:52:50.41Z","postedAtRelative":"Over a year ago","body":"In 2023, using VS 2022 x64 release, the runtime difference is hardly existent when sorting and not sorting using the example code. Maybe the compiler got smarter. Still, when refactoring the inner loop into using a foreach loop, the branch prediction issues arise again. That is quite surprising.","htmlBody":"In 2023, using VS 2022 x64 release, the runtime difference is hardly existent when sorting and not sorting using the example code. Maybe the compiler got smarter. Still, when refactoring the inner loop into using a foreach loop, the branch prediction issues arise again. That is quite surprising.","score":0,"editCount":1,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false},{"id":138221291,"user":{"userId":22493563,"isDeleted":false,"displayName":"Praveen Kumar","url":"/users/22493563/praveen-kumar","profileImageUrl":"https://i.sstatic.net/eYFbU.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"PraveenKumar","noSpacesUserName":"PraveenKumar","reputationDisplayText":"0"},"postedAt":"2024-04-29T11:57:30.323Z","postedAtRelative":"Over a year ago","body":"Prediction requires processing. Doesn\u2019t it slow down the hardware since the coding is same for all.","htmlBody":"Prediction requires processing. Doesn\u2019t it slow down the hardware since the coding is same for all.","score":0,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false},{"id":138317843,"user":{"userId":21038936,"isDeleted":false,"displayName":"Mippy","url":"/users/21038936/mippy","profileImageUrl":"https://i.sstatic.net/wtPcMJY8.jpg?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"Mippy","noSpacesUserName":"Mippy","reputationDisplayText":"0"},"postedAt":"2024-05-09T23:13:33.333Z","postedAtRelative":"Over a year ago","body":"@PraveenKumar Where did you find that info, just curious?","htmlBody":"@PraveenKumar Where did you find that info, just curious?","score":0,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false},{"id":138333512,"user":{"userId":224132,"isDeleted":false,"displayName":"Peter Cordes","url":"/users/224132/peter-cordes","profileImageUrl":"https://i.sstatic.net/N4ivW.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"PeterCordes","noSpacesUserName":"PeterCordes","reputationDisplayText":"0"},"postedAt":"2024-05-12T04:02:13.103Z","postedAtRelative":"Over a year ago","body":"@Mippy: Praveen\u0027s comment doesn\u0027t apply to all CPUs.  On some, in the best case, a correctly predicted branch (especially if not-taken) doesn\u0027t create any bubbles in the pipeline.  Of course, if you want to process more than 1 element per instruction (with SIMD) you need branchless code, other than the loop branch of course.  See the clang Q\u0026A linked in the update section.  High-performance CPU hardware needs to predict every branch, even unconditional ones, so it can be fetching from the right place before the branch is even decoded.  ([Slow jmp-instruction](//stackoverflow.com/q/38811901))","htmlBody":"@Mippy: Praveen\u0026#39;s comment doesn\u0026#39;t apply to all CPUs.  On some, in the best case, a correctly predicted branch (especially if not-taken) doesn\u0026#39;t create any bubbles in the pipeline.  Of course, if you want to process more than 1 element per instruction (with SIMD) you need branchless code, other than the loop branch of course.  See the clang Q\u0026amp;A linked in the update section.  High-performance CPU hardware needs to predict every branch, even unconditional ones, so it can be fetching from the right place before the branch is even decoded.  (\u003Ca href=\u0022//stackoverflow.com/q/38811901\u0022\u003ESlow jmp-instruction\u003C/a\u003E)","score":0,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false},{"id":139043262,"user":{"userId":3255455,"isDeleted":false,"displayName":"gnasher729","url":"/users/3255455/gnasher729","profileImageUrl":"https://www.gravatar.com/avatar/df163b8a55fa3258785cca0bfe5f224c?s=48\u0026d=identicon\u0026r=PG\u0026f=y\u0026so-version=2","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"gnasher729","noSpacesUserName":"gnasher729","reputationDisplayText":"0"},"postedAt":"2024-08-12T19:55:20.773Z","postedAtRelative":"Over a year ago","body":"Hints: On many processors, taken branches take longer than non-taken branches. So if you have an if/else, you have a choice which code follows the conditional branch and you pick it so you have more non-taken branches according to the hint. You can do the same with a plain if.","htmlBody":"Hints: On many processors, taken branches take longer than non-taken branches. So if you have an if/else, you have a choice which code follows the conditional branch and you pick it so you have more non-taken branches according to the hint. You can do the same with a plain if.","score":0,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false},{"id":139043617,"user":{"userId":224132,"isDeleted":false,"displayName":"Peter Cordes","url":"/users/224132/peter-cordes","profileImageUrl":"https://i.sstatic.net/N4ivW.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"PeterCordes","noSpacesUserName":"PeterCordes","reputationDisplayText":"0"},"postedAt":"2024-08-12T20:50:29.16Z","postedAtRelative":"Over a year ago","body":"@gnasher729: It\u0027s up to the compiler whether the \u0060if\u0060 or the \u0060else\u0060 is the fast path (no taken branches) when laying out the asm.  (Or whether each way has one taken branch, one with a conditional branch over the first block, the other with an unconditional jump at the end of the first block over the second block, if neither block is \u0022out of line\u0022 after the \u0060ret\u0060.)  Compilers like GCC have heuristics to guess which side of an if/else will be more common, if they don\u0027t have profiling data, and there\u0027s \u0060__builtin_expect\u0060 in the source.","htmlBody":"@gnasher729: It\u0026#39;s up to the compiler whether the \u003Ccode\u003Eif\u003C/code\u003E or the \u003Ccode\u003Eelse\u003C/code\u003E is the fast path (no taken branches) when laying out the asm.  (Or whether each way has one taken branch, one with a conditional branch over the first block, the other with an unconditional jump at the end of the first block over the second block, if neither block is \u0026quot;out of line\u0026quot; after the \u003Ccode\u003Eret\u003C/code\u003E.)  Compilers like GCC have heuristics to guess which side of an if/else will be more common, if they don\u0026#39;t have profiling data, and there\u0026#39;s \u003Ccode\u003E__builtin_expect\u003C/code\u003E in the source.","score":0,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false},{"id":140119587,"user":{"userId":847235,"isDeleted":false,"displayName":"Intrepidis","url":"/users/847235/intrepidis","profileImageUrl":"https://www.gravatar.com/avatar/644382c3f7d5191d16cf61700d80db93?s=48\u0026d=identicon\u0026r=PG","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"Intrepidis","noSpacesUserName":"Intrepidis","reputationDisplayText":"0"},"postedAt":"2025-02-19T13:49:47.573Z","postedAtRelative":"Feb 19, 2025 at 13:49","body":"The answer says that \u0022when faced with unpredictable branches with no recognizable patterns, branch predictors are virtually useless\u0022; but aren\u0027t they worse than useless? Because if the prediction is incorrect, it has to flush the pipeline, which can lead to wasted cycles and reduced performance.","htmlBody":"The answer says that \u0026quot;when faced with unpredictable branches with no recognizable patterns, branch predictors are virtually useless\u0026quot;; but aren\u0026#39;t they worse than useless? Because if the prediction is incorrect, it has to flush the pipeline, which can lead to wasted cycles and reduced performance.","score":0,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false},{"id":140120632,"user":{"userId":224132,"isDeleted":false,"displayName":"Peter Cordes","url":"/users/224132/peter-cordes","profileImageUrl":"https://i.sstatic.net/N4ivW.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"PeterCordes","noSpacesUserName":"PeterCordes","reputationDisplayText":"0"},"postedAt":"2025-02-19T17:15:00.333Z","postedAtRelative":"Feb 19, 2025 at 17:15","body":"@Intrepidis: On an OoO exec CPU (unlike an in-order pipeline) yes, branch recovery might be a few cycles slower than if the CPU had stalled on every branch until it executes.  In such a design, the CPU still has to wait for I-cache latency and the length of the pipeline up to the exec stage before useful work is getting done again.  There are cases like binary search where speculative exec is a useful hardware prefetch at least half the time, and others where the same memory is accessed after a branch so a load can be in flight during branch recovery.","htmlBody":"@Intrepidis: On an OoO exec CPU (unlike an in-order pipeline) yes, branch recovery might be a few cycles slower than if the CPU had stalled on every branch until it executes.  In such a design, the CPU still has to wait for I-cache latency and the length of the pipeline up to the exec stage before useful work is getting done again.  There are cases like binary search where speculative exec is a useful hardware prefetch at least half the time, and others where the same memory is accessed after a branch so a load can be in flight during branch recovery.","score":1,"editCount":1,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false},{"id":140120650,"user":{"userId":224132,"isDeleted":false,"displayName":"Peter Cordes","url":"/users/224132/peter-cordes","profileImageUrl":"https://i.sstatic.net/N4ivW.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"PeterCordes","noSpacesUserName":"PeterCordes","reputationDisplayText":"0"},"postedAt":"2025-02-19T17:17:16.173Z","postedAtRelative":"Feb 19, 2025 at 17:17","body":"@Intrepidis: Also, the ability to speculate is necessary to not stall on every possibly-faulting instruction, like loads, stores, integer division, FP instructions if exceptions are unmasked, etc.  And most branches *are* predictable, e.g. loops are very common.  So it of course makes sense for out-of-order exec CPUs to execute speculatively.","htmlBody":"@Intrepidis: Also, the ability to speculate is necessary to not stall on every possibly-faulting instruction, like loads, stores, integer division, FP instructions if exceptions are unmasked, etc.  And most branches \u003Ci\u003Eare\u003C/i\u003E predictable, e.g. loops are very common.  So it of course makes sense for out-of-order exec CPUs to execute speculatively.","score":0,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false},{"id":140898328,"user":{"userId":22384325,"isDeleted":false,"displayName":"Nischal Bhusal","url":"/users/22384325/nischal-bhusal","profileImageUrl":"https://www.gravatar.com/avatar/bb6c722d5d14f8abf37c6e22e313b3e5?s=48\u0026d=identicon\u0026r=PG\u0026f=y\u0026so-version=2","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"NischalBhusal","noSpacesUserName":"NischalBhusal","reputationDisplayText":"0"},"postedAt":"2025-12-11T16:12:09.563Z","postedAtRelative":"Dec 11, 2025 at 16:12","body":"The bitwise hack works here because the values are constrained to 0 - 255, but wouldn\u2019t this break if the data range changed? Or is that assumption guaranteed in the actual use case..","htmlBody":"The bitwise hack works here because the values are constrained to 0 - 255, but wouldn\u2019t this break if the data range changed? Or is that assumption guaranteed in the actual use case..","score":0,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[{"id":140898530,"user":{"userId":224132,"isDeleted":false,"displayName":"Peter Cordes","url":"/users/224132/peter-cordes","profileImageUrl":"https://i.sstatic.net/N4ivW.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"PeterCordes","noSpacesUserName":"PeterCordes","reputationDisplayText":"0"},"postedAt":"2025-12-11T18:21:48.823Z","postedAtRelative":"Dec 11, 2025 at 18:21","body":"Yes, with full-range \u0060int\u0060 values you\u0027d have signed overflow UB, and even with wrapping 2\u0027s complement subtraction via \u0060(int)((unsigned)x - 128)\u0060 the sign of the result only matches the compare result when overflow didn\u0027t happen.  So use \u0060sum \u002B= data[c] \u003E= 128 ? data[c] : 0;\u0060 as a hint to compilers that they should use branchless CMOV / CSEL on ISAs which have such instructions.  (A data dependency instead of a control dependency).  Of course, modern C\u002B\u002B compilers already do that even with \u0060if\u0060, aka if-conversion optimization.","htmlBody":"Yes, with full-range \u003Ccode\u003Eint\u003C/code\u003E values you\u0026#39;d have signed overflow UB, and even with wrapping 2\u0026#39;s complement subtraction via \u003Ccode\u003E(int)((unsigned)x - 128)\u003C/code\u003E the sign of the result only matches the compare result when overflow didn\u0026#39;t happen.  So use \u003Ccode\u003Esum \u002B= data[c] \u0026gt;= 128 ? data[c] : 0;\u003C/code\u003E as a hint to compilers that they should use branchless CMOV / CSEL on ISAs which have such instructions.  (A data dependency instead of a control dependency).  Of course, modern C\u002B\u002B compilers already do that even with \u003Ccode\u003Eif\u003C/code\u003E, aka if-conversion optimization.","score":0,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":true,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"NischalBhusal","noSpacesReplyToUserName":"NischalBhusal","isTopScored":false,"parentCommentId":140898328}],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false},{"id":140944421,"user":{"userId":31501948,"isDeleted":false,"displayName":"Harshit Aggarwal","url":"/users/31501948/harshit-aggarwal","profileImageUrl":"https://www.gravatar.com/avatar/0f47e8f3ac916001d0e30e16a5e4bbd0?s=48\u0026d=identicon\u0026r=PG\u0026f=y\u0026so-version=2","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"HarshitAggarwal","noSpacesUserName":"HarshitAggarwal","reputationDisplayText":"0"},"postedAt":"2026-01-16T06:35:27.64Z","postedAtRelative":"Jan 16 at 6:35","body":"Processing a sorted array is faster than the Unsorted array because in Sorted array elements are stored at continuous memory locations and they can be easily accessed using their indexes and it depends upon the size of each element and run time complexity is constant in sorted array.","htmlBody":"Processing a sorted array is faster than the Unsorted array because in Sorted array elements are stored at continuous memory locations and they can be easily accessed using their indexes and it depends upon the size of each element and run time complexity is constant in sorted array.","score":0,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[{"id":140944612,"user":{"userId":224132,"isDeleted":false,"displayName":"Peter Cordes","url":"/users/224132/peter-cordes","profileImageUrl":"https://i.sstatic.net/N4ivW.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"PeterCordes","noSpacesUserName":"PeterCordes","reputationDisplayText":"0"},"postedAt":"2026-01-16T09:31:30.443Z","postedAtRelative":"Jan 16 at 9:31","body":"This is C\u002B\u002B, and Java primitive types, not objects.  So it\u0027s a flat array of values, not pointers.  Looping over the array in order always accesses contiguous memory, regardless of the values.  What you said is true in some implementations of Python for example, but not here.  When ChatGPT was new, many people posted wrong AI-generated answers making that claim.","htmlBody":"This is C\u002B\u002B, and Java primitive types, not objects.  So it\u0026#39;s a flat array of values, not pointers.  Looping over the array in order always accesses contiguous memory, regardless of the values.  What you said is true in some implementations of Python for example, but not here.  When ChatGPT was new, many people posted wrong AI-generated answers making that claim.","score":0,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":true,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"HarshitAggarwal","noSpacesReplyToUserName":"HarshitAggarwal","isTopScored":false,"parentCommentId":140944421}],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":true,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false}],"postId":11227902,"currentUserIsMod":false,"currentUserIsAnonymous":true,"commentFlagsRemainingToday":10,"maxNestingLevel":3,"hasOptedOut":false,"showCtaUnderComments":true,"containerElementId":"follow-ups-container-11227902","fKey":"d09ecbbe5140a7c1439a7e4020cdd7d76b52d28795a889bb24233842877804f3","questionId":11227809,"questionAuthorId":87234,"answerId":11227902,"answerPositionOnPage":0,"newUiSettings":{"largerFontSize":false},"showFirstTimeCommentingModal":false,"isMentionEnabled":false,"showSpamFlag":true,"mergeUnfriendlyAndRudeFlags":true,"allowRetractingCommentFlags":true,"commentMinLength":15}</script>
    </div>

        </div>
</div>
<div class="js-zone-container zone-container-main">
    <div id="dfp-mlb" class="everyonelovesstackoverflow everyoneloves__mid-leaderboard everyoneloves__leaderboard"></div>
		<div class="js-report-ad-button-container " style="width: 728px"></div>
</div>
                                        
<a name="11227877"></a>
<div id="answer-11227877" class="answer js-answer " data-answerid="11227877"
     data-parentid="11227809" data-score="4764" data-position-on-page="2"
     data-highest-scored="0"
     data-question-has-accepted-highest-score="1"
     data-author-username="Daniel Fischer"
     data-author-reputation="184534"
     data-should-show-copy-button=True
     data-se-share-sheet-license-name="CC BY-SA 3.0"
     data-is-edited="True"
      itemprop="suggestedAnswer"
     itemscope itemtype="https://schema.org/Answer">
        <div class="post-layout ">
                <div class="votecell post-layout--left">
                    
<div class="js-voting-container d-flex jc-center fd-column ai-center gs4 fc-black-300" data-post-id="11227877" data-referrer="None">
        <button class="js-vote-up-btn flex--item s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
                id="upvote-btn-11227877"
                data-controller="s-tooltip"
                data-s-tooltip-placement="right"
                title="This answer is useful"
                aria-pressed="false"
                aria-label="Up vote"
                data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
                data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">
            <svg aria-hidden="true" class="svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg>
        </button>
        <input type="hidden" id="voteUpHash" value="70:3:31e,16:48149d315e68591e,10:1771427630,16:7cbf7b93510bd107,8:11227877,dd14a4f30b5b75ae20723fd6226551d20164a904461ffedba0bf52f5a004e52a" />
        <div class="js-vote-count flex--item d-flex fd-column ai-center fc-theme-body-font fw-bold fs-subheading py4"
             itemprop="upvoteCount"
             data-value="4764">
4764        </div>
        <button
            class="js-vote-down-btn flex--item mb8 s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
            id=downvote-btn-11227877
            title="This answer is not useful"
            aria-pressed="false"
            aria-label="Down vote"
            data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
            data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">

            <svg aria-hidden="true" class="svg-icon iconArrowDown" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 6h16l-8 8z"/></svg>
        </button>
        <input type="hidden" id="voteDownHash" value="70:3:31e,16:a6c37b4aed33c778,10:1771427630,16:4836e5aa2b84b7c4,8:11227877,2e5af3b042576bbd8148ede14385b3eabf0324411c07b8aa7d18b492fcdcefb4" />


        
<button class="js-saves-btn s-btn s-btn__unset c-pointer py4"
        type="button"
        id="saves-btn-11227877"
        data-controller="s-tooltip"
        data-s-tooltip-placement="right"
        data-s-popover-placement=""
        title="Save this answer."
        data-is-saved="false"
        aria-label="Save"
        data-post-id="11227877"
        data-post-type-id="2"
        data-user-privilege-for-post-click="0"
        aria-controls=""
        data-s-popover-auto-show="false"
>
    <svg aria-hidden="true" class="fc-theme-primary-400 js-saves-btn-selected d-none svg-icon iconBookmark" width="18" height="18"  viewBox="0 0 18 18"><path  d="M3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
    <svg aria-hidden="true" class="js-saves-btn-unselected svg-icon iconBookmarkAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m9 10.6 4 2.66V3H5v10.26zM3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
</button>







            <div class="js-accepted-answer-indicator flex--item fc-green-400 py6 mtn8 d-none" data-s-tooltip-placement="right" title="Loading when this answer was accepted&#x2026;" tabindex="0" role="note" aria-label="Accepted">
                <div class="ta-center">
                    <svg aria-hidden="true" class="svg-icon iconCheckmarkLg" width="36" height="36"  viewBox="0 0 36 36"><path  d="m6 14 8 8L30 6v8L14 30l-8-8z"/></svg>
                </div>
            </div>

    
    <a class="js-post-issue flex--item s-btn s-btn__unset c-pointer py6 mx-auto" href="/posts/11227877/timeline" data-shortcut="T" data-ks-title="timeline" data-controller="s-tooltip" data-s-tooltip-placement="right" title="Show activity on this post." aria-label="Timeline"><svg aria-hidden="true" class="mln2 mr0 svg-icon iconHistory" width="19" height="18"  viewBox="0 0 19 18"><path  d="M3 9a8 8 0 1 1 3.73 6.77L8.2 14.3A6 6 0 1 0 5 9l3.01-.01-4 4-4-4zm7-4h1.01L11 9.36l3.22 2.1-.6.93L10 10z"/></svg></a>

</div>

                </div>

            

<div class="answercell post-layout--right">
    


    <div class="s-prose js-post-body" itemprop="text">
<p><strong>Branch prediction.</strong></p>
<p>With a sorted array, the condition <code>data[c] &gt;= 128</code> is first <code>false</code> for a streak of values, then becomes <code>true</code> for all later values. That's easy to predict. With an unsorted array, you pay for the branching cost.</p>
    </div>
    <div class="mt24">
        <div class="d-flex fw-wrap ai-start jc-end gs8 gsy">

            <time itemprop="dateCreated" datetime="2012-06-27 13:54:45Z"></time>
            <div class="flex--item mr16" style="flex: 1 1 100px;">
                


<div class="js-post-menu pt2" data-post-id="11227877" data-post-type-id="2">

    <div class="d-flex gs8 s-anchors s-anchors__muted fw-wrap">

        <div class="flex--item">
            <a href="/a/11227877"
               rel="nofollow"
               itemprop="url"
               class="js-share-link js-gps-track"
               title="Short permalink to this answer"
               data-gps-track="post.click({ item: 2, priv: 0, post_type: 2 })"
               data-controller="se-share-sheet"
               data-se-share-sheet-title="Share a link to this answer"
               data-se-share-sheet-subtitle=""
               data-se-share-sheet-post-type="answer"
               data-se-share-sheet-social="facebook twitter devto"
               data-se-share-sheet-location="2"
               data-se-share-sheet-license-url="https%3a%2f%2fcreativecommons.org%2flicenses%2fby-sa%2f3.0%2f"
               data-se-share-sheet-license-name="CC BY-SA 3.0"
               data-s-popover-placement="bottom-start">Share</a>
        </div>


                    <div class="flex--item">
                        <a href="/posts/11227877/edit" class="js-suggest-edit-post js-gps-track" data-gps-track="post.click({ item: 6, priv: 0, post_type: 2 })" title="">Improve this answer</a>
                    </div>

                <div class="flex--item">
                    <button type="button"
                            id="btnFollowPost-11227877" class="s-btn s-btn__link js-follow-post js-follow-answer js-gps-track"
                            data-gps-track="post.click({ item: 14, priv: 0, post_type: 2 })"
                            data-controller="s-tooltip " data-s-tooltip-placement="bottom"
                            data-s-popover-placement="bottom" aria-controls=""
                            title="Follow this answer to receive notifications">
                        Follow
                        <input type="hidden" id="voteFollowHash" value="70:3:31e,16:9ef6d71e3c8e7180,10:1771427630,16:e69ed70270a9d76f,8:11227877,0e52fd1334da49e36a4f2539f1a5ce3fed6beae0b92d1a86fb08336910c4ead0" />
                    </button>
                </div>






    </div>
    <div class="js-menu-popup-container"></div>
</div>
            </div>
            <div class="post-signature flex--item fl0">
<div class="user-info user-hover ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            <a href="/posts/11227877/revisions" title="show all edits to this post"
                         class="js-gps-track"
                         data-gps-track="post.click({ item: 4, priv: 0, post_type: 2 })">edited <span title='2020-06-20 09:12:55Z' class='relativetime'>Jun 20, 2020 at 9:12</span></a>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/-1/community"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/a007be5a61f6aa8f3e85ae2fc18dd66e?s=64&amp;d=identicon&amp;r=PG" alt="Community&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/-1/community" dir="auto">Community</a><span class="flex--item s-badge ml2  s-badge__xs mtn2" title="Community Bot  not a real person. Replies to this bot are not monitored.">Bot</span>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">1</span><span title="1 silver badge" aria-hidden="true"><span class="badge2"></span><span class="badgecount">1</span></span><span class="v-visible-sr">1 silver badge</span>
        </div>
    </div>
</div>
            </div>


                <div class="post-signature flex--item fl0">
                    <div class="user-info user-hover ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            answered <span title='2012-06-27 13:54:45Z' class='relativetime'>Jun 27, 2012 at 13:54</span>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/1011995/daniel-fischer"><div class="gravatar-wrapper-32"><img src="https://i.sstatic.net/Jca5Q.jpg?s=64" alt="Daniel Fischer&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <a href="/users/1011995/daniel-fischer" itemprop="url" dir="auto">Daniel Fischer</a><meta itemprop="name" content="Daniel Fischer"/>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 184,534" dir="ltr">185k</span><span title="19 gold badges" aria-hidden="true"><span class="badge1"></span><span class="badgecount">19</span></span><span class="v-visible-sr">19 gold badges</span><span title="319 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">319</span></span><span class="v-visible-sr">319 silver badges</span><span title="436 bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">436</span></span><span class="v-visible-sr">436 bronze badges</span>
        </div>
    </div>
</div>


                </div>
        </div>
        
    
    </div>
    
</div>




                

    <div class="post-layout--right">
        

<div id="follow-ups-container-11227877">
    <!--[--><div class="mt16"><div class="mb8 d-flex ai-center g8 c-pointer" role="button" tabindex="0"><h2 class="mb0">12 Comments</h2> <!--[--><!--[--><!----><svg aria-hidden="true" class="svg-icon iconArrowDownAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m16.01 7.43-1.4-1.41L9 11.6 3.42 6l-1.4 1.42 7 7z"/></svg><!----><!--]--><!--]--></div> <div class="mb12"><!--[!--><button type="button" class="s-btn s-btn__muted s-btn__outlined w100 d-flex ai-center p8" data-so-test="parent-answer-11227877"><!--[!--><!--]--> <div class="flex--item ml8"><p class="mb0">Add a comment</p></div></button><!--]--></div> <!--[--><div role="list"><!--[--><div id="follow-up-40722655" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/538458/adam-freeman" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://i.sstatic.net/6tkJq.jpg?s=64" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Adam Freeman</div> <div class="s-user-card--awards"><!--[--><a href="/users/538458/adam-freeman" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Adam Freeman</a><!--]--> <a class="comment-link" href="#comment40722655_11227877"><time title="2014-09-23T18:58:12.7Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[--><span class="o50" title="Edited 1 time"><!----><svg aria-hidden="true" class="svg-icon iconPencilSm" width="14" height="14"  viewBox="0 0 14 14"><path fill="#F1B600" d="m2 10.12 6.37-6.43 1.88 1.88L3.88 12H2z"/><path fill="#E87C87" d="m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0"/></svg><!----><!----></span><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->Does branch prediction work better on sorted arrays vs. arrays with different patterns?  For example, for the array --&gt; { 10, 5, 20, 10, 40, 20, ... } the next element in the array from the pattern is 80.  Would this kind of array be sped up by branch prediction in which the next element is 80 here if the pattern is followed?  Or does it usually only help with sorted arrays?<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2014-09-23T18:58:12.7Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-40722655"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">176</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-40722655"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-40722655" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-40722655"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-40722655" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-41900025" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/3206624/agrim-pathak" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://www.gravatar.com/avatar/c1eb194b8aa43884b0ab35aed18648a9?s=48&amp;d=identicon&amp;r=PG&amp;f=y&amp;so-version=2" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Agrim Pathak</div> <div class="s-user-card--awards"><!--[--><a href="/users/3206624/agrim-pathak" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Agrim Pathak</a><!--]--> <a class="comment-link" href="#comment41900025_11227877"><time title="2014-10-30T07:51:58.257Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->So basically everything I conventionally learned about big-O is out of the window?  Better to incur a sorting cost than a branching cost?<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2014-10-30T07:51:58.257Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-41900025"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">223</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-41900025"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-41900025" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-41900025"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-41900025" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-41904388" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/1011995/daniel-fischer" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://i.sstatic.net/Jca5Q.jpg?s=64" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Daniel Fischer</div> <div class="s-user-card--awards"><!--[--><a href="/users/1011995/daniel-fischer" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Daniel Fischer</a><!--]--> <a class="comment-link" href="#comment41904388_11227877"><time title="2014-10-30T10:14:12.367Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->@AgrimPathak That depends. For not too large input, an algorithm with higher complexity is faster than an algorithm with lower complexity when the constants are smaller for the algorithm with higher complexity. Where the break-even point is can be hard to predict. Also, <a href="http://stackoverflow.com/questions/14023988/why-is-processing-a-sorted-array-slower-than-an-unsorted-array?lq=1">compare this</a>, locality is important. Big-O is important, but it is not the sole criterion for performance.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2014-10-30T10:14:12.367Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-41904388"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">213</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-41904388"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-41904388" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-41904388"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-41904388" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-42224805" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/2047418/filip-bartuzi" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://www.gravatar.com/avatar/1d49bccfa9d2c633db6f854e67b88362?s=48&amp;d=identicon&amp;r=PG" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Filip Bartuzi</div> <div class="s-user-card--awards"><!--[--><a href="/users/2047418/filip-bartuzi" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Filip Bartuzi</a><!--]--> <a class="comment-link" href="#comment42224805_11227877"><time title="2014-11-09T13:37:18.36Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->When does branch prediction takes place? When does language will know that array is sorted? I&#39;m thinking of situation of array that looks like: [1,2,3,4,5,...998,999,1000, 3, 10001, 10002] ? will this obscure 3 increase running time? Will it be as long as unsorted array?<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2014-11-09T13:37:18.36Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-42224805"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">117</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-42224805"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-42224805" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-42224805"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-42224805" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-42225007" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/1011995/daniel-fischer" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://i.sstatic.net/Jca5Q.jpg?s=64" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Daniel Fischer</div> <div class="s-user-card--awards"><!--[--><a href="/users/1011995/daniel-fischer" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Daniel Fischer</a><!--]--> <a class="comment-link" href="#comment42225007_11227877"><time title="2014-11-09T13:49:37.987Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->@FilipBartuzi Branch prediction takes place in the processor, below the language level (but the language may offer ways to tell the compiler what&#39;s likely, so the compiler can emit code suited to that). In your example, the out-of-order 3 will lead to a branch-misprediction (for appropriate conditions, where 3 gives a different result than 1000), and thus processing that array will likely take a couple dozen or hundred nanoseconds longer than a sorted array would, hardly ever noticeable. What costs time is i high rate of mispredictions, one misprediction per 1000 isn&#39;t much.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2014-11-09T13:49:37.987Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-42225007"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">117</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-42225007"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-42225007" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-42225007"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-42225007" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><!--]--></div> <!--[--><div class="d-flex g8 my8"><!--[--><button class="s-link s-btn__muted s-btn__outlined comments-link" data-so-test="parent-answer-11227877">Add a comment</button> <!--[--><span>|</span><!--]--><!--]--> <!--[--><button class="s-link s-btn__muted s-btn__outlined comments-link">Show 7 more comments</button><!--]--></div><!--]--><!----><!--]--> <!--[!--><!--]--></div><!--]-->
</div>

<script type="application/json" data-role="module-args" data-module-name="islands/follow-ups/index.mod">{"replies":[{"id":40722655,"user":{"userId":538458,"isDeleted":false,"displayName":"Adam Freeman","url":"/users/538458/adam-freeman","profileImageUrl":"https://i.sstatic.net/6tkJq.jpg?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"AdamFreeman","noSpacesUserName":"AdamFreeman","reputationDisplayText":"0"},"postedAt":"2014-09-23T18:58:12.7Z","postedAtRelative":"Over a year ago","body":"Does branch prediction work better on sorted arrays vs. arrays with different patterns?  For example, for the array --\u003E { 10, 5, 20, 10, 40, 20, ... } the next element in the array from the pattern is 80.  Would this kind of array be sped up by branch prediction in which the next element is 80 here if the pattern is followed?  Or does it usually only help with sorted arrays?","htmlBody":"Does branch prediction work better on sorted arrays vs. arrays with different patterns?  For example, for the array --\u0026gt; { 10, 5, 20, 10, 40, 20, ... } the next element in the array from the pattern is 80.  Would this kind of array be sped up by branch prediction in which the next element is 80 here if the pattern is followed?  Or does it usually only help with sorted arrays?","score":176,"editCount":1,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":41900025,"user":{"userId":3206624,"isDeleted":false,"displayName":"Agrim Pathak","url":"/users/3206624/agrim-pathak","profileImageUrl":"https://www.gravatar.com/avatar/c1eb194b8aa43884b0ab35aed18648a9?s=48\u0026d=identicon\u0026r=PG\u0026f=y\u0026so-version=2","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"AgrimPathak","noSpacesUserName":"AgrimPathak","reputationDisplayText":"0"},"postedAt":"2014-10-30T07:51:58.257Z","postedAtRelative":"Over a year ago","body":"So basically everything I conventionally learned about big-O is out of the window?  Better to incur a sorting cost than a branching cost?","htmlBody":"So basically everything I conventionally learned about big-O is out of the window?  Better to incur a sorting cost than a branching cost?","score":223,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":41904388,"user":{"userId":1011995,"isDeleted":false,"displayName":"Daniel Fischer","url":"/users/1011995/daniel-fischer","profileImageUrl":"https://i.sstatic.net/Jca5Q.jpg?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"DanielFischer","noSpacesUserName":"DanielFischer","reputationDisplayText":"0"},"postedAt":"2014-10-30T10:14:12.367Z","postedAtRelative":"Over a year ago","body":"@AgrimPathak That depends. For not too large input, an algorithm with higher complexity is faster than an algorithm with lower complexity when the constants are smaller for the algorithm with higher complexity. Where the break-even point is can be hard to predict. Also, [compare this](http://stackoverflow.com/questions/14023988/why-is-processing-a-sorted-array-slower-than-an-unsorted-array?lq=1), locality is important. Big-O is important, but it is not the sole criterion for performance.","htmlBody":"@AgrimPathak That depends. For not too large input, an algorithm with higher complexity is faster than an algorithm with lower complexity when the constants are smaller for the algorithm with higher complexity. Where the break-even point is can be hard to predict. Also, \u003Ca href=\u0022http://stackoverflow.com/questions/14023988/why-is-processing-a-sorted-array-slower-than-an-unsorted-array?lq=1\u0022\u003Ecompare this\u003C/a\u003E, locality is important. Big-O is important, but it is not the sole criterion for performance.","score":213,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":42224805,"user":{"userId":2047418,"isDeleted":false,"displayName":"Filip Bartuzi","url":"/users/2047418/filip-bartuzi","profileImageUrl":"https://www.gravatar.com/avatar/1d49bccfa9d2c633db6f854e67b88362?s=48\u0026d=identicon\u0026r=PG","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"FilipBartuzi","noSpacesUserName":"FilipBartuzi","reputationDisplayText":"0"},"postedAt":"2014-11-09T13:37:18.36Z","postedAtRelative":"Over a year ago","body":"When does branch prediction takes place? When does language will know that array is sorted? I\u0027m thinking of situation of array that looks like: [1,2,3,4,5,...998,999,1000, 3, 10001, 10002] ? will this obscure 3 increase running time? Will it be as long as unsorted array?","htmlBody":"When does branch prediction takes place? When does language will know that array is sorted? I\u0026#39;m thinking of situation of array that looks like: [1,2,3,4,5,...998,999,1000, 3, 10001, 10002] ? will this obscure 3 increase running time? Will it be as long as unsorted array?","score":117,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":42225007,"user":{"userId":1011995,"isDeleted":false,"displayName":"Daniel Fischer","url":"/users/1011995/daniel-fischer","profileImageUrl":"https://i.sstatic.net/Jca5Q.jpg?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"DanielFischer","noSpacesUserName":"DanielFischer","reputationDisplayText":"0"},"postedAt":"2014-11-09T13:49:37.987Z","postedAtRelative":"Over a year ago","body":"@FilipBartuzi Branch prediction takes place in the processor, below the language level (but the language may offer ways to tell the compiler what\u0027s likely, so the compiler can emit code suited to that). In your example, the out-of-order 3 will lead to a branch-misprediction (for appropriate conditions, where 3 gives a different result than 1000), and thus processing that array will likely take a couple dozen or hundred nanoseconds longer than a sorted array would, hardly ever noticeable. What costs time is i high rate of mispredictions, one misprediction per 1000 isn\u0027t much.","htmlBody":"@FilipBartuzi Branch prediction takes place in the processor, below the language level (but the language may offer ways to tell the compiler what\u0026#39;s likely, so the compiler can emit code suited to that). In your example, the out-of-order 3 will lead to a branch-misprediction (for appropriate conditions, where 3 gives a different result than 1000), and thus processing that array will likely take a couple dozen or hundred nanoseconds longer than a sorted array would, hardly ever noticeable. What costs time is i high rate of mispredictions, one misprediction per 1000 isn\u0026#39;t much.","score":117,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":48082367,"user":{"userId":1715673,"isDeleted":false,"displayName":"Peter Wone","url":"/users/1715673/peter-wone","profileImageUrl":"https://www.gravatar.com/avatar/dcd9836a94720caadd7dfc82d1df627d?s=48\u0026d=identicon\u0026r=PG","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"PeterWone","noSpacesUserName":"PeterWone","reputationDisplayText":"0"},"postedAt":"2015-05-01T04:02:56.987Z","postedAtRelative":"Over a year ago","body":"@AdamFreeman - Sorting is relevant here only inasmuch as *in this code* it increases branch prediction to 100% success.","htmlBody":"@AdamFreeman - Sorting is relevant here only inasmuch as \u003Ci\u003Ein this code\u003C/i\u003E it increases branch prediction to 100% success.","score":8,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false},{"id":75387346,"user":{"userId":7886227,"isDeleted":false,"displayName":"Dr t","url":"/users/7886227/dr-t","profileImageUrl":"https://i.sstatic.net/hec3U.jpg?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"Drt","noSpacesUserName":"Drt","reputationDisplayText":"0"},"postedAt":"2017-05-25T17:51:33.05Z","postedAtRelative":"Over a year ago","body":"I would recommend a look at: https://en.wikibooks.org/wiki/Optimizing_C%2B%2B/Writing_efficient_code/Performance_improving_features  which provides a good discussion with examples of this topic including some that are not mentioned in any comments that i have seen regarding this question.","htmlBody":"I would recommend a look at: \u003Ca href=\u0022https://en.wikibooks.org/wiki/Optimizing_C%2B%2B/Writing_efficient_code/Performance_improving_features\u0022 rel=\u0022nofollow noreferrer\u0022\u003Een.wikibooks.org/wiki/Optimizing_C%2B%2B/Writing_efficient_code/\u0026hellip;\u003C/a\u003E  which provides a good discussion with examples of this topic including some that are not mentioned in any comments that i have seen regarding this question.","score":9,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false},{"id":79447312,"user":{"userId":4285898,"isDeleted":false,"displayName":"\u0906\u0928\u0902\u0926","url":"/users/4285898/%e0%a4%86%e0%a4%a8%e0%a4%82%e0%a4%a6","profileImageUrl":"https://lh3.googleusercontent.com/-2RjNyl00QDA/AAAAAAAAAAI/AAAAAAAAARQ/FrNVhUUIMLw/s48-rj/photo.jpg","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"\u0906\u0928\u0902\u0926","noSpacesUserName":"\u0906\u0928\u0902\u0926","reputationDisplayText":"0"},"postedAt":"2017-09-15T14:16:54.367Z","postedAtRelative":"Over a year ago","body":"@DanielFischer does compiler knows which array is sorted and which one is not?","htmlBody":"@DanielFischer does compiler knows which array is sorted and which one is not?","score":8,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false},{"id":80423729,"user":{"userId":1054647,"isDeleted":false,"displayName":"knickum","url":"/users/1054647/knickum","profileImageUrl":"https://www.gravatar.com/avatar/05df494d41b7d14a22d7bff3959d531a?s=48\u0026d=identicon\u0026r=PG","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"knickum","noSpacesUserName":"knickum","reputationDisplayText":"0"},"postedAt":"2017-10-13T21:43:01.933Z","postedAtRelative":"Over a year ago","body":"@AnandTyagi As Peter Wone noted, it\u0027s not that the compiler knows which array is sorted or not. Imagine an extremely simple branch predictor that takes the same path as the previous iteration, e.g. a train taking a left if it took a left last time, and vice versa. For a sorted array of 256 ints, (ignoring the undefined first iteration), the prediction would be correct from 2-128, wrong at 129, and then correct from 130-256. Now, that\u0027s a terrible branch predictor that would only work in this specific situation, but a really good predictor should still handle this capably.","htmlBody":"@AnandTyagi As Peter Wone noted, it\u0026#39;s not that the compiler knows which array is sorted or not. Imagine an extremely simple branch predictor that takes the same path as the previous iteration, e.g. a train taking a left if it took a left last time, and vice versa. For a sorted array of 256 ints, (ignoring the undefined first iteration), the prediction would be correct from 2-128, wrong at 129, and then correct from 130-256. Now, that\u0026#39;s a terrible branch predictor that would only work in this specific situation, but a really good predictor should still handle this capably.","score":10,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false},{"id":110714690,"user":{"userId":1494680,"isDeleted":false,"displayName":"Omer","url":"/users/1494680/omer","profileImageUrl":"https://www.gravatar.com/avatar/303668e5317cc07925197755ff3c10c4?s=48\u0026d=identicon\u0026r=PG","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"Omer","noSpacesUserName":"Omer","reputationDisplayText":"0"},"postedAt":"2020-06-27T05:57:38.313Z","postedAtRelative":"Over a year ago","body":"Is the branch predictions mostly happen at compiler level or it is handled by processor? And why java or c\u002B\u002B can not handled it? I mean why is not complicated to predict it right?","htmlBody":"Is the branch predictions mostly happen at compiler level or it is handled by processor? And why java or c\u002B\u002B can not handled it? I mean why is not complicated to predict it right?","score":3,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false},{"id":127137562,"user":{"userId":224132,"isDeleted":false,"displayName":"Peter Cordes","url":"/users/224132/peter-cordes","profileImageUrl":"https://i.sstatic.net/N4ivW.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"PeterCordes","noSpacesUserName":"PeterCordes","reputationDisplayText":"0"},"postedAt":"2022-04-21T05:36:20.397Z","postedAtRelative":"Over a year ago","body":"@AgrimPathak: No, unless you can sort once but iterate over the array many times, the time to sort an array is much larger than one pass with this loop.  Comparison-based sorting also involves many data-dependent branches.  (O(N) sorts like Counting Sort or Radix Sort may avoid mispredicts depending on implementation choice, but still have enough overhead to make it not worth it.)  What you should actually do is encourage the compiler to make branchless asm, like \u0060sum \u002B=  (v \u003E= 128 ? v : 0);\u0060 or similar, or to [vectorize with SIMD](https://stackoverflow.com/q/66521344).","htmlBody":"@AgrimPathak: No, unless you can sort once but iterate over the array many times, the time to sort an array is much larger than one pass with this loop.  Comparison-based sorting also involves many data-dependent branches.  (O(N) sorts like Counting Sort or Radix Sort may avoid mispredicts depending on implementation choice, but still have enough overhead to make it not worth it.)  What you should actually do is encourage the compiler to make branchless asm, like \u003Ccode\u003Esum \u002B=  (v \u0026gt;= 128 ? v : 0);\u003C/code\u003E or similar, or to \u003Ca href=\u0022https://stackoverflow.com/q/66521344\u0022\u003Evectorize with SIMD\u003C/a\u003E.","score":0,"editCount":1,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false},{"id":131591422,"user":{"userId":16589128,"isDeleted":false,"displayName":"puppydrum64","url":"/users/16589128/puppydrum64","profileImageUrl":"https://www.gravatar.com/avatar/6972c4410bbb513b34ec0d4b2251ce6c?s=48\u0026d=identicon\u0026r=PG\u0026f=y\u0026so-version=2","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"puppydrum64","noSpacesUserName":"puppydrum64","reputationDisplayText":"0"},"postedAt":"2022-11-23T12:45:00.28Z","postedAtRelative":"Over a year ago","body":"@Omer The branch predictions are purely at a processor level.  Even in assembly there\u0027s no syntax to help the CPU branch predict. It boils down to the way the hardware works. There\u0027s just no way to know whether a branch will be taken ahead of time.  While it\u0027s obvious to you and me, a computer really isn\u0027t as smart. It\u0027s not aware of anything that exists outside of a few instructions ahead and the caches.","htmlBody":"@Omer The branch predictions are purely at a processor level.  Even in assembly there\u0026#39;s no syntax to help the CPU branch predict. It boils down to the way the hardware works. There\u0026#39;s just no way to know whether a branch will be taken ahead of time.  While it\u0026#39;s obvious to you and me, a computer really isn\u0026#39;t as smart. It\u0026#39;s not aware of anything that exists outside of a few instructions ahead and the caches.","score":2,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":true,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false}],"postId":11227877,"currentUserIsMod":false,"currentUserIsAnonymous":true,"commentFlagsRemainingToday":10,"maxNestingLevel":3,"hasOptedOut":false,"showCtaUnderComments":true,"containerElementId":"follow-ups-container-11227877","fKey":"d09ecbbe5140a7c1439a7e4020cdd7d76b52d28795a889bb24233842877804f3","questionId":11227809,"questionAuthorId":87234,"answerId":11227877,"answerPositionOnPage":0,"newUiSettings":{"largerFontSize":false},"showFirstTimeCommentingModal":false,"isMentionEnabled":false,"showSpamFlag":true,"mergeUnfriendlyAndRudeFlags":true,"allowRetractingCommentFlags":true,"commentMinLength":15}</script>
    </div>

        </div>
</div>
                                        
<a name="11237235"></a>
<div id="answer-11237235" class="answer js-answer " data-answerid="11237235"
     data-parentid="11227809" data-score="3861" data-position-on-page="3"
     data-highest-scored="0"
     data-question-has-accepted-highest-score="1"
     data-author-username="WiSaGaN"
     data-author-reputation="48397"
     data-should-show-copy-button=True
     data-se-share-sheet-license-name="CC BY-SA 4.0"
     data-is-edited="True"
      itemprop="suggestedAnswer"
     itemscope itemtype="https://schema.org/Answer">
        <div class="post-layout ">
                <div class="votecell post-layout--left">
                    
<div class="js-voting-container d-flex jc-center fd-column ai-center gs4 fc-black-300" data-post-id="11237235" data-referrer="None">
        <button class="js-vote-up-btn flex--item s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
                id="upvote-btn-11237235"
                data-controller="s-tooltip"
                data-s-tooltip-placement="right"
                title="This answer is useful"
                aria-pressed="false"
                aria-label="Up vote"
                data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
                data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">
            <svg aria-hidden="true" class="svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg>
        </button>
        <input type="hidden" id="voteUpHash" value="70:3:31e,16:6bdbb6479e1ec108,10:1771427630,16:8b3b3ee8015224cb,8:11237235,80502721831cd220d87cae29779777d906f10b1275eddb60294bc33c2146d503" />
        <div class="js-vote-count flex--item d-flex fd-column ai-center fc-theme-body-font fw-bold fs-subheading py4"
             itemprop="upvoteCount"
             data-value="3861">
3861        </div>
        <button
            class="js-vote-down-btn flex--item mb8 s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
            id=downvote-btn-11237235
            title="This answer is not useful"
            aria-pressed="false"
            aria-label="Down vote"
            data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
            data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">

            <svg aria-hidden="true" class="svg-icon iconArrowDown" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 6h16l-8 8z"/></svg>
        </button>
        <input type="hidden" id="voteDownHash" value="70:3:31e,16:e04a93ecf7fa0c98,10:1771427630,16:4b073bf9004d7587,8:11237235,eefa22962222bcca81bb16943fff8f7da3c97a7fb5bd2716306c2fdbee3b5487" />


        
<button class="js-saves-btn s-btn s-btn__unset c-pointer py4"
        type="button"
        id="saves-btn-11237235"
        data-controller="s-tooltip"
        data-s-tooltip-placement="right"
        data-s-popover-placement=""
        title="Save this answer."
        data-is-saved="false"
        aria-label="Save"
        data-post-id="11237235"
        data-post-type-id="2"
        data-user-privilege-for-post-click="0"
        aria-controls=""
        data-s-popover-auto-show="false"
>
    <svg aria-hidden="true" class="fc-theme-primary-400 js-saves-btn-selected d-none svg-icon iconBookmark" width="18" height="18"  viewBox="0 0 18 18"><path  d="M3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
    <svg aria-hidden="true" class="js-saves-btn-unselected svg-icon iconBookmarkAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m9 10.6 4 2.66V3H5v10.26zM3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
</button>







            <div class="js-accepted-answer-indicator flex--item fc-green-400 py6 mtn8 d-none" data-s-tooltip-placement="right" title="Loading when this answer was accepted&#x2026;" tabindex="0" role="note" aria-label="Accepted">
                <div class="ta-center">
                    <svg aria-hidden="true" class="svg-icon iconCheckmarkLg" width="36" height="36"  viewBox="0 0 36 36"><path  d="m6 14 8 8L30 6v8L14 30l-8-8z"/></svg>
                </div>
            </div>
            
<div class="js-bounty-award-container flex--item py4">

    <div class="d-flex fd-column gs4 ai-center">

            <div class="js-bounty-award flex--item s-badge s-badge__bounty s-badge__sm as-center"
                 title="This answer has been awarded bounties worth 150 reputation by DatEpicCoderGuyWhoPrograms" data-controller="s-tooltip" data-s-tooltip-placement="right">
                +150
            </div>

    </div>
</div>


    
    <a class="js-post-issue flex--item s-btn s-btn__unset c-pointer py6 mx-auto" href="/posts/11237235/timeline" data-shortcut="T" data-ks-title="timeline" data-controller="s-tooltip" data-s-tooltip-placement="right" title="Show activity on this post." aria-label="Timeline"><svg aria-hidden="true" class="mln2 mr0 svg-icon iconHistory" width="19" height="18"  viewBox="0 0 19 18"><path  d="M3 9a8 8 0 1 1 3.73 6.77L8.2 14.3A6 6 0 1 0 5 9l3.01-.01-4 4-4-4zm7-4h1.01L11 9.36l3.22 2.1-.6.93L10 10z"/></svg></a>

</div>

                </div>

            

<div class="answercell post-layout--right">
    


    <div class="s-prose js-post-body" itemprop="text">
<p>The reason why performance improves drastically when the data is sorted is that the branch prediction penalty is removed, as explained beautifully in <a href="//stackoverflow.com/questions/11227809/why-is-it-faster-to-process-a-sorted-array-than-an-unsorted-array/11227902#11227902">Mysticial's answer</a>.</p>
<p>Now, if we look at the code</p>
<pre><code>if (data[c] &gt;= 128)
    sum += data[c];
</code></pre>
<p>we can find that the meaning of this particular <code>if... else...</code> branch is to add something when a condition is satisfied. This type of branch can be easily transformed into a <strong>conditional move</strong> statement, which would be compiled into a conditional move instruction: <code>cmovl</code>, in an <code>x86</code> system. The branch and thus the potential branch prediction penalty is removed.</p>
<p>In <code>C</code>, thus <code>C++</code>, the statement, which would compile directly (without any optimization) into the conditional move instruction in <code>x86</code>, is the ternary operator <code>... ? ... : ...</code>. So we rewrite the above statement into an equivalent one:</p>
<pre><code>sum += data[c] &gt;=128 ? data[c] : 0;
</code></pre>
<p>While maintaining readability, we can check the speedup factor.</p>
<p>On an Intel <a href="//en.wikipedia.org/wiki/Intel_Core#Core_i7" rel="noreferrer">Core i7</a>-2600K @ 3.4GHz and Visual Studio 2010 Release Mode, the benchmark is:</p>
<p><strong>x86</strong></p>
<div class="s-table-container">
<table class="s-table">
<thead>
<tr>
<th>Scenario</th>
<th>Time (seconds)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Branching - Random data</td>
<td>8.885</td>
</tr>
<tr>
<td>Branching - Sorted data</td>
<td>1.528</td>
</tr>
<tr>
<td>Branchless - Random data</td>
<td>3.716</td>
</tr>
<tr>
<td>Branchless - Sorted data</td>
<td>3.71</td>
</tr>
</tbody>
</table>
</div>
<p><strong>x64</strong></p>
<div class="s-table-container">
<table class="s-table">
<thead>
<tr>
<th>Scenario</th>
<th>Time (seconds)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Branching - Random data</td>
<td>11.302</td>
</tr>
<tr>
<td>Branching - Sorted data</td>
<td>1.830</td>
</tr>
<tr>
<td>Branchless - Random data</td>
<td>2.736</td>
</tr>
<tr>
<td>Branchless - Sorted data</td>
<td>2.737</td>
</tr>
</tbody>
</table>
</div>
<p>The result is robust in multiple tests. We get a great speedup when the branch result is unpredictable, but we suffer a little bit when it is predictable. In fact, when using a conditional move, the performance is the same regardless of the data pattern.</p>
<p>Now let's look more closely by investigating the <code>x86</code> assembly they generate. For simplicity, we use two functions <code>max1</code> and <code>max2</code>.</p>
<p><code>max1</code> uses the conditional branch <code>if... else ...</code>:</p>
<pre><code>int max1(int a, int b) {
    if (a &gt; b)
        return a;
    else
        return b;
}
</code></pre>
<p><code>max2</code> uses the ternary operator <code>... ? ... : ...</code>:</p>
<pre><code>int max2(int a, int b) {
    return a &gt; b ? a : b;
}
</code></pre>
<p>On an x86-64 machine, <code>GCC -S</code> generates the assembly below.</p>
<pre><code>:max1
    movl    %edi, -4(%rbp)
    movl    %esi, -8(%rbp)
    movl    -4(%rbp), %eax
    cmpl    -8(%rbp), %eax
    jle     .L2
    movl    -4(%rbp), %eax
    movl    %eax, -12(%rbp)
    jmp     .L4
.L2:
    movl    -8(%rbp), %eax
    movl    %eax, -12(%rbp)
.L4:
    movl    -12(%rbp), %eax
    leave
    ret

:max2
    movl    %edi, -4(%rbp)
    movl    %esi, -8(%rbp)
    movl    -4(%rbp), %eax
    cmpl    %eax, -8(%rbp)
    cmovge  -8(%rbp), %eax
    leave
    ret
</code></pre>
<p><code>max2</code> uses much less code due to the usage of instruction <code>cmovge</code>. But the real gain is that <code>max2</code> does not involve branch jumps, <code>jmp</code>, which would have a significant performance penalty if the predicted result is not right.</p>
<p>So why does a conditional move perform better?</p>
<p>In a typical <code>x86</code> processor, the execution of an instruction is divided into several stages. Roughly, we have different hardware to deal with different stages. So we do not have to wait for one instruction to finish to start a new one. This is called <strong><a href="//en.wikipedia.org/wiki/Pipeline_(computing)" rel="noreferrer">pipelining</a></strong>.</p>
<p>In a branch case, the following instruction is determined by the preceding one, so we cannot do pipelining. We have to either wait or predict.</p>
<p>In a conditional move case, the execution of conditional move instruction is divided into several stages, but the earlier stages like <code>Fetch</code> and <code>Decode</code> do not depend on the result of the previous instruction; only the latter stages need the result. Thus, we wait a fraction of one instruction's execution time. This is why the conditional move version is slower than the branch when the prediction is easy.</p>
<p>The book <em><a href="https://rads.stackoverflow.com/amzn/click/com/0136108040" rel="noreferrer" rel="nofollow noreferrer">Computer Systems: A Programmer's Perspective, second edition</a></em> explains this in detail. You can check Section 3.6.6 for <em>Conditional Move Instructions</em>, entire Chapter 4 for <em>Processor Architecture</em>, and Section 5.11.2 for special treatment for <em>Branch Prediction and Misprediction Penalties</em>.</p>
<p>Sometimes, some modern compilers can optimize our code to assembly with better performance, and sometimes some compilers can't (the code in question is using Visual Studio's native compiler). Knowing the performance difference between a branch and a conditional move when unpredictable can help us write code with better performance when the scenario gets so complex that the compiler can not optimize them automatically.</p>
    </div>
    <div class="mt24">
        <div class="d-flex fw-wrap ai-start jc-end gs8 gsy">

            <time itemprop="dateCreated" datetime="2012-06-28 02:14:03Z"></time>
            <div class="flex--item mr16" style="flex: 1 1 100px;">
                


<div class="js-post-menu pt2" data-post-id="11237235" data-post-type-id="2">

    <div class="d-flex gs8 s-anchors s-anchors__muted fw-wrap">

        <div class="flex--item">
            <a href="/a/11237235"
               rel="nofollow"
               itemprop="url"
               class="js-share-link js-gps-track"
               title="Short permalink to this answer"
               data-gps-track="post.click({ item: 2, priv: 0, post_type: 2 })"
               data-controller="se-share-sheet"
               data-se-share-sheet-title="Share a link to this answer"
               data-se-share-sheet-subtitle=""
               data-se-share-sheet-post-type="answer"
               data-se-share-sheet-social="facebook twitter devto"
               data-se-share-sheet-location="2"
               data-se-share-sheet-license-url="https%3a%2f%2fcreativecommons.org%2flicenses%2fby-sa%2f4.0%2f"
               data-se-share-sheet-license-name="CC BY-SA 4.0"
               data-s-popover-placement="bottom-start">Share</a>
        </div>


                    <div class="flex--item">
                        <a href="/posts/11237235/edit" class="js-suggest-edit-post js-gps-track" data-gps-track="post.click({ item: 6, priv: 0, post_type: 2 })" title="">Improve this answer</a>
                    </div>

                <div class="flex--item">
                    <button type="button"
                            id="btnFollowPost-11237235" class="s-btn s-btn__link js-follow-post js-follow-answer js-gps-track"
                            data-gps-track="post.click({ item: 14, priv: 0, post_type: 2 })"
                            data-controller="s-tooltip " data-s-tooltip-placement="bottom"
                            data-s-popover-placement="bottom" aria-controls=""
                            title="Follow this answer to receive notifications">
                        Follow
                        <input type="hidden" id="voteFollowHash" value="70:3:31e,16:4d9ca579604296e5,10:1771427630,16:aad7c7c0c3167dd4,8:11237235,f0129856bfd07890bfc75bd17b8c178b09b06e0a7e90166a542acf75c2c9d6ed" />
                    </button>
                </div>






    </div>
    <div class="js-menu-popup-container"></div>
</div>
            </div>
            <div class="post-signature flex--item fl0">
<div class="user-info user-hover ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            <a href="/posts/11237235/revisions" title="show all edits to this post"
                         class="js-gps-track"
                         data-gps-track="post.click({ item: 4, priv: 0, post_type: 2 })">edited <span title='2022-07-03 15:12:52Z' class='relativetime'>Jul 3, 2022 at 15:12</span></a>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/13567719/mihir-ajmera"><div class="gravatar-wrapper-32"><img src="https://lh3.googleusercontent.com/a-/AOh14Gi6Vstmxgn9x_VZsGjlQzJlXZXJKGZhfOvn1TB_=k-s64" alt="Mihir Ajmera&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/13567719/mihir-ajmera" dir="auto">Mihir Ajmera</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">127</span><span title="1 silver badge" aria-hidden="true"><span class="badge2"></span><span class="badgecount">1</span></span><span class="v-visible-sr">1 silver badge</span><span title="9 bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">9</span></span><span class="v-visible-sr">9 bronze badges</span>
        </div>
    </div>
</div>
            </div>


                <div class="post-signature flex--item fl0">
                    <div class="user-info ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            answered <span title='2012-06-28 02:14:03Z' class='relativetime'>Jun 28, 2012 at 2:14</span>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/866732/wisagan"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/f09f0253204000d6083ed1de21afc6fd?s=64&amp;d=identicon&amp;r=PG" alt="WiSaGaN&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <a href="/users/866732/wisagan" itemprop="url" dir="auto">WiSaGaN</a><meta itemprop="name" content="WiSaGaN"/>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 48,397" dir="ltr">48.4k</span><span title="10 gold badges" aria-hidden="true"><span class="badge1"></span><span class="badgecount">10</span></span><span class="v-visible-sr">10 gold badges</span><span title="59 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">59</span></span><span class="v-visible-sr">59 silver badges</span><span title="92 bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">92</span></span><span class="v-visible-sr">92 bronze badges</span>
        </div>
    </div>
</div>


                </div>
        </div>
        
    
    </div>
    
</div>




                

    <div class="post-layout--right">
        

<div id="follow-ups-container-11237235">
    <!--[--><div class="mt16"><div class="mb8 d-flex ai-center g8 c-pointer" role="button" tabindex="0"><h2 class="mb0">4 Comments</h2> <!--[--><!--[--><!----><svg aria-hidden="true" class="svg-icon iconArrowDownAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m16.01 7.43-1.4-1.41L9 11.6 3.42 6l-1.4 1.42 7 7z"/></svg><!----><!--]--><!--]--></div> <div class="mb12"><!--[!--><button type="button" class="s-btn s-btn__muted s-btn__outlined w100 d-flex ai-center p8 comments-link" data-so-test="parent-answer-11237235"><!--[!--><!--]--> <div class="flex--item ml8"><p class="mb0">Add a comment</p></div></button><!--]--></div> <!--[--><div role="list"><!--[--><div id="follow-up-115127186" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/3924108/linus-fernandes" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://www.gravatar.com/avatar/7b7612263f0c62d716c6dee0fe7ecb76?s=48&amp;d=identicon&amp;r=PG" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Linus Fernandes</div> <div class="s-user-card--awards"><!--[--><a href="/users/3924108/linus-fernandes" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Linus Fernandes</a><!--]--> <a class="comment-link" href="#comment115127186_11237235"><time title="2020-12-03T05:32:04.127Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!----><a href="https://stackoverflow.com/questions/9745389/is-the-ternary-operator-faster-than-an-if-condition-in-java" title="is the ternary operator faster than an if condition in java">stackoverflow.com/questions/9745389/&hellip;</a><!----><!--]--></div> <time class="d-none" itemprop="datePublished">2020-12-03T05:32:04.127Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-115127186"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">17</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-115127186"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-115127186" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-115127186"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-115127186" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-128673830" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/224132/peter-cordes" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://i.sstatic.net/N4ivW.png?s=64" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Peter Cordes</div> <div class="s-user-card--awards"><!--[--><a href="/users/224132/peter-cordes" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Peter Cordes</a><!--]--> <a class="comment-link" href="#comment128673830_11237235"><time title="2022-07-03T21:05:16.91Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[--><span class="o50" title="Edited 2 times"><!----><svg aria-hidden="true" class="svg-icon iconPencilSm" width="14" height="14"  viewBox="0 0 14 14"><path fill="#F1B600" d="m2 10.12 6.37-6.43 1.88 1.88L3.88 12H2z"/><path fill="#E87C87" d="m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0"/></svg><!----><!----></span><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->You forgot to enable optimization; it&#39;s not useful to benchmark debug builds that <a href="https://stackoverflow.com/questions/53366394/why-does-clang-produce-inefficient-asm-with-o0-for-this-simple-floating-point">store/reload everything to the stack</a>.  Use <code>gcc -O2 -fno-tree-vectorize -S</code> if you want efficient scalar asm that hopefully uses cmov.  (<code>-O3</code> would probably auto-vectorize, so would <code>-O2</code> with GCC12 or later.)  See also <a href="https://stackoverflow.com/q/28875325">gcc optimization flag -O3 makes code slower than -O2</a> (for the sorted case, when it uses cmov poorly for the <code>if</code>).<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2022-07-03T21:05:16.91Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-128673830"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">6</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-128673830"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-128673830" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-128673830"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-128673830" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-139632555" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/13986340/ed" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://www.gravatar.com/avatar/89f242f32a44c937c6cb929c0df9dab2?s=48&amp;d=identicon&amp;r=PG&amp;f=y&amp;so-version=2" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">ed__</div> <div class="s-user-card--awards"><!--[--><a href="/users/13986340/ed" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">ed__</a><!--]--> <a class="comment-link" href="#comment139632555_11237235"><time title="2024-11-13T15:38:21.83Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->I think calling the ternary operator &quot;branchless&quot; is the wrong idea here. You are relying on a language optimization feature which just so happens to be used in one of the two functions, even when they are semantically equivalent.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2024-11-13T15:38:21.83Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-139632555"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">2</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-139632555"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-139632555" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-139632555"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-139632555" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-140928204" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/14672114/rare-kpop-manifesto" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://lh3.googleusercontent.com/a-/AOh14Gh77XbK_ZXsqVwrM6a6K6g2DNN4_XD_K1wOopWCVA=k-s48" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">RARE Kpop Manifesto</div> <div class="s-user-card--awards"><!--[--><a href="/users/14672114/rare-kpop-manifesto" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">RARE Kpop Manifesto</a><!--]--> <a class="comment-link" href="#comment140928204_11237235"><time title="2026-01-05T01:50:33.627Z" class="s-user-card--time ws-nowrap truncate">Jan 5 at 1:50</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->shouldn&#39;t it be <code>int max2(int a, int b) { return a &gt;= b ? a : b }</code> so the value matching scenario wouldn&#39;t have to go to backside of the ternary ? (or does it make no difference?)<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2026-01-05T01:50:33.627Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-140928204"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">0</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-140928204"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-140928204" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-140928204"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-140928204" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><!--]--></div> <!--[--><div class="d-flex g8 my8"><!--[--><button class="s-link s-btn__muted s-btn__outlined comments-link" data-so-test="parent-answer-11237235">Add a comment</button> <!--[!--><!--]--><!--]--> <!--[!--><!--]--></div><!--]--><!----><!--]--> <!--[!--><!--]--></div><!--]-->
</div>

<script type="application/json" data-role="module-args" data-module-name="islands/follow-ups/index.mod">{"replies":[{"id":115127186,"user":{"userId":3924108,"isDeleted":false,"displayName":"Linus Fernandes","url":"/users/3924108/linus-fernandes","profileImageUrl":"https://www.gravatar.com/avatar/7b7612263f0c62d716c6dee0fe7ecb76?s=48\u0026d=identicon\u0026r=PG","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"LinusFernandes","noSpacesUserName":"LinusFernandes","reputationDisplayText":"0"},"postedAt":"2020-12-03T05:32:04.127Z","postedAtRelative":"Over a year ago","body":"https://stackoverflow.com/questions/9745389/is-the-ternary-operator-faster-than-an-if-condition-in-java","htmlBody":"\u003Ca href=\u0022https://stackoverflow.com/questions/9745389/is-the-ternary-operator-faster-than-an-if-condition-in-java\u0022 title=\u0022is the ternary operator faster than an if condition in java\u0022\u003Estackoverflow.com/questions/9745389/\u0026hellip;\u003C/a\u003E","score":17,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":128673830,"user":{"userId":224132,"isDeleted":false,"displayName":"Peter Cordes","url":"/users/224132/peter-cordes","profileImageUrl":"https://i.sstatic.net/N4ivW.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"PeterCordes","noSpacesUserName":"PeterCordes","reputationDisplayText":"0"},"postedAt":"2022-07-03T21:05:16.91Z","postedAtRelative":"Over a year ago","body":"You forgot to enable optimization; it\u0027s not useful to benchmark debug builds that [store/reload everything to the stack](https://stackoverflow.com/questions/53366394/why-does-clang-produce-inefficient-asm-with-o0-for-this-simple-floating-point).  Use \u0060gcc -O2 -fno-tree-vectorize -S\u0060 if you want efficient scalar asm that hopefully uses cmov.  (\u0060-O3\u0060 would probably auto-vectorize, so would \u0060-O2\u0060 with GCC12 or later.)  See also [gcc optimization flag -O3 makes code slower than -O2](https://stackoverflow.com/q/28875325) (for the sorted case, when it uses cmov poorly for the \u0060if\u0060).","htmlBody":"You forgot to enable optimization; it\u0026#39;s not useful to benchmark debug builds that \u003Ca href=\u0022https://stackoverflow.com/questions/53366394/why-does-clang-produce-inefficient-asm-with-o0-for-this-simple-floating-point\u0022\u003Estore/reload everything to the stack\u003C/a\u003E.  Use \u003Ccode\u003Egcc -O2 -fno-tree-vectorize -S\u003C/code\u003E if you want efficient scalar asm that hopefully uses cmov.  (\u003Ccode\u003E-O3\u003C/code\u003E would probably auto-vectorize, so would \u003Ccode\u003E-O2\u003C/code\u003E with GCC12 or later.)  See also \u003Ca href=\u0022https://stackoverflow.com/q/28875325\u0022\u003Egcc optimization flag -O3 makes code slower than -O2\u003C/a\u003E (for the sorted case, when it uses cmov poorly for the \u003Ccode\u003Eif\u003C/code\u003E).","score":6,"editCount":2,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":139632555,"user":{"userId":13986340,"isDeleted":false,"displayName":"ed__","url":"/users/13986340/ed","profileImageUrl":"https://www.gravatar.com/avatar/89f242f32a44c937c6cb929c0df9dab2?s=48\u0026d=identicon\u0026r=PG\u0026f=y\u0026so-version=2","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"ed__","noSpacesUserName":"ed__","reputationDisplayText":"0"},"postedAt":"2024-11-13T15:38:21.83Z","postedAtRelative":"Over a year ago","body":"I think calling the ternary operator \u0022branchless\u0022 is the wrong idea here. You are relying on a language optimization feature which just so happens to be used in one of the two functions, even when they are semantically equivalent.","htmlBody":"I think calling the ternary operator \u0026quot;branchless\u0026quot; is the wrong idea here. You are relying on a language optimization feature which just so happens to be used in one of the two functions, even when they are semantically equivalent.","score":2,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":140928204,"user":{"userId":14672114,"isDeleted":false,"displayName":"RARE Kpop Manifesto","url":"/users/14672114/rare-kpop-manifesto","profileImageUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh77XbK_ZXsqVwrM6a6K6g2DNN4_XD_K1wOopWCVA=k-s48","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"RAREKpopManifesto","noSpacesUserName":"RAREKpopManifesto","reputationDisplayText":"0"},"postedAt":"2026-01-05T01:50:33.627Z","postedAtRelative":"Jan 5 at 1:50","body":"shouldn\u0027t it be \u0060int max2(int a, int b) { return a \u003E= b ? a : b }\u0060 so the value matching scenario wouldn\u0027t have to go to backside of the ternary ? (or does it make no difference?)","htmlBody":"shouldn\u0026#39;t it be \u003Ccode\u003Eint max2(int a, int b) { return a \u0026gt;= b ? a : b }\u003C/code\u003E so the value matching scenario wouldn\u0026#39;t have to go to backside of the ternary ? (or does it make no difference?)","score":0,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":true,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true}],"postId":11237235,"currentUserIsMod":false,"currentUserIsAnonymous":true,"commentFlagsRemainingToday":10,"maxNestingLevel":3,"hasOptedOut":false,"showCtaUnderComments":true,"containerElementId":"follow-ups-container-11237235","fKey":"d09ecbbe5140a7c1439a7e4020cdd7d76b52d28795a889bb24233842877804f3","questionId":11227809,"questionAuthorId":87234,"answerId":11237235,"answerPositionOnPage":0,"newUiSettings":{"largerFontSize":false},"showFirstTimeCommentingModal":false,"isMentionEnabled":false,"showSpamFlag":true,"mergeUnfriendlyAndRudeFlags":true,"allowRetractingCommentFlags":true,"commentMinLength":15}</script>
    </div>

        </div>
</div>
<div class="js-zone-container zone-container-main">
    <div id="dfp-smlb" class="everyonelovesstackoverflow everyoneloves__mid-second-leaderboard everyoneloves__leaderboard"></div>
		<div class="js-report-ad-button-container " style="width: 728px"></div>
</div>
                                        
<a name="11303693"></a>
<div id="answer-11303693" class="answer js-answer " data-answerid="11303693"
     data-parentid="11227809" data-score="2667" data-position-on-page="4"
     data-highest-scored="0"
     data-question-has-accepted-highest-score="1"
     data-author-username="vulcan raven"
     data-author-reputation="33822"
     data-should-show-copy-button=True
     data-se-share-sheet-license-name="CC BY-SA 4.0"
     data-is-edited="True"
      itemprop="suggestedAnswer"
     itemscope itemtype="https://schema.org/Answer">
        <div class="post-layout ">
                <div class="votecell post-layout--left">
                    
<div class="js-voting-container d-flex jc-center fd-column ai-center gs4 fc-black-300" data-post-id="11303693" data-referrer="None">
        <button class="js-vote-up-btn flex--item s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
                id="upvote-btn-11303693"
                data-controller="s-tooltip"
                data-s-tooltip-placement="right"
                title="This answer is useful"
                aria-pressed="false"
                aria-label="Up vote"
                data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
                data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">
            <svg aria-hidden="true" class="svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg>
        </button>
        <input type="hidden" id="voteUpHash" value="70:3:31e,16:f590536398954b57,10:1771427630,16:cc9a000f0e98ada8,8:11303693,6d0532747a87bedff2c2a6ea11a65ac46ee4d12935a5641c74ea68844c841934" />
        <div class="js-vote-count flex--item d-flex fd-column ai-center fc-theme-body-font fw-bold fs-subheading py4"
             itemprop="upvoteCount"
             data-value="2667">
2667        </div>
        <button
            class="js-vote-down-btn flex--item mb8 s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
            id=downvote-btn-11303693
            title="This answer is not useful"
            aria-pressed="false"
            aria-label="Down vote"
            data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
            data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">

            <svg aria-hidden="true" class="svg-icon iconArrowDown" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 6h16l-8 8z"/></svg>
        </button>
        <input type="hidden" id="voteDownHash" value="70:3:31e,16:94b38f827a815762,10:1771427630,16:7be6fa8d7702380d,8:11303693,d2a9cd7c8e580a3771b4037f1c7662a4d9de6b7b6cdfe4c9d33d11a01dbe027e" />


        
<button class="js-saves-btn s-btn s-btn__unset c-pointer py4"
        type="button"
        id="saves-btn-11303693"
        data-controller="s-tooltip"
        data-s-tooltip-placement="right"
        data-s-popover-placement=""
        title="Save this answer."
        data-is-saved="false"
        aria-label="Save"
        data-post-id="11303693"
        data-post-type-id="2"
        data-user-privilege-for-post-click="0"
        aria-controls=""
        data-s-popover-auto-show="false"
>
    <svg aria-hidden="true" class="fc-theme-primary-400 js-saves-btn-selected d-none svg-icon iconBookmark" width="18" height="18"  viewBox="0 0 18 18"><path  d="M3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
    <svg aria-hidden="true" class="js-saves-btn-unselected svg-icon iconBookmarkAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m9 10.6 4 2.66V3H5v10.26zM3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
</button>







            <div class="js-accepted-answer-indicator flex--item fc-green-400 py6 mtn8 d-none" data-s-tooltip-placement="right" title="Loading when this answer was accepted&#x2026;" tabindex="0" role="note" aria-label="Accepted">
                <div class="ta-center">
                    <svg aria-hidden="true" class="svg-icon iconCheckmarkLg" width="36" height="36"  viewBox="0 0 36 36"><path  d="m6 14 8 8L30 6v8L14 30l-8-8z"/></svg>
                </div>
            </div>

    
    <a class="js-post-issue flex--item s-btn s-btn__unset c-pointer py6 mx-auto" href="/posts/11303693/timeline" data-shortcut="T" data-ks-title="timeline" data-controller="s-tooltip" data-s-tooltip-placement="right" title="Show activity on this post." aria-label="Timeline"><svg aria-hidden="true" class="mln2 mr0 svg-icon iconHistory" width="19" height="18"  viewBox="0 0 19 18"><path  d="M3 9a8 8 0 1 1 3.73 6.77L8.2 14.3A6 6 0 1 0 5 9l3.01-.01-4 4-4-4zm7-4h1.01L11 9.36l3.22 2.1-.6.93L10 10z"/></svg></a>

</div>

                </div>

            

<div class="answercell post-layout--right">
    


    <div class="s-prose js-post-body" itemprop="text">
<p>If you are curious about even more optimizations that can be done to this code, consider this:</p>
<p>Starting with the original loop:</p>
<pre class="lang-cpp prettyprint-override"><code>for (unsigned i = 0; i &lt; 100000; ++i)
{
    for (unsigned j = 0; j &lt; arraySize; ++j)
    {
        if (data[j] &gt;= 128)
            sum += data[j];
    }
}
</code></pre>
<p>With loop interchange, we can safely change this loop to:</p>
<pre class="lang-cpp prettyprint-override"><code>for (unsigned j = 0; j &lt; arraySize; ++j)
{
    for (unsigned i = 0; i &lt; 100000; ++i)
    {
        if (data[j] &gt;= 128)
            sum += data[j];
    }
}
</code></pre>
<p>Then, you can see that the <code>if</code> conditional is constant throughout the execution of the <code>i</code> loop, so you can hoist the <code>if</code> out:</p>
<pre class="lang-cpp prettyprint-override"><code> for (unsigned j = 0; j &lt; arraySize; ++j)
 {
     if (data[j] &gt;= 128)
     {
         for (unsigned i = 0; i &lt; 100000; ++i)
         {
             sum += data[j];
         }
    }
}
</code></pre>
<p>Then, you see that the inner loop can be collapsed into one single expression, assuming the floating point model allows it (<code>/fp:fast</code> is thrown, for example)</p>
<pre class="lang-cpp prettyprint-override"><code>for (unsigned j = 0; j &lt; arraySize; ++j)
{
    if (data[j] &gt;= 128)
    {
        sum += data[j] * 100000;
    }
}
</code></pre>
<p>That one is 100,000 times faster than before.</p>
    </div>
    <div class="mt24">
        <div class="d-flex fw-wrap ai-start jc-end gs8 gsy">

            <time itemprop="dateCreated" datetime="2012-07-03 02:25:30Z"></time>
            <div class="flex--item mr16" style="flex: 1 1 100px;">
                


<div class="js-post-menu pt2" data-post-id="11303693" data-post-type-id="2">

    <div class="d-flex gs8 s-anchors s-anchors__muted fw-wrap">

        <div class="flex--item">
            <a href="/a/11303693"
               rel="nofollow"
               itemprop="url"
               class="js-share-link js-gps-track"
               title="Short permalink to this answer"
               data-gps-track="post.click({ item: 2, priv: 0, post_type: 2 })"
               data-controller="se-share-sheet"
               data-se-share-sheet-title="Share a link to this answer"
               data-se-share-sheet-subtitle=""
               data-se-share-sheet-post-type="answer"
               data-se-share-sheet-social="facebook twitter devto"
               data-se-share-sheet-location="2"
               data-se-share-sheet-license-url="https%3a%2f%2fcreativecommons.org%2flicenses%2fby-sa%2f4.0%2f"
               data-se-share-sheet-license-name="CC BY-SA 4.0"
               data-s-popover-placement="bottom-start">Share</a>
        </div>


                    <div class="flex--item">
                        <a href="/posts/11303693/edit" class="js-suggest-edit-post js-gps-track" data-gps-track="post.click({ item: 6, priv: 0, post_type: 2 })" title="">Improve this answer</a>
                    </div>

                <div class="flex--item">
                    <button type="button"
                            id="btnFollowPost-11303693" class="s-btn s-btn__link js-follow-post js-follow-answer js-gps-track"
                            data-gps-track="post.click({ item: 14, priv: 0, post_type: 2 })"
                            data-controller="s-tooltip " data-s-tooltip-placement="bottom"
                            data-s-popover-placement="bottom" aria-controls=""
                            title="Follow this answer to receive notifications">
                        Follow
                        <input type="hidden" id="voteFollowHash" value="70:3:31e,16:3d521b0dca40b8c5,10:1771427630,16:845b6da93c1400cf,8:11303693,62ec97fc3f003d47046c135a982f3f746db77f18fe5404e3a152aab2222dcdc6" />
                    </button>
                </div>






    </div>
    <div class="js-menu-popup-container"></div>
</div>
            </div>
            <div class="post-signature flex--item fl0">
<div class="user-info user-hover ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            <a href="/posts/11303693/revisions" title="show all edits to this post"
                         class="js-gps-track"
                         data-gps-track="post.click({ item: 4, priv: 0, post_type: 2 })">edited <span title='2024-01-02 18:32:46Z' class='relativetime'>Jan 2, 2024 at 18:32</span></a>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/11631959/avidcoder"><div class="gravatar-wrapper-32"><img src="https://lh3.googleusercontent.com/-T8NkNQvhOyE/AAAAAAAAAAI/AAAAAAAAB-0/9JoUPhYxXIw/s64-rj/photo.jpg" alt="AvidCoder&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/11631959/avidcoder" dir="auto">AvidCoder</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">531</span><span title="2 gold badges" aria-hidden="true"><span class="badge1"></span><span class="badgecount">2</span></span><span class="v-visible-sr">2 gold badges</span><span title="8 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">8</span></span><span class="v-visible-sr">8 silver badges</span><span title="27 bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">27</span></span><span class="v-visible-sr">27 bronze badges</span>
        </div>
    </div>
</div>
            </div>


                <div class="post-signature flex--item fl0">
                    <div class="user-info ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            answered <span title='2012-07-03 02:25:30Z' class='relativetime'>Jul 3, 2012 at 2:25</span>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/863980/vulcan-raven"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/ea08c9063ae1de86e8d576fb569d513a?s=64&amp;d=identicon&amp;r=PG" alt="vulcan raven&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <a href="/users/863980/vulcan-raven" itemprop="url" dir="auto">vulcan raven</a><meta itemprop="name" content="vulcan raven"/>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 33,822" dir="ltr">33.8k</span><span title="11 gold badges" aria-hidden="true"><span class="badge1"></span><span class="badgecount">11</span></span><span class="v-visible-sr">11 gold badges</span><span title="61 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">61</span></span><span class="v-visible-sr">61 silver badges</span><span title="101 bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">101</span></span><span class="v-visible-sr">101 bronze badges</span>
        </div>
    </div>
</div>


                </div>
        </div>
        
    
    </div>
    
</div>




                

    <div class="post-layout--right">
        

<div id="follow-ups-container-11303693">
    <!--[--><div class="mt16"><div class="mb8 d-flex ai-center g8 c-pointer" role="button" tabindex="0"><h2 class="mb0">3 Comments</h2> <!--[--><!--[--><!----><svg aria-hidden="true" class="svg-icon iconArrowDownAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m16.01 7.43-1.4-1.41L9 11.6 3.42 6l-1.4 1.42 7 7z"/></svg><!----><!--]--><!--]--></div> <div class="mb12"><!--[!--><button type="button" class="s-btn s-btn__muted s-btn__outlined w100 d-flex ai-center p8 comments-link" data-so-test="parent-answer-11303693"><!--[!--><!--]--> <div class="flex--item ml8"><p class="mb0">Add a comment</p></div></button><!--]--></div> <!--[--><div role="list"><!--[--><div id="follow-up-130709739" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/4969945/cpcallen" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://lh3.googleusercontent.com/-V_gW7xpKyDI/AAAAAAAAAAI/AAAAAAAAH7o/Fvn3wFRSbMA/s48-rj/photo.jpg" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">cpcallen</div> <div class="s-user-card--awards"><!--[--><a href="/users/4969945/cpcallen" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">cpcallen</a><!--]--> <a class="comment-link" href="#comment130709739_11303693"><time title="2022-10-11T13:13:33.85Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->This is delightful, but for anyone who might not understand the joke: the purpose of the <code>for (unsigned i = 0; i &lt; 100000; ++i)</code> in the original code is to run the code being benchmarked many times so as to be able to more accurately measure the time taken to execute itmeasurements that would otherwise be compromised by limited timer resolution and/or jitter caused by other processes (including the OS) unpredictably preempting this one.  It is true that the benchmarked code does take much, <i>much</i> less time to execute if you run it only once!<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2022-10-11T13:13:33.85Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-130709739"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">33</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-130709739"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-130709739" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-130709739"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-130709739" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-137067847" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/224132/peter-cordes" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://i.sstatic.net/N4ivW.png?s=64" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Peter Cordes</div> <div class="s-user-card--awards"><!--[--><a href="/users/224132/peter-cordes" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Peter Cordes</a><!--]--> <a class="comment-link" href="#comment137067847_11303693"><time title="2024-01-02T21:37:08.867Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->@NameSurname - your edit didn&#39;t actually change the syntax highlighting; Java/C++ syntax highlighting was already the default because of the tags on the question, and Java vs. C++ highlighting don&#39;t differ in how they highlight this so it didn&#39;t matter which it picked.  Please don&#39;t clutter up the edit queue (or spend your time on) edits that don&#39;t actually change anything.  Also, in some of your other recent edit suggestions, don&#39;t use <code>code formatting</code> for names of programs, only things that are actual shell commands or source-code names of functions or variables. It&#39;s bad for screen readers<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2024-01-02T21:37:08.867Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-137067847"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">6</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-137067847"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-137067847" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-137067847"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-137067847" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-140928206" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/14672114/rare-kpop-manifesto" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://lh3.googleusercontent.com/a-/AOh14Gh77XbK_ZXsqVwrM6a6K6g2DNN4_XD_K1wOopWCVA=k-s48" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">RARE Kpop Manifesto</div> <div class="s-user-card--awards"><!--[--><a href="/users/14672114/rare-kpop-manifesto" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">RARE Kpop Manifesto</a><!--]--> <a class="comment-link" href="#comment140928206_11303693"><time title="2026-01-05T01:52:23.013Z" class="s-user-card--time ws-nowrap truncate">Jan 5 at 1:52</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->can we just lump it all into just <code>sum += data[j] * (data[j] &gt;= 128) * 100000</code>, and make it <b>semi</b>-constant time ?<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2026-01-05T01:52:23.013Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-140928206"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">0</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-140928206"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-140928206" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-140928206"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-140928206" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><!--]--></div> <!--[--><div class="d-flex g8 my8"><!--[--><button class="s-link s-btn__muted s-btn__outlined comments-link" data-so-test="parent-answer-11303693">Add a comment</button> <!--[!--><!--]--><!--]--> <!--[!--><!--]--></div><!--]--><!----><!--]--> <!--[!--><!--]--></div><!--]-->
</div>

<script type="application/json" data-role="module-args" data-module-name="islands/follow-ups/index.mod">{"replies":[{"id":130709739,"user":{"userId":4969945,"isDeleted":false,"displayName":"cpcallen","url":"/users/4969945/cpcallen","profileImageUrl":"https://lh3.googleusercontent.com/-V_gW7xpKyDI/AAAAAAAAAAI/AAAAAAAAH7o/Fvn3wFRSbMA/s48-rj/photo.jpg","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"cpcallen","noSpacesUserName":"cpcallen","reputationDisplayText":"0"},"postedAt":"2022-10-11T13:13:33.85Z","postedAtRelative":"Over a year ago","body":"This is delightful, but for anyone who might not understand the joke: the purpose of the \u0060for (unsigned i = 0; i \u003C 100000; \u002B\u002Bi)\u0060 in the original code is to run the code being benchmarked many times so as to be able to more accurately measure the time taken to execute it\u2014measurements that would otherwise be compromised by limited timer resolution and/or jitter caused by other processes (including the OS) unpredictably preempting this one.  It is true that the benchmarked code does take much, _much_ less time to execute if you run it only once!","htmlBody":"This is delightful, but for anyone who might not understand the joke: the purpose of the \u003Ccode\u003Efor (unsigned i = 0; i \u0026lt; 100000; \u002B\u002Bi)\u003C/code\u003E in the original code is to run the code being benchmarked many times so as to be able to more accurately measure the time taken to execute it\u2014measurements that would otherwise be compromised by limited timer resolution and/or jitter caused by other processes (including the OS) unpredictably preempting this one.  It is true that the benchmarked code does take much, \u003Ci\u003Emuch\u003C/i\u003E less time to execute if you run it only once!","score":33,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":137067847,"user":{"userId":224132,"isDeleted":false,"displayName":"Peter Cordes","url":"/users/224132/peter-cordes","profileImageUrl":"https://i.sstatic.net/N4ivW.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"PeterCordes","noSpacesUserName":"PeterCordes","reputationDisplayText":"0"},"postedAt":"2024-01-02T21:37:08.867Z","postedAtRelative":"Over a year ago","body":"@NameSurname - your edit didn\u0027t actually change the syntax highlighting; Java/C\u002B\u002B syntax highlighting was already the default because of the tags on the question, and Java vs. C\u002B\u002B highlighting don\u0027t differ in how they highlight this so it didn\u0027t matter which it picked.  Please don\u0027t clutter up the edit queue (or spend your time on) edits that don\u0027t actually change anything.  Also, in some of your other recent edit suggestions, don\u0027t use \u0060code formatting\u0060 for names of programs, only things that are actual shell commands or source-code names of functions or variables. It\u0027s bad for screen readers","htmlBody":"@NameSurname - your edit didn\u0026#39;t actually change the syntax highlighting; Java/C\u002B\u002B syntax highlighting was already the default because of the tags on the question, and Java vs. C\u002B\u002B highlighting don\u0026#39;t differ in how they highlight this so it didn\u0026#39;t matter which it picked.  Please don\u0026#39;t clutter up the edit queue (or spend your time on) edits that don\u0026#39;t actually change anything.  Also, in some of your other recent edit suggestions, don\u0026#39;t use \u003Ccode\u003Ecode formatting\u003C/code\u003E for names of programs, only things that are actual shell commands or source-code names of functions or variables. It\u0026#39;s bad for screen readers","score":6,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":140928206,"user":{"userId":14672114,"isDeleted":false,"displayName":"RARE Kpop Manifesto","url":"/users/14672114/rare-kpop-manifesto","profileImageUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh77XbK_ZXsqVwrM6a6K6g2DNN4_XD_K1wOopWCVA=k-s48","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"RAREKpopManifesto","noSpacesUserName":"RAREKpopManifesto","reputationDisplayText":"0"},"postedAt":"2026-01-05T01:52:23.013Z","postedAtRelative":"Jan 5 at 1:52","body":"can we just lump it all into just \u0060sum \u002B= data[j] * (data[j] \u003E= 128) * 100000\u0060, and make it **semi**-constant time ?","htmlBody":"can we just lump it all into just \u003Ccode\u003Esum \u002B= data[j] * (data[j] \u0026gt;= 128) * 100000\u003C/code\u003E, and make it \u003Cb\u003Esemi\u003C/b\u003E-constant time ?","score":0,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":true,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true}],"postId":11303693,"currentUserIsMod":false,"currentUserIsAnonymous":true,"commentFlagsRemainingToday":10,"maxNestingLevel":3,"hasOptedOut":false,"showCtaUnderComments":true,"containerElementId":"follow-ups-container-11303693","fKey":"d09ecbbe5140a7c1439a7e4020cdd7d76b52d28795a889bb24233842877804f3","questionId":11227809,"questionAuthorId":87234,"answerId":11303693,"answerPositionOnPage":0,"newUiSettings":{"largerFontSize":false},"showFirstTimeCommentingModal":false,"isMentionEnabled":false,"showSpamFlag":true,"mergeUnfriendlyAndRudeFlags":true,"allowRetractingCommentFlags":true,"commentMinLength":15}</script>
    </div>

        </div>
</div>
                                        
<a name="12853037"></a>
<div id="answer-12853037" class="answer js-answer " data-answerid="12853037"
     data-parentid="11227809" data-score="2210" data-position-on-page="5"
     data-highest-scored="0"
     data-question-has-accepted-highest-score="1"
     data-author-username="caf"
     data-author-reputation="241151"
     data-should-show-copy-button=True
     data-se-share-sheet-license-name="CC BY-SA 3.0"
     data-is-edited="True"
      itemprop="suggestedAnswer"
     itemscope itemtype="https://schema.org/Answer">
        <div class="post-layout ">
                <div class="votecell post-layout--left">
                    
<div class="js-voting-container d-flex jc-center fd-column ai-center gs4 fc-black-300" data-post-id="12853037" data-referrer="None">
        <button class="js-vote-up-btn flex--item s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
                id="upvote-btn-12853037"
                data-controller="s-tooltip"
                data-s-tooltip-placement="right"
                title="This answer is useful"
                aria-pressed="false"
                aria-label="Up vote"
                data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
                data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">
            <svg aria-hidden="true" class="svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg>
        </button>
        <input type="hidden" id="voteUpHash" value="70:3:31e,16:51cc08a490afca9e,10:1771427630,16:7b073b5279080dc3,8:12853037,4e067bee6d753a90b0d687440b31da6691020fce779dff25b8f8bacc7e0395fc" />
        <div class="js-vote-count flex--item d-flex fd-column ai-center fc-theme-body-font fw-bold fs-subheading py4"
             itemprop="upvoteCount"
             data-value="2210">
2210        </div>
        <button
            class="js-vote-down-btn flex--item mb8 s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
            id=downvote-btn-12853037
            title="This answer is not useful"
            aria-pressed="false"
            aria-label="Down vote"
            data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
            data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">

            <svg aria-hidden="true" class="svg-icon iconArrowDown" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 6h16l-8 8z"/></svg>
        </button>
        <input type="hidden" id="voteDownHash" value="70:3:31e,16:b620285f839d5f0b,10:1771427630,16:5584f23d456fa55e,8:12853037,2156ec1a010eaa7cf4cc5299a1a9069525d0fe16c92f8fa43b72fed85e3872cd" />


        
<button class="js-saves-btn s-btn s-btn__unset c-pointer py4"
        type="button"
        id="saves-btn-12853037"
        data-controller="s-tooltip"
        data-s-tooltip-placement="right"
        data-s-popover-placement=""
        title="Save this answer."
        data-is-saved="false"
        aria-label="Save"
        data-post-id="12853037"
        data-post-type-id="2"
        data-user-privilege-for-post-click="0"
        aria-controls=""
        data-s-popover-auto-show="false"
>
    <svg aria-hidden="true" class="fc-theme-primary-400 js-saves-btn-selected d-none svg-icon iconBookmark" width="18" height="18"  viewBox="0 0 18 18"><path  d="M3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
    <svg aria-hidden="true" class="js-saves-btn-unselected svg-icon iconBookmarkAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m9 10.6 4 2.66V3H5v10.26zM3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
</button>







            <div class="js-accepted-answer-indicator flex--item fc-green-400 py6 mtn8 d-none" data-s-tooltip-placement="right" title="Loading when this answer was accepted&#x2026;" tabindex="0" role="note" aria-label="Accepted">
                <div class="ta-center">
                    <svg aria-hidden="true" class="svg-icon iconCheckmarkLg" width="36" height="36"  viewBox="0 0 36 36"><path  d="m6 14 8 8L30 6v8L14 30l-8-8z"/></svg>
                </div>
            </div>

    
    <a class="js-post-issue flex--item s-btn s-btn__unset c-pointer py6 mx-auto" href="/posts/12853037/timeline" data-shortcut="T" data-ks-title="timeline" data-controller="s-tooltip" data-s-tooltip-placement="right" title="Show activity on this post." aria-label="Timeline"><svg aria-hidden="true" class="mln2 mr0 svg-icon iconHistory" width="19" height="18"  viewBox="0 0 19 18"><path  d="M3 9a8 8 0 1 1 3.73 6.77L8.2 14.3A6 6 0 1 0 5 9l3.01-.01-4 4-4-4zm7-4h1.01L11 9.36l3.22 2.1-.6.93L10 10z"/></svg></a>

</div>

                </div>

            

<div class="answercell post-layout--right">
    


    <div class="s-prose js-post-body" itemprop="text">
<p>No doubt some of us would be interested in ways of identifying code that is problematic for the CPU's branch-predictor. The Valgrind tool <code>cachegrind</code> has a branch-predictor simulator, enabled by using the <code>--branch-sim=yes</code> flag. Running it over the examples in this question, with the number of outer loops reduced to 10000 and compiled with <code>g++</code>, gives these results:</p>

<p><strong>Sorted:</strong></p>

<pre><code>==32551== Branches:        656,645,130  (  656,609,208 cond +    35,922 ind)
==32551== Mispredicts:         169,556  (      169,095 cond +       461 ind)
==32551== Mispred rate:            0.0% (          0.0%     +       1.2%   )
</code></pre>

<p><strong>Unsorted:</strong></p>

<pre><code>==32555== Branches:        655,996,082  (  655,960,160 cond +  35,922 ind)
==32555== Mispredicts:     164,073,152  (  164,072,692 cond +     460 ind)
==32555== Mispred rate:           25.0% (         25.0%     +     1.2%   )
</code></pre>

<p>Drilling down into the line-by-line output produced by <code>cg_annotate</code> we see for the loop in question:</p>

<p><strong>Sorted:</strong></p>

<pre><code>          Bc    Bcm Bi Bim
      10,001      4  0   0      for (unsigned i = 0; i &lt; 10000; ++i)
           .      .  .   .      {
           .      .  .   .          // primary loop
 327,690,000 10,016  0   0          for (unsigned c = 0; c &lt; arraySize; ++c)
           .      .  .   .          {
 327,680,000 10,006  0   0              if (data[c] &gt;= 128)
           0      0  0   0                  sum += data[c];
           .      .  .   .          }
           .      .  .   .      }
</code></pre>

<p><strong>Unsorted:</strong></p>

<pre><code>          Bc         Bcm Bi Bim
      10,001           4  0   0      for (unsigned i = 0; i &lt; 10000; ++i)
           .           .  .   .      {
           .           .  .   .          // primary loop
 327,690,000      10,038  0   0          for (unsigned c = 0; c &lt; arraySize; ++c)
           .           .  .   .          {
 327,680,000 164,050,007  0   0              if (data[c] &gt;= 128)
           0           0  0   0                  sum += data[c];
           .           .  .   .          }
           .           .  .   .      }
</code></pre>

<p>This lets you easily identify the problematic line - in the unsorted version the <code>if (data[c] &gt;= 128)</code> line is causing 164,050,007 mispredicted conditional branches (<code>Bcm</code>) under cachegrind's branch-predictor model, whereas it's only causing 10,006 in the sorted version.</p>

<hr>

<p>Alternatively, on Linux you can use the performance counters subsystem to accomplish the same task, but with native performance using CPU counters.</p>

<pre><code>perf stat ./sumtest_sorted
</code></pre>

<p><strong>Sorted:</strong></p>

<pre><code> Performance counter stats for './sumtest_sorted':

  11808.095776 task-clock                #    0.998 CPUs utilized          
         1,062 context-switches          #    0.090 K/sec                  
            14 CPU-migrations            #    0.001 K/sec                  
           337 page-faults               #    0.029 K/sec                  
26,487,882,764 cycles                    #    2.243 GHz                    
41,025,654,322 instructions              #    1.55  insns per cycle        
 6,558,871,379 branches                  #  555.455 M/sec                  
       567,204 branch-misses             #    0.01% of all branches        

  11.827228330 seconds time elapsed
</code></pre>

<p><strong>Unsorted:</strong></p>

<pre><code> Performance counter stats for './sumtest_unsorted':

  28877.954344 task-clock                #    0.998 CPUs utilized          
         2,584 context-switches          #    0.089 K/sec                  
            18 CPU-migrations            #    0.001 K/sec                  
           335 page-faults               #    0.012 K/sec                  
65,076,127,595 cycles                    #    2.253 GHz                    
41,032,528,741 instructions              #    0.63  insns per cycle        
 6,560,579,013 branches                  #  227.183 M/sec                  
 1,646,394,749 branch-misses             #   25.10% of all branches        

  28.935500947 seconds time elapsed
</code></pre>

<p>It can also do source code annotation with dissassembly.</p>

<pre><code>perf record -e branch-misses ./sumtest_unsorted
perf annotate -d sumtest_unsorted
</code></pre>



<pre><code> Percent |      Source code &amp; Disassembly of sumtest_unsorted
------------------------------------------------
...
         :                      sum += data[c];
    0.00 :        400a1a:       mov    -0x14(%rbp),%eax
   39.97 :        400a1d:       mov    %eax,%eax
    5.31 :        400a1f:       mov    -0x20040(%rbp,%rax,4),%eax
    4.60 :        400a26:       cltq   
    0.00 :        400a28:       add    %rax,-0x30(%rbp)
...
</code></pre>

<p>See <a href="https://perf.wiki.kernel.org/index.php/Tutorial" rel="noreferrer">the performance tutorial</a> for more details.</p>
    </div>
    <div class="mt24">
        <div class="d-flex fw-wrap ai-start jc-end gs8 gsy">

            <time itemprop="dateCreated" datetime="2012-10-12 05:53:33Z"></time>
            <div class="flex--item mr16" style="flex: 1 1 100px;">
                


<div class="js-post-menu pt2" data-post-id="12853037" data-post-type-id="2">

    <div class="d-flex gs8 s-anchors s-anchors__muted fw-wrap">

        <div class="flex--item">
            <a href="/a/12853037"
               rel="nofollow"
               itemprop="url"
               class="js-share-link js-gps-track"
               title="Short permalink to this answer"
               data-gps-track="post.click({ item: 2, priv: 0, post_type: 2 })"
               data-controller="se-share-sheet"
               data-se-share-sheet-title="Share a link to this answer"
               data-se-share-sheet-subtitle=""
               data-se-share-sheet-post-type="answer"
               data-se-share-sheet-social="facebook twitter devto"
               data-se-share-sheet-location="2"
               data-se-share-sheet-license-url="https%3a%2f%2fcreativecommons.org%2flicenses%2fby-sa%2f3.0%2f"
               data-se-share-sheet-license-name="CC BY-SA 3.0"
               data-s-popover-placement="bottom-start">Share</a>
        </div>


                    <div class="flex--item">
                        <a href="/posts/12853037/edit" class="js-suggest-edit-post js-gps-track" data-gps-track="post.click({ item: 6, priv: 0, post_type: 2 })" title="">Improve this answer</a>
                    </div>

                <div class="flex--item">
                    <button type="button"
                            id="btnFollowPost-12853037" class="s-btn s-btn__link js-follow-post js-follow-answer js-gps-track"
                            data-gps-track="post.click({ item: 14, priv: 0, post_type: 2 })"
                            data-controller="s-tooltip " data-s-tooltip-placement="bottom"
                            data-s-popover-placement="bottom" aria-controls=""
                            title="Follow this answer to receive notifications">
                        Follow
                        <input type="hidden" id="voteFollowHash" value="70:3:31e,16:d73b8564e8af0fa8,10:1771427630,16:6b2441601159f527,8:12853037,c86b9c1ce26923ca0cae9258a348ed530e16a4523c6b93e2a685aad7712f1933" />
                    </button>
                </div>






    </div>
    <div class="js-menu-popup-container"></div>
</div>
            </div>
            <div class="post-signature flex--item fl0">
<div class="user-info user-hover ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            <a href="/posts/12853037/revisions" title="show all edits to this post"
                         class="js-gps-track"
                         data-gps-track="post.click({ item: 4, priv: 0, post_type: 2 })">edited <span title='2012-10-18 19:20:21Z' class='relativetime'>Oct 18, 2012 at 19:20</span></a>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/63550/peter-mortensen"><div class="gravatar-wrapper-32"><img src="https://i.sstatic.net/RIZKi.png?s=64" alt="Peter Mortensen&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/63550/peter-mortensen" dir="auto">Peter Mortensen</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 31,210" dir="ltr">31.2k</span><span title="22 gold badges" aria-hidden="true"><span class="badge1"></span><span class="badgecount">22</span></span><span class="v-visible-sr">22 gold badges</span><span title="111 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">111</span></span><span class="v-visible-sr">111 silver badges</span><span title="134 bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">134</span></span><span class="v-visible-sr">134 bronze badges</span>
        </div>
    </div>
</div>
            </div>


                <div class="post-signature flex--item fl0">
                    <div class="user-info ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            answered <span title='2012-10-12 05:53:33Z' class='relativetime'>Oct 12, 2012 at 5:53</span>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/134633/caf"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/dc6be45ddcfd038ba5e1e5fca319c7fa?s=64&amp;d=identicon&amp;r=PG" alt="caf&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <a href="/users/134633/caf" itemprop="url" dir="auto">caf</a><meta itemprop="name" content="caf"/>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 241,151" dir="ltr">241k</span><span title="42 gold badges" aria-hidden="true"><span class="badge1"></span><span class="badgecount">42</span></span><span class="v-visible-sr">42 gold badges</span><span title="344 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">344</span></span><span class="v-visible-sr">344 silver badges</span><span title="481 bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">481</span></span><span class="v-visible-sr">481 bronze badges</span>
        </div>
    </div>
</div>


                </div>
        </div>
        
    
    </div>
    
</div>




                

    <div class="post-layout--right">
        

<div id="follow-ups-container-12853037">
    <!--[--><div class="mt16"><div class="mb8 d-flex ai-center g8 c-pointer" role="button" tabindex="0"><h2 class="mb0">3 Comments</h2> <!--[--><!--[--><!----><svg aria-hidden="true" class="svg-icon iconArrowDownAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m16.01 7.43-1.4-1.41L9 11.6 3.42 6l-1.4 1.42 7 7z"/></svg><!----><!--]--><!--]--></div> <div class="mb12"><!--[!--><button type="button" class="s-btn s-btn__muted s-btn__outlined w100 d-flex ai-center p8 comments-link" data-so-test="parent-answer-12853037"><!--[!--><!--]--> <div class="flex--item ml8"><p class="mb0">Add a comment</p></div></button><!--]--></div> <!--[--><div role="list"><!--[--><div id="follow-up-30576818" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/2383730/tallbrianl" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://i.sstatic.net/giP28.jpg?s=64" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">TallBrianL</div> <div class="s-user-card--awards"><!--[--><a href="/users/2383730/tallbrianl" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">TallBrianL</a><!--]--> <a class="comment-link" href="#comment30576818_12853037"><time title="2013-12-09T04:00:09.29Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->This is scary, in the unsorted list, there should be 50% chance of hitting the add.  Somehow the branch prediction only has a 25% miss rate, how can it do better than 50% miss?<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2013-12-09T04:00:09.29Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-30576818"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">108</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-30576818"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-30576818" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-30576818"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-30576818" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-30577316" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/134633/caf" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://www.gravatar.com/avatar/dc6be45ddcfd038ba5e1e5fca319c7fa?s=48&amp;d=identicon&amp;r=PG" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">caf</div> <div class="s-user-card--awards"><!--[--><a href="/users/134633/caf" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">caf</a><!--]--> <a class="comment-link" href="#comment30577316_12853037"><time title="2013-12-09T04:29:25.037Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->@tall.b.lo: The 25% is of all branches - there are <i>two</i> branches in the loop, one for <code>data[c] &gt;= 128</code> (which has a 50% miss rate as you suggest) and one for the loop condition <code>c &lt; arraySize</code> which has ~0% miss rate.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2013-12-09T04:29:25.037Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-30577316"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">181</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-30577316"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-30577316" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-30577316"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-30577316" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-127137494" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/224132/peter-cordes" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://i.sstatic.net/N4ivW.png?s=64" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Peter Cordes</div> <div class="s-user-card--awards"><!--[--><a href="/users/224132/peter-cordes" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Peter Cordes</a><!--]--> <a class="comment-link" href="#comment127137494_12853037"><time title="2022-04-21T05:31:14.443Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->Note that benchmarking / profiling un-optimized (&quot;debug mode&quot;) code is normally a bad idea.  With optimization, that version without branch misses would be faster by a much larger margin, not stalling on store/reload latency for local variables.  The actual branch mispredict rate for the critical branch should be about the same, though (assuming there is one: modern compilers can <a href="https://stackoverflow.com/q/66521344">vectorize this</a> or otherwise make branchless asm).  Loop unrolling could change the overall miss rate by running a predictable loop branch less often.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2022-04-21T05:31:14.443Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-127137494"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">10</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-127137494"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-127137494" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-127137494"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-127137494" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><!--]--></div> <!--[--><div class="d-flex g8 my8"><!--[--><button class="s-link s-btn__muted s-btn__outlined comments-link" data-so-test="parent-answer-12853037">Add a comment</button> <!--[!--><!--]--><!--]--> <!--[!--><!--]--></div><!--]--><!----><!--]--> <!--[!--><!--]--></div><!--]-->
</div>

<script type="application/json" data-role="module-args" data-module-name="islands/follow-ups/index.mod">{"replies":[{"id":30576818,"user":{"userId":2383730,"isDeleted":false,"displayName":"TallBrianL","url":"/users/2383730/tallbrianl","profileImageUrl":"https://i.sstatic.net/giP28.jpg?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"TallBrianL","noSpacesUserName":"TallBrianL","reputationDisplayText":"0"},"postedAt":"2013-12-09T04:00:09.29Z","postedAtRelative":"Over a year ago","body":"This is scary, in the unsorted list, there should be 50% chance of hitting the add.  Somehow the branch prediction only has a 25% miss rate, how can it do better than 50% miss?","htmlBody":"This is scary, in the unsorted list, there should be 50% chance of hitting the add.  Somehow the branch prediction only has a 25% miss rate, how can it do better than 50% miss?","score":108,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":30577316,"user":{"userId":134633,"isDeleted":false,"displayName":"caf","url":"/users/134633/caf","profileImageUrl":"https://www.gravatar.com/avatar/dc6be45ddcfd038ba5e1e5fca319c7fa?s=48\u0026d=identicon\u0026r=PG","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"caf","noSpacesUserName":"caf","reputationDisplayText":"0"},"postedAt":"2013-12-09T04:29:25.037Z","postedAtRelative":"Over a year ago","body":"@tall.b.lo: The 25% is of all branches - there are *two* branches in the loop, one for \u0060data[c] \u003E= 128\u0060 (which has a 50% miss rate as you suggest) and one for the loop condition \u0060c \u003C arraySize\u0060 which has ~0% miss rate.","htmlBody":"@tall.b.lo: The 25% is of all branches - there are \u003Ci\u003Etwo\u003C/i\u003E branches in the loop, one for \u003Ccode\u003Edata[c] \u0026gt;= 128\u003C/code\u003E (which has a 50% miss rate as you suggest) and one for the loop condition \u003Ccode\u003Ec \u0026lt; arraySize\u003C/code\u003E which has ~0% miss rate.","score":181,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":127137494,"user":{"userId":224132,"isDeleted":false,"displayName":"Peter Cordes","url":"/users/224132/peter-cordes","profileImageUrl":"https://i.sstatic.net/N4ivW.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"PeterCordes","noSpacesUserName":"PeterCordes","reputationDisplayText":"0"},"postedAt":"2022-04-21T05:31:14.443Z","postedAtRelative":"Over a year ago","body":"Note that benchmarking / profiling un-optimized (\u0022debug mode\u0022) code is normally a bad idea.  With optimization, that version without branch misses would be faster by a much larger margin, not stalling on store/reload latency for local variables.  The actual branch mispredict rate for the critical branch should be about the same, though (assuming there is one: modern compilers can [vectorize this](https://stackoverflow.com/q/66521344) or otherwise make branchless asm).  Loop unrolling could change the overall miss rate by running a predictable loop branch less often.","htmlBody":"Note that benchmarking / profiling un-optimized (\u0026quot;debug mode\u0026quot;) code is normally a bad idea.  With optimization, that version without branch misses would be faster by a much larger margin, not stalling on store/reload latency for local variables.  The actual branch mispredict rate for the critical branch should be about the same, though (assuming there is one: modern compilers can \u003Ca href=\u0022https://stackoverflow.com/q/66521344\u0022\u003Evectorize this\u003C/a\u003E or otherwise make branchless asm).  Loop unrolling could change the overall miss rate by running a predictable loop branch less often.","score":10,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":true,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true}],"postId":12853037,"currentUserIsMod":false,"currentUserIsAnonymous":true,"commentFlagsRemainingToday":10,"maxNestingLevel":3,"hasOptedOut":false,"showCtaUnderComments":true,"containerElementId":"follow-ups-container-12853037","fKey":"d09ecbbe5140a7c1439a7e4020cdd7d76b52d28795a889bb24233842877804f3","questionId":11227809,"questionAuthorId":87234,"answerId":12853037,"answerPositionOnPage":0,"newUiSettings":{"largerFontSize":false},"showFirstTimeCommentingModal":false,"isMentionEnabled":false,"showSpamFlag":true,"mergeUnfriendlyAndRudeFlags":true,"allowRetractingCommentFlags":true,"commentMinLength":15}</script>
    </div>

        </div>
</div>
                                        
<a name="16184827"></a>
<div id="answer-16184827" class="answer js-answer " data-answerid="16184827"
     data-parentid="11227809" data-score="1630" data-position-on-page="6"
     data-highest-scored="0"
     data-question-has-accepted-highest-score="1"
     data-author-username="atlaste"
     data-author-reputation="31256"
     data-should-show-copy-button=True
     data-se-share-sheet-license-name="CC BY-SA 4.0"
     data-is-edited="True"
      itemprop="suggestedAnswer"
     itemscope itemtype="https://schema.org/Answer">
        <div class="post-layout ">
                <div class="votecell post-layout--left">
                    
<div class="js-voting-container d-flex jc-center fd-column ai-center gs4 fc-black-300" data-post-id="16184827" data-referrer="None">
        <button class="js-vote-up-btn flex--item s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
                id="upvote-btn-16184827"
                data-controller="s-tooltip"
                data-s-tooltip-placement="right"
                title="This answer is useful"
                aria-pressed="false"
                aria-label="Up vote"
                data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
                data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">
            <svg aria-hidden="true" class="svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg>
        </button>
        <input type="hidden" id="voteUpHash" value="70:3:31e,16:f1ab045ba58a77a4,10:1771427630,16:a5706290df91058c,8:16184827,190218d50304c1e719b4a2d9dbe062cfcf72e682cca3fa8d11fdaa18abe7557d" />
        <div class="js-vote-count flex--item d-flex fd-column ai-center fc-theme-body-font fw-bold fs-subheading py4"
             itemprop="upvoteCount"
             data-value="1630">
1630        </div>
        <button
            class="js-vote-down-btn flex--item mb8 s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
            id=downvote-btn-16184827
            title="This answer is not useful"
            aria-pressed="false"
            aria-label="Down vote"
            data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
            data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">

            <svg aria-hidden="true" class="svg-icon iconArrowDown" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 6h16l-8 8z"/></svg>
        </button>
        <input type="hidden" id="voteDownHash" value="70:3:31e,16:2b1e5f724f05ba0a,10:1771427630,16:afc3d002242c3d91,8:16184827,5df6fb61d9871ff82de9454afe01335009cfab5830f037999b7d0faaf1af3df7" />


        
<button class="js-saves-btn s-btn s-btn__unset c-pointer py4"
        type="button"
        id="saves-btn-16184827"
        data-controller="s-tooltip"
        data-s-tooltip-placement="right"
        data-s-popover-placement=""
        title="Save this answer."
        data-is-saved="false"
        aria-label="Save"
        data-post-id="16184827"
        data-post-type-id="2"
        data-user-privilege-for-post-click="0"
        aria-controls=""
        data-s-popover-auto-show="false"
>
    <svg aria-hidden="true" class="fc-theme-primary-400 js-saves-btn-selected d-none svg-icon iconBookmark" width="18" height="18"  viewBox="0 0 18 18"><path  d="M3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
    <svg aria-hidden="true" class="js-saves-btn-unselected svg-icon iconBookmarkAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m9 10.6 4 2.66V3H5v10.26zM3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
</button>







            <div class="js-accepted-answer-indicator flex--item fc-green-400 py6 mtn8 d-none" data-s-tooltip-placement="right" title="Loading when this answer was accepted&#x2026;" tabindex="0" role="note" aria-label="Accepted">
                <div class="ta-center">
                    <svg aria-hidden="true" class="svg-icon iconCheckmarkLg" width="36" height="36"  viewBox="0 0 36 36"><path  d="m6 14 8 8L30 6v8L14 30l-8-8z"/></svg>
                </div>
            </div>

    
    <a class="js-post-issue flex--item s-btn s-btn__unset c-pointer py6 mx-auto" href="/posts/16184827/timeline" data-shortcut="T" data-ks-title="timeline" data-controller="s-tooltip" data-s-tooltip-placement="right" title="Show activity on this post." aria-label="Timeline"><svg aria-hidden="true" class="mln2 mr0 svg-icon iconHistory" width="19" height="18"  viewBox="0 0 19 18"><path  d="M3 9a8 8 0 1 1 3.73 6.77L8.2 14.3A6 6 0 1 0 5 9l3.01-.01-4 4-4-4zm7-4h1.01L11 9.36l3.22 2.1-.6.93L10 10z"/></svg></a>

</div>

                </div>

            

<div class="answercell post-layout--right">
    


    <div class="s-prose js-post-body" itemprop="text">
<p>I just read up on this question and its answers, and I feel an answer is missing.</p>

<p>A common way to eliminate branch prediction that I've found to work particularly good in managed languages is a table lookup instead of using a branch (although I haven't tested it in this case).</p>

<p>This approach works in general if:</p>

<ol>
<li>it's a small table and is likely to be cached in the processor, and</li>
<li>you are running things in a quite tight loop and/or the processor can preload the data.</li>
</ol>

<p><strong>Background and why</strong></p>

<p>From a processor perspective, your memory is slow. To compensate for the difference in speed, a couple of caches are built into your processor (L1/L2 cache). So imagine that you're doing your nice calculations and figure out that you need a piece of memory. The processor will get its 'load' operation and loads the piece of memory into cache -- and then uses the cache to do the rest of the calculations. Because memory is relatively slow, this 'load' will slow down your program.</p>

<p>Like branch prediction, this was optimized in the Pentium processors: the processor predicts that it needs to load a piece of data and attempts to load that into the cache before the operation actually hits the cache. As we've already seen, branch prediction sometimes goes horribly wrong -- in the worst case scenario you need to go back and actually wait for a memory load, which will take forever (<strong>in other words: failing branch prediction is bad, a memory load after a branch prediction fail is just horrible!</strong>).</p>

<p>Fortunately for us, if the memory access pattern is predictable, the processor will load it in its fast cache and all is well.</p>

<p>The first thing we need to know is what is <em>small</em>? While smaller is generally better, a rule of thumb is to stick to lookup tables that are &lt;= 4096 bytes in size. As an upper limit: if your lookup table is larger than 64K it's probably worth reconsidering.</p>

<p><strong>Constructing a table</strong></p>

<p>So we've figured out that we can create a small table. Next thing to do is get a lookup function in place. Lookup functions are usually small functions that use a couple of basic integer operations (and, or, xor, shift, add, remove and perhaps multiply). You want to have your input translated by the lookup function to some kind of 'unique key' in your table, which then simply gives you the answer of all the work you wanted it to do.</p>

<p>In this case: >= 128 means we can keep the value, &lt; 128 means we get rid of it. The easiest way to do that is by using an 'AND': if we keep it, we AND it with 7FFFFFFF; if we want to get rid of it, we AND it with 0. Notice also that 128 is a power of 2 -- so we can go ahead and make a table of 32768/128 integers and fill it with one zero and a lot of 7FFFFFFFF's.</p>

<p><strong>Managed languages</strong></p>

<p>You might wonder why this works well in managed languages. After all, managed languages check the boundaries of the arrays with a branch to ensure you don't mess up...</p>

<p>Well, not exactly... :-)</p>

<p>There has been quite some work on eliminating this branch for managed languages. For example:</p>



<pre class="lang-cs prettyprint-override"><code>for (int i = 0; i &lt; array.Length; ++i)
{
   // Use array[i]
}
</code></pre>

<p>In this case, it's obvious to the compiler that the boundary condition will never be hit. At least the Microsoft JIT compiler (but I expect Java does similar things) will notice this and remove the check altogether. WOW, that means no branch. Similarly, it will deal with other obvious cases.</p>

<p>If you run into trouble with lookups in managed languages -- the key is to add a <code>&amp; 0x[something]FFF</code> to your lookup function to make the boundary check predictable -- and watch it going faster.</p>

<p><strong>The result of this case</strong></p>

<pre class="lang-cs prettyprint-override"><code>// Generate data
int arraySize = 32768;
int[] data = new int[arraySize];

Random random = new Random(0);
for (int c = 0; c &lt; arraySize; ++c)
{
    data[c] = random.Next(256);
}

/*To keep the spirit of the code intact, I'll make a separate lookup table
(I assume we cannot modify 'data' or the number of loops)*/

int[] lookup = new int[256];

for (int c = 0; c &lt; 256; ++c)
{
    lookup[c] = (c &gt;= 128) ? c : 0;
}

// Test
DateTime startTime = System.DateTime.Now;
long sum = 0;

for (int i = 0; i &lt; 100000; ++i)
{
    // Primary loop
    for (int j = 0; j &lt; arraySize; ++j)
    {
        /* Here you basically want to use simple operations - so no
        random branches, but things like &amp;, |, *, -, +, etc. are fine. */
        sum += lookup[data[j]];
    }
}

DateTime endTime = System.DateTime.Now;
Console.WriteLine(endTime - startTime);
Console.WriteLine("sum = " + sum);
Console.ReadLine();
</code></pre>
    </div>
    <div class="mt24">
        <div class="d-flex fw-wrap ai-start jc-end gs8 gsy">

            <time itemprop="dateCreated" datetime="2013-04-24 06:26:28Z"></time>
            <div class="flex--item mr16" style="flex: 1 1 100px;">
                


<div class="js-post-menu pt2" data-post-id="16184827" data-post-type-id="2">

    <div class="d-flex gs8 s-anchors s-anchors__muted fw-wrap">

        <div class="flex--item">
            <a href="/a/16184827"
               rel="nofollow"
               itemprop="url"
               class="js-share-link js-gps-track"
               title="Short permalink to this answer"
               data-gps-track="post.click({ item: 2, priv: 0, post_type: 2 })"
               data-controller="se-share-sheet"
               data-se-share-sheet-title="Share a link to this answer"
               data-se-share-sheet-subtitle=""
               data-se-share-sheet-post-type="answer"
               data-se-share-sheet-social="facebook twitter devto"
               data-se-share-sheet-location="2"
               data-se-share-sheet-license-url="https%3a%2f%2fcreativecommons.org%2flicenses%2fby-sa%2f4.0%2f"
               data-se-share-sheet-license-name="CC BY-SA 4.0"
               data-s-popover-placement="bottom-start">Share</a>
        </div>


                    <div class="flex--item">
                        <a href="/posts/16184827/edit" class="js-suggest-edit-post js-gps-track" data-gps-track="post.click({ item: 6, priv: 0, post_type: 2 })" title="">Improve this answer</a>
                    </div>

                <div class="flex--item">
                    <button type="button"
                            id="btnFollowPost-16184827" class="s-btn s-btn__link js-follow-post js-follow-answer js-gps-track"
                            data-gps-track="post.click({ item: 14, priv: 0, post_type: 2 })"
                            data-controller="s-tooltip " data-s-tooltip-placement="bottom"
                            data-s-popover-placement="bottom" aria-controls=""
                            title="Follow this answer to receive notifications">
                        Follow
                        <input type="hidden" id="voteFollowHash" value="70:3:31e,16:a3963d942a05106b,10:1771427630,16:d9960feb19a709cc,8:16184827,2b87697d57ddf792465016de92e2bb5428d2cf6d9720ef2937834ed3f6a5b0e1" />
                    </button>
                </div>






    </div>
    <div class="js-menu-popup-container"></div>
</div>
            </div>
            <div class="post-signature flex--item fl0">
<div class="user-info user-hover ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            <a href="/posts/16184827/revisions" title="show all edits to this post"
                         class="js-gps-track"
                         data-gps-track="post.click({ item: 4, priv: 0, post_type: 2 })">edited <span title='2019-01-16 04:47:21Z' class='relativetime'>Jan 16, 2019 at 4:47</span></a>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/2157640/palec"><div class="gravatar-wrapper-32"><img src="https://i.sstatic.net/aoymS.png?s=64" alt="Palec&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/2157640/palec" dir="auto">Palec</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 13,795" dir="ltr">13.8k</span><span title="8 gold badges" aria-hidden="true"><span class="badge1"></span><span class="badgecount">8</span></span><span class="v-visible-sr">8 gold badges</span><span title="80 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">80</span></span><span class="v-visible-sr">80 silver badges</span><span title="147 bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">147</span></span><span class="v-visible-sr">147 bronze badges</span>
        </div>
    </div>
</div>
            </div>


                <div class="post-signature flex--item fl0">
                    <div class="user-info user-hover ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            answered <span title='2013-04-24 06:26:28Z' class='relativetime'>Apr 24, 2013 at 6:26</span>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/1031591/atlaste"><div class="gravatar-wrapper-32"><img src="https://i.sstatic.net/s3MiH.jpg?s=64" alt="atlaste&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <a href="/users/1031591/atlaste" itemprop="url" dir="auto">atlaste</a><meta itemprop="name" content="atlaste"/>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 31,256" dir="ltr">31.3k</span><span title="3 gold badges" aria-hidden="true"><span class="badge1"></span><span class="badgecount">3</span></span><span class="v-visible-sr">3 gold badges</span><span title="62 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">62</span></span><span class="v-visible-sr">62 silver badges</span><span title="94 bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">94</span></span><span class="v-visible-sr">94 bronze badges</span>
        </div>
    </div>
</div>


                </div>
        </div>
        
    
    </div>
    
</div>




                

    <div class="post-layout--right">
        

<div id="follow-ups-container-16184827">
    <!--[--><div class="mt16"><div class="mb8 d-flex ai-center g8" role="button" tabindex="0"><h2 class="mb0">Comments</h2> <!--[!--><!--]--></div> <div class="mb12"><!--[!--><button type="button" class="s-btn s-btn__muted s-btn__outlined w100 d-flex ai-center p8 comments-link" data-so-test="parent-answer-16184827"><!--[!--><!--]--> <div class="flex--item ml8"><p class="mb0">Add a comment</p></div></button><!--]--></div> <!--[--><div role="list"><!--[--><!--]--></div> <!--[!--><!--]--><!----><!--]--> <!--[!--><!--]--></div><!--]-->
</div>

<script type="application/json" data-role="module-args" data-module-name="islands/follow-ups/index.mod">{"replies":[],"postId":16184827,"currentUserIsMod":false,"currentUserIsAnonymous":true,"commentFlagsRemainingToday":10,"maxNestingLevel":3,"hasOptedOut":false,"showCtaUnderComments":false,"containerElementId":"follow-ups-container-16184827","fKey":"d09ecbbe5140a7c1439a7e4020cdd7d76b52d28795a889bb24233842877804f3","questionId":11227809,"questionAuthorId":87234,"answerId":16184827,"answerPositionOnPage":0,"newUiSettings":{"largerFontSize":false},"showFirstTimeCommentingModal":false,"isMentionEnabled":false,"showSpamFlag":true,"mergeUnfriendlyAndRudeFlags":true,"allowRetractingCommentFlags":true,"commentMinLength":15}</script>
    </div>

        </div>
</div>
                                        
<a name="14889969"></a>
<div id="answer-14889969" class="answer js-answer " data-answerid="14889969"
     data-parentid="11227809" data-score="1451" data-position-on-page="7"
     data-highest-scored="0"
     data-question-has-accepted-highest-score="1"
     data-author-username="Saqlain"
     data-author-reputation="17988"
     data-should-show-copy-button=True
     data-se-share-sheet-license-name="CC BY-SA 4.0"
     data-is-edited="True"
      itemprop="suggestedAnswer"
     itemscope itemtype="https://schema.org/Answer">
        <div class="post-layout ">
                <div class="votecell post-layout--left">
                    
<div class="js-voting-container d-flex jc-center fd-column ai-center gs4 fc-black-300" data-post-id="14889969" data-referrer="None">
        <button class="js-vote-up-btn flex--item s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
                id="upvote-btn-14889969"
                data-controller="s-tooltip"
                data-s-tooltip-placement="right"
                title="This answer is useful"
                aria-pressed="false"
                aria-label="Up vote"
                data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
                data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">
            <svg aria-hidden="true" class="svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg>
        </button>
        <input type="hidden" id="voteUpHash" value="70:3:31e,16:c451e88489df235f,10:1771427630,16:f6b4b3d24debc437,8:14889969,a2d047073efa2bec4a7b6ae24626fe1af1b7bf9350a10ca5ebef6a5384e875e5" />
        <div class="js-vote-count flex--item d-flex fd-column ai-center fc-theme-body-font fw-bold fs-subheading py4"
             itemprop="upvoteCount"
             data-value="1451">
1451        </div>
        <button
            class="js-vote-down-btn flex--item mb8 s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
            id=downvote-btn-14889969
            title="This answer is not useful"
            aria-pressed="false"
            aria-label="Down vote"
            data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
            data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">

            <svg aria-hidden="true" class="svg-icon iconArrowDown" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 6h16l-8 8z"/></svg>
        </button>
        <input type="hidden" id="voteDownHash" value="70:3:31e,16:b4410774f94df24a,10:1771427630,16:2b44856c30e32b97,8:14889969,3ff7f76389271291382f249f6480549e19a0c0a5e297b147efe3a764a6ebb59c" />


        
<button class="js-saves-btn s-btn s-btn__unset c-pointer py4"
        type="button"
        id="saves-btn-14889969"
        data-controller="s-tooltip"
        data-s-tooltip-placement="right"
        data-s-popover-placement=""
        title="Save this answer."
        data-is-saved="false"
        aria-label="Save"
        data-post-id="14889969"
        data-post-type-id="2"
        data-user-privilege-for-post-click="0"
        aria-controls=""
        data-s-popover-auto-show="false"
>
    <svg aria-hidden="true" class="fc-theme-primary-400 js-saves-btn-selected d-none svg-icon iconBookmark" width="18" height="18"  viewBox="0 0 18 18"><path  d="M3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
    <svg aria-hidden="true" class="js-saves-btn-unselected svg-icon iconBookmarkAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m9 10.6 4 2.66V3H5v10.26zM3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
</button>







            <div class="js-accepted-answer-indicator flex--item fc-green-400 py6 mtn8 d-none" data-s-tooltip-placement="right" title="Loading when this answer was accepted&#x2026;" tabindex="0" role="note" aria-label="Accepted">
                <div class="ta-center">
                    <svg aria-hidden="true" class="svg-icon iconCheckmarkLg" width="36" height="36"  viewBox="0 0 36 36"><path  d="m6 14 8 8L30 6v8L14 30l-8-8z"/></svg>
                </div>
            </div>

    
    <a class="js-post-issue flex--item s-btn s-btn__unset c-pointer py6 mx-auto" href="/posts/14889969/timeline" data-shortcut="T" data-ks-title="timeline" data-controller="s-tooltip" data-s-tooltip-placement="right" title="Show activity on this post." aria-label="Timeline"><svg aria-hidden="true" class="mln2 mr0 svg-icon iconHistory" width="19" height="18"  viewBox="0 0 19 18"><path  d="M3 9a8 8 0 1 1 3.73 6.77L8.2 14.3A6 6 0 1 0 5 9l3.01-.01-4 4-4-4zm7-4h1.01L11 9.36l3.22 2.1-.6.93L10 10z"/></svg></a>

</div>

                </div>

            

<div class="answercell post-layout--right">
    


    <div class="s-prose js-post-body" itemprop="text">
<p>As data is distributed between 0 and 255 when the array is sorted, around the first half of the iterations will not enter the <code>if</code>-statement (the <code>if</code> statement is shared below).</p>

<pre><code>if (data[c] &gt;= 128)
    sum += data[c];
</code></pre>

<p>The question is: What makes the above statement not execute in certain cases as in case of sorted data? Here comes the "branch predictor". A branch predictor is a digital circuit that tries to guess which way a branch (e.g. an <code>if-then-else</code> structure) will go before this is known for sure. The purpose of the branch predictor is to improve the flow in the instruction pipeline. Branch predictors play a critical role in achieving high effective performance!</p>

<p><strong>Let's do some bench marking to understand it better</strong></p>

<p>The performance of an <code>if</code>-statement depends on whether its condition has a predictable pattern. If the condition is always true or always false, the branch prediction logic in the processor will pick up the pattern. On the other hand, if the pattern is unpredictable, the <code>if</code>-statement will be much more expensive.</p>

<p>Lets measure the performance of this loop with different conditions:</p>

<pre><code>for (int i = 0; i &lt; max; i++)
    if (condition)
        sum++;
</code></pre>

<p>Here are the timings of the loop with different true-false patterns:</p>

<pre><code>Condition                Pattern             Time (ms)
-------------------------------------------------------
(i &amp; 080000000) == 0    T repeated          322

(i &amp; 0xffffffff) == 0    F repeated          276

(i &amp; 1) == 0             TF alternating      760

(i &amp; 3) == 0             TFFFTFFF           513

(i &amp; 2) == 0             TTFFTTFF           1675

(i &amp; 4) == 0             TTTTFFFFTTTTFFFF   1275

(i &amp; 8) == 0             8T 8F 8T 8F        752

(i &amp; 16) == 0            16T 16F 16T 16F    490
</code></pre>

<p>A <strong>bad</strong> true-false pattern can make an <code>if</code>-statement up to six times slower than a <strong>good</strong> pattern! Of course, which pattern is good and which is bad depends on the exact instructions generated by the compiler and on the specific processor.</p>

<p>So there is no doubt about the impact of branch prediction on performance!</p>
    </div>
    <div class="mt24">
        <div class="d-flex fw-wrap ai-start jc-end gs8 gsy">

            <time itemprop="dateCreated" datetime="2013-02-15 07:24:16Z"></time>
            <div class="flex--item mr16" style="flex: 1 1 100px;">
                


<div class="js-post-menu pt2" data-post-id="14889969" data-post-type-id="2">

    <div class="d-flex gs8 s-anchors s-anchors__muted fw-wrap">

        <div class="flex--item">
            <a href="/a/14889969"
               rel="nofollow"
               itemprop="url"
               class="js-share-link js-gps-track"
               title="Short permalink to this answer"
               data-gps-track="post.click({ item: 2, priv: 0, post_type: 2 })"
               data-controller="se-share-sheet"
               data-se-share-sheet-title="Share a link to this answer"
               data-se-share-sheet-subtitle=""
               data-se-share-sheet-post-type="answer"
               data-se-share-sheet-social="facebook twitter devto"
               data-se-share-sheet-location="2"
               data-se-share-sheet-license-url="https%3a%2f%2fcreativecommons.org%2flicenses%2fby-sa%2f4.0%2f"
               data-se-share-sheet-license-name="CC BY-SA 4.0"
               data-s-popover-placement="bottom-start">Share</a>
        </div>


                    <div class="flex--item">
                        <a href="/posts/14889969/edit" class="js-suggest-edit-post js-gps-track" data-gps-track="post.click({ item: 6, priv: 0, post_type: 2 })" title="">Improve this answer</a>
                    </div>

                <div class="flex--item">
                    <button type="button"
                            id="btnFollowPost-14889969" class="s-btn s-btn__link js-follow-post js-follow-answer js-gps-track"
                            data-gps-track="post.click({ item: 14, priv: 0, post_type: 2 })"
                            data-controller="s-tooltip " data-s-tooltip-placement="bottom"
                            data-s-popover-placement="bottom" aria-controls=""
                            title="Follow this answer to receive notifications">
                        Follow
                        <input type="hidden" id="voteFollowHash" value="70:3:31e,16:349c60b5c378cd15,10:1771427630,16:4794a439e5e691b3,8:14889969,1d8a5fc21ec162d595545d09d5fc5c0a5f91217866a5690d73b70275dc3bf3a3" />
                    </button>
                </div>






    </div>
    <div class="js-menu-popup-container"></div>
</div>
            </div>
            <div class="post-signature flex--item fl0">
<div class="user-info user-hover ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            <a href="/posts/14889969/revisions" title="show all edits to this post"
                         class="js-gps-track"
                         data-gps-track="post.click({ item: 4, priv: 0, post_type: 2 })">edited <span title='2019-02-27 10:58:32Z' class='relativetime'>Feb 27, 2019 at 10:58</span></a>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/4298200/georg-plaz"><div class="gravatar-wrapper-32"><img src="https://lh5.googleusercontent.com/-HcKtiretO2g/AAAAAAAAAAI/AAAAAAAAAH0/IXGAL7MX8sQ/s64-rj/photo.jpg" alt="Georg Plaz&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/4298200/georg-plaz" dir="auto">Georg Plaz</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">6,124</span><span title="5 gold badges" aria-hidden="true"><span class="badge1"></span><span class="badgecount">5</span></span><span class="v-visible-sr">5 gold badges</span><span title="45 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">45</span></span><span class="v-visible-sr">45 silver badges</span><span title="66 bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">66</span></span><span class="v-visible-sr">66 bronze badges</span>
        </div>
    </div>
</div>
            </div>


                <div class="post-signature flex--item fl0">
                    <div class="user-info user-hover ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            answered <span title='2013-02-15 07:24:16Z' class='relativetime'>Feb 15, 2013 at 7:24</span>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/1012551/saqlain"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/22df608584e3ef466f34afef94f134df?s=64&amp;d=identicon&amp;r=PG" alt="Saqlain&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <a href="/users/1012551/saqlain" itemprop="url" dir="auto">Saqlain</a><meta itemprop="name" content="Saqlain"/>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 17,988" dir="ltr">18k</span><span title="4 gold badges" aria-hidden="true"><span class="badge1"></span><span class="badgecount">4</span></span><span class="v-visible-sr">4 gold badges</span><span title="31 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">31</span></span><span class="v-visible-sr">31 silver badges</span><span title="33 bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">33</span></span><span class="v-visible-sr">33 bronze badges</span>
        </div>
    </div>
</div>


                </div>
        </div>
        
    
    </div>
    
</div>




                

    <div class="post-layout--right">
        

<div id="follow-ups-container-14889969">
    <!--[--><div class="mt16"><div class="mb8 d-flex ai-center g8 c-pointer" role="button" tabindex="0"><h2 class="mb0">11 Comments</h2> <!--[--><!--[--><!----><svg aria-hidden="true" class="svg-icon iconArrowDownAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m16.01 7.43-1.4-1.41L9 11.6 3.42 6l-1.4 1.42 7 7z"/></svg><!----><!--]--><!--]--></div> <div class="mb12"><!--[!--><button type="button" class="s-btn s-btn__muted s-btn__outlined w100 d-flex ai-center p8" data-so-test="parent-answer-14889969"><!--[!--><!--]--> <div class="flex--item ml8"><p class="mb0">Add a comment</p></div></button><!--]--></div> <!--[--><div role="list"><!--[--><div id="follow-up-60153643" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/4037019/cst1992" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://i.sstatic.net/nveNe.jpg?s=64" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">cst1992</div> <div class="s-user-card--awards"><!--[--><a href="/users/4037019/cst1992" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">cst1992</a><!--]--> <a class="comment-link" href="#comment60153643_14889969"><time title="2016-03-28T12:58:51.93Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->@MooingDuck &#39;Cause it won&#39;t make a difference - that value can be anything, but it still will be in the bounds of these thresholds. So why show a random value when you already know the limits? Although I agree that you could show one for the sake of completeness, and &#39;just for the heck of it&#39;.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2016-03-28T12:58:51.93Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-60153643"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">56</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-60153643"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-60153643" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-60153643"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-60153643" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-60164274" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/845092/mooing-duck" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=48&amp;d=identicon&amp;r=PG" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Mooing Duck</div> <div class="s-user-card--awards"><!--[--><a href="/users/845092/mooing-duck" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Mooing Duck</a><!--]--> <a class="comment-link" href="#comment60164274_14889969"><time title="2016-03-28T18:27:16.857Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[--><span class="o50" title="Edited 2 times"><!----><svg aria-hidden="true" class="svg-icon iconPencilSm" width="14" height="14"  viewBox="0 0 14 14"><path fill="#F1B600" d="m2 10.12 6.37-6.43 1.88 1.88L3.88 12H2z"/><path fill="#E87C87" d="m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0"/></svg><!----><!----></span><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->@cst1992: Right now his slowest timing is TTFFTTFFTTFF, which seems, to my human eye, quite predictable. Random is inherently unpredictable, so it&#39;s entirely possible it would be slower still, and thus outside the limits shown here.  OTOH, it could be that TTFFTTFF perfectly hits the pathological case.  Can&#39;t tell, since he didn&#39;t show the timings for random.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2016-03-28T18:27:16.857Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-60164274"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">58</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-60164274"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-60164274" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-60164274"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-60164274" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-64383305" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/166949/steveha" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://i.sstatic.net/tIFie.png?s=64" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">steveha</div> <div class="s-user-card--awards"><!--[--><a href="/users/166949/steveha" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">steveha</a><!--]--> <a class="comment-link" href="#comment64383305_14889969"><time title="2016-07-20T21:07:37.617Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->@MooingDuck To a human eye, &quot;TTFFTTFFTTFF&quot; is a predictable sequence, but what we are talking about here is the behavior of the branch predictor built into a CPU.  The branch predictor is not AI-level pattern recognition; it&#39;s very simple.  When you just alternate branches it doesn&#39;t predict well.  In most code, branches go the same way almost all the time; consider a loop that executes a thousand times.  The branch at the end of the loop goes back to the start of the loop 999 times, and then the thousandth time does something different.  A very simple branch predictor works well, usually.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2016-07-20T21:07:37.617Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-64383305"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">51</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-64383305"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-64383305" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-64383305"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-64383305" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-64383386" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/845092/mooing-duck" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=48&amp;d=identicon&amp;r=PG" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Mooing Duck</div> <div class="s-user-card--awards"><!--[--><a href="/users/845092/mooing-duck" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Mooing Duck</a><!--]--> <a class="comment-link" href="#comment64383386_14889969"><time title="2016-07-20T21:10:18.967Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->@steveha: I think you&#39;re making assumptions about how the CPU branch predictor works, and I disagree with that methodology. I don&#39;t know how advanced that branch predictor is, but I seem to think it&#39;s far more advanced than you do. You&#39;re probably right, but measurements would definitely be good.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2016-07-20T21:10:18.967Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-64383386"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">48</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-64383386"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-64383386" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-64383386"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-64383386" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-64551074" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/845092/mooing-duck" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=48&amp;d=identicon&amp;r=PG" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Mooing Duck</div> <div class="s-user-card--awards"><!--[--><a href="/users/845092/mooing-duck" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Mooing Duck</a><!--]--> <a class="comment-link" href="#comment64551074_14889969"><time title="2016-07-26T04:33:55.5Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->@steveha: The Two-level adaptive predictor could lock onto the TTFFTTFF pattern with no issue whatsoever. &quot;Variants of this prediction method are used in most modern microprocessors&quot;. Local branch prediction and Global branch prediction are based on a two level adaptive predictor, they can as well. &quot;Global branch prediction is used in AMD processors, and in Intel Pentium M, Core, Core 2, and Silvermont-based Atom processors&quot;  Also add Agree predictor, Hybrid predictor, Prediction of indirect jumps, to that list. Loop predictor wont lock on, but hits 75%. That leaves only 2 that can&#39;t lock on<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2016-07-26T04:33:55.5Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-64551074"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">32</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-64551074"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-64551074" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-64551074"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-64551074" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><!--]--></div> <!--[--><div class="d-flex g8 my8"><!--[--><button class="s-link s-btn__muted s-btn__outlined comments-link" data-so-test="parent-answer-14889969">Add a comment</button> <!--[--><span>|</span><!--]--><!--]--> <!--[--><button class="s-link s-btn__muted s-btn__outlined comments-link">Show 6 more comments</button><!--]--></div><!--]--><!----><!--]--> <!--[!--><!--]--></div><!--]-->
</div>

<script type="application/json" data-role="module-args" data-module-name="islands/follow-ups/index.mod">{"replies":[{"id":60153643,"user":{"userId":4037019,"isDeleted":false,"displayName":"cst1992","url":"/users/4037019/cst1992","profileImageUrl":"https://i.sstatic.net/nveNe.jpg?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"cst1992","noSpacesUserName":"cst1992","reputationDisplayText":"0"},"postedAt":"2016-03-28T12:58:51.93Z","postedAtRelative":"Over a year ago","body":"@MooingDuck \u0027Cause it won\u0027t make a difference - that value can be anything, but it still will be in the bounds of these thresholds. So why show a random value when you already know the limits? Although I agree that you could show one for the sake of completeness, and \u0027just for the heck of it\u0027.","htmlBody":"@MooingDuck \u0026#39;Cause it won\u0026#39;t make a difference - that value can be anything, but it still will be in the bounds of these thresholds. So why show a random value when you already know the limits? Although I agree that you could show one for the sake of completeness, and \u0026#39;just for the heck of it\u0026#39;.","score":56,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":60164274,"user":{"userId":845092,"isDeleted":false,"displayName":"Mooing Duck","url":"/users/845092/mooing-duck","profileImageUrl":"https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=48\u0026d=identicon\u0026r=PG","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"MooingDuck","noSpacesUserName":"MooingDuck","reputationDisplayText":"0"},"postedAt":"2016-03-28T18:27:16.857Z","postedAtRelative":"Over a year ago","body":"@cst1992: Right now his slowest timing is TTFFTTFFTTFF, which seems, to my human eye, quite predictable. Random is inherently unpredictable, so it\u0027s entirely possible it would be slower still, and thus outside the limits shown here.  OTOH, it could be that TTFFTTFF perfectly hits the pathological case.  Can\u0027t tell, since he didn\u0027t show the timings for random.","htmlBody":"@cst1992: Right now his slowest timing is TTFFTTFFTTFF, which seems, to my human eye, quite predictable. Random is inherently unpredictable, so it\u0026#39;s entirely possible it would be slower still, and thus outside the limits shown here.  OTOH, it could be that TTFFTTFF perfectly hits the pathological case.  Can\u0026#39;t tell, since he didn\u0026#39;t show the timings for random.","score":58,"editCount":2,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":64383305,"user":{"userId":166949,"isDeleted":false,"displayName":"steveha","url":"/users/166949/steveha","profileImageUrl":"https://i.sstatic.net/tIFie.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"steveha","noSpacesUserName":"steveha","reputationDisplayText":"0"},"postedAt":"2016-07-20T21:07:37.617Z","postedAtRelative":"Over a year ago","body":"@MooingDuck To a human eye, \u0022TTFFTTFFTTFF\u0022 is a predictable sequence, but what we are talking about here is the behavior of the branch predictor built into a CPU.  The branch predictor is not AI-level pattern recognition; it\u0027s very simple.  When you just alternate branches it doesn\u0027t predict well.  In most code, branches go the same way almost all the time; consider a loop that executes a thousand times.  The branch at the end of the loop goes back to the start of the loop 999 times, and then the thousandth time does something different.  A very simple branch predictor works well, usually.","htmlBody":"@MooingDuck To a human eye, \u0026quot;TTFFTTFFTTFF\u0026quot; is a predictable sequence, but what we are talking about here is the behavior of the branch predictor built into a CPU.  The branch predictor is not AI-level pattern recognition; it\u0026#39;s very simple.  When you just alternate branches it doesn\u0026#39;t predict well.  In most code, branches go the same way almost all the time; consider a loop that executes a thousand times.  The branch at the end of the loop goes back to the start of the loop 999 times, and then the thousandth time does something different.  A very simple branch predictor works well, usually.","score":51,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":64383386,"user":{"userId":845092,"isDeleted":false,"displayName":"Mooing Duck","url":"/users/845092/mooing-duck","profileImageUrl":"https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=48\u0026d=identicon\u0026r=PG","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"MooingDuck","noSpacesUserName":"MooingDuck","reputationDisplayText":"0"},"postedAt":"2016-07-20T21:10:18.967Z","postedAtRelative":"Over a year ago","body":"@steveha: I think you\u0027re making assumptions about how the CPU branch predictor works, and I disagree with that methodology. I don\u0027t know how advanced that branch predictor is, but I seem to think it\u0027s far more advanced than you do. You\u0027re probably right, but measurements would definitely be good.","htmlBody":"@steveha: I think you\u0026#39;re making assumptions about how the CPU branch predictor works, and I disagree with that methodology. I don\u0026#39;t know how advanced that branch predictor is, but I seem to think it\u0026#39;s far more advanced than you do. You\u0026#39;re probably right, but measurements would definitely be good.","score":48,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":64550377,"user":{"userId":166949,"isDeleted":false,"displayName":"steveha","url":"/users/166949/steveha","profileImageUrl":"https://i.sstatic.net/tIFie.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"steveha","noSpacesUserName":"steveha","reputationDisplayText":"0"},"postedAt":"2016-07-26T03:49:15.973Z","postedAtRelative":"Over a year ago","body":"@MooingDuck It is true that I am not an expert in processor design.  But I invite you to read the Wikipedia page about branch predictors.  Not one of the discussed designs could lock on to the pattern TTFFTTFF... and predict correctly.  (Except maybe for the neural net one, with a sufficiently advanced neural net, and I\u0027ll bet you cash money that you don\u0027t own a computing device that has such a branch predictor in its processor.)  https://en.wikipedia.org/wiki/Branch_predictor","htmlBody":"@MooingDuck It is true that I am not an expert in processor design.  But I invite you to read the Wikipedia page about branch predictors.  Not one of the discussed designs could lock on to the pattern TTFFTTFF... and predict correctly.  (Except maybe for the neural net one, with a sufficiently advanced neural net, and I\u0026#39;ll bet you cash money that you don\u0026#39;t own a computing device that has such a branch predictor in its processor.)  \u003Ca href=\u0022https://en.wikipedia.org/wiki/Branch_predictor\u0022 rel=\u0022nofollow noreferrer\u0022\u003Een.wikipedia.org/wiki/Branch_predictor\u003C/a\u003E","score":8,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false},{"id":64551074,"user":{"userId":845092,"isDeleted":false,"displayName":"Mooing Duck","url":"/users/845092/mooing-duck","profileImageUrl":"https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=48\u0026d=identicon\u0026r=PG","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"MooingDuck","noSpacesUserName":"MooingDuck","reputationDisplayText":"0"},"postedAt":"2016-07-26T04:33:55.5Z","postedAtRelative":"Over a year ago","body":"@steveha: The Two-level adaptive predictor could lock onto the TTFFTTFF pattern with no issue whatsoever. \u0022Variants of this prediction method are used in most modern microprocessors\u0022. Local branch prediction and Global branch prediction are based on a two level adaptive predictor, they can as well. \u0022Global branch prediction is used in AMD processors, and in Intel Pentium M, Core, Core 2, and Silvermont-based Atom processors\u0022  Also add Agree predictor, Hybrid predictor, Prediction of indirect jumps, to that list. Loop predictor wont lock on, but hits 75%. That leaves only 2 that can\u0027t lock on","htmlBody":"@steveha: The Two-level adaptive predictor could lock onto the TTFFTTFF pattern with no issue whatsoever. \u0026quot;Variants of this prediction method are used in most modern microprocessors\u0026quot;. Local branch prediction and Global branch prediction are based on a two level adaptive predictor, they can as well. \u0026quot;Global branch prediction is used in AMD processors, and in Intel Pentium M, Core, Core 2, and Silvermont-based Atom processors\u0026quot;  Also add Agree predictor, Hybrid predictor, Prediction of indirect jumps, to that list. Loop predictor wont lock on, but hits 75%. That leaves only 2 that can\u0026#39;t lock on","score":32,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":69820096,"user":{"userId":4509583,"isDeleted":false,"displayName":"Warren K","url":"/users/4509583/warren-k","profileImageUrl":"https://i.sstatic.net/zda9x.jpg?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"WarrenK","noSpacesUserName":"WarrenK","reputationDisplayText":"0"},"postedAt":"2016-12-23T22:32:07.8Z","postedAtRelative":"Over a year ago","body":"@MooingDuck : The diagram in Surt\u0027s [answer below](http://stackoverflow.com/a/33070112/4509583) I think explains why TTFFTTFF is in fact the \u0022pathological case\u0022 in Saqlain\u0027s example.","htmlBody":"@MooingDuck : The diagram in Surt\u0026#39;s \u003Ca href=\u0022http://stackoverflow.com/a/33070112/4509583\u0022\u003Eanswer below\u003C/a\u003E I think explains why TTFFTTFF is in fact the \u0026quot;pathological case\u0026quot; in Saqlain\u0026#39;s example.","score":9,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false},{"id":127144053,"user":{"userId":224132,"isDeleted":false,"displayName":"Peter Cordes","url":"/users/224132/peter-cordes","profileImageUrl":"https://i.sstatic.net/N4ivW.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"PeterCordes","noSpacesUserName":"PeterCordes","reputationDisplayText":"0"},"postedAt":"2022-04-21T10:47:15.293Z","postedAtRelative":"Over a year ago","body":"What CPU did you benchmark this on? A real modern CPU like Haswell?  Or a simulator with an old 2-bit saturating counter branch predictor like @WarrenK mentioned?  Intel since Haswell has used IT-TAGE predictors that can spread the prediction history for a single branch across basically the whole storage space of the predictor.  (e.g. in a repeat loop, was able to \u0022learn\u0022 all the branching in a 12 to 14 element bubble sort on my Skylake CPU, hand-written in asm with an outer loop to copy the same unsorted data back into place with a couple vmovdqa.)  https://danluu.com/branch-prediction/","htmlBody":"What CPU did you benchmark this on? A real modern CPU like Haswell?  Or a simulator with an old 2-bit saturating counter branch predictor like @WarrenK mentioned?  Intel since Haswell has used IT-TAGE predictors that can spread the prediction history for a single branch across basically the whole storage space of the predictor.  (e.g. in a repeat loop, was able to \u0026quot;learn\u0026quot; all the branching in a 12 to 14 element bubble sort on my Skylake CPU, hand-written in asm with an outer loop to copy the same unsorted data back into place with a couple vmovdqa.)  \u003Ca href=\u0022https://danluu.com/branch-prediction/\u0022 rel=\u0022nofollow noreferrer\u0022\u003Edanluu.com/branch-prediction\u003C/a\u003E","score":1,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false},{"id":127144369,"user":{"userId":224132,"isDeleted":false,"displayName":"Peter Cordes","url":"/users/224132/peter-cordes","profileImageUrl":"https://i.sstatic.net/N4ivW.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"PeterCordes","noSpacesUserName":"PeterCordes","reputationDisplayText":"0"},"postedAt":"2022-04-21T11:02:20.46Z","postedAtRelative":"Over a year ago","body":"With this test code (https://godbolt.org/z/GY1dxh8Ka) compiled with clang\u002B\u002B 13.0 on my i7-6700k Skylake CPU, (with \u0060-Os -mbranches-within-32B-boundaries\u0060 to make branchy asm), the \u0060i\u00262\u0060 TTFF pattern does predict perfectly.  I had to use \u0060-Os\u0060 or \u0060-O1\u0060 instead of \u0060-O2\u0060, to get such dumb asm for such simple source.  GCC -O2 uses \u0060cmp\u0060 / \u0060sbb count, -1\u0060 to add the cmp result.  clang -O2  unrolls by 4 which exposes the pattern, optimizing into \u0060add sum, 2\u0060 / \u0060sub counter, 4\u0060 / \u0060jne top_of_loop\u0060 (with actual registers, that\u0027s pseudo-code).  I\u0027m curious what CPUs before Skylake would do, though.","htmlBody":"With this test code (\u003Ca href=\u0022https://godbolt.org/z/GY1dxh8Ka\u0022 rel=\u0022nofollow noreferrer\u0022\u003Egodbolt.org/z/GY1dxh8Ka\u003C/a\u003E) compiled with clang\u002B\u002B 13.0 on my i7-6700k Skylake CPU, (with \u003Ccode\u003E-Os -mbranches-within-32B-boundaries\u003C/code\u003E to make branchy asm), the \u003Ccode\u003Ei\u0026amp;2\u003C/code\u003E TTFF pattern does predict perfectly.  I had to use \u003Ccode\u003E-Os\u003C/code\u003E or \u003Ccode\u003E-O1\u003C/code\u003E instead of \u003Ccode\u003E-O2\u003C/code\u003E, to get such dumb asm for such simple source.  GCC -O2 uses \u003Ccode\u003Ecmp\u003C/code\u003E / \u003Ccode\u003Esbb count, -1\u003C/code\u003E to add the cmp result.  clang -O2  unrolls by 4 which exposes the pattern, optimizing into \u003Ccode\u003Eadd sum, 2\u003C/code\u003E / \u003Ccode\u003Esub counter, 4\u003C/code\u003E / \u003Ccode\u003Ejne top_of_loop\u003C/code\u003E (with actual registers, that\u0026#39;s pseudo-code).  I\u0026#39;m curious what CPUs before Skylake would do, though.","score":1,"editCount":2,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false},{"id":127144604,"user":{"userId":224132,"isDeleted":false,"displayName":"Peter Cordes","url":"/users/224132/peter-cordes","profileImageUrl":"https://i.sstatic.net/N4ivW.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"PeterCordes","noSpacesUserName":"PeterCordes","reputationDisplayText":"0"},"postedAt":"2022-04-21T11:11:48.917Z","postedAtRelative":"Over a year ago","body":"Tried on an old Core2Duo; \u0060i\u00261\u0060 is twice as fast as \u0060i\u00262\u0060.  (6.34s vs. 3.02s).  vs. both similar on my Skylake at 1.13 vs. 1.28 (yes, \u0060i\u00261\u0060 was slower on SKL, but I think due to some uop-cache effect, since I got higher counts for \u0060idq.mite_uops\u0060).","htmlBody":"Tried on an old Core2Duo; \u003Ccode\u003Ei\u0026amp;1\u003C/code\u003E is twice as fast as \u003Ccode\u003Ei\u0026amp;2\u003C/code\u003E.  (6.34s vs. 3.02s).  vs. both similar on my Skylake at 1.13 vs. 1.28 (yes, \u003Ccode\u003Ei\u0026amp;1\u003C/code\u003E was slower on SKL, but I think due to some uop-cache effect, since I got higher counts for \u003Ccode\u003Eidq.mite_uops\u003C/code\u003E).","score":1,"editCount":1,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false},{"id":138732144,"user":{"userId":25397671,"isDeleted":false,"displayName":"Karol","url":"/users/25397671/karol","profileImageUrl":"https://i.sstatic.net/7oX3Kyhe.jpg?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"Karol","noSpacesUserName":"Karol","reputationDisplayText":"0"},"postedAt":"2024-06-30T01:12:57.737Z","postedAtRelative":"Over a year ago","body":"Sorry, Can you explain more?","htmlBody":"Sorry, Can you explain more?","score":0,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":true,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false}],"postId":14889969,"currentUserIsMod":false,"currentUserIsAnonymous":true,"commentFlagsRemainingToday":10,"maxNestingLevel":3,"hasOptedOut":false,"showCtaUnderComments":true,"containerElementId":"follow-ups-container-14889969","fKey":"d09ecbbe5140a7c1439a7e4020cdd7d76b52d28795a889bb24233842877804f3","questionId":11227809,"questionAuthorId":87234,"answerId":14889969,"answerPositionOnPage":0,"newUiSettings":{"largerFontSize":false},"showFirstTimeCommentingModal":false,"isMentionEnabled":false,"showSpamFlag":true,"mergeUnfriendlyAndRudeFlags":true,"allowRetractingCommentFlags":true,"commentMinLength":15}</script>
    </div>

        </div>
</div>
                                        
<a name="17782979"></a>
<div id="answer-17782979" class="answer js-answer " data-answerid="17782979"
     data-parentid="11227809" data-score="1386" data-position-on-page="8"
     data-highest-scored="0"
     data-question-has-accepted-highest-score="1"
     data-author-username="steveha"
     data-author-reputation="77173"
     data-should-show-copy-button=True
     data-se-share-sheet-license-name="CC BY-SA 4.0"
     data-is-edited="True"
      itemprop="suggestedAnswer"
     itemscope itemtype="https://schema.org/Answer">
        <div class="post-layout ">
                <div class="votecell post-layout--left">
                    
<div class="js-voting-container d-flex jc-center fd-column ai-center gs4 fc-black-300" data-post-id="17782979" data-referrer="None">
        <button class="js-vote-up-btn flex--item s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
                id="upvote-btn-17782979"
                data-controller="s-tooltip"
                data-s-tooltip-placement="right"
                title="This answer is useful"
                aria-pressed="false"
                aria-label="Up vote"
                data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
                data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">
            <svg aria-hidden="true" class="svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg>
        </button>
        <input type="hidden" id="voteUpHash" value="70:3:31e,16:b13fdc47ff60e650,10:1771427630,16:fd44bcbc437ad157,8:17782979,1decc2247e2bcc9e7180973016728d184d778769d325cfd051818365c355d545" />
        <div class="js-vote-count flex--item d-flex fd-column ai-center fc-theme-body-font fw-bold fs-subheading py4"
             itemprop="upvoteCount"
             data-value="1386">
1386        </div>
        <button
            class="js-vote-down-btn flex--item mb8 s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
            id=downvote-btn-17782979
            title="This answer is not useful"
            aria-pressed="false"
            aria-label="Down vote"
            data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
            data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">

            <svg aria-hidden="true" class="svg-icon iconArrowDown" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 6h16l-8 8z"/></svg>
        </button>
        <input type="hidden" id="voteDownHash" value="70:3:31e,16:baf454fab9e8c7c7,10:1771427630,16:d2cf970a33fc8374,8:17782979,dd8130d62b460ed13073f3e6b4cb291273a4cc0f1876721a410fcfb3fa0f663d" />


        
<button class="js-saves-btn s-btn s-btn__unset c-pointer py4"
        type="button"
        id="saves-btn-17782979"
        data-controller="s-tooltip"
        data-s-tooltip-placement="right"
        data-s-popover-placement=""
        title="Save this answer."
        data-is-saved="false"
        aria-label="Save"
        data-post-id="17782979"
        data-post-type-id="2"
        data-user-privilege-for-post-click="0"
        aria-controls=""
        data-s-popover-auto-show="false"
>
    <svg aria-hidden="true" class="fc-theme-primary-400 js-saves-btn-selected d-none svg-icon iconBookmark" width="18" height="18"  viewBox="0 0 18 18"><path  d="M3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
    <svg aria-hidden="true" class="js-saves-btn-unselected svg-icon iconBookmarkAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m9 10.6 4 2.66V3H5v10.26zM3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
</button>







            <div class="js-accepted-answer-indicator flex--item fc-green-400 py6 mtn8 d-none" data-s-tooltip-placement="right" title="Loading when this answer was accepted&#x2026;" tabindex="0" role="note" aria-label="Accepted">
                <div class="ta-center">
                    <svg aria-hidden="true" class="svg-icon iconCheckmarkLg" width="36" height="36"  viewBox="0 0 36 36"><path  d="m6 14 8 8L30 6v8L14 30l-8-8z"/></svg>
                </div>
            </div>

    
    <a class="js-post-issue flex--item s-btn s-btn__unset c-pointer py6 mx-auto" href="/posts/17782979/timeline" data-shortcut="T" data-ks-title="timeline" data-controller="s-tooltip" data-s-tooltip-placement="right" title="Show activity on this post." aria-label="Timeline"><svg aria-hidden="true" class="mln2 mr0 svg-icon iconHistory" width="19" height="18"  viewBox="0 0 19 18"><path  d="M3 9a8 8 0 1 1 3.73 6.77L8.2 14.3A6 6 0 1 0 5 9l3.01-.01-4 4-4-4zm7-4h1.01L11 9.36l3.22 2.1-.6.93L10 10z"/></svg></a>

</div>

                </div>

            

<div class="answercell post-layout--right">
    


    <div class="s-prose js-post-body" itemprop="text">
<p>One way to avoid branch prediction errors is to build a lookup table, and index it using the data.  Stefan de Bruijn discussed that in his answer.</p>
<p>But in this case, we know values are in the range [0, 255] and we only care about values &gt;= 128.  That means we can easily extract a single bit that will tell us whether we want a value or not: by shifting the data to the right 7 bits, we are left with a 0 bit or a 1 bit, and we only want to add the value when we have a 1 bit.  Let's call this bit the &quot;decision bit&quot;.</p>
<p>By using the 0/1 value of the decision bit as an index into an array, we can make code that will be equally fast whether the data is sorted or not sorted.  Our code will always add a value, but when the decision bit is 0, we will add the value somewhere we don't care about.  Here's the code:</p>
<pre><code>// Test
clock_t start = clock();
long long a[] = {0, 0};
long long sum;

for (unsigned i = 0; i &lt; 100000; ++i)
{
    // Primary loop
    for (unsigned c = 0; c &lt; arraySize; ++c)
    {
        int j = (data[c] &gt;&gt; 7);
        a[j] += data[c];
    }
}

double elapsedTime = static_cast&lt;double&gt;(clock() - start) / CLOCKS_PER_SEC;
sum = a[1];
</code></pre>
<p>This code wastes half of the adds but never has a branch prediction failure.  It's tremendously faster on random data than the version with an actual if statement.</p>
<p>But in my testing, an explicit lookup table was slightly faster than this, probably because indexing into a lookup table was slightly faster than bit shifting.  This shows how my code sets up and uses the lookup table (unimaginatively called <code>lut</code> for &quot;LookUp Table&quot; in the code).  Here's the C++ code:</p>
<pre><code>// Declare and then fill in the lookup table
int lut[256];
for (unsigned c = 0; c &lt; 256; ++c)
    lut[c] = (c &gt;= 128) ? c : 0;

// Use the lookup table after it is built
for (unsigned i = 0; i &lt; 100000; ++i)
{
    // Primary loop
    for (unsigned c = 0; c &lt; arraySize; ++c)
    {
        sum += lut[data[c]];
    }
}
</code></pre>
<p>In this case, the lookup table was only 256 bytes, so it fits nicely in a cache and all was fast.  This technique wouldn't work well if the data was 24-bit values and we only wanted half of them... the lookup table would be far too big to be practical.  On the other hand, we can combine the two techniques shown above: first shift the bits over, then index a lookup table.  For a 24-bit value that we only want the top half value, we could potentially shift the data right by 12 bits, and be left with a 12-bit value for a table index.  A 12-bit table index implies a table of 4096 values, which might be practical.</p>
<p>The technique of indexing into an array, instead of using an <code>if</code> statement, can be used for deciding which pointer to use.  I saw a library that implemented binary trees, and instead of having two named pointers (<code>pLeft</code> and <code>pRight</code> or whatever) had a length-2 array of pointers and used the &quot;decision bit&quot; technique to decide which one to follow.  For example, instead of:</p>
<pre><code>if (x &lt; node-&gt;value)
    node = node-&gt;pLeft;
else
    node = node-&gt;pRight;
</code></pre>
<p>this library would do something like:</p>
<pre><code>i = (x &lt; node-&gt;value);
node = node-&gt;link[i];
</code></pre>
<p>Here's a link to this code: <a href="https://web.archive.org/web/20190207151651/https://www.eternallyconfuzzled.com/tuts/datastructures/jsw_tut_rbtree.aspx" rel="noreferrer">Red Black Trees</a>, <em>Eternally Confuzzled</em></p>
    </div>
    <div class="mt24">
        <div class="d-flex fw-wrap ai-start jc-end gs8 gsy">

            <time itemprop="dateCreated" datetime="2013-07-22 08:29:30Z"></time>
            <div class="flex--item mr16" style="flex: 1 1 100px;">
                


<div class="js-post-menu pt2" data-post-id="17782979" data-post-type-id="2">

    <div class="d-flex gs8 s-anchors s-anchors__muted fw-wrap">

        <div class="flex--item">
            <a href="/a/17782979"
               rel="nofollow"
               itemprop="url"
               class="js-share-link js-gps-track"
               title="Short permalink to this answer"
               data-gps-track="post.click({ item: 2, priv: 0, post_type: 2 })"
               data-controller="se-share-sheet"
               data-se-share-sheet-title="Share a link to this answer"
               data-se-share-sheet-subtitle=""
               data-se-share-sheet-post-type="answer"
               data-se-share-sheet-social="facebook twitter devto"
               data-se-share-sheet-location="2"
               data-se-share-sheet-license-url="https%3a%2f%2fcreativecommons.org%2flicenses%2fby-sa%2f4.0%2f"
               data-se-share-sheet-license-name="CC BY-SA 4.0"
               data-s-popover-placement="bottom-start">Share</a>
        </div>


                    <div class="flex--item">
                        <a href="/posts/17782979/edit" class="js-suggest-edit-post js-gps-track" data-gps-track="post.click({ item: 6, priv: 0, post_type: 2 })" title="">Improve this answer</a>
                    </div>

                <div class="flex--item">
                    <button type="button"
                            id="btnFollowPost-17782979" class="s-btn s-btn__link js-follow-post js-follow-answer js-gps-track"
                            data-gps-track="post.click({ item: 14, priv: 0, post_type: 2 })"
                            data-controller="s-tooltip " data-s-tooltip-placement="bottom"
                            data-s-popover-placement="bottom" aria-controls=""
                            title="Follow this answer to receive notifications">
                        Follow
                        <input type="hidden" id="voteFollowHash" value="70:3:31e,16:823d15c8477c95ed,10:1771427630,16:423640629f84270b,8:17782979,d17e8da96812856239f5f439b118403469781ecb72c6aef015d53b910eaa745b" />
                    </button>
                </div>






    </div>
    <div class="js-menu-popup-container"></div>
</div>
            </div>
            <div class="post-signature flex--item fl0">
<div class="user-info ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            <a href="/posts/17782979/revisions" title="show all edits to this post"
                         class="js-gps-track"
                         data-gps-track="post.click({ item: 4, priv: 0, post_type: 2 })">edited <span title='2021-01-27 10:03:36Z' class='relativetime'>Jan 27, 2021 at 10:03</span></a>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/13367995/jakubde"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/efd8d484207a182322f67154d5bb4acd?s=64&amp;d=identicon&amp;r=PG&amp;f=y&amp;so-version=2" alt="jakubde&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/13367995/jakubde" dir="auto">jakubde</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">31</span><span title="1 gold badge" aria-hidden="true"><span class="badge1"></span><span class="badgecount">1</span></span><span class="v-visible-sr">1 gold badge</span><span title="3 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">3</span></span><span class="v-visible-sr">3 silver badges</span><span title="6 bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">6</span></span><span class="v-visible-sr">6 bronze badges</span>
        </div>
    </div>
</div>
            </div>


                <div class="post-signature flex--item fl0">
                    <div class="user-info ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            answered <span title='2013-07-22 08:29:30Z' class='relativetime'>Jul 22, 2013 at 8:29</span>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/166949/steveha"><div class="gravatar-wrapper-32"><img src="https://i.sstatic.net/tIFie.png?s=64" alt="steveha&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <a href="/users/166949/steveha" itemprop="url" dir="auto">steveha</a><meta itemprop="name" content="steveha"/>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 77,173" dir="ltr">77.2k</span><span title="21 gold badges" aria-hidden="true"><span class="badge1"></span><span class="badgecount">21</span></span><span class="v-visible-sr">21 gold badges</span><span title="94 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">94</span></span><span class="v-visible-sr">94 silver badges</span><span title="119 bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">119</span></span><span class="v-visible-sr">119 bronze badges</span>
        </div>
    </div>
</div>


                </div>
        </div>
        
    
    </div>
    
</div>




                

    <div class="post-layout--right">
        

<div id="follow-ups-container-17782979">
    <!--[--><div class="mt16"><div class="mb8 d-flex ai-center g8 c-pointer" role="button" tabindex="0"><h2 class="mb0">11 Comments</h2> <!--[--><!--[--><!----><svg aria-hidden="true" class="svg-icon iconArrowDownAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m16.01 7.43-1.4-1.41L9 11.6 3.42 6l-1.4 1.42 7 7z"/></svg><!----><!--]--><!--]--></div> <div class="mb12"><!--[!--><button type="button" class="s-btn s-btn__muted s-btn__outlined w100 d-flex ai-center p8" data-so-test="parent-answer-17782979"><!--[!--><!--]--> <div class="flex--item ml8"><p class="mb0">Add a comment</p></div></button><!--]--></div> <!--[--><div role="list"><!--[--><div id="follow-up-26185793" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/1031591/atlaste" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://i.sstatic.net/s3MiH.jpg?s=64" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">atlaste</div> <div class="s-user-card--awards"><!--[--><a href="/users/1031591/atlaste" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">atlaste</a><!--]--> <a class="comment-link" href="#comment26185793_17782979"><time title="2013-07-29T12:05:24.863Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->Right, you can also just use the bit directly and multiply (<code>data[c]&gt;&gt;7</code> - which is discussed somewhere here as well); I intentionally left this solution out, but of course you are correct. Just a small note: The rule of thumb for lookup tables is that if it fits in 4KB (because of caching), it&#39;ll work - preferably make the table as small as possible. For managed languages I&#39;d push that to 64KB, for low-level languages like C++ and C, I&#39;d probably reconsider (that&#39;s just my experience). Since <code>typeof(int) = 4</code>, I&#39;d try to stick to max 10 bits.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2013-07-29T12:05:24.863Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-26185793"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">58</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-26185793"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-26185793" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-26185793"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-26185793" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-26206652" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/166949/steveha" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://i.sstatic.net/tIFie.png?s=64" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">steveha</div> <div class="s-user-card--awards"><!--[--><a href="/users/166949/steveha" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">steveha</a><!--]--> <a class="comment-link" href="#comment26206652_17782979"><time title="2013-07-29T22:02:13.85Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->I think indexing with the 0/1 value will probably be faster than an integer multiply, but I guess if performance is really critical you should profile it.  I agree that small lookup tables are essential to avoid cache pressure, but clearly if you have a bigger cache you can get away with a bigger lookup table, so 4KB is more a rule of thumb than a hard rule.  I think you meant <code>sizeof(int) == 4</code>?  That would be true for 32-bit.  My two-year-old cell phone has a 32KB L1 cache, so even a 4K lookup table might work, especially if the lookup values were a byte instead of an int.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2013-07-29T22:02:13.85Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-26206652"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">44</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-26206652"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-26206652" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-26206652"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-26206652" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-33658701" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/2187042/richard-tingle" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://i.sstatic.net/otBg3.jpg?s=64" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Richard Tingle</div> <div class="s-user-card--awards"><!--[--><a href="/users/2187042/richard-tingle" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Richard Tingle</a><!--]--> <a class="comment-link" href="#comment33658701_17782979"><time title="2014-03-04T15:38:24.483Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->Possibly I&#39;m missing something but in your <code>j</code> equals 0 or 1 method why don&#39;t you just multiply your value by <code>j</code> before adding it rather than using the array indexing (possibly should be multiplied by <code>1-j</code> rather than <code>j</code>)<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2014-03-04T15:38:24.483Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-33658701"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">34</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-33658701"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-33658701" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-33658701"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-33658701" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-34186464" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/1031591/atlaste" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://i.sstatic.net/s3MiH.jpg?s=64" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">atlaste</div> <div class="s-user-card--awards"><!--[--><a href="/users/1031591/atlaste" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">atlaste</a><!--]--> <a class="comment-link" href="#comment34186464_17782979"><time title="2014-03-18T08:45:05.437Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->@steveha Multiplication should be faster, I tried looking it up in the Intel books, but couldn&#39;t find it... either way, benchmarking also gives me that result here.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2014-03-18T08:45:05.437Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-34186464"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">22</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-34186464"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-34186464" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-34186464"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-34186464" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-34186699" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/1031591/atlaste" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://i.sstatic.net/s3MiH.jpg?s=64" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">atlaste</div> <div class="s-user-card--awards"><!--[--><a href="/users/1031591/atlaste" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">atlaste</a><!--]--> <a class="comment-link" href="#comment34186699_17782979"><time title="2014-03-18T08:52:11.39Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->@steveha P.S.: another possible answer would be <code>int c = data[j]; sum += c &amp; -(c &gt;&gt; 7);</code> which requires no multiplications at all.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2014-03-18T08:52:11.39Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-34186699"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">26</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-34186699"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-34186699" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-34186699"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-34186699" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><!--]--></div> <!--[--><div class="d-flex g8 my8"><!--[--><button class="s-link s-btn__muted s-btn__outlined comments-link" data-so-test="parent-answer-17782979">Add a comment</button> <!--[--><span>|</span><!--]--><!--]--> <!--[--><button class="s-link s-btn__muted s-btn__outlined comments-link">Show 6 more comments</button><!--]--></div><!--]--><!----><!--]--> <!--[!--><!--]--></div><!--]-->
</div>

<script type="application/json" data-role="module-args" data-module-name="islands/follow-ups/index.mod">{"replies":[{"id":26185793,"user":{"userId":1031591,"isDeleted":false,"displayName":"atlaste","url":"/users/1031591/atlaste","profileImageUrl":"https://i.sstatic.net/s3MiH.jpg?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"atlaste","noSpacesUserName":"atlaste","reputationDisplayText":"0"},"postedAt":"2013-07-29T12:05:24.863Z","postedAtRelative":"Over a year ago","body":"Right, you can also just use the bit directly and multiply (\u0060data[c]\u003E\u003E7\u0060 - which is discussed somewhere here as well); I intentionally left this solution out, but of course you are correct. Just a small note: The rule of thumb for lookup tables is that if it fits in 4KB (because of caching), it\u0027ll work - preferably make the table as small as possible. For managed languages I\u0027d push that to 64KB, for low-level languages like C\u002B\u002B and C, I\u0027d probably reconsider (that\u0027s just my experience). Since \u0060typeof(int) = 4\u0060, I\u0027d try to stick to max 10 bits.","htmlBody":"Right, you can also just use the bit directly and multiply (\u003Ccode\u003Edata[c]\u0026gt;\u0026gt;7\u003C/code\u003E - which is discussed somewhere here as well); I intentionally left this solution out, but of course you are correct. Just a small note: The rule of thumb for lookup tables is that if it fits in 4KB (because of caching), it\u0026#39;ll work - preferably make the table as small as possible. For managed languages I\u0026#39;d push that to 64KB, for low-level languages like C\u002B\u002B and C, I\u0026#39;d probably reconsider (that\u0026#39;s just my experience). Since \u003Ccode\u003Etypeof(int) = 4\u003C/code\u003E, I\u0026#39;d try to stick to max 10 bits.","score":58,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":26206652,"user":{"userId":166949,"isDeleted":false,"displayName":"steveha","url":"/users/166949/steveha","profileImageUrl":"https://i.sstatic.net/tIFie.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"steveha","noSpacesUserName":"steveha","reputationDisplayText":"0"},"postedAt":"2013-07-29T22:02:13.85Z","postedAtRelative":"Over a year ago","body":"I think indexing with the 0/1 value will probably be faster than an integer multiply, but I guess if performance is really critical you should profile it.  I agree that small lookup tables are essential to avoid cache pressure, but clearly if you have a bigger cache you can get away with a bigger lookup table, so 4KB is more a rule of thumb than a hard rule.  I think you meant \u0060sizeof(int) == 4\u0060?  That would be true for 32-bit.  My two-year-old cell phone has a 32KB L1 cache, so even a 4K lookup table might work, especially if the lookup values were a byte instead of an int.","htmlBody":"I think indexing with the 0/1 value will probably be faster than an integer multiply, but I guess if performance is really critical you should profile it.  I agree that small lookup tables are essential to avoid cache pressure, but clearly if you have a bigger cache you can get away with a bigger lookup table, so 4KB is more a rule of thumb than a hard rule.  I think you meant \u003Ccode\u003Esizeof(int) == 4\u003C/code\u003E?  That would be true for 32-bit.  My two-year-old cell phone has a 32KB L1 cache, so even a 4K lookup table might work, especially if the lookup values were a byte instead of an int.","score":44,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":33658701,"user":{"userId":2187042,"isDeleted":false,"displayName":"Richard Tingle","url":"/users/2187042/richard-tingle","profileImageUrl":"https://i.sstatic.net/otBg3.jpg?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"RichardTingle","noSpacesUserName":"RichardTingle","reputationDisplayText":"0"},"postedAt":"2014-03-04T15:38:24.483Z","postedAtRelative":"Over a year ago","body":"Possibly I\u0027m missing something but in your \u0060j\u0060 equals 0 or 1 method why don\u0027t you just multiply your value by \u0060j\u0060 before adding it rather than using the array indexing (possibly should be multiplied by \u00601-j\u0060 rather than \u0060j\u0060)","htmlBody":"Possibly I\u0026#39;m missing something but in your \u003Ccode\u003Ej\u003C/code\u003E equals 0 or 1 method why don\u0026#39;t you just multiply your value by \u003Ccode\u003Ej\u003C/code\u003E before adding it rather than using the array indexing (possibly should be multiplied by \u003Ccode\u003E1-j\u003C/code\u003E rather than \u003Ccode\u003Ej\u003C/code\u003E)","score":34,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":34186464,"user":{"userId":1031591,"isDeleted":false,"displayName":"atlaste","url":"/users/1031591/atlaste","profileImageUrl":"https://i.sstatic.net/s3MiH.jpg?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"atlaste","noSpacesUserName":"atlaste","reputationDisplayText":"0"},"postedAt":"2014-03-18T08:45:05.437Z","postedAtRelative":"Over a year ago","body":"@steveha Multiplication should be faster, I tried looking it up in the Intel books, but couldn\u0027t find it... either way, benchmarking also gives me that result here.","htmlBody":"@steveha Multiplication should be faster, I tried looking it up in the Intel books, but couldn\u0026#39;t find it... either way, benchmarking also gives me that result here.","score":22,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":34186699,"user":{"userId":1031591,"isDeleted":false,"displayName":"atlaste","url":"/users/1031591/atlaste","profileImageUrl":"https://i.sstatic.net/s3MiH.jpg?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"atlaste","noSpacesUserName":"atlaste","reputationDisplayText":"0"},"postedAt":"2014-03-18T08:52:11.39Z","postedAtRelative":"Over a year ago","body":"@steveha P.S.: another possible answer would be \u0060int c = data[j]; sum \u002B= c \u0026 -(c \u003E\u003E 7);\u0060 which requires no multiplications at all.","htmlBody":"@steveha P.S.: another possible answer would be \u003Ccode\u003Eint c = data[j]; sum \u002B= c \u0026amp; -(c \u0026gt;\u0026gt; 7);\u003C/code\u003E which requires no multiplications at all.","score":26,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":34796004,"user":{"userId":3070062,"isDeleted":false,"displayName":"Falco","url":"/users/3070062/falco","profileImageUrl":"https://www.gravatar.com/avatar/7b895b012aefe99d0c1f6e2f56cab358?s=48\u0026d=identicon\u0026r=PG\u0026f=y\u0026so-version=2","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"Falco","noSpacesUserName":"Falco","reputationDisplayText":"0"},"postedAt":"2014-04-02T15:15:02.693Z","postedAtRelative":"Over a year ago","body":"Good answer - since a lookup-table can also handle complex cases, where we cannot easily cheat with bit-manipulation","htmlBody":"Good answer - since a lookup-table can also handle complex cases, where we cannot easily cheat with bit-manipulation","score":2,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false},{"id":38070759,"user":{"userId":116186,"isDeleted":false,"displayName":"Petter","url":"/users/116186/petter","profileImageUrl":"https://www.gravatar.com/avatar/dc5f7c3937e6844cb776d2004b903578?s=48\u0026d=identicon\u0026r=PG","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"Petter","noSpacesUserName":"Petter","reputationDisplayText":"0"},"postedAt":"2014-07-04T14:56:03.893Z","postedAtRelative":"Over a year ago","body":"Zain is correct. The \u201Cif\u201D is just hidden in the lookup table. The code is faster because the lookup table is hidden OUTSIDE the 100000 iterations. There is nothign to gain from using a lookup table for this problem.","htmlBody":"Zain is correct. The \u201Cif\u201D is just hidden in the lookup table. The code is faster because the lookup table is hidden OUTSIDE the 100000 iterations. There is nothign to gain from using a lookup table for this problem.","score":2,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false},{"id":41807953,"user":{"userId":1685098,"isDeleted":false,"displayName":"Logan Pickup","url":"/users/1685098/logan-pickup","profileImageUrl":"https://www.gravatar.com/avatar/285de66759f2353fcbe6121465e10d04?s=48\u0026d=identicon\u0026r=PG","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"LoganPickup","noSpacesUserName":"LoganPickup","reputationDisplayText":"0"},"postedAt":"2014-10-27T21:01:42.223Z","postedAtRelative":"Over a year ago","body":"\u0060i = (x \u003C node-\u003Evalue);\nnode = node-\u003Elink[i];\u0060 doesn\u0027t have an explicit branch, but it still contains a comparison; it depends a lot on the target architecture as to whether this can be resolved without a branch or not. Since it can be done on x86 (using either CMOV or LAHF) and ARM (conditional add or move), which are the only architectures I use, this is possibly not important!","htmlBody":"\u003Ccode\u003Ei = (x \u0026lt; node-\u0026gt;value); node = node-\u0026gt;link[i];\u003C/code\u003E doesn\u0026#39;t have an explicit branch, but it still contains a comparison; it depends a lot on the target architecture as to whether this can be resolved without a branch or not. Since it can be done on x86 (using either CMOV or LAHF) and ARM (conditional add or move), which are the only architectures I use, this is possibly not important!","score":2,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false},{"id":41810917,"user":{"userId":166949,"isDeleted":false,"displayName":"steveha","url":"/users/166949/steveha","profileImageUrl":"https://i.sstatic.net/tIFie.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"steveha","noSpacesUserName":"steveha","reputationDisplayText":"0"},"postedAt":"2014-10-27T23:05:57.803Z","postedAtRelative":"Over a year ago","body":"On what architecture would an expression like \u0060(x \u003C node-\u003Evalue)\u0060 require a branch to evaluate?  All the architectures with which I am familiar have a \u0022flags\u0022 register, and it is simple to extract the desired flag value.  I guess on the Pentium 4 the flag bit extraction might be slow as IIRC that chip doesn\u0027t have dedicated shifting hardware for addresses, but borrows the ALU to shift bits.  But I don\u0027t know where an actual branch would be needed.  Hmm, your examples were conditional... the idea is that once you extract the bit from flags, you can just use indexing with no branch.","htmlBody":"On what architecture would an expression like \u003Ccode\u003E(x \u0026lt; node-\u0026gt;value)\u003C/code\u003E require a branch to evaluate?  All the architectures with which I am familiar have a \u0026quot;flags\u0026quot; register, and it is simple to extract the desired flag value.  I guess on the Pentium 4 the flag bit extraction might be slow as IIRC that chip doesn\u0026#39;t have dedicated shifting hardware for addresses, but borrows the ALU to shift bits.  But I don\u0026#39;t know where an actual branch would be needed.  Hmm, your examples were conditional... the idea is that once you extract the bit from flags, you can just use indexing with no branch.","score":2,"editCount":1,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false},{"id":96616372,"user":{"userId":3950982,"isDeleted":false,"displayName":"Luke Hutchison","url":"/users/3950982/luke-hutchison","profileImageUrl":"https://www.gravatar.com/avatar/7491f45ae073ed6bfe01b1e63fb06bf0?s=48\u0026d=identicon\u0026r=PG","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"LukeHutchison","noSpacesUserName":"LukeHutchison","reputationDisplayText":"0"},"postedAt":"2019-02-28T12:37:24.547Z","postedAtRelative":"Over a year ago","body":"Bit shifting is a zero-cost operation in ARM, so you may find the bit-shifted version is faster on ARM.","htmlBody":"Bit shifting is a zero-cost operation in ARM, so you may find the bit-shifted version is faster on ARM.","score":3,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false},{"id":99261002,"user":{"userId":63550,"isDeleted":false,"displayName":"Peter Mortensen","url":"/users/63550/peter-mortensen","profileImageUrl":"https://i.sstatic.net/RIZKi.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"PeterMortensen","noSpacesUserName":"PeterMortensen","reputationDisplayText":"0"},"postedAt":"2019-05-27T13:07:05.647Z","postedAtRelative":"Over a year ago","body":"What about cache sizes, L1, L2, etc.? Having to go to main memory for a table lookup would be killer. Can you address that in your answer?","htmlBody":"What about cache sizes, L1, L2, etc.? Having to go to main memory for a table lookup would be killer. Can you address that in your answer?","score":2,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":true,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false}],"postId":17782979,"currentUserIsMod":false,"currentUserIsAnonymous":true,"commentFlagsRemainingToday":10,"maxNestingLevel":3,"hasOptedOut":false,"showCtaUnderComments":true,"containerElementId":"follow-ups-container-17782979","fKey":"d09ecbbe5140a7c1439a7e4020cdd7d76b52d28795a889bb24233842877804f3","questionId":11227809,"questionAuthorId":87234,"answerId":17782979,"answerPositionOnPage":0,"newUiSettings":{"largerFontSize":false},"showFirstTimeCommentingModal":false,"isMentionEnabled":false,"showSpamFlag":true,"mergeUnfriendlyAndRudeFlags":true,"allowRetractingCommentFlags":true,"commentMinLength":15}</script>
    </div>

        </div>
</div>
                                        
<a name="17828251"></a>
<div id="answer-17828251" class="answer js-answer " data-answerid="17828251"
     data-parentid="11227809" data-score="1243" data-position-on-page="9"
     data-highest-scored="0"
     data-question-has-accepted-highest-score="1"
     data-author-username="user1196549"
     data-author-reputation=""
     data-should-show-copy-button=True
     data-se-share-sheet-license-name="CC BY-SA 4.0"
     data-is-edited="True"
      itemprop="suggestedAnswer"
     itemscope itemtype="https://schema.org/Answer">
        <div class="post-layout ">
                <div class="votecell post-layout--left">
                    
<div class="js-voting-container d-flex jc-center fd-column ai-center gs4 fc-black-300" data-post-id="17828251" data-referrer="None">
        <button class="js-vote-up-btn flex--item s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
                id="upvote-btn-17828251"
                data-controller="s-tooltip"
                data-s-tooltip-placement="right"
                title="This answer is useful"
                aria-pressed="false"
                aria-label="Up vote"
                data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
                data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">
            <svg aria-hidden="true" class="svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg>
        </button>
        <input type="hidden" id="voteUpHash" value="70:3:31e,16:eab653ed86b89d02,10:1771427630,16:21591f539b766187,8:17828251,ac65a36d5d898c0582f0aec1c3ec4dd3c35cd3bb221e76bfc61327bfe47ded9d" />
        <div class="js-vote-count flex--item d-flex fd-column ai-center fc-theme-body-font fw-bold fs-subheading py4"
             itemprop="upvoteCount"
             data-value="1243">
1243        </div>
        <button
            class="js-vote-down-btn flex--item mb8 s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
            id=downvote-btn-17828251
            title="This answer is not useful"
            aria-pressed="false"
            aria-label="Down vote"
            data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
            data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">

            <svg aria-hidden="true" class="svg-icon iconArrowDown" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 6h16l-8 8z"/></svg>
        </button>
        <input type="hidden" id="voteDownHash" value="70:3:31e,16:af5ca05c8c00a108,10:1771427630,16:4f1f79b67b2776ed,8:17828251,850757b70e4217f48130b96777e40a07ecb1e50cb8c9037407f32835d42358a5" />


        
<button class="js-saves-btn s-btn s-btn__unset c-pointer py4"
        type="button"
        id="saves-btn-17828251"
        data-controller="s-tooltip"
        data-s-tooltip-placement="right"
        data-s-popover-placement=""
        title="Save this answer."
        data-is-saved="false"
        aria-label="Save"
        data-post-id="17828251"
        data-post-type-id="2"
        data-user-privilege-for-post-click="0"
        aria-controls=""
        data-s-popover-auto-show="false"
>
    <svg aria-hidden="true" class="fc-theme-primary-400 js-saves-btn-selected d-none svg-icon iconBookmark" width="18" height="18"  viewBox="0 0 18 18"><path  d="M3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
    <svg aria-hidden="true" class="js-saves-btn-unselected svg-icon iconBookmarkAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m9 10.6 4 2.66V3H5v10.26zM3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
</button>







            <div class="js-accepted-answer-indicator flex--item fc-green-400 py6 mtn8 d-none" data-s-tooltip-placement="right" title="Loading when this answer was accepted&#x2026;" tabindex="0" role="note" aria-label="Accepted">
                <div class="ta-center">
                    <svg aria-hidden="true" class="svg-icon iconCheckmarkLg" width="36" height="36"  viewBox="0 0 36 36"><path  d="m6 14 8 8L30 6v8L14 30l-8-8z"/></svg>
                </div>
            </div>

    
    <a class="js-post-issue flex--item s-btn s-btn__unset c-pointer py6 mx-auto" href="/posts/17828251/timeline" data-shortcut="T" data-ks-title="timeline" data-controller="s-tooltip" data-s-tooltip-placement="right" title="Show activity on this post." aria-label="Timeline"><svg aria-hidden="true" class="mln2 mr0 svg-icon iconHistory" width="19" height="18"  viewBox="0 0 19 18"><path  d="M3 9a8 8 0 1 1 3.73 6.77L8.2 14.3A6 6 0 1 0 5 9l3.01-.01-4 4-4-4zm7-4h1.01L11 9.36l3.22 2.1-.6.93L10 10z"/></svg></a>

</div>

                </div>

            

<div class="answercell post-layout--right">
    


    <div class="s-prose js-post-body" itemprop="text">
<p>In the sorted case, you can do better than relying on successful branch prediction or any branchless comparison trick: completely remove the branch.</p>

<p>Indeed, the array is partitioned in a contiguous zone with <code>data &lt; 128</code> and another with <code>data &gt;= 128</code>. So you should find the partition point with a <a href="https://en.wikipedia.org/wiki/Dichotomic_search" rel="noreferrer">dichotomic search</a> (using <code>Lg(arraySize) = 15</code> comparisons), then do a straight accumulation from that point.</p>

<p>Something like (unchecked)</p>

<pre><code>int i= 0, j, k= arraySize;
while (i &lt; k)
{
  j= (i + k) &gt;&gt; 1;
  if (data[j] &gt;= 128)
    k= j;
  else
    i= j;
}
sum= 0;
for (; i &lt; arraySize; i++)
  sum+= data[i];
</code></pre>

<p>or, slightly more obfuscated</p>

<pre><code>int i, k, j= (i + k) &gt;&gt; 1;
for (i= 0, k= arraySize; i &lt; k; (data[j] &gt;= 128 ? k : i)= j)
  j= (i + k) &gt;&gt; 1;
for (sum= 0; i &lt; arraySize; i++)
  sum+= data[i];
</code></pre>

<p>A yet faster approach, that gives an <strong>approximate</strong> solution for both sorted or unsorted is: <code>sum= 3137536;</code> (assuming a truly uniform distribution, 16384 samples with expected value 191.5) <strong>:-)</strong></p>
    </div>
    <div class="mt24">
        <div class="d-flex fw-wrap ai-start jc-end gs8 gsy">

            <time itemprop="dateCreated" datetime="2013-07-24 07:57:39Z"></time>
            <div class="flex--item mr16" style="flex: 1 1 100px;">
                


<div class="js-post-menu pt2" data-post-id="17828251" data-post-type-id="2">

    <div class="d-flex gs8 s-anchors s-anchors__muted fw-wrap">

        <div class="flex--item">
            <a href="/a/17828251"
               rel="nofollow"
               itemprop="url"
               class="js-share-link js-gps-track"
               title="Short permalink to this answer"
               data-gps-track="post.click({ item: 2, priv: 0, post_type: 2 })"
               data-controller="se-share-sheet"
               data-se-share-sheet-title="Share a link to this answer"
               data-se-share-sheet-subtitle=""
               data-se-share-sheet-post-type="answer"
               data-se-share-sheet-social="facebook twitter devto"
               data-se-share-sheet-location="2"
               data-se-share-sheet-license-url="https%3a%2f%2fcreativecommons.org%2flicenses%2fby-sa%2f4.0%2f"
               data-se-share-sheet-license-name="CC BY-SA 4.0"
               data-s-popover-placement="bottom-start">Share</a>
        </div>


                    <div class="flex--item">
                        <a href="/posts/17828251/edit" class="js-suggest-edit-post js-gps-track" data-gps-track="post.click({ item: 6, priv: 0, post_type: 2 })" title="">Improve this answer</a>
                    </div>

                <div class="flex--item">
                    <button type="button"
                            id="btnFollowPost-17828251" class="s-btn s-btn__link js-follow-post js-follow-answer js-gps-track"
                            data-gps-track="post.click({ item: 14, priv: 0, post_type: 2 })"
                            data-controller="s-tooltip " data-s-tooltip-placement="bottom"
                            data-s-popover-placement="bottom" aria-controls=""
                            title="Follow this answer to receive notifications">
                        Follow
                        <input type="hidden" id="voteFollowHash" value="70:3:31e,16:b2fdb23a86b8efe5,10:1771427630,16:7708fa6f5e593e78,8:17828251,eae31be8d23370be3517d280312efc9e9b0804cbf6de4591af79496bec46da4c" />
                    </button>
                </div>






    </div>
    <div class="js-menu-popup-container"></div>
</div>
            </div>
            <div class="post-signature flex--item fl0">
<div class="user-info user-hover ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            <a href="/posts/17828251/revisions" title="show all edits to this post"
                         class="js-gps-track"
                         data-gps-track="post.click({ item: 4, priv: 0, post_type: 2 })">edited <span title='2019-05-11 11:31:12Z' class='relativetime'>May 11, 2019 at 11:31</span></a>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/710069/konard"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/74bbef6437ca6a5a9158601455d7a534?s=64&amp;d=identicon&amp;r=PG" alt="Konard&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/710069/konard" dir="auto">Konard</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">3,114</span><span title="36 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">36</span></span><span class="v-visible-sr">36 silver badges</span><span title="28 bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">28</span></span><span class="v-visible-sr">28 bronze badges</span>
        </div>
    </div>
</div>
            </div>


                <div class="post-signature flex--item fl0">
                    <div class="user-info ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            answered <span title='2013-07-24 07:57:39Z' class='relativetime'>Jul 24, 2013 at 7:57</span>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <span class="anonymous-gravatar"></span>
    </div>
    <div class="user-details" itemprop="author" itemscope itemtype="http://schema.org/Person">
        user1196549<meta itemprop="name" content="user1196549"/>
        <div class="-flair">
            
        </div>
    </div>
</div>


                </div>
        </div>
        
    
    </div>
    
</div>




                

    <div class="post-layout--right">
        

<div id="follow-ups-container-17828251">
    <!--[--><div class="mt16"><div class="mb8 d-flex ai-center g8 c-pointer" role="button" tabindex="0"><h2 class="mb0">3 Comments</h2> <!--[--><!--[--><!----><svg aria-hidden="true" class="svg-icon iconArrowDownAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m16.01 7.43-1.4-1.41L9 11.6 3.42 6l-1.4 1.42 7 7z"/></svg><!----><!--]--><!--]--></div> <div class="mb12"><!--[!--><button type="button" class="s-btn s-btn__muted s-btn__outlined w100 d-flex ai-center p8 comments-link" data-so-test="parent-answer-17828251"><!--[!--><!--]--> <div class="flex--item ml8"><p class="mb0">Add a comment</p></div></button><!--]--></div> <!--[--><div role="list"><!--[--><div id="follow-up-26040119" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/85371/sehe" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=48&amp;d=identicon&amp;r=PG" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">sehe</div> <div class="s-user-card--awards"><!--[--><a href="/users/85371/sehe" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">sehe</a><!--]--> <a class="comment-link" href="#comment26040119_17828251"><time title="2013-07-24T16:31:30.36Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!----><code>sum= 3137536</code> - clever. That&#39;s kinda obviously not the point of the question. The question is clearly about explaining surprising performance characteristics. I&#39;m inclined to say that the addition of doing <code>std::partition</code> instead of <code>std::sort</code> is valuable. Though the actual question extends to more than just the synthetic benchmark given.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2013-07-24T16:31:30.36Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-26040119"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">44</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-26040119"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-26040119" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-26040119"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-26040119" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-26048383" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[!--><div class="s-avatar s-avatar__24 s-user-card--avatar gravatar-wrapper-24"><div class="anonymous-gravatar shift-left-a-bit svelte-1jhulwk"></div></div><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">user1196549</div> <div class="s-user-card--awards"><!--[!--><span class="s-user-card--link truncate wmx2 comment-user lh-xs">user1196549</span><!--]--> <a class="comment-link" href="#comment26048383_17828251"><time title="2013-07-24T20:37:31.79Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->@DeadMG: this is indeed not the standard dichotomic search for a given key, but a search for the partitioning index; it requires a single compare per iteration. But don&#39;t rely on this code, I have not checked it. If you are interested in a guaranteed correct implementation, let me know.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2013-07-24T20:37:31.79Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-26048383"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">26</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-26048383"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-26048383" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-26048383"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-26048383" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-127143721" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/224132/peter-cordes" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://i.sstatic.net/N4ivW.png?s=64" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Peter Cordes</div> <div class="s-user-card--awards"><!--[--><a href="/users/224132/peter-cordes" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Peter Cordes</a><!--]--> <a class="comment-link" href="#comment127143721_17828251"><time title="2022-04-21T10:32:12.12Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->Binary search for the cut-point is unnecessary, just start summing from the end you want to keep, stopping when you get to a value you don&#39;t want.  (Unless HW prefetching works <i>much</i> worse when looping downwards instead of upwards).  Of course, actually taking time to sort is not a useful part of an algorithm that starts with unsorted data.  A histogram might be, if you want to answer multiple queries for different cut-points, other than 128, from the same data.  (Since the small value-range means there are many duplicates in this smallish array.)<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2022-04-21T10:32:12.12Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-127143721"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">1</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-127143721"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-127143721" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-127143721"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-127143721" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><!--]--></div> <!--[--><div class="d-flex g8 my8"><!--[--><button class="s-link s-btn__muted s-btn__outlined comments-link" data-so-test="parent-answer-17828251">Add a comment</button> <!--[!--><!--]--><!--]--> <!--[!--><!--]--></div><!--]--><!----><!--]--> <!--[!--><!--]--></div><!--]-->
</div>

<script type="application/json" data-role="module-args" data-module-name="islands/follow-ups/index.mod">{"replies":[{"id":26040119,"user":{"userId":85371,"isDeleted":false,"displayName":"sehe","url":"/users/85371/sehe","profileImageUrl":"https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=48\u0026d=identicon\u0026r=PG","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"sehe","noSpacesUserName":"sehe","reputationDisplayText":"0"},"postedAt":"2013-07-24T16:31:30.36Z","postedAtRelative":"Over a year ago","body":"\u0060sum= 3137536\u0060 - clever. That\u0027s kinda obviously not the point of the question. The question is clearly about explaining surprising performance characteristics. I\u0027m inclined to say that the addition of doing \u0060std::partition\u0060 instead of \u0060std::sort\u0060 is valuable. Though the actual question extends to more than just the synthetic benchmark given.","htmlBody":"\u003Ccode\u003Esum= 3137536\u003C/code\u003E - clever. That\u0026#39;s kinda obviously not the point of the question. The question is clearly about explaining surprising performance characteristics. I\u0026#39;m inclined to say that the addition of doing \u003Ccode\u003Estd::partition\u003C/code\u003E instead of \u003Ccode\u003Estd::sort\u003C/code\u003E is valuable. Though the actual question extends to more than just the synthetic benchmark given.","score":44,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":26048383,"user":{"userId":0,"isDeleted":true,"displayName":"user1196549","url":"/users/0/user1196549","profileImageUrl":"","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"user1196549","noSpacesUserName":"user1196549","reputationDisplayText":"0"},"postedAt":"2013-07-24T20:37:31.79Z","postedAtRelative":"Over a year ago","body":"@DeadMG: this is indeed not the standard dichotomic search for a given key, but a search for the partitioning index; it requires a single compare per iteration. But don\u0027t rely on this code, I have not checked it. If you are interested in a guaranteed correct implementation, let me know.","htmlBody":"@DeadMG: this is indeed not the standard dichotomic search for a given key, but a search for the partitioning index; it requires a single compare per iteration. But don\u0026#39;t rely on this code, I have not checked it. If you are interested in a guaranteed correct implementation, let me know.","score":26,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":127143721,"user":{"userId":224132,"isDeleted":false,"displayName":"Peter Cordes","url":"/users/224132/peter-cordes","profileImageUrl":"https://i.sstatic.net/N4ivW.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"PeterCordes","noSpacesUserName":"PeterCordes","reputationDisplayText":"0"},"postedAt":"2022-04-21T10:32:12.12Z","postedAtRelative":"Over a year ago","body":"Binary search for the cut-point is unnecessary, just start summing from the end you want to keep, stopping when you get to a value you don\u0027t want.  (Unless HW prefetching works *much* worse when looping downwards instead of upwards).  Of course, actually taking time to sort is not a useful part of an algorithm that starts with unsorted data.  A histogram might be, if you want to answer multiple queries for different cut-points, other than 128, from the same data.  (Since the small value-range means there are many duplicates in this smallish array.)","htmlBody":"Binary search for the cut-point is unnecessary, just start summing from the end you want to keep, stopping when you get to a value you don\u0026#39;t want.  (Unless HW prefetching works \u003Ci\u003Emuch\u003C/i\u003E worse when looping downwards instead of upwards).  Of course, actually taking time to sort is not a useful part of an algorithm that starts with unsorted data.  A histogram might be, if you want to answer multiple queries for different cut-points, other than 128, from the same data.  (Since the small value-range means there are many duplicates in this smallish array.)","score":1,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":true,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true}],"postId":17828251,"currentUserIsMod":false,"currentUserIsAnonymous":true,"commentFlagsRemainingToday":10,"maxNestingLevel":3,"hasOptedOut":false,"showCtaUnderComments":true,"containerElementId":"follow-ups-container-17828251","fKey":"d09ecbbe5140a7c1439a7e4020cdd7d76b52d28795a889bb24233842877804f3","questionId":11227809,"questionAuthorId":87234,"answerId":17828251,"answerPositionOnPage":0,"newUiSettings":{"largerFontSize":false},"showFirstTimeCommentingModal":false,"isMentionEnabled":false,"showSpamFlag":true,"mergeUnfriendlyAndRudeFlags":true,"allowRetractingCommentFlags":true,"commentMinLength":15}</script>
    </div>

        </div>
</div>
                                        
<a name="31210295"></a>
<div id="answer-31210295" class="answer js-answer " data-answerid="31210295"
     data-parentid="11227809" data-score="1047" data-position-on-page="10"
     data-highest-scored="0"
     data-question-has-accepted-highest-score="1"
     data-author-username="Harsh Sharma"
     data-author-reputation="11312"
     data-should-show-copy-button=True
     data-se-share-sheet-license-name="CC BY-SA 4.0"
     data-is-edited="True"
      itemprop="suggestedAnswer"
     itemscope itemtype="https://schema.org/Answer">
        <div class="post-layout ">
                <div class="votecell post-layout--left">
                    
<div class="js-voting-container d-flex jc-center fd-column ai-center gs4 fc-black-300" data-post-id="31210295" data-referrer="None">
        <button class="js-vote-up-btn flex--item s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
                id="upvote-btn-31210295"
                data-controller="s-tooltip"
                data-s-tooltip-placement="right"
                title="This answer is useful"
                aria-pressed="false"
                aria-label="Up vote"
                data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
                data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">
            <svg aria-hidden="true" class="svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg>
        </button>
        <input type="hidden" id="voteUpHash" value="70:3:31e,16:605eaf78234d3d38,10:1771427630,16:ae214ac109be081a,8:31210295,423f61d28f7aa48adf67a7d5f2efadd5babf47494cf89fc57fb910b25d407cc1" />
        <div class="js-vote-count flex--item d-flex fd-column ai-center fc-theme-body-font fw-bold fs-subheading py4"
             itemprop="upvoteCount"
             data-value="1047">
1047        </div>
        <button
            class="js-vote-down-btn flex--item mb8 s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
            id=downvote-btn-31210295
            title="This answer is not useful"
            aria-pressed="false"
            aria-label="Down vote"
            data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
            data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">

            <svg aria-hidden="true" class="svg-icon iconArrowDown" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 6h16l-8 8z"/></svg>
        </button>
        <input type="hidden" id="voteDownHash" value="70:3:31e,16:b04742de161e97e4,10:1771427630,16:282a6e91bdc6e1a0,8:31210295,1764ca9a79246c085d0916cd3e54a2cdebb8bf471404215a14a14fec09c70ddc" />


        
<button class="js-saves-btn s-btn s-btn__unset c-pointer py4"
        type="button"
        id="saves-btn-31210295"
        data-controller="s-tooltip"
        data-s-tooltip-placement="right"
        data-s-popover-placement=""
        title="Save this answer."
        data-is-saved="false"
        aria-label="Save"
        data-post-id="31210295"
        data-post-type-id="2"
        data-user-privilege-for-post-click="0"
        aria-controls=""
        data-s-popover-auto-show="false"
>
    <svg aria-hidden="true" class="fc-theme-primary-400 js-saves-btn-selected d-none svg-icon iconBookmark" width="18" height="18"  viewBox="0 0 18 18"><path  d="M3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
    <svg aria-hidden="true" class="js-saves-btn-unselected svg-icon iconBookmarkAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m9 10.6 4 2.66V3H5v10.26zM3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
</button>







            <div class="js-accepted-answer-indicator flex--item fc-green-400 py6 mtn8 d-none" data-s-tooltip-placement="right" title="Loading when this answer was accepted&#x2026;" tabindex="0" role="note" aria-label="Accepted">
                <div class="ta-center">
                    <svg aria-hidden="true" class="svg-icon iconCheckmarkLg" width="36" height="36"  viewBox="0 0 36 36"><path  d="m6 14 8 8L30 6v8L14 30l-8-8z"/></svg>
                </div>
            </div>

    
    <a class="js-post-issue flex--item s-btn s-btn__unset c-pointer py6 mx-auto" href="/posts/31210295/timeline" data-shortcut="T" data-ks-title="timeline" data-controller="s-tooltip" data-s-tooltip-placement="right" title="Show activity on this post." aria-label="Timeline"><svg aria-hidden="true" class="mln2 mr0 svg-icon iconHistory" width="19" height="18"  viewBox="0 0 19 18"><path  d="M3 9a8 8 0 1 1 3.73 6.77L8.2 14.3A6 6 0 1 0 5 9l3.01-.01-4 4-4-4zm7-4h1.01L11 9.36l3.22 2.1-.6.93L10 10z"/></svg></a>

</div>

                </div>

            

<div class="answercell post-layout--right">
    


    <div class="s-prose js-post-body" itemprop="text">
<p>The above behavior is happening because of Branch prediction.</p>
<p>To understand branch prediction one must first understand an <strong>Instruction Pipeline.</strong></p>
<p>The the steps of running an instruction can be overlapped with the sequence of steps of running the previous and next instruction, so that different steps can be executed concurrently in parallel. This technique is known as instruction pipelining and is used to increase throughput in modern processors. To understand this better please see this <a href="https://en.wikipedia.org/wiki/Pipeline_(computing)#Concept_and_motivation" rel="noreferrer">example on Wikipedia</a>.</p>
<p>Generally, modern processors have quite long (and wide) pipelines, so many instruction can be in flight.  See <a href="https://www.lighterra.com/papers/modernmicroprocessors/" rel="noreferrer">Modern Microprocessors
A 90-Minute Guide!</a> which starts by introducing basic in-order pipelining and goes from there.</p>
<p>But for ease <strong>let's consider a simple in-order pipeline with these 4 steps only.</strong><br />
(Like a <a href="https://en.wikipedia.org/wiki/Classic_RISC_pipeline" rel="noreferrer">classic 5-stage RISC</a>, but omitting a separate MEM stage.)</p>
<ol>
<li>IF -- Fetch the instruction from memory</li>
<li>ID -- Decode the instruction</li>
<li>EX -- Execute the instruction</li>
<li>WB -- Write back to CPU register</li>
</ol>
<p><strong>4-stage pipeline in general for 2 instructions.</strong><br />
<img src="https://i.sstatic.net/PqBBR.png" alt="4-stage pipeline in general" /></p>
<p>Moving back to the above question let's consider the following instructions:</p>
<pre><code>                        A) if (data[c] &gt;= 128)
                                /\
                               /  \
                              /    \
                        true /      \ false
                            /        \
                           /          \
                          /            \
                         /              \
              B) sum += data[c];          C) for loop or print().
</code></pre>
<p>Without branch prediction, the following would occur:</p>
<p>To execute instruction B or instruction C the processor will have to wait (<em>stall</em>) till the instruction A leaves the EX stage in the pipeline, as the decision to go to instruction B or instruction C depends on the result of instruction A.  (i.e. where to fetch from next.) So the pipeline will look like this:</p>
<p><em><strong>Without prediction: when <code>if</code> condition is true:</strong></em>
<img src="https://i.sstatic.net/0H4gP.png" alt="enter image description here" /></p>
<p><em><strong>Without prediction: When <code>if</code> condition is false:</strong></em>
<img src="https://i.sstatic.net/APpca.png" alt="enter image description here" /></p>
<p>As a result of waiting for the result of instruction A, the total CPU cycles spent in the above case (without branch prediction; for both true and false) is 7.</p>
<p><strong>So what is branch prediction?</strong></p>
<p>Branch predictor will try to guess which way a branch (an if-then-else structure) will go before this is known for sure. It will not wait for the instruction A to reach the EX stage of the pipeline, but it will guess the decision and go to that instruction (B or C in case of our example).</p>
<p><em><strong>In case of a correct guess, the pipeline looks something like this:</strong></em>
<img src="https://i.sstatic.net/ZYUbs.png" alt="enter image description here" /></p>
<p>If it is later detected that the guess was wrong then the partially executed instructions are discarded and the pipeline starts over with the correct branch, incurring a delay.
The time that is wasted in case of a branch misprediction is equal to the number of stages in the pipeline from the fetch stage to the execute stage. Modern microprocessors tend to have quite long pipelines so that the misprediction delay is between 10 and 20 clock cycles. The longer the pipeline the greater the need for a good <a href="https://en.wikipedia.org/wiki/Branch_predictor" rel="noreferrer">branch predictor</a>.</p>
<p>In the OP's code, the first time when the conditional, the branch predictor does not have any information to base up prediction, so the first time it will randomly choose the next instruction. (Or fall back to <em>static</em> prediction, typically forward not-taken, backward taken).  Later in the for loop, it can base the prediction on the history.
For an array sorted in ascending order, there are three possibilities:</p>
<ol>
<li> All the elements are less than 128
<li> All the elements are greater than 128
<li> Some starting new elements are less than 128 and later it become greater than 128
</ol>
<p>Let us assume that the predictor will always assume the true branch on the first run.</p>
<p>So in the first case, it will always take the true branch since historically all its predictions are correct.
In the 2nd case, initially it will predict wrong, but after a few iterations, it will predict correctly.
In the 3rd case, it will initially predict correctly till the elements are less than 128. After which it will fail for some time and the correct itself when it sees branch prediction failure in history.</p>
<p>In all these cases the failure will be too less in number and as a result, only a few times it will need to discard the partially executed instructions and start over with the correct branch, resulting in fewer CPU cycles.</p>
<p>But in case of a random unsorted array, the prediction will need to discard the partially executed instructions and start over with the correct branch most of the time and result in more CPU cycles compared to the sorted array.</p>
<hr />
<p>Further reading:</p>
<ul>
<li><a href="https://www.lighterra.com/papers/modernmicroprocessors/" rel="noreferrer">Modern Microprocessors
A 90-Minute Guide!</a></li>
<li><a href="https://danluu.com/branch-prediction/" rel="noreferrer">Dan Luu's article on branch prediction</a> (which covers older branch predictors, not modern IT-TAGE or Perceptron)</li>
<li><a href="https://en.wikipedia.org/wiki/Branch_predictor" rel="noreferrer">https://en.wikipedia.org/wiki/Branch_predictor</a></li>
<li><a href="https://hal.inria.fr/hal-01100647/document" rel="noreferrer">Branch Prediction and the Performance of Interpreters -
Dont Trust Folklore</a> - 2015 paper showing how well Intel's Haswell does at predicting the indirect branch of a Python interpreter's main loop (historically problematic due to a non-simple pattern), vs. earlier CPUs which didn't use IT-TAGE.  (They don't help with this fully random case, though.  Still 50% mispredict rate for the if inside the loop on a Skylake CPU when the source is compiled to branch asm.)</li>
<li><a href="https://xania.org/201602/bpu-part-one" rel="noreferrer">Static branch prediction on newer Intel processors</a> - what CPUs actually do when running a branch instruction that doesn't have a dynamic prediction available.  Historically, forward not-taken (like an <code>if</code> or <code>break</code>), backward taken (like a loop) has been used because it's better than nothing.  Laying out code so the fast path / common case minimizes taken branches is good for I-cache density as well as static prediction, so compilers already do that.  (That's the <a href="https://stackoverflow.com/questions/1851299/is-it-possible-to-tell-the-branch-predictor-how-likely-it-is-to-follow-the-branc">real effect</a> of <code>likely</code> / <code>unlikely</code> hints in C source, not actually hinting the hardware branch prediction in most CPU, except maybe via static prediction.)</li>
</ul>
    </div>
    <div class="mt24">
        <div class="d-flex fw-wrap ai-start jc-end gs8 gsy">

            <time itemprop="dateCreated" datetime="2015-07-03 15:35:52Z"></time>
            <div class="flex--item mr16" style="flex: 1 1 100px;">
                


<div class="js-post-menu pt2" data-post-id="31210295" data-post-type-id="2">

    <div class="d-flex gs8 s-anchors s-anchors__muted fw-wrap">

        <div class="flex--item">
            <a href="/a/31210295"
               rel="nofollow"
               itemprop="url"
               class="js-share-link js-gps-track"
               title="Short permalink to this answer"
               data-gps-track="post.click({ item: 2, priv: 0, post_type: 2 })"
               data-controller="se-share-sheet"
               data-se-share-sheet-title="Share a link to this answer"
               data-se-share-sheet-subtitle=""
               data-se-share-sheet-post-type="answer"
               data-se-share-sheet-social="facebook twitter devto"
               data-se-share-sheet-location="2"
               data-se-share-sheet-license-url="https%3a%2f%2fcreativecommons.org%2flicenses%2fby-sa%2f4.0%2f"
               data-se-share-sheet-license-name="CC BY-SA 4.0"
               data-s-popover-placement="bottom-start">Share</a>
        </div>


                    <div class="flex--item">
                        <a href="/posts/31210295/edit" class="js-suggest-edit-post js-gps-track" data-gps-track="post.click({ item: 6, priv: 0, post_type: 2 })" title="">Improve this answer</a>
                    </div>

                <div class="flex--item">
                    <button type="button"
                            id="btnFollowPost-31210295" class="s-btn s-btn__link js-follow-post js-follow-answer js-gps-track"
                            data-gps-track="post.click({ item: 14, priv: 0, post_type: 2 })"
                            data-controller="s-tooltip " data-s-tooltip-placement="bottom"
                            data-s-popover-placement="bottom" aria-controls=""
                            title="Follow this answer to receive notifications">
                        Follow
                        <input type="hidden" id="voteFollowHash" value="70:3:31e,16:a4620524fcea946a,10:1771427630,16:3edf73eff2b97e8a,8:31210295,40d86b63990dbdf7ddc385f26e22897c6917a485929c9a346c3e8163b7c8ec96" />
                    </button>
                </div>






    </div>
    <div class="js-menu-popup-container"></div>
</div>
            </div>
            <div class="post-signature flex--item fl0">
<div class="user-info user-hover ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            <a href="/posts/31210295/revisions" title="show all edits to this post"
                         class="js-gps-track"
                         data-gps-track="post.click({ item: 4, priv: 0, post_type: 2 })">edited <span title='2022-04-22 01:31:28Z' class='relativetime'>Apr 22, 2022 at 1:31</span></a>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/224132/peter-cordes"><div class="gravatar-wrapper-32"><img src="https://i.sstatic.net/N4ivW.png?s=64" alt="Peter Cordes&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/224132/peter-cordes" dir="auto">Peter Cordes</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 379,441" dir="ltr">379k</span><span title="52 gold badges" aria-hidden="true"><span class="badge1"></span><span class="badgecount">52</span></span><span class="v-visible-sr">52 gold badges</span><span title="754 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">754</span></span><span class="v-visible-sr">754 silver badges</span><span title="1k bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">1k</span></span><span class="v-visible-sr">1k bronze badges</span>
        </div>
    </div>
</div>
            </div>


                <div class="post-signature flex--item fl0">
                    <div class="user-info user-hover ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            answered <span title='2015-07-03 15:35:52Z' class='relativetime'>Jul 3, 2015 at 15:35</span>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/1627741/harsh-sharma"><div class="gravatar-wrapper-32"><img src="https://i.sstatic.net/YXvvz.jpg?s=64" alt="Harsh Sharma&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <a href="/users/1627741/harsh-sharma" itemprop="url" dir="auto">Harsh Sharma</a><meta itemprop="name" content="Harsh Sharma"/>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 11,312" dir="ltr">11.3k</span><span title="2 gold badges" aria-hidden="true"><span class="badge1"></span><span class="badgecount">2</span></span><span class="v-visible-sr">2 gold badges</span><span title="20 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">20</span></span><span class="v-visible-sr">20 silver badges</span><span title="30 bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">30</span></span><span class="v-visible-sr">30 bronze badges</span>
        </div>
    </div>
</div>


                </div>
        </div>
        
    
    </div>
    
</div>




                

    <div class="post-layout--right">
        

<div id="follow-ups-container-31210295">
    <!--[--><div class="mt16"><div class="mb8 d-flex ai-center g8 c-pointer" role="button" tabindex="0"><h2 class="mb0">2 Comments</h2> <!--[--><!--[--><!----><svg aria-hidden="true" class="svg-icon iconArrowDownAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m16.01 7.43-1.4-1.41L9 11.6 3.42 6l-1.4 1.42 7 7z"/></svg><!----><!--]--><!--]--></div> <div class="mb12"><!--[!--><button type="button" class="s-btn s-btn__muted s-btn__outlined w100 d-flex ai-center p8 comments-link" data-so-test="parent-answer-31210295"><!--[!--><!--]--> <div class="flex--item ml8"><p class="mb0">Add a comment</p></div></button><!--]--></div> <!--[--><div role="list"><!--[--><div id="follow-up-80330289" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/4767498/m-kazem-akhgary" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://lh3.googleusercontent.com/-u6daZXYwzxs/AAAAAAAAAAI/AAAAAAAAABI/0xXoH0XUtkc/s48-rj/photo.jpg" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">M.kazem Akhgary</div> <div class="s-user-card--awards"><!--[--><a href="/users/4767498/m-kazem-akhgary" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">M.kazem Akhgary</a><!--]--> <a class="comment-link" href="#comment80330289_31210295"><time title="2017-10-11T14:49:42.493Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->how are two instructions executed together? is this done with separate cpu cores or is pipeline instruction is integrated in single cpu core?<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2017-10-11T14:49:42.493Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-80330289"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">11</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-80330289"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-80330289" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-80330289"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-80330289" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-81130628" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/6583956/sergey-quixoticaxis-ivanov" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://i.sstatic.net/rM8OA.jpg?s=64" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Sergey.quixoticaxis.Ivanov</div> <div class="s-user-card--awards"><!--[--><a href="/users/6583956/sergey-quixoticaxis-ivanov" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Sergey.quixoticaxis.Ivanov</a><!--]--> <a class="comment-link" href="#comment81130628_31210295"><time title="2017-11-03T07:45:12.107Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[--><span class="o50" title="Edited 2 times"><!----><svg aria-hidden="true" class="svg-icon iconPencilSm" width="14" height="14"  viewBox="0 0 14 14"><path fill="#F1B600" d="m2 10.12 6.37-6.43 1.88 1.88L3.88 12H2z"/><path fill="#E87C87" d="m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0"/></svg><!----><!----></span><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->@M.kazemAkhgary It&#39;s all inside one logical core. If you&#39;re interested, this is nicely described for example in <a href="https://software.intel.com/en-us/articles/intel-sdm" rel="nofollow noreferrer">Intel Software Developer Manual</a><!----><!--]--></div> <time class="d-none" itemprop="datePublished">2017-11-03T07:45:12.107Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-81130628"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">7</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-81130628"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-81130628" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-81130628"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-81130628" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><!--]--></div> <!--[!--><!--]--><!----><!--]--> <!--[!--><!--]--></div><!--]-->
</div>

<script type="application/json" data-role="module-args" data-module-name="islands/follow-ups/index.mod">{"replies":[{"id":80330289,"user":{"userId":4767498,"isDeleted":false,"displayName":"M.kazem Akhgary","url":"/users/4767498/m-kazem-akhgary","profileImageUrl":"https://lh3.googleusercontent.com/-u6daZXYwzxs/AAAAAAAAAAI/AAAAAAAAABI/0xXoH0XUtkc/s48-rj/photo.jpg","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"M.kazemAkhgary","noSpacesUserName":"M.kazemAkhgary","reputationDisplayText":"0"},"postedAt":"2017-10-11T14:49:42.493Z","postedAtRelative":"Over a year ago","body":"how are two instructions executed together? is this done with separate cpu cores or is pipeline instruction is integrated in single cpu core?","htmlBody":"how are two instructions executed together? is this done with separate cpu cores or is pipeline instruction is integrated in single cpu core?","score":11,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":81130628,"user":{"userId":6583956,"isDeleted":false,"displayName":"Sergey.quixoticaxis.Ivanov","url":"/users/6583956/sergey-quixoticaxis-ivanov","profileImageUrl":"https://i.sstatic.net/rM8OA.jpg?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"Sergey.quixoticaxis.Ivanov","noSpacesUserName":"Sergey.quixoticaxis.Ivanov","reputationDisplayText":"0"},"postedAt":"2017-11-03T07:45:12.107Z","postedAtRelative":"Over a year ago","body":"@M.kazemAkhgary It\u0027s all inside one logical core. If you\u0027re interested, this is nicely described for example in [Intel Software Developer Manual](https://software.intel.com/en-us/articles/intel-sdm)","htmlBody":"@M.kazemAkhgary It\u0026#39;s all inside one logical core. If you\u0026#39;re interested, this is nicely described for example in \u003Ca href=\u0022https://software.intel.com/en-us/articles/intel-sdm\u0022 rel=\u0022nofollow noreferrer\u0022\u003EIntel Software Developer Manual\u003C/a\u003E","score":7,"editCount":2,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":true,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true}],"postId":31210295,"currentUserIsMod":false,"currentUserIsAnonymous":true,"commentFlagsRemainingToday":10,"maxNestingLevel":3,"hasOptedOut":false,"showCtaUnderComments":false,"containerElementId":"follow-ups-container-31210295","fKey":"d09ecbbe5140a7c1439a7e4020cdd7d76b52d28795a889bb24233842877804f3","questionId":11227809,"questionAuthorId":87234,"answerId":31210295,"answerPositionOnPage":0,"newUiSettings":{"largerFontSize":false},"showFirstTimeCommentingModal":false,"isMentionEnabled":false,"showSpamFlag":true,"mergeUnfriendlyAndRudeFlags":true,"allowRetractingCommentFlags":true,"commentMinLength":15}</script>
    </div>

        </div>
</div>
                                        
<a name="33070112"></a>
<div id="answer-33070112" class="answer js-answer " data-answerid="33070112"
     data-parentid="11227809" data-score="919" data-position-on-page="11"
     data-highest-scored="0"
     data-question-has-accepted-highest-score="1"
     data-author-username="Surt"
     data-author-reputation="16149"
     data-should-show-copy-button=True
     data-se-share-sheet-license-name="CC BY-SA 3.0"
     data-is-edited="True"
      itemprop="suggestedAnswer"
     itemscope itemtype="https://schema.org/Answer">
        <div class="post-layout ">
                <div class="votecell post-layout--left">
                    
<div class="js-voting-container d-flex jc-center fd-column ai-center gs4 fc-black-300" data-post-id="33070112" data-referrer="None">
        <button class="js-vote-up-btn flex--item s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
                id="upvote-btn-33070112"
                data-controller="s-tooltip"
                data-s-tooltip-placement="right"
                title="This answer is useful"
                aria-pressed="false"
                aria-label="Up vote"
                data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
                data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">
            <svg aria-hidden="true" class="svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg>
        </button>
        <input type="hidden" id="voteUpHash" value="70:3:31e,16:5c89ffa5976c9092,10:1771427630,16:c98a3ea831162cc3,8:33070112,df35b97e16d6f19f6fbe17e588c9ea98ae212803a858357d5d1189facfaf1758" />
        <div class="js-vote-count flex--item d-flex fd-column ai-center fc-theme-body-font fw-bold fs-subheading py4"
             itemprop="upvoteCount"
             data-value="919">
919        </div>
        <button
            class="js-vote-down-btn flex--item mb8 s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
            id=downvote-btn-33070112
            title="This answer is not useful"
            aria-pressed="false"
            aria-label="Down vote"
            data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
            data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">

            <svg aria-hidden="true" class="svg-icon iconArrowDown" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 6h16l-8 8z"/></svg>
        </button>
        <input type="hidden" id="voteDownHash" value="70:3:31e,16:ec6bb0dec797a239,10:1771427630,16:ae1b99f4112992ce,8:33070112,45d023784ed7e5ab8c1a920ba39ba116d808d1af82962e1fb4326b7bec812a43" />


        
<button class="js-saves-btn s-btn s-btn__unset c-pointer py4"
        type="button"
        id="saves-btn-33070112"
        data-controller="s-tooltip"
        data-s-tooltip-placement="right"
        data-s-popover-placement=""
        title="Save this answer."
        data-is-saved="false"
        aria-label="Save"
        data-post-id="33070112"
        data-post-type-id="2"
        data-user-privilege-for-post-click="0"
        aria-controls=""
        data-s-popover-auto-show="false"
>
    <svg aria-hidden="true" class="fc-theme-primary-400 js-saves-btn-selected d-none svg-icon iconBookmark" width="18" height="18"  viewBox="0 0 18 18"><path  d="M3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
    <svg aria-hidden="true" class="js-saves-btn-unselected svg-icon iconBookmarkAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m9 10.6 4 2.66V3H5v10.26zM3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
</button>







            <div class="js-accepted-answer-indicator flex--item fc-green-400 py6 mtn8 d-none" data-s-tooltip-placement="right" title="Loading when this answer was accepted&#x2026;" tabindex="0" role="note" aria-label="Accepted">
                <div class="ta-center">
                    <svg aria-hidden="true" class="svg-icon iconCheckmarkLg" width="36" height="36"  viewBox="0 0 36 36"><path  d="m6 14 8 8L30 6v8L14 30l-8-8z"/></svg>
                </div>
            </div>

    
    <a class="js-post-issue flex--item s-btn s-btn__unset c-pointer py6 mx-auto" href="/posts/33070112/timeline" data-shortcut="T" data-ks-title="timeline" data-controller="s-tooltip" data-s-tooltip-placement="right" title="Show activity on this post." aria-label="Timeline"><svg aria-hidden="true" class="mln2 mr0 svg-icon iconHistory" width="19" height="18"  viewBox="0 0 19 18"><path  d="M3 9a8 8 0 1 1 3.73 6.77L8.2 14.3A6 6 0 1 0 5 9l3.01-.01-4 4-4-4zm7-4h1.01L11 9.36l3.22 2.1-.6.93L10 10z"/></svg></a>

</div>

                </div>

            

<div class="answercell post-layout--right">
    


    <div class="s-prose js-post-body" itemprop="text">
<p>An official answer would be from</p>

<ol>
<li><a href="https://software.intel.com/en-us/articles/avoiding-the-cost-of-branch-misprediction" rel="noreferrer">Intel - Avoiding the Cost of Branch Misprediction</a></li>
<li><a href="https://software.intel.com/en-us/articles/branch-and-loop-reorganization-to-prevent-mispredicts" rel="noreferrer">Intel - Branch and Loop Reorganization to Prevent Mispredicts</a></li>
<li><a href="https://scholar.google.com/scholar?q=branch%20prediction%20computer%20architecture&amp;hl=da&amp;as_sdt=0&amp;as_vis=1&amp;oi=scholart" rel="noreferrer">Scientific papers - branch prediction computer architecture</a></li>
<li>Books: J.L. Hennessy, D.A. Patterson: Computer architecture: a quantitative approach</li>
<li>Articles in scientific publications: T.Y. Yeh, Y.N. Patt made a lot of these on branch predictions.</li>
</ol>

<p>You can also see from this lovely <a href="https://en.wikipedia.org/wiki/Branch_predictor#/media/File:Branch_prediction_2bit_saturating_counter-dia.svg" rel="noreferrer">diagram</a> why the branch predictor gets confused.</p>

<p><a href="https://i.sstatic.net/pBMV2.png" rel="noreferrer"><img src="https://i.sstatic.net/pBMV2.png" alt="2-bit state diagram"></a></p>

<p>Each element in the original code is a random value</p>

<pre><code>data[c] = std::rand() % 256;
</code></pre>

<p>so the predictor will change sides as the <code>std::rand()</code> blow.</p>

<p>On the other hand, once it's sorted, the predictor will first move into a state of strongly not taken and when the values change to the high value the predictor will in three runs through change all the way from strongly not taken to strongly taken.</p>

<hr>
    </div>
    <div class="mt24">
        <div class="d-flex fw-wrap ai-start jc-end gs8 gsy">

            <time itemprop="dateCreated" datetime="2015-10-11 21:05:18Z"></time>
            <div class="flex--item mr16" style="flex: 1 1 100px;">
                


<div class="js-post-menu pt2" data-post-id="33070112" data-post-type-id="2">

    <div class="d-flex gs8 s-anchors s-anchors__muted fw-wrap">

        <div class="flex--item">
            <a href="/a/33070112"
               rel="nofollow"
               itemprop="url"
               class="js-share-link js-gps-track"
               title="Short permalink to this answer"
               data-gps-track="post.click({ item: 2, priv: 0, post_type: 2 })"
               data-controller="se-share-sheet"
               data-se-share-sheet-title="Share a link to this answer"
               data-se-share-sheet-subtitle=""
               data-se-share-sheet-post-type="answer"
               data-se-share-sheet-social="facebook twitter devto"
               data-se-share-sheet-location="2"
               data-se-share-sheet-license-url="https%3a%2f%2fcreativecommons.org%2flicenses%2fby-sa%2f3.0%2f"
               data-se-share-sheet-license-name="CC BY-SA 3.0"
               data-s-popover-placement="bottom-start">Share</a>
        </div>


                    <div class="flex--item">
                        <a href="/posts/33070112/edit" class="js-suggest-edit-post js-gps-track" data-gps-track="post.click({ item: 6, priv: 0, post_type: 2 })" title="">Improve this answer</a>
                    </div>

                <div class="flex--item">
                    <button type="button"
                            id="btnFollowPost-33070112" class="s-btn s-btn__link js-follow-post js-follow-answer js-gps-track"
                            data-gps-track="post.click({ item: 14, priv: 0, post_type: 2 })"
                            data-controller="s-tooltip " data-s-tooltip-placement="bottom"
                            data-s-popover-placement="bottom" aria-controls=""
                            title="Follow this answer to receive notifications">
                        Follow
                        <input type="hidden" id="voteFollowHash" value="70:3:31e,16:856d20b1ba172c7f,10:1771427630,16:b0f32ec812c60ed6,8:33070112,ca7ce713aa60b4c6636f493170e237156c0a5ded688890dc2399f89bc215f9fe" />
                    </button>
                </div>






    </div>
    <div class="js-menu-popup-container"></div>
</div>
            </div>
            <div class="post-signature flex--item fl0">
<div class="user-info user-hover ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            <a href="/posts/33070112/revisions" title="show all edits to this post"
                         class="js-gps-track"
                         data-gps-track="post.click({ item: 4, priv: 0, post_type: 2 })">edited <span title='2017-01-31 11:39:33Z' class='relativetime'>Jan 31, 2017 at 11:39</span></a>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/234175/greatwolf"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/37f386df1c4e98d9ce0350431f590f2a?s=64&amp;d=identicon&amp;r=PG" alt="greatwolf&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/234175/greatwolf" dir="auto">greatwolf</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 21,024" dir="ltr">21k</span><span title="13 gold badges" aria-hidden="true"><span class="badge1"></span><span class="badgecount">13</span></span><span class="v-visible-sr">13 gold badges</span><span title="77 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">77</span></span><span class="v-visible-sr">77 silver badges</span><span title="105 bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">105</span></span><span class="v-visible-sr">105 bronze badges</span>
        </div>
    </div>
</div>
            </div>


                <div class="post-signature flex--item fl0">
                    <div class="user-info ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            answered <span title='2015-10-11 21:05:18Z' class='relativetime'>Oct 11, 2015 at 21:05</span>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/4013258/surt"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/e865f13f21d7a46668ee25724b66fed3?s=64&amp;d=identicon&amp;r=PG&amp;f=y&amp;so-version=2" alt="Surt&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <a href="/users/4013258/surt" itemprop="url" dir="auto">Surt</a><meta itemprop="name" content="Surt"/>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 16,149" dir="ltr">16.1k</span><span title="3 gold badges" aria-hidden="true"><span class="badge1"></span><span class="badgecount">3</span></span><span class="v-visible-sr">3 gold badges</span><span title="27 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">27</span></span><span class="v-visible-sr">27 silver badges</span><span title="40 bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">40</span></span><span class="v-visible-sr">40 bronze badges</span>
        </div>
    </div>
</div>


                </div>
        </div>
        
    
    </div>
    
</div>




                

    <div class="post-layout--right">
        

<div id="follow-ups-container-33070112">
    <!--[--><div class="mt16"><div class="mb8 d-flex ai-center g8" role="button" tabindex="0"><h2 class="mb0">Comments</h2> <!--[!--><!--]--></div> <div class="mb12"><!--[!--><button type="button" class="s-btn s-btn__muted s-btn__outlined w100 d-flex ai-center p8 comments-link" data-so-test="parent-answer-33070112"><!--[!--><!--]--> <div class="flex--item ml8"><p class="mb0">Add a comment</p></div></button><!--]--></div> <!--[--><div role="list"><!--[--><!--]--></div> <!--[!--><!--]--><!----><!--]--> <!--[!--><!--]--></div><!--]-->
</div>

<script type="application/json" data-role="module-args" data-module-name="islands/follow-ups/index.mod">{"replies":[],"postId":33070112,"currentUserIsMod":false,"currentUserIsAnonymous":true,"commentFlagsRemainingToday":10,"maxNestingLevel":3,"hasOptedOut":false,"showCtaUnderComments":false,"containerElementId":"follow-ups-container-33070112","fKey":"d09ecbbe5140a7c1439a7e4020cdd7d76b52d28795a889bb24233842877804f3","questionId":11227809,"questionAuthorId":87234,"answerId":33070112,"answerPositionOnPage":0,"newUiSettings":{"largerFontSize":false},"showFirstTimeCommentingModal":false,"isMentionEnabled":false,"showSpamFlag":true,"mergeUnfriendlyAndRudeFlags":true,"allowRetractingCommentFlags":true,"commentMinLength":15}</script>
    </div>

        </div>
</div>
                                        
<a name="32742980"></a>
<div id="answer-32742980" class="answer js-answer " data-answerid="32742980"
     data-parentid="11227809" data-score="879" data-position-on-page="12"
     data-highest-scored="0"
     data-question-has-accepted-highest-score="1"
     data-author-username="rkachach"
     data-author-reputation="17525"
     data-should-show-copy-button=True
     data-se-share-sheet-license-name="CC BY-SA 3.0"
     data-is-edited="True"
      itemprop="suggestedAnswer"
     itemscope itemtype="https://schema.org/Answer">
        <div class="post-layout ">
                <div class="votecell post-layout--left">
                    
<div class="js-voting-container d-flex jc-center fd-column ai-center gs4 fc-black-300" data-post-id="32742980" data-referrer="None">
        <button class="js-vote-up-btn flex--item s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
                id="upvote-btn-32742980"
                data-controller="s-tooltip"
                data-s-tooltip-placement="right"
                title="This answer is useful"
                aria-pressed="false"
                aria-label="Up vote"
                data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
                data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">
            <svg aria-hidden="true" class="svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg>
        </button>
        <input type="hidden" id="voteUpHash" value="70:3:31e,16:43c6f9929f971c72,10:1771427630,16:29bc5ea494a84c4c,8:32742980,34edd89f3fa9288aac79659028b134d1c3fd6cd31024b3139360aef83f4eba9d" />
        <div class="js-vote-count flex--item d-flex fd-column ai-center fc-theme-body-font fw-bold fs-subheading py4"
             itemprop="upvoteCount"
             data-value="879">
879        </div>
        <button
            class="js-vote-down-btn flex--item mb8 s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
            id=downvote-btn-32742980
            title="This answer is not useful"
            aria-pressed="false"
            aria-label="Down vote"
            data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
            data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">

            <svg aria-hidden="true" class="svg-icon iconArrowDown" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 6h16l-8 8z"/></svg>
        </button>
        <input type="hidden" id="voteDownHash" value="70:3:31e,16:a14368bf2bd5333a,10:1771427630,16:a4965c9b1418c5e7,8:32742980,1351c6296b27546a7c342e93b229a1cf813a86df4e04b8154d4a085aa242b248" />


        
<button class="js-saves-btn s-btn s-btn__unset c-pointer py4"
        type="button"
        id="saves-btn-32742980"
        data-controller="s-tooltip"
        data-s-tooltip-placement="right"
        data-s-popover-placement=""
        title="Save this answer."
        data-is-saved="false"
        aria-label="Save"
        data-post-id="32742980"
        data-post-type-id="2"
        data-user-privilege-for-post-click="0"
        aria-controls=""
        data-s-popover-auto-show="false"
>
    <svg aria-hidden="true" class="fc-theme-primary-400 js-saves-btn-selected d-none svg-icon iconBookmark" width="18" height="18"  viewBox="0 0 18 18"><path  d="M3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
    <svg aria-hidden="true" class="js-saves-btn-unselected svg-icon iconBookmarkAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m9 10.6 4 2.66V3H5v10.26zM3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
</button>







            <div class="js-accepted-answer-indicator flex--item fc-green-400 py6 mtn8 d-none" data-s-tooltip-placement="right" title="Loading when this answer was accepted&#x2026;" tabindex="0" role="note" aria-label="Accepted">
                <div class="ta-center">
                    <svg aria-hidden="true" class="svg-icon iconCheckmarkLg" width="36" height="36"  viewBox="0 0 36 36"><path  d="m6 14 8 8L30 6v8L14 30l-8-8z"/></svg>
                </div>
            </div>
            
<div class="js-bounty-award-container flex--item py4">

    <div class="d-flex fd-column gs4 ai-center">

            <div class="js-bounty-award flex--item s-badge s-badge__bounty s-badge__sm as-center"
                 title="This answer has been awarded bounties worth 100 reputation by ArtEze" data-controller="s-tooltip" data-s-tooltip-placement="right">
                +100
            </div>

    </div>
</div>


    
    <a class="js-post-issue flex--item s-btn s-btn__unset c-pointer py6 mx-auto" href="/posts/32742980/timeline" data-shortcut="T" data-ks-title="timeline" data-controller="s-tooltip" data-s-tooltip-placement="right" title="Show activity on this post." aria-label="Timeline"><svg aria-hidden="true" class="mln2 mr0 svg-icon iconHistory" width="19" height="18"  viewBox="0 0 19 18"><path  d="M3 9a8 8 0 1 1 3.73 6.77L8.2 14.3A6 6 0 1 0 5 9l3.01-.01-4 4-4-4zm7-4h1.01L11 9.36l3.22 2.1-.6.93L10 10z"/></svg></a>

</div>

                </div>

            

<div class="answercell post-layout--right">
    


    <div class="s-prose js-post-body" itemprop="text">
<p>In the same line (I think this was not highlighted by any answer) it's good to mention that sometimes (specially in software where the performance matterslike in the Linux kernel) you can find some if statements like the following:</p>

<pre><code>if (likely( everything_is_ok ))
{
    /* Do something */
}
</code></pre>

<p>or similarly:</p>

<pre><code>if (unlikely(very_improbable_condition))
{
    /* Do something */    
}
</code></pre>

<p>Both <code>likely()</code> and <code>unlikely()</code> are in fact macros that are defined by using something like the GCC's <code>__builtin_expect</code> to help the compiler insert prediction code to favour the condition taking into account the information provided by the user. GCC supports other builtins that could change the behavior of the running program or emit low level instructions like clearing the cache, etc. See <a href="https://gcc.gnu.org/onlinedocs/gcc/Other-Builtins.html" rel="noreferrer">this documentation</a> that goes through the available GCC's builtins.</p>

<p>Normally this kind of optimizations are mainly found in hard-real time applications or embedded systems where execution time matters and it's critical. For example, if you are checking for some error condition that only happens 1/10000000 times, then why not inform the compiler about this? This way, by default, the branch prediction would assume that the condition is false.</p>
    </div>
    <div class="mt24">
        <div class="d-flex fw-wrap ai-start jc-end gs8 gsy">

            <time itemprop="dateCreated" datetime="2015-09-23 14:57:47Z"></time>
            <div class="flex--item mr16" style="flex: 1 1 100px;">
                


<div class="js-post-menu pt2" data-post-id="32742980" data-post-type-id="2">

    <div class="d-flex gs8 s-anchors s-anchors__muted fw-wrap">

        <div class="flex--item">
            <a href="/a/32742980"
               rel="nofollow"
               itemprop="url"
               class="js-share-link js-gps-track"
               title="Short permalink to this answer"
               data-gps-track="post.click({ item: 2, priv: 0, post_type: 2 })"
               data-controller="se-share-sheet"
               data-se-share-sheet-title="Share a link to this answer"
               data-se-share-sheet-subtitle=""
               data-se-share-sheet-post-type="answer"
               data-se-share-sheet-social="facebook twitter devto"
               data-se-share-sheet-location="2"
               data-se-share-sheet-license-url="https%3a%2f%2fcreativecommons.org%2flicenses%2fby-sa%2f3.0%2f"
               data-se-share-sheet-license-name="CC BY-SA 3.0"
               data-s-popover-placement="bottom-start">Share</a>
        </div>


                    <div class="flex--item">
                        <a href="/posts/32742980/edit" class="js-suggest-edit-post js-gps-track" data-gps-track="post.click({ item: 6, priv: 0, post_type: 2 })" title="">Improve this answer</a>
                    </div>

                <div class="flex--item">
                    <button type="button"
                            id="btnFollowPost-32742980" class="s-btn s-btn__link js-follow-post js-follow-answer js-gps-track"
                            data-gps-track="post.click({ item: 14, priv: 0, post_type: 2 })"
                            data-controller="s-tooltip " data-s-tooltip-placement="bottom"
                            data-s-popover-placement="bottom" aria-controls=""
                            title="Follow this answer to receive notifications">
                        Follow
                        <input type="hidden" id="voteFollowHash" value="70:3:31e,16:6848127ffca8eb82,10:1771427630,16:88e07706c796c847,8:32742980,836ca53fd2e0c0533e4cd2eb81fb35fc1e0069e3d1286c2275598c7f873985b7" />
                    </button>
                </div>






    </div>
    <div class="js-menu-popup-container"></div>
</div>
            </div>
            <div class="post-signature flex--item fl0">
<div class="user-info user-hover ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            <a href="/posts/32742980/revisions" title="show all edits to this post"
                         class="js-gps-track"
                         data-gps-track="post.click({ item: 4, priv: 0, post_type: 2 })">edited <span title='2016-10-28 10:28:11Z' class='relativetime'>Oct 28, 2016 at 10:28</span></a>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/1372621/stacked"><div class="gravatar-wrapper-32"><img src="https://i.sstatic.net/0fqUn.jpg?s=64" alt="Stacked&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/1372621/stacked" dir="auto">Stacked</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">7,386</span><span title="7 gold badges" aria-hidden="true"><span class="badge1"></span><span class="badgecount">7</span></span><span class="v-visible-sr">7 gold badges</span><span title="63 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">63</span></span><span class="v-visible-sr">63 silver badges</span><span title="76 bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">76</span></span><span class="v-visible-sr">76 bronze badges</span>
        </div>
    </div>
</div>
            </div>


                <div class="post-signature flex--item fl0">
                    <div class="user-info user-hover ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            answered <span title='2015-09-23 14:57:47Z' class='relativetime'>Sep 23, 2015 at 14:57</span>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/1313233/rkachach"><div class="gravatar-wrapper-32"><img src="https://i.sstatic.net/hBeXC.png?s=64" alt="rkachach&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <a href="/users/1313233/rkachach" itemprop="url" dir="auto">rkachach</a><meta itemprop="name" content="rkachach"/>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 17,525" dir="ltr">17.5k</span><span title="8 gold badges" aria-hidden="true"><span class="badge1"></span><span class="badgecount">8</span></span><span class="v-visible-sr">8 gold badges</span><span title="49 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">49</span></span><span class="v-visible-sr">49 silver badges</span><span title="69 bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">69</span></span><span class="v-visible-sr">69 bronze badges</span>
        </div>
    </div>
</div>


                </div>
        </div>
        
    
    </div>
    
</div>




                

    <div class="post-layout--right">
        

<div id="follow-ups-container-32742980">
    <!--[--><div class="mt16"><div class="mb8 d-flex ai-center g8" role="button" tabindex="0"><h2 class="mb0">Comments</h2> <!--[!--><!--]--></div> <div class="mb12"><!--[!--><button type="button" class="s-btn s-btn__muted s-btn__outlined w100 d-flex ai-center p8 comments-link" data-so-test="parent-answer-32742980"><!--[!--><!--]--> <div class="flex--item ml8"><p class="mb0">Add a comment</p></div></button><!--]--></div> <!--[--><div role="list"><!--[--><!--]--></div> <!--[!--><!--]--><!----><!--]--> <!--[!--><!--]--></div><!--]-->
</div>

<script type="application/json" data-role="module-args" data-module-name="islands/follow-ups/index.mod">{"replies":[],"postId":32742980,"currentUserIsMod":false,"currentUserIsAnonymous":true,"commentFlagsRemainingToday":10,"maxNestingLevel":3,"hasOptedOut":false,"showCtaUnderComments":false,"containerElementId":"follow-ups-container-32742980","fKey":"d09ecbbe5140a7c1439a7e4020cdd7d76b52d28795a889bb24233842877804f3","questionId":11227809,"questionAuthorId":87234,"answerId":32742980,"answerPositionOnPage":0,"newUiSettings":{"largerFontSize":false},"showFirstTimeCommentingModal":false,"isMentionEnabled":false,"showSpamFlag":true,"mergeUnfriendlyAndRudeFlags":true,"allowRetractingCommentFlags":true,"commentMinLength":15}</script>
    </div>

        </div>
</div>
                                        
<a name="33048998"></a>
<div id="answer-33048998" class="answer js-answer " data-answerid="33048998"
     data-parentid="11227809" data-score="851" data-position-on-page="13"
     data-highest-scored="0"
     data-question-has-accepted-highest-score="1"
     data-author-username="Maciej"
     data-author-reputation="9633"
     data-should-show-copy-button=True
     data-se-share-sheet-license-name="CC BY-SA 4.0"
     data-is-edited="True"
      itemprop="suggestedAnswer"
     itemscope itemtype="https://schema.org/Answer">
        <div class="post-layout ">
                <div class="votecell post-layout--left">
                    
<div class="js-voting-container d-flex jc-center fd-column ai-center gs4 fc-black-300" data-post-id="33048998" data-referrer="None">
        <button class="js-vote-up-btn flex--item s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
                id="upvote-btn-33048998"
                data-controller="s-tooltip"
                data-s-tooltip-placement="right"
                title="This answer is useful"
                aria-pressed="false"
                aria-label="Up vote"
                data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
                data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">
            <svg aria-hidden="true" class="svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg>
        </button>
        <input type="hidden" id="voteUpHash" value="70:3:31e,16:864b91bdca432f22,10:1771427630,16:834472d5bf8c3e05,8:33048998,1ca158d725d82bb10dc0248f8cd24cb3f12c228ddc60da672981b7908fc455c3" />
        <div class="js-vote-count flex--item d-flex fd-column ai-center fc-theme-body-font fw-bold fs-subheading py4"
             itemprop="upvoteCount"
             data-value="851">
851        </div>
        <button
            class="js-vote-down-btn flex--item mb8 s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
            id=downvote-btn-33048998
            title="This answer is not useful"
            aria-pressed="false"
            aria-label="Down vote"
            data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
            data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">

            <svg aria-hidden="true" class="svg-icon iconArrowDown" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 6h16l-8 8z"/></svg>
        </button>
        <input type="hidden" id="voteDownHash" value="70:3:31e,16:6c3f515fe03dbc4e,10:1771427630,16:e25da953933e1a13,8:33048998,c4bd4d9ef08aad337ca290acc823cf6e6e421d11809e5918169177ddb3c38b2c" />


        
<button class="js-saves-btn s-btn s-btn__unset c-pointer py4"
        type="button"
        id="saves-btn-33048998"
        data-controller="s-tooltip"
        data-s-tooltip-placement="right"
        data-s-popover-placement=""
        title="Save this answer."
        data-is-saved="false"
        aria-label="Save"
        data-post-id="33048998"
        data-post-type-id="2"
        data-user-privilege-for-post-click="0"
        aria-controls=""
        data-s-popover-auto-show="false"
>
    <svg aria-hidden="true" class="fc-theme-primary-400 js-saves-btn-selected d-none svg-icon iconBookmark" width="18" height="18"  viewBox="0 0 18 18"><path  d="M3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
    <svg aria-hidden="true" class="js-saves-btn-unselected svg-icon iconBookmarkAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m9 10.6 4 2.66V3H5v10.26zM3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
</button>







            <div class="js-accepted-answer-indicator flex--item fc-green-400 py6 mtn8 d-none" data-s-tooltip-placement="right" title="Loading when this answer was accepted&#x2026;" tabindex="0" role="note" aria-label="Accepted">
                <div class="ta-center">
                    <svg aria-hidden="true" class="svg-icon iconCheckmarkLg" width="36" height="36"  viewBox="0 0 36 36"><path  d="m6 14 8 8L30 6v8L14 30l-8-8z"/></svg>
                </div>
            </div>
            
<div class="js-bounty-award-container flex--item py4">

    <div class="d-flex fd-column gs4 ai-center">

            <div class="js-bounty-award flex--item s-badge s-badge__bounty s-badge__sm as-center"
                 title="This answer has been awarded bounties worth 25 reputation by Community" data-controller="s-tooltip" data-s-tooltip-placement="right">
                +25
            </div>

    </div>
</div>


    
    <a class="js-post-issue flex--item s-btn s-btn__unset c-pointer py6 mx-auto" href="/posts/33048998/timeline" data-shortcut="T" data-ks-title="timeline" data-controller="s-tooltip" data-s-tooltip-placement="right" title="Show activity on this post." aria-label="Timeline"><svg aria-hidden="true" class="mln2 mr0 svg-icon iconHistory" width="19" height="18"  viewBox="0 0 19 18"><path  d="M3 9a8 8 0 1 1 3.73 6.77L8.2 14.3A6 6 0 1 0 5 9l3.01-.01-4 4-4-4zm7-4h1.01L11 9.36l3.22 2.1-.6.93L10 10z"/></svg></a>

</div>

                </div>

            

<div class="answercell post-layout--right">
    


    <div class="s-prose js-post-body" itemprop="text">
<p>Frequently used Boolean operations in C++ produce many branches in the compiled program. If these branches are inside loops and are hard to predict they can slow down execution significantly. Boolean variables are stored as 8-bit integers with the value <code>0</code> for <code>false</code> and <code>1</code> for <code>true</code>.</p>

<p>Boolean variables are overdetermined in the sense that all operators that have Boolean variables as input check if the inputs have any other value than <code>0</code> or <code>1</code>, but operators that have Booleans as output can produce no other value than <code>0</code> or <code>1</code>. This makes operations with Boolean variables as input less efficient than necessary.
Consider example:</p>

<pre><code>bool a, b, c, d;
c = a &amp;&amp; b;
d = a || b;
</code></pre>

<p>This is typically implemented by the compiler in the following way:</p>

<pre><code>bool a, b, c, d;
if (a != 0) {
    if (b != 0) {
        c = 1;
    }
    else {
        goto CFALSE;
    }
}
else {
    CFALSE:
    c = 0;
}
if (a == 0) {
    if (b == 0) {
        d = 0;
    }
    else {
        goto DTRUE;
    }
}
else {
    DTRUE:
    d = 1;
}
</code></pre>

<p>This code is far from optimal. The branches may take a long time in case of mispredictions. The Boolean operations can be made much more efficient if it is known with certainty that the operands have no other values than <code>0</code> and <code>1</code>. The reason why the compiler does not make such an assumption is that the variables might have other values if they are uninitialized or come from unknown sources. The above code can be optimized if <code>a</code> and <code>b</code> has been initialized to valid values or if they come from operators that produce Boolean output. The optimized code looks like this:</p>

<pre><code>char a = 0, b = 1, c, d;
c = a &amp; b;
d = a | b;
</code></pre>

<p><code>char</code> is used instead of <code>bool</code> in order to make it possible to use the bitwise operators (<code>&amp;</code> and <code>|</code>) instead of the Boolean operators (<code>&amp;&amp;</code> and <code>||</code>). The bitwise operators are single instructions that take only one clock cycle. The OR operator (<code>|</code>) works even if <code>a</code> and <code>b</code> have other values than <code>0</code> or <code>1</code>. The AND operator (<code>&amp;</code>) and the EXCLUSIVE OR operator (<code>^</code>) may give inconsistent results if the operands have other values than <code>0</code> and <code>1</code>.</p>

<p><code>~</code> can not be used for NOT. Instead, you can make a Boolean NOT on a variable which is known to be <code>0</code> or <code>1</code> by XOR'ing it with <code>1</code>:</p>

<pre><code>bool a, b;
b = !a;
</code></pre>

<p>can be optimized to:</p>

<pre><code>char a = 0, b;
b = a ^ 1;
</code></pre>

<p><code>a &amp;&amp; b</code> cannot be replaced with <code>a &amp; b</code> if <code>b</code> is an expression that should not be evaluated if <code>a</code> is <code>false</code> ( <code>&amp;&amp;</code> will not evaluate <code>b</code>, <code>&amp;</code> will). Likewise, <code>a || b</code> can not be replaced with <code>a | b</code> if <code>b</code> is an expression that should not be evaluated if <code>a</code> is <code>true</code>.</p>

<p>Using bitwise operators is more advantageous if the operands are variables than if the operands are comparisons:</p>

<pre><code>bool a; double x, y, z;
a = x &gt; y &amp;&amp; z &lt; 5.0;
</code></pre>

<p>is optimal in most cases (unless you expect the <code>&amp;&amp;</code> expression to generate many branch mispredictions).</p>
    </div>
    <div class="mt24">
        <div class="d-flex fw-wrap ai-start jc-end gs8 gsy">

            <time itemprop="dateCreated" datetime="2015-10-10 00:30:42Z"></time>
            <div class="flex--item mr16" style="flex: 1 1 100px;">
                


<div class="js-post-menu pt2" data-post-id="33048998" data-post-type-id="2">

    <div class="d-flex gs8 s-anchors s-anchors__muted fw-wrap">

        <div class="flex--item">
            <a href="/a/33048998"
               rel="nofollow"
               itemprop="url"
               class="js-share-link js-gps-track"
               title="Short permalink to this answer"
               data-gps-track="post.click({ item: 2, priv: 0, post_type: 2 })"
               data-controller="se-share-sheet"
               data-se-share-sheet-title="Share a link to this answer"
               data-se-share-sheet-subtitle=""
               data-se-share-sheet-post-type="answer"
               data-se-share-sheet-social="facebook twitter devto"
               data-se-share-sheet-location="2"
               data-se-share-sheet-license-url="https%3a%2f%2fcreativecommons.org%2flicenses%2fby-sa%2f4.0%2f"
               data-se-share-sheet-license-name="CC BY-SA 4.0"
               data-s-popover-placement="bottom-start">Share</a>
        </div>


                    <div class="flex--item">
                        <a href="/posts/33048998/edit" class="js-suggest-edit-post js-gps-track" data-gps-track="post.click({ item: 6, priv: 0, post_type: 2 })" title="">Improve this answer</a>
                    </div>

                <div class="flex--item">
                    <button type="button"
                            id="btnFollowPost-33048998" class="s-btn s-btn__link js-follow-post js-follow-answer js-gps-track"
                            data-gps-track="post.click({ item: 14, priv: 0, post_type: 2 })"
                            data-controller="s-tooltip " data-s-tooltip-placement="bottom"
                            data-s-popover-placement="bottom" aria-controls=""
                            title="Follow this answer to receive notifications">
                        Follow
                        <input type="hidden" id="voteFollowHash" value="70:3:31e,16:0169160096d7e7ea,10:1771427630,16:da167ac5cef5876a,8:33048998,114794eacfbcabcd1ea337c32f95d354a2722f203478f04c1870eb3d3fae1d46" />
                    </button>
                </div>






    </div>
    <div class="js-menu-popup-container"></div>
</div>
            </div>
            <div class="post-signature flex--item fl0">
<div class="user-info user-hover ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            <a href="/posts/33048998/revisions" title="show all edits to this post"
                         class="js-gps-track"
                         data-gps-track="post.click({ item: 4, priv: 0, post_type: 2 })">edited <span title='2019-05-30 16:34:26Z' class='relativetime'>May 30, 2019 at 16:34</span></a>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/7405477/sujal-patel"><div class="gravatar-wrapper-32"><img src="https://i.sstatic.net/0IrqS.jpg?s=64" alt="Sujal Patel&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/7405477/sujal-patel" dir="auto">Sujal Patel</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">2,540</span><span title="2 gold badges" aria-hidden="true"><span class="badge1"></span><span class="badgecount">2</span></span><span class="v-visible-sr">2 gold badges</span><span title="22 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">22</span></span><span class="v-visible-sr">22 silver badges</span><span title="40 bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">40</span></span><span class="v-visible-sr">40 bronze badges</span>
        </div>
    </div>
</div>
            </div>


                <div class="post-signature flex--item fl0">
                    <div class="user-info ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            answered <span title='2015-10-10 00:30:42Z' class='relativetime'>Oct 10, 2015 at 0:30</span>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/4895229/maciej"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/b45e17c035c3b5a8110f3ff7a4add638?s=64&amp;d=identicon&amp;r=PG&amp;f=y&amp;so-version=2" alt="Maciej&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <a href="/users/4895229/maciej" itemprop="url" dir="auto">Maciej</a><meta itemprop="name" content="Maciej"/>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">9,633</span><span title="2 gold badges" aria-hidden="true"><span class="badge1"></span><span class="badgecount">2</span></span><span class="v-visible-sr">2 gold badges</span><span title="18 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">18</span></span><span class="v-visible-sr">18 silver badges</span><span title="18 bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">18</span></span><span class="v-visible-sr">18 bronze badges</span>
        </div>
    </div>
</div>


                </div>
        </div>
        
    
    </div>
    
</div>




                

    <div class="post-layout--right">
        

<div id="follow-ups-container-33048998">
    <!--[--><div class="mt16"><div class="mb8 d-flex ai-center g8" role="button" tabindex="0"><h2 class="mb0">Comments</h2> <!--[!--><!--]--></div> <div class="mb12"><!--[!--><button type="button" class="s-btn s-btn__muted s-btn__outlined w100 d-flex ai-center p8 comments-link" data-so-test="parent-answer-33048998"><!--[!--><!--]--> <div class="flex--item ml8"><p class="mb0">Add a comment</p></div></button><!--]--></div> <!--[--><div role="list"><!--[--><!--]--></div> <!--[!--><!--]--><!----><!--]--> <!--[!--><!--]--></div><!--]-->
</div>

<script type="application/json" data-role="module-args" data-module-name="islands/follow-ups/index.mod">{"replies":[],"postId":33048998,"currentUserIsMod":false,"currentUserIsAnonymous":true,"commentFlagsRemainingToday":10,"maxNestingLevel":3,"hasOptedOut":false,"showCtaUnderComments":false,"containerElementId":"follow-ups-container-33048998","fKey":"d09ecbbe5140a7c1439a7e4020cdd7d76b52d28795a889bb24233842877804f3","questionId":11227809,"questionAuthorId":87234,"answerId":33048998,"answerPositionOnPage":0,"newUiSettings":{"largerFontSize":false},"showFirstTimeCommentingModal":false,"isMentionEnabled":false,"showSpamFlag":true,"mergeUnfriendlyAndRudeFlags":true,"allowRetractingCommentFlags":true,"commentMinLength":15}</script>
    </div>

        </div>
</div>
                                        
<a name="44614591"></a>
<div id="answer-44614591" class="answer js-answer " data-answerid="44614591"
     data-parentid="11227809" data-score="513" data-position-on-page="14"
     data-highest-scored="0"
     data-question-has-accepted-highest-score="1"
     data-author-username="Alireza"
     data-author-reputation="105510"
     data-should-show-copy-button=True
     data-se-share-sheet-license-name="CC BY-SA 4.0"
     data-is-edited="True"
      itemprop="suggestedAnswer"
     itemscope itemtype="https://schema.org/Answer">
        <div class="post-layout ">
                <div class="votecell post-layout--left">
                    
<div class="js-voting-container d-flex jc-center fd-column ai-center gs4 fc-black-300" data-post-id="44614591" data-referrer="None">
        <button class="js-vote-up-btn flex--item s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
                id="upvote-btn-44614591"
                data-controller="s-tooltip"
                data-s-tooltip-placement="right"
                title="This answer is useful"
                aria-pressed="false"
                aria-label="Up vote"
                data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
                data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">
            <svg aria-hidden="true" class="svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg>
        </button>
        <input type="hidden" id="voteUpHash" value="70:3:31e,16:a395074a87dbe13f,10:1771427630,16:752fcac8a4836190,8:44614591,59665e569e3cdfef13a2f300cd242eb48138c2348701b75c7b01d4e900fb0176" />
        <div class="js-vote-count flex--item d-flex fd-column ai-center fc-theme-body-font fw-bold fs-subheading py4"
             itemprop="upvoteCount"
             data-value="513">
513        </div>
        <button
            class="js-vote-down-btn flex--item mb8 s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
            id=downvote-btn-44614591
            title="This answer is not useful"
            aria-pressed="false"
            aria-label="Down vote"
            data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
            data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">

            <svg aria-hidden="true" class="svg-icon iconArrowDown" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 6h16l-8 8z"/></svg>
        </button>
        <input type="hidden" id="voteDownHash" value="70:3:31e,16:6c8ea50e72658b9b,10:1771427630,16:1a1b0d61789616e4,8:44614591,ed2b0832ffb6cddeac8776b4687ce740b41a97a4a81458e750de08d0f6780157" />


        
<button class="js-saves-btn s-btn s-btn__unset c-pointer py4"
        type="button"
        id="saves-btn-44614591"
        data-controller="s-tooltip"
        data-s-tooltip-placement="right"
        data-s-popover-placement=""
        title="Save this answer."
        data-is-saved="false"
        aria-label="Save"
        data-post-id="44614591"
        data-post-type-id="2"
        data-user-privilege-for-post-click="0"
        aria-controls=""
        data-s-popover-auto-show="false"
>
    <svg aria-hidden="true" class="fc-theme-primary-400 js-saves-btn-selected d-none svg-icon iconBookmark" width="18" height="18"  viewBox="0 0 18 18"><path  d="M3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
    <svg aria-hidden="true" class="js-saves-btn-unselected svg-icon iconBookmarkAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m9 10.6 4 2.66V3H5v10.26zM3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
</button>







            <div class="js-accepted-answer-indicator flex--item fc-green-400 py6 mtn8 d-none" data-s-tooltip-placement="right" title="Loading when this answer was accepted&#x2026;" tabindex="0" role="note" aria-label="Accepted">
                <div class="ta-center">
                    <svg aria-hidden="true" class="svg-icon iconCheckmarkLg" width="36" height="36"  viewBox="0 0 36 36"><path  d="m6 14 8 8L30 6v8L14 30l-8-8z"/></svg>
                </div>
            </div>

    
    <a class="js-post-issue flex--item s-btn s-btn__unset c-pointer py6 mx-auto" href="/posts/44614591/timeline" data-shortcut="T" data-ks-title="timeline" data-controller="s-tooltip" data-s-tooltip-placement="right" title="Show activity on this post." aria-label="Timeline"><svg aria-hidden="true" class="mln2 mr0 svg-icon iconHistory" width="19" height="18"  viewBox="0 0 19 18"><path  d="M3 9a8 8 0 1 1 3.73 6.77L8.2 14.3A6 6 0 1 0 5 9l3.01-.01-4 4-4-4zm7-4h1.01L11 9.36l3.22 2.1-.6.93L10 10z"/></svg></a>

</div>

                </div>

            

<div class="answercell post-layout--right">
    


    <div class="s-prose js-post-body" itemprop="text">
<p>That's for sure!...</p>
<p><strong>Branch prediction</strong> makes the logic run slower, because of the switching which happens in your code! It's like you are going a straight street or a street with a lot of turnings, for sure the straight one is going to be done quicker!...</p>
<p>If the array is sorted, your condition is false at the first step: <code>data[c] &gt;= 128</code>, then becomes a true value for the whole way to the end of the street. That's how you get to the end of the logic faster. On the other hand, using an unsorted array, you need a lot of turning and processing which make your code run slower for sure...</p>
<p>Look at the image I created for you below. Which street is going to be finished faster?</p>
<p><a href="https://i.sstatic.net/cSmCa.jpg" rel="noreferrer"><img src="https://i.sstatic.net/cSmCa.jpg" alt="Branch Prediction" /></a></p>
<p>So programmatically, <strong>branch prediction</strong> causes the process to be slower...</p>
<p>Also at the end, it's good to know we have two kinds of branch predictions that each is going to affect your code differently:</p>
<p><strong>1. Static</strong></p>
<p><strong>2. Dynamic</strong></p>
<p><a href="https://i.sstatic.net/ZfhDu.jpg" rel="noreferrer"><img src="https://i.sstatic.net/ZfhDu.jpg" alt="Branch Prediction" /></a></p>
<p>See also <a href="https://web.archive.org/web/20100315172026/http://software.intel.com/en-us/articles/branch-and-loop-reorganization-to-prevent-mispredicts/" rel="noreferrer">this document from Intel</a>, which says:</p>
<blockquote>
<p>Static branch prediction is used by the microprocessor the first time
a conditional branch is encountered, and dynamic branch prediction is
used for succeeding executions of the conditional branch code.</p>
<p>In order to effectively write your code to take advantage of these
rules, when writing <strong>if-else</strong> or <strong>switch</strong> statements, check the most
common cases first and work progressively down to the least common.
Loops do not necessarily require any special ordering of code for
static branch prediction, as only the condition of the loop iterator
is normally used.</p>
</blockquote>
    </div>
    <div class="mt24">
        <div class="d-flex fw-wrap ai-start jc-end gs8 gsy">

            <time itemprop="dateCreated" datetime="2017-06-18 11:40:43Z"></time>
            <div class="flex--item mr16" style="flex: 1 1 100px;">
                


<div class="js-post-menu pt2" data-post-id="44614591" data-post-type-id="2">

    <div class="d-flex gs8 s-anchors s-anchors__muted fw-wrap">

        <div class="flex--item">
            <a href="/a/44614591"
               rel="nofollow"
               itemprop="url"
               class="js-share-link js-gps-track"
               title="Short permalink to this answer"
               data-gps-track="post.click({ item: 2, priv: 0, post_type: 2 })"
               data-controller="se-share-sheet"
               data-se-share-sheet-title="Share a link to this answer"
               data-se-share-sheet-subtitle=""
               data-se-share-sheet-post-type="answer"
               data-se-share-sheet-social="facebook twitter devto"
               data-se-share-sheet-location="2"
               data-se-share-sheet-license-url="https%3a%2f%2fcreativecommons.org%2flicenses%2fby-sa%2f4.0%2f"
               data-se-share-sheet-license-name="CC BY-SA 4.0"
               data-s-popover-placement="bottom-start">Share</a>
        </div>


                    <div class="flex--item">
                        <a href="/posts/44614591/edit" class="js-suggest-edit-post js-gps-track" data-gps-track="post.click({ item: 6, priv: 0, post_type: 2 })" title="">Improve this answer</a>
                    </div>

                <div class="flex--item">
                    <button type="button"
                            id="btnFollowPost-44614591" class="s-btn s-btn__link js-follow-post js-follow-answer js-gps-track"
                            data-gps-track="post.click({ item: 14, priv: 0, post_type: 2 })"
                            data-controller="s-tooltip " data-s-tooltip-placement="bottom"
                            data-s-popover-placement="bottom" aria-controls=""
                            title="Follow this answer to receive notifications">
                        Follow
                        <input type="hidden" id="voteFollowHash" value="70:3:31e,16:9d98654d11b4daa9,10:1771427630,16:229e1aa3ef405990,8:44614591,c8b97304743b403a51995dd2944809ec993e9c05a6604eb9317c26228cbf193b" />
                    </button>
                </div>






    </div>
    <div class="js-menu-popup-container"></div>
</div>
            </div>
            <div class="post-signature flex--item fl0">
<div class="user-info user-hover ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            <a href="/posts/44614591/revisions" title="show all edits to this post"
                         class="js-gps-track"
                         data-gps-track="post.click({ item: 4, priv: 0, post_type: 2 })">edited <span title='2023-05-10 17:27:53Z' class='relativetime'>May 10, 2023 at 17:27</span></a>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/1255289/miken32"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/5ed02658b2440179f00eeff8beb7aa4c?s=64&amp;d=identicon&amp;r=PG" alt="miken32&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/1255289/miken32" dir="auto">miken32</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 42,503" dir="ltr">42.5k</span><span title="16 gold badges" aria-hidden="true"><span class="badge1"></span><span class="badgecount">16</span></span><span class="v-visible-sr">16 gold badges</span><span title="127 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">127</span></span><span class="v-visible-sr">127 silver badges</span><span title="178 bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">178</span></span><span class="v-visible-sr">178 bronze badges</span>
        </div>
    </div>
</div>
            </div>


                <div class="post-signature flex--item fl0">
                    <div class="user-info user-hover ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            answered <span title='2017-06-18 11:40:43Z' class='relativetime'>Jun 18, 2017 at 11:40</span>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/5423108/alireza"><div class="gravatar-wrapper-32"><img src="https://i.sstatic.net/WtfBG.png?s=64" alt="Alireza&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <a href="/users/5423108/alireza" itemprop="url" dir="auto">Alireza</a><meta itemprop="name" content="Alireza"/>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 105,510" dir="ltr">106k</span><span title="27 gold badges" aria-hidden="true"><span class="badge1"></span><span class="badgecount">27</span></span><span class="v-visible-sr">27 gold badges</span><span title="280 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">280</span></span><span class="v-visible-sr">280 silver badges</span><span title="173 bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">173</span></span><span class="v-visible-sr">173 bronze badges</span>
        </div>
    </div>
</div>


                </div>
        </div>
        
    
    </div>
    
</div>




                

    <div class="post-layout--right">
        

<div id="follow-ups-container-44614591">
    <!--[--><div class="mt16"><div class="mb8 d-flex ai-center g8" role="button" tabindex="0"><h2 class="mb0">Comments</h2> <!--[!--><!--]--></div> <div class="mb12"><!--[!--><button type="button" class="s-btn s-btn__muted s-btn__outlined w100 d-flex ai-center p8 comments-link" data-so-test="parent-answer-44614591"><!--[!--><!--]--> <div class="flex--item ml8"><p class="mb0">Add a comment</p></div></button><!--]--></div> <!--[--><div role="list"><!--[--><!--]--></div> <!--[!--><!--]--><!----><!--]--> <!--[!--><!--]--></div><!--]-->
</div>

<script type="application/json" data-role="module-args" data-module-name="islands/follow-ups/index.mod">{"replies":[],"postId":44614591,"currentUserIsMod":false,"currentUserIsAnonymous":true,"commentFlagsRemainingToday":10,"maxNestingLevel":3,"hasOptedOut":false,"showCtaUnderComments":false,"containerElementId":"follow-ups-container-44614591","fKey":"d09ecbbe5140a7c1439a7e4020cdd7d76b52d28795a889bb24233842877804f3","questionId":11227809,"questionAuthorId":87234,"answerId":44614591,"answerPositionOnPage":0,"newUiSettings":{"largerFontSize":false},"showFirstTimeCommentingModal":false,"isMentionEnabled":false,"showSpamFlag":true,"mergeUnfriendlyAndRudeFlags":true,"allowRetractingCommentFlags":true,"commentMinLength":15}</script>
    </div>

        </div>
</div>
                                        
<a name="41603849"></a>
<div id="answer-41603849" class="answer js-answer " data-answerid="41603849"
     data-parentid="11227809" data-score="463" data-position-on-page="15"
     data-highest-scored="0"
     data-question-has-accepted-highest-score="1"
     data-author-username="ForeverLearning"
     data-author-reputation="6745"
     data-should-show-copy-button=True
     data-se-share-sheet-license-name="CC BY-SA 4.0"
     data-is-edited="True"
      itemprop="suggestedAnswer"
     itemscope itemtype="https://schema.org/Answer">
        <div class="post-layout ">
                <div class="votecell post-layout--left">
                    
<div class="js-voting-container d-flex jc-center fd-column ai-center gs4 fc-black-300" data-post-id="41603849" data-referrer="None">
        <button class="js-vote-up-btn flex--item s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
                id="upvote-btn-41603849"
                data-controller="s-tooltip"
                data-s-tooltip-placement="right"
                title="This answer is useful"
                aria-pressed="false"
                aria-label="Up vote"
                data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
                data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">
            <svg aria-hidden="true" class="svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg>
        </button>
        <input type="hidden" id="voteUpHash" value="70:3:31e,16:ff735adb71af8bd1,10:1771427630,16:e1f033506e8637d5,8:41603849,98dbc02223f61302d5fb39405c9bc30c07d128c701c20f105f7d80af58a62547" />
        <div class="js-vote-count flex--item d-flex fd-column ai-center fc-theme-body-font fw-bold fs-subheading py4"
             itemprop="upvoteCount"
             data-value="463">
463        </div>
        <button
            class="js-vote-down-btn flex--item mb8 s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
            id=downvote-btn-41603849
            title="This answer is not useful"
            aria-pressed="false"
            aria-label="Down vote"
            data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
            data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">

            <svg aria-hidden="true" class="svg-icon iconArrowDown" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 6h16l-8 8z"/></svg>
        </button>
        <input type="hidden" id="voteDownHash" value="70:3:31e,16:4464191d8424635a,10:1771427630,16:58b83282aea50f98,8:41603849,633c57c057e55afd6de065cab57a1f16855364944bb998206970d3f7a86bafb8" />


        
<button class="js-saves-btn s-btn s-btn__unset c-pointer py4"
        type="button"
        id="saves-btn-41603849"
        data-controller="s-tooltip"
        data-s-tooltip-placement="right"
        data-s-popover-placement=""
        title="Save this answer."
        data-is-saved="false"
        aria-label="Save"
        data-post-id="41603849"
        data-post-type-id="2"
        data-user-privilege-for-post-click="0"
        aria-controls=""
        data-s-popover-auto-show="false"
>
    <svg aria-hidden="true" class="fc-theme-primary-400 js-saves-btn-selected d-none svg-icon iconBookmark" width="18" height="18"  viewBox="0 0 18 18"><path  d="M3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
    <svg aria-hidden="true" class="js-saves-btn-unselected svg-icon iconBookmarkAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m9 10.6 4 2.66V3H5v10.26zM3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
</button>







            <div class="js-accepted-answer-indicator flex--item fc-green-400 py6 mtn8 d-none" data-s-tooltip-placement="right" title="Loading when this answer was accepted&#x2026;" tabindex="0" role="note" aria-label="Accepted">
                <div class="ta-center">
                    <svg aria-hidden="true" class="svg-icon iconCheckmarkLg" width="36" height="36"  viewBox="0 0 36 36"><path  d="m6 14 8 8L30 6v8L14 30l-8-8z"/></svg>
                </div>
            </div>

    
    <a class="js-post-issue flex--item s-btn s-btn__unset c-pointer py6 mx-auto" href="/posts/41603849/timeline" data-shortcut="T" data-ks-title="timeline" data-controller="s-tooltip" data-s-tooltip-placement="right" title="Show activity on this post." aria-label="Timeline"><svg aria-hidden="true" class="mln2 mr0 svg-icon iconHistory" width="19" height="18"  viewBox="0 0 19 18"><path  d="M3 9a8 8 0 1 1 3.73 6.77L8.2 14.3A6 6 0 1 0 5 9l3.01-.01-4 4-4-4zm7-4h1.01L11 9.36l3.22 2.1-.6.93L10 10z"/></svg></a>

</div>

                </div>

            

<div class="answercell post-layout--right">
    


    <div class="s-prose js-post-body" itemprop="text">
<p>This question has already been answered excellently many times over. Still I'd like to draw the group's attention to yet another interesting analysis.</p>
<p>Recently this example (modified very slightly) was also used as a way to demonstrate how a piece of code can be profiled within the program itself on Windows. Along the way, the author also shows how to use the results to determine where the code is spending most of its time in both the sorted &amp; unsorted case. Finally the piece also shows how to use a little known feature of the HAL (Hardware Abstraction Layer) to determine just how much branch misprediction is happening in the unsorted case.</p>
<p>The link is here:
<a href="//www.geoffchappell.com/studies/windows/km/ntoskrnl/api/ex/profile/demo.htm" rel="noreferrer"><strong>A Demonstration of Self-Profiling</strong></a></p>
    </div>
    <div class="mt24">
        <div class="d-flex fw-wrap ai-start jc-end gs8 gsy">

            <time itemprop="dateCreated" datetime="2017-01-12 01:50:28Z"></time>
            <div class="flex--item mr16" style="flex: 1 1 100px;">
                


<div class="js-post-menu pt2" data-post-id="41603849" data-post-type-id="2">

    <div class="d-flex gs8 s-anchors s-anchors__muted fw-wrap">

        <div class="flex--item">
            <a href="/a/41603849"
               rel="nofollow"
               itemprop="url"
               class="js-share-link js-gps-track"
               title="Short permalink to this answer"
               data-gps-track="post.click({ item: 2, priv: 0, post_type: 2 })"
               data-controller="se-share-sheet"
               data-se-share-sheet-title="Share a link to this answer"
               data-se-share-sheet-subtitle=""
               data-se-share-sheet-post-type="answer"
               data-se-share-sheet-social="facebook twitter devto"
               data-se-share-sheet-location="2"
               data-se-share-sheet-license-url="https%3a%2f%2fcreativecommons.org%2flicenses%2fby-sa%2f4.0%2f"
               data-se-share-sheet-license-name="CC BY-SA 4.0"
               data-s-popover-placement="bottom-start">Share</a>
        </div>


                    <div class="flex--item">
                        <a href="/posts/41603849/edit" class="js-suggest-edit-post js-gps-track" data-gps-track="post.click({ item: 6, priv: 0, post_type: 2 })" title="">Improve this answer</a>
                    </div>

                <div class="flex--item">
                    <button type="button"
                            id="btnFollowPost-41603849" class="s-btn s-btn__link js-follow-post js-follow-answer js-gps-track"
                            data-gps-track="post.click({ item: 14, priv: 0, post_type: 2 })"
                            data-controller="s-tooltip " data-s-tooltip-placement="bottom"
                            data-s-popover-placement="bottom" aria-controls=""
                            title="Follow this answer to receive notifications">
                        Follow
                        <input type="hidden" id="voteFollowHash" value="70:3:31e,16:5a7e801ad1f972fb,10:1771427630,16:7a0c5e536452048a,8:41603849,0a7ae620090af70fe9d0a1fdd04c7f3043b9939f61eca86820b1a1c0c7be40b5" />
                    </button>
                </div>






    </div>
    <div class="js-menu-popup-container"></div>
</div>
            </div>
            <div class="post-signature flex--item fl0">
<div class="user-info ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            <a href="/posts/41603849/revisions" title="show all edits to this post"
                         class="js-gps-track"
                         data-gps-track="post.click({ item: 4, priv: 0, post_type: 2 })">edited <span title='2021-01-10 15:50:40Z' class='relativetime'>Jan 10, 2021 at 15:50</span></a>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/3204551/deduplicator"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/0a3ee6bc4b5927b369b8c8220586913a?s=64&amp;d=identicon&amp;r=PG&amp;f=y&amp;so-version=2" alt="Deduplicator&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/3204551/deduplicator" dir="auto">Deduplicator</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 45,989" dir="ltr">46k</span><span title="7 gold badges" aria-hidden="true"><span class="badge1"></span><span class="badgecount">7</span></span><span class="v-visible-sr">7 gold badges</span><span title="75 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">75</span></span><span class="v-visible-sr">75 silver badges</span><span title="125 bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">125</span></span><span class="v-visible-sr">125 bronze badges</span>
        </div>
    </div>
</div>
            </div>


                <div class="post-signature flex--item fl0">
                    <div class="user-info ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            answered <span title='2017-01-12 01:50:28Z' class='relativetime'>Jan 12, 2017 at 1:50</span>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/601567/foreverlearning"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/354e6825881d0dbb29130bdd4c0e560e?s=64&amp;d=identicon&amp;r=PG" alt="ForeverLearning&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <a href="/users/601567/foreverlearning" itemprop="url" dir="auto">ForeverLearning</a><meta itemprop="name" content="ForeverLearning"/>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">6,745</span><span title="4 gold badges" aria-hidden="true"><span class="badge1"></span><span class="badgecount">4</span></span><span class="v-visible-sr">4 gold badges</span><span title="31 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">31</span></span><span class="v-visible-sr">31 silver badges</span><span title="40 bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">40</span></span><span class="v-visible-sr">40 bronze badges</span>
        </div>
    </div>
</div>


                </div>
        </div>
        
    
    </div>
    
</div>




                

    <div class="post-layout--right">
        

<div id="follow-ups-container-41603849">
    <!--[--><div class="mt16"><div class="mb8 d-flex ai-center g8 c-pointer" role="button" tabindex="0"><h2 class="mb0">2 Comments</h2> <!--[--><!--[--><!----><svg aria-hidden="true" class="svg-icon iconArrowDownAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m16.01 7.43-1.4-1.41L9 11.6 3.42 6l-1.4 1.42 7 7z"/></svg><!----><!--]--><!--]--></div> <div class="mb12"><!--[!--><button type="button" class="s-btn s-btn__muted s-btn__outlined w100 d-flex ai-center p8 comments-link" data-so-test="parent-answer-41603849"><!--[!--><!--]--> <div class="flex--item ml8"><p class="mb0">Add a comment</p></div></button><!--]--></div> <!--[--><div role="list"><!--[--><div id="follow-up-85643214" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/63550/peter-mortensen" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://i.sstatic.net/RIZKi.png?s=64" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Peter Mortensen</div> <div class="s-user-card--awards"><!--[--><a href="/users/63550/peter-mortensen" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Peter Mortensen</a><!--]--> <a class="comment-link" href="#comment85643214_41603849"><time title="2018-03-16T12:47:19.543Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->That is a very interesting article (in fact, I have just read all of it), but how does it answer the question?<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2018-03-16T12:47:19.543Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-85643214"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">8</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-85643214"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-85643214" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-85643214"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-85643214" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-85650402" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/601567/foreverlearning" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://www.gravatar.com/avatar/354e6825881d0dbb29130bdd4c0e560e?s=48&amp;d=identicon&amp;r=PG" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">ForeverLearning</div> <div class="s-user-card--awards"><!--[--><a href="/users/601567/foreverlearning" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">ForeverLearning</a><!--]--> <a class="comment-link" href="#comment85650402_41603849"><time title="2018-03-16T15:37:16.81Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->@PeterMortensen I am a bit flummoxed by your question. For example here is one relevant line from that piece:  <code>When the input is unsorted, all the rest of the loop takes substantial time. But with sorted input, the processor is somehow able to spend not just less time in the body of the loop, meaning the buckets at offsets 0x18 and 0x1C, but vanishingly little time on the mechanism of looping.</code>  Author is trying to discuss profiling in the context of code posted here and in the process trying to explain why the sorted case is so much more faster.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2018-03-16T15:37:16.81Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-85650402"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">7</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-85650402"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-85650402" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-85650402"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-85650402" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><!--]--></div> <!--[!--><!--]--><!----><!--]--> <!--[!--><!--]--></div><!--]-->
</div>

<script type="application/json" data-role="module-args" data-module-name="islands/follow-ups/index.mod">{"replies":[{"id":85643214,"user":{"userId":63550,"isDeleted":false,"displayName":"Peter Mortensen","url":"/users/63550/peter-mortensen","profileImageUrl":"https://i.sstatic.net/RIZKi.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"PeterMortensen","noSpacesUserName":"PeterMortensen","reputationDisplayText":"0"},"postedAt":"2018-03-16T12:47:19.543Z","postedAtRelative":"Over a year ago","body":"That is a very interesting article (in fact, I have just read all of it), but how does it answer the question?","htmlBody":"That is a very interesting article (in fact, I have just read all of it), but how does it answer the question?","score":8,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":85650402,"user":{"userId":601567,"isDeleted":false,"displayName":"ForeverLearning","url":"/users/601567/foreverlearning","profileImageUrl":"https://www.gravatar.com/avatar/354e6825881d0dbb29130bdd4c0e560e?s=48\u0026d=identicon\u0026r=PG","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"ForeverLearning","noSpacesUserName":"ForeverLearning","reputationDisplayText":"0"},"postedAt":"2018-03-16T15:37:16.81Z","postedAtRelative":"Over a year ago","body":"@PeterMortensen I am a bit flummoxed by your question. For example here is one relevant line from that piece:\n\n\u0060When the input is unsorted, all the rest of the loop takes substantial time. But with sorted input, the processor is somehow able to spend not just less time in the body of the loop, meaning the buckets at offsets 0x18 and 0x1C, but vanishingly little time on the mechanism of looping.\u0060\n\nAuthor is trying to discuss profiling in the context of code posted here and in the process trying to explain why the sorted case is so much more faster.","htmlBody":"@PeterMortensen I am a bit flummoxed by your question. For example here is one relevant line from that piece:  \u003Ccode\u003EWhen the input is unsorted, all the rest of the loop takes substantial time. But with sorted input, the processor is somehow able to spend not just less time in the body of the loop, meaning the buckets at offsets 0x18 and 0x1C, but vanishingly little time on the mechanism of looping.\u003C/code\u003E  Author is trying to discuss profiling in the context of code posted here and in the process trying to explain why the sorted case is so much more faster.","score":7,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":true,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true}],"postId":41603849,"currentUserIsMod":false,"currentUserIsAnonymous":true,"commentFlagsRemainingToday":10,"maxNestingLevel":3,"hasOptedOut":false,"showCtaUnderComments":false,"containerElementId":"follow-ups-container-41603849","fKey":"d09ecbbe5140a7c1439a7e4020cdd7d76b52d28795a889bb24233842877804f3","questionId":11227809,"questionAuthorId":87234,"answerId":41603849,"answerPositionOnPage":0,"newUiSettings":{"largerFontSize":false},"showFirstTimeCommentingModal":false,"isMentionEnabled":false,"showSpamFlag":true,"mergeUnfriendlyAndRudeFlags":true,"allowRetractingCommentFlags":true,"commentMinLength":15}</script>
    </div>

        </div>
</div>
                                        
<a name="47141245"></a>
<div id="answer-47141245" class="answer js-answer " data-answerid="47141245"
     data-parentid="11227809" data-score="421" data-position-on-page="16"
     data-highest-scored="0"
     data-question-has-accepted-highest-score="1"
     data-author-username="Eugene"
     data-author-reputation="11175"
     data-should-show-copy-button=True
     data-se-share-sheet-license-name="CC BY-SA 4.0"
     data-is-edited="True"
      itemprop="suggestedAnswer"
     itemscope itemtype="https://schema.org/Answer">
        <div class="post-layout ">
                <div class="votecell post-layout--left">
                    
<div class="js-voting-container d-flex jc-center fd-column ai-center gs4 fc-black-300" data-post-id="47141245" data-referrer="None">
        <button class="js-vote-up-btn flex--item s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
                id="upvote-btn-47141245"
                data-controller="s-tooltip"
                data-s-tooltip-placement="right"
                title="This answer is useful"
                aria-pressed="false"
                aria-label="Up vote"
                data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
                data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">
            <svg aria-hidden="true" class="svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg>
        </button>
        <input type="hidden" id="voteUpHash" value="70:3:31e,16:50f3802a9890a703,10:1771427630,16:d8f3f0a4088144cb,8:47141245,a616d66143262c52d3567508e3fae96418616fcad228d9e77236850aec219044" />
        <div class="js-vote-count flex--item d-flex fd-column ai-center fc-theme-body-font fw-bold fs-subheading py4"
             itemprop="upvoteCount"
             data-value="421">
421        </div>
        <button
            class="js-vote-down-btn flex--item mb8 s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
            id=downvote-btn-47141245
            title="This answer is not useful"
            aria-pressed="false"
            aria-label="Down vote"
            data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
            data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">

            <svg aria-hidden="true" class="svg-icon iconArrowDown" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 6h16l-8 8z"/></svg>
        </button>
        <input type="hidden" id="voteDownHash" value="70:3:31e,16:1671a1d4f3a7dce8,10:1771427630,16:afe9380dfb5067ab,8:47141245,b84dcf79c49e36e06274e52f45b70ec0a54c0938a4570b629c0cf4be457f001b" />


        
<button class="js-saves-btn s-btn s-btn__unset c-pointer py4"
        type="button"
        id="saves-btn-47141245"
        data-controller="s-tooltip"
        data-s-tooltip-placement="right"
        data-s-popover-placement=""
        title="Save this answer."
        data-is-saved="false"
        aria-label="Save"
        data-post-id="47141245"
        data-post-type-id="2"
        data-user-privilege-for-post-click="0"
        aria-controls=""
        data-s-popover-auto-show="false"
>
    <svg aria-hidden="true" class="fc-theme-primary-400 js-saves-btn-selected d-none svg-icon iconBookmark" width="18" height="18"  viewBox="0 0 18 18"><path  d="M3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
    <svg aria-hidden="true" class="js-saves-btn-unselected svg-icon iconBookmarkAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m9 10.6 4 2.66V3H5v10.26zM3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
</button>







            <div class="js-accepted-answer-indicator flex--item fc-green-400 py6 mtn8 d-none" data-s-tooltip-placement="right" title="Loading when this answer was accepted&#x2026;" tabindex="0" role="note" aria-label="Accepted">
                <div class="ta-center">
                    <svg aria-hidden="true" class="svg-icon iconCheckmarkLg" width="36" height="36"  viewBox="0 0 36 36"><path  d="m6 14 8 8L30 6v8L14 30l-8-8z"/></svg>
                </div>
            </div>

    
    <a class="js-post-issue flex--item s-btn s-btn__unset c-pointer py6 mx-auto" href="/posts/47141245/timeline" data-shortcut="T" data-ks-title="timeline" data-controller="s-tooltip" data-s-tooltip-placement="right" title="Show activity on this post." aria-label="Timeline"><svg aria-hidden="true" class="mln2 mr0 svg-icon iconHistory" width="19" height="18"  viewBox="0 0 19 18"><path  d="M3 9a8 8 0 1 1 3.73 6.77L8.2 14.3A6 6 0 1 0 5 9l3.01-.01-4 4-4-4zm7-4h1.01L11 9.36l3.22 2.1-.6.93L10 10z"/></svg></a>

</div>

                </div>

            

<div class="answercell post-layout--right">
    


    <div class="s-prose js-post-body" itemprop="text">
<p>As what has already been mentioned by others, what behind the mystery is <a href="https://en.wikipedia.org/wiki/Branch_predictor" rel="noreferrer">Branch Predictor</a>. </p>

<p>I'm not trying to add something but explaining the concept in another way. 
There is a concise introduction on the wiki which contains text and diagram.
I do like the explanation below which uses a diagram to elaborate the Branch Predictor intuitively.</p>

<blockquote>
  <p>In computer architecture, a branch predictor is a
  digital circuit that tries to guess which way a branch (e.g. an
  if-then-else structure) will go before this is known for sure. The
  purpose of the branch predictor is to improve the flow in the
  instruction pipeline. Branch predictors play a critical role in
  achieving high effective performance in many modern pipelined
  microprocessor architectures such as x86.</p>
  
  <p>Two-way branching is usually implemented with a conditional jump
  instruction. A conditional jump can either be "not taken" and continue
  execution with the first branch of code which follows immediately
  after the conditional jump, or it can be "taken" and jump to a
  different place in program memory where the second branch of code is
  stored. It is not known for certain whether a conditional jump will be
  taken or not taken until the condition has been calculated and the
  conditional jump has passed the execution stage in the instruction
  pipeline (see fig. 1).</p>
</blockquote>

<p><a href="https://i.sstatic.net/unxnb.png" rel="noreferrer"><img src="https://i.sstatic.net/unxnb.png" alt="figure 1"></a></p>

<p>Based on the described scenario, I have written an animation demo to show how instructions are executed in a pipeline in different situations.</p>

<ol>
<li>Without the Branch Predictor. </li>
</ol>

<blockquote>
  <p>Without branch prediction, the processor would have to wait until the
  conditional jump instruction has passed the execute stage before the
  next instruction can enter the fetch stage in the pipeline.</p>
</blockquote>

<p>The example contains three instructions and the first one is a conditional jump instruction. The latter two instructions can go into the pipeline until the conditional jump instruction is executed. </p>

<p><a href="https://i.sstatic.net/GMFQ6.gif" rel="noreferrer"><img src="https://i.sstatic.net/GMFQ6.gif" alt="without branch predictor"></a></p>

<p>It will take 9 clock cycles for 3 instructions to be completed.</p>

<ol start="2">
<li>Use Branch Predictor and don't take a conditional jump. Let's assume that the predict is <strong>not</strong> taking the conditional jump.</li>
</ol>

<p><a href="https://i.sstatic.net/Ms5p1.gif" rel="noreferrer"><img src="https://i.sstatic.net/Ms5p1.gif" alt="enter image description here"></a></p>

<p>It will take 7 clock cycles for 3 instructions to be completed.</p>

<ol start="3">
<li>Use Branch Predictor and take a conditional jump. Let's assume that the predict is <strong>not</strong> taking the conditional jump.</li>
</ol>

<p><a href="https://i.sstatic.net/HIpG3.gif" rel="noreferrer"><img src="https://i.sstatic.net/HIpG3.gif" alt="enter image description here"></a></p>

<p>It will take 9 clock cycles for 3 instructions to be completed.</p>

<blockquote>
  <p>The time that is wasted in case of a branch misprediction is equal to
  the number of stages in the pipeline from the fetch stage to the
  execute stage. Modern microprocessors tend to have quite long
  pipelines so that the misprediction delay is between 10 and 20 clock
  cycles. As a result, making a pipeline longer increases the need for a
  more advanced branch predictor.</p>
</blockquote>

<p>As you can see, it seems we don't have a reason not to use Branch Predictor.</p>

<p>It's quite a simple demo that clarifies the very basic part of Branch Predictor. If those gifs are annoying, please feel free to remove them from the answer and visitors can also get the live demo source code from <a href="https://github.com/Eugene-Mark/BranchPredictorDemo" rel="noreferrer">BranchPredictorDemo</a></p>
    </div>
    <div class="mt24">
        <div class="d-flex fw-wrap ai-start jc-end gs8 gsy">

            <time itemprop="dateCreated" datetime="2017-11-06 16:15:16Z"></time>
            <div class="flex--item mr16" style="flex: 1 1 100px;">
                


<div class="js-post-menu pt2" data-post-id="47141245" data-post-type-id="2">

    <div class="d-flex gs8 s-anchors s-anchors__muted fw-wrap">

        <div class="flex--item">
            <a href="/a/47141245"
               rel="nofollow"
               itemprop="url"
               class="js-share-link js-gps-track"
               title="Short permalink to this answer"
               data-gps-track="post.click({ item: 2, priv: 0, post_type: 2 })"
               data-controller="se-share-sheet"
               data-se-share-sheet-title="Share a link to this answer"
               data-se-share-sheet-subtitle=""
               data-se-share-sheet-post-type="answer"
               data-se-share-sheet-social="facebook twitter devto"
               data-se-share-sheet-location="2"
               data-se-share-sheet-license-url="https%3a%2f%2fcreativecommons.org%2flicenses%2fby-sa%2f4.0%2f"
               data-se-share-sheet-license-name="CC BY-SA 4.0"
               data-s-popover-placement="bottom-start">Share</a>
        </div>


                    <div class="flex--item">
                        <a href="/posts/47141245/edit" class="js-suggest-edit-post js-gps-track" data-gps-track="post.click({ item: 6, priv: 0, post_type: 2 })" title="">Improve this answer</a>
                    </div>

                <div class="flex--item">
                    <button type="button"
                            id="btnFollowPost-47141245" class="s-btn s-btn__link js-follow-post js-follow-answer js-gps-track"
                            data-gps-track="post.click({ item: 14, priv: 0, post_type: 2 })"
                            data-controller="s-tooltip " data-s-tooltip-placement="bottom"
                            data-s-popover-placement="bottom" aria-controls=""
                            title="Follow this answer to receive notifications">
                        Follow
                        <input type="hidden" id="voteFollowHash" value="70:3:31e,16:37c9287e22fd2cfa,10:1771427630,16:c0b2fdc699f73dad,8:47141245,0ba9902adef66f4a97d44303588c1886e2d598817c9c63fe4338b99b70f7a4cd" />
                    </button>
                </div>






    </div>
    <div class="js-menu-popup-container"></div>
</div>
            </div>
            <div class="post-signature flex--item fl0">
<div class="user-info ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            <a href="/posts/47141245/revisions" title="show all edits to this post"
                         class="js-gps-track"
                         data-gps-track="post.click({ item: 4, priv: 0, post_type: 2 })">edited <span title='2020-02-10 02:05:29Z' class='relativetime'>Feb 10, 2020 at 2:05</span></a>
        </div>
        
    </div>
    <div class="user-gravatar32">
        
    </div>
    <div class="user-details">
        
        <div class="-flair">
            
        </div>
    </div>
</div>
            </div>


                <div class="post-signature flex--item fl0">
                    <div class="user-info user-hover ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            answered <span title='2017-11-06 16:15:16Z' class='relativetime'>Nov 6, 2017 at 16:15</span>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/3378204/eugene"><div class="gravatar-wrapper-32"><img src="https://i.sstatic.net/jrjpD.png?s=64" alt="Eugene&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <a href="/users/3378204/eugene" itemprop="url" dir="auto">Eugene</a><meta itemprop="name" content="Eugene"/>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 11,175" dir="ltr">11.2k</span><span title="7 gold badges" aria-hidden="true"><span class="badge1"></span><span class="badgecount">7</span></span><span class="v-visible-sr">7 gold badges</span><span title="57 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">57</span></span><span class="v-visible-sr">57 silver badges</span><span title="73 bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">73</span></span><span class="v-visible-sr">73 bronze badges</span>
        </div>
    </div>
</div>


                </div>
        </div>
        
    
    </div>
    
</div>




                

    <div class="post-layout--right">
        

<div id="follow-ups-container-47141245">
    <!--[--><div class="mt16"><div class="mb8 d-flex ai-center g8 c-pointer" role="button" tabindex="0"><h2 class="mb0">4 Comments</h2> <!--[--><!--[--><!----><svg aria-hidden="true" class="svg-icon iconArrowDownAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m16.01 7.43-1.4-1.41L9 11.6 3.42 6l-1.4 1.42 7 7z"/></svg><!----><!--]--><!--]--></div> <div class="mb12"><!--[!--><button type="button" class="s-btn s-btn__muted s-btn__outlined w100 d-flex ai-center p8 comments-link" data-so-test="parent-answer-47141245"><!--[!--><!--]--> <div class="flex--item ml8"><p class="mb0">Add a comment</p></div></button><!--]--></div> <!--[--><div role="list"><!--[--><div id="follow-up-100995393" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/1734032/mckenzm" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://i.sstatic.net/xFnWL1Ci.jpg?s=64" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">mckenzm</div> <div class="s-user-card--awards"><!--[--><a href="/users/1734032/mckenzm" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">mckenzm</a><!--]--> <a class="comment-link" href="#comment100995393_47141245"><time title="2019-07-29T05:14:16.327Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->Almost as good as the Intel marketing animations, and they were obsessed not just with branch prediction but out of order execution, both strategies being &quot;speculative&quot;. Reading ahead in memory and storage (sequential pre-fetch to buffer) is also speculative. It all adds up.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2019-07-29T05:14:16.327Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-100995393"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">11</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-100995393"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-100995393" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-100995393"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-100995393" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-106374648" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/224132/peter-cordes" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://i.sstatic.net/N4ivW.png?s=64" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Peter Cordes</div> <div class="s-user-card--awards"><!--[--><a href="/users/224132/peter-cordes" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Peter Cordes</a><!--]--> <a class="comment-link" href="#comment106374648_47141245"><time title="2020-02-10T04:03:19.707Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->@mckenzm: out-of-order speculative exec makes branch prediction even more valuable; as well as hiding fetch/decode bubbles, branch prediction + speculative exec removes control dependencies from critical path latency.  Code inside or after an <code>if()</code> block can execute <i>before</i> the branch condition is known.  Or for a search loop like <code>strlen</code> or <code>memchr</code>, interations can overlap.  If you had to wait for the match-or-not result to be known before running any of the next iteration, you&#39;d bottleneck on cache load + ALU latency instead of throughput.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2020-02-10T04:03:19.707Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-106374648"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">9</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-106374648"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-106374648" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-106374648"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-106374648" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-110823751" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/9045408/justin-meskan" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://graph.facebook.com/146982662736728/picture?type=large" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Justin Meskan</div> <div class="s-user-card--awards"><!--[--><a href="/users/9045408/justin-meskan" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Justin Meskan</a><!--]--> <a class="comment-link" href="#comment110823751_47141245"><time title="2020-07-01T00:19:09.667Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->Did you make the example app in JavaFX?<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2020-07-01T00:19:09.667Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-110823751"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">7</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-110823751"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-110823751" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-110823751"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-110823751" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-110824362" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/3378204/eugene" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://i.sstatic.net/jrjpD.png?s=64" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Eugene</div> <div class="s-user-card--awards"><!--[--><a href="/users/3378204/eugene" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Eugene</a><!--]--> <a class="comment-link" href="#comment110824362_47141245"><time title="2020-07-01T01:14:51.15Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->@HannaMcquaig No, it&#39;s made by Swing. The code is available at <a href="https://github.com/Eugene-Mark/branch-predictor-demo" rel="nofollow noreferrer">github.com/Eugene-Mark/branch-predictor-demo</a>.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2020-07-01T01:14:51.15Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-110824362"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">5</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-110824362"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-110824362" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-110824362"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-110824362" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><!--]--></div> <!--[--><div class="d-flex g8 my8"><!--[--><button class="s-link s-btn__muted s-btn__outlined comments-link" data-so-test="parent-answer-47141245">Add a comment</button> <!--[!--><!--]--><!--]--> <!--[!--><!--]--></div><!--]--><!----><!--]--> <!--[!--><!--]--></div><!--]-->
</div>

<script type="application/json" data-role="module-args" data-module-name="islands/follow-ups/index.mod">{"replies":[{"id":100995393,"user":{"userId":1734032,"isDeleted":false,"displayName":"mckenzm","url":"/users/1734032/mckenzm","profileImageUrl":"https://i.sstatic.net/xFnWL1Ci.jpg?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"mckenzm","noSpacesUserName":"mckenzm","reputationDisplayText":"0"},"postedAt":"2019-07-29T05:14:16.327Z","postedAtRelative":"Over a year ago","body":"Almost as good as the Intel marketing animations, and they were obsessed not just with branch prediction but out of order execution, both strategies being \u0022speculative\u0022. Reading ahead in memory and storage (sequential pre-fetch to buffer) is also speculative. It all adds up.","htmlBody":"Almost as good as the Intel marketing animations, and they were obsessed not just with branch prediction but out of order execution, both strategies being \u0026quot;speculative\u0026quot;. Reading ahead in memory and storage (sequential pre-fetch to buffer) is also speculative. It all adds up.","score":11,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":106374648,"user":{"userId":224132,"isDeleted":false,"displayName":"Peter Cordes","url":"/users/224132/peter-cordes","profileImageUrl":"https://i.sstatic.net/N4ivW.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"PeterCordes","noSpacesUserName":"PeterCordes","reputationDisplayText":"0"},"postedAt":"2020-02-10T04:03:19.707Z","postedAtRelative":"Over a year ago","body":"@mckenzm: out-of-order speculative exec makes branch prediction even more valuable; as well as hiding fetch/decode bubbles, branch prediction \u002B speculative exec removes control dependencies from critical path latency.  Code inside or after an \u0060if()\u0060 block can execute *before* the branch condition is known.  Or for a search loop like \u0060strlen\u0060 or \u0060memchr\u0060, interations can overlap.  If you had to wait for the match-or-not result to be known before running any of the next iteration, you\u0027d bottleneck on cache load \u002B ALU latency instead of throughput.","htmlBody":"@mckenzm: out-of-order speculative exec makes branch prediction even more valuable; as well as hiding fetch/decode bubbles, branch prediction \u002B speculative exec removes control dependencies from critical path latency.  Code inside or after an \u003Ccode\u003Eif()\u003C/code\u003E block can execute \u003Ci\u003Ebefore\u003C/i\u003E the branch condition is known.  Or for a search loop like \u003Ccode\u003Estrlen\u003C/code\u003E or \u003Ccode\u003Ememchr\u003C/code\u003E, interations can overlap.  If you had to wait for the match-or-not result to be known before running any of the next iteration, you\u0026#39;d bottleneck on cache load \u002B ALU latency instead of throughput.","score":9,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":110823751,"user":{"userId":9045408,"isDeleted":false,"displayName":"Justin Meskan","url":"/users/9045408/justin-meskan","profileImageUrl":"https://graph.facebook.com/146982662736728/picture?type=large","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"JustinMeskan","noSpacesUserName":"JustinMeskan","reputationDisplayText":"0"},"postedAt":"2020-07-01T00:19:09.667Z","postedAtRelative":"Over a year ago","body":"Did you make the example app in JavaFX?","htmlBody":"Did you make the example app in JavaFX?","score":7,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":110824362,"user":{"userId":3378204,"isDeleted":false,"displayName":"Eugene","url":"/users/3378204/eugene","profileImageUrl":"https://i.sstatic.net/jrjpD.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"Eugene","noSpacesUserName":"Eugene","reputationDisplayText":"0"},"postedAt":"2020-07-01T01:14:51.15Z","postedAtRelative":"Over a year ago","body":"@HannaMcquaig No, it\u0027s made by Swing. The code is available at https://github.com/Eugene-Mark/branch-predictor-demo.","htmlBody":"@HannaMcquaig No, it\u0026#39;s made by Swing. The code is available at \u003Ca href=\u0022https://github.com/Eugene-Mark/branch-predictor-demo\u0022 rel=\u0022nofollow noreferrer\u0022\u003Egithub.com/Eugene-Mark/branch-predictor-demo\u003C/a\u003E.","score":5,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":true,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true}],"postId":47141245,"currentUserIsMod":false,"currentUserIsAnonymous":true,"commentFlagsRemainingToday":10,"maxNestingLevel":3,"hasOptedOut":false,"showCtaUnderComments":true,"containerElementId":"follow-ups-container-47141245","fKey":"d09ecbbe5140a7c1439a7e4020cdd7d76b52d28795a889bb24233842877804f3","questionId":11227809,"questionAuthorId":87234,"answerId":47141245,"answerPositionOnPage":0,"newUiSettings":{"largerFontSize":false},"showFirstTimeCommentingModal":false,"isMentionEnabled":false,"showSpamFlag":true,"mergeUnfriendlyAndRudeFlags":true,"allowRetractingCommentFlags":true,"commentMinLength":15}</script>
    </div>

        </div>
</div>
                                        
<a name="45503985"></a>
<div id="answer-45503985" class="answer js-answer " data-answerid="45503985"
     data-parentid="11227809" data-score="325" data-position-on-page="17"
     data-highest-scored="0"
     data-question-has-accepted-highest-score="1"
     data-author-username="Tony Tannous"
     data-author-reputation="15024"
     data-should-show-copy-button=True
     data-se-share-sheet-license-name="CC BY-SA 3.0"
     data-is-edited="True"
      itemprop="suggestedAnswer"
     itemscope itemtype="https://schema.org/Answer">
        <div class="post-layout ">
                <div class="votecell post-layout--left">
                    
<div class="js-voting-container d-flex jc-center fd-column ai-center gs4 fc-black-300" data-post-id="45503985" data-referrer="None">
        <button class="js-vote-up-btn flex--item s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
                id="upvote-btn-45503985"
                data-controller="s-tooltip"
                data-s-tooltip-placement="right"
                title="This answer is useful"
                aria-pressed="false"
                aria-label="Up vote"
                data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
                data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">
            <svg aria-hidden="true" class="svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg>
        </button>
        <input type="hidden" id="voteUpHash" value="70:3:31e,16:d5b312b7f29f231e,10:1771427630,16:a513531a2222f2d5,8:45503985,b125eb41027a983be8e1fd6059efa09f47bcda63d2a6ecfcd24ede3a85222a7c" />
        <div class="js-vote-count flex--item d-flex fd-column ai-center fc-theme-body-font fw-bold fs-subheading py4"
             itemprop="upvoteCount"
             data-value="325">
325        </div>
        <button
            class="js-vote-down-btn flex--item mb8 s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
            id=downvote-btn-45503985
            title="This answer is not useful"
            aria-pressed="false"
            aria-label="Down vote"
            data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
            data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">

            <svg aria-hidden="true" class="svg-icon iconArrowDown" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 6h16l-8 8z"/></svg>
        </button>
        <input type="hidden" id="voteDownHash" value="70:3:31e,16:021ad605fa6f35db,10:1771427630,16:9122679b40010347,8:45503985,4297b0f267ceae094be42ef973cbdd77e3834e5d4e680bdfb858a576ea030ab8" />


        
<button class="js-saves-btn s-btn s-btn__unset c-pointer py4"
        type="button"
        id="saves-btn-45503985"
        data-controller="s-tooltip"
        data-s-tooltip-placement="right"
        data-s-popover-placement=""
        title="Save this answer."
        data-is-saved="false"
        aria-label="Save"
        data-post-id="45503985"
        data-post-type-id="2"
        data-user-privilege-for-post-click="0"
        aria-controls=""
        data-s-popover-auto-show="false"
>
    <svg aria-hidden="true" class="fc-theme-primary-400 js-saves-btn-selected d-none svg-icon iconBookmark" width="18" height="18"  viewBox="0 0 18 18"><path  d="M3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
    <svg aria-hidden="true" class="js-saves-btn-unselected svg-icon iconBookmarkAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m9 10.6 4 2.66V3H5v10.26zM3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
</button>







            <div class="js-accepted-answer-indicator flex--item fc-green-400 py6 mtn8 d-none" data-s-tooltip-placement="right" title="Loading when this answer was accepted&#x2026;" tabindex="0" role="note" aria-label="Accepted">
                <div class="ta-center">
                    <svg aria-hidden="true" class="svg-icon iconCheckmarkLg" width="36" height="36"  viewBox="0 0 36 36"><path  d="m6 14 8 8L30 6v8L14 30l-8-8z"/></svg>
                </div>
            </div>

    
    <a class="js-post-issue flex--item s-btn s-btn__unset c-pointer py6 mx-auto" href="/posts/45503985/timeline" data-shortcut="T" data-ks-title="timeline" data-controller="s-tooltip" data-s-tooltip-placement="right" title="Show activity on this post." aria-label="Timeline"><svg aria-hidden="true" class="mln2 mr0 svg-icon iconHistory" width="19" height="18"  viewBox="0 0 19 18"><path  d="M3 9a8 8 0 1 1 3.73 6.77L8.2 14.3A6 6 0 1 0 5 9l3.01-.01-4 4-4-4zm7-4h1.01L11 9.36l3.22 2.1-.6.93L10 10z"/></svg></a>

</div>

                </div>

            

<div class="answercell post-layout--right">
    


    <div class="s-prose js-post-body" itemprop="text">
<p><strong>Branch-prediction gain!</strong></p>
<p>It is important to understand that branch misprediction doesn't slow down programs. The cost of a missed prediction is just as if branch prediction didn't exist and you waited for the evaluation of the expression to decide what code to run (further explanation in the next paragraph).</p>
<pre><code>if (expression)
{
    // Run 1
} else {
    // Run 2
}
</code></pre>
<p>Whenever there's an <code>if-else</code> \ <code>switch</code> statement, the expression has to be evaluated to determine which block should be executed. In the assembly code generated by the compiler, conditional <a href="https://en.wikipedia.org/wiki/Branch_(computer_science)" rel="noreferrer">branch</a> instructions are inserted.</p>
<p>A branch instruction can cause a computer to begin executing a different instruction sequence and thus deviate from its default behavior of executing instructions in order (i.e. if the expression is false, the program skips the code of the <code>if</code> block) depending on some condition, which is the expression evaluation in our case.</p>
<p>That being said, the compiler tries to predict the outcome prior to it being actually evaluated. It will fetch instructions from the <code>if</code> block, and if the expression turns out to be true, then wonderful! We gained the time it took to evaluate it and made progress in the code; if not then we are running the wrong code, the pipeline is flushed, and the correct block is run.</p>
<h3>Visualization:</h3>
<p>Let's say you need to pick route 1 or route 2. Waiting for your partner to check the map, you have stopped at ## and waited, or you could just pick route1 and if you were lucky (route 1 is the correct route), then great you didn't have to wait for your partner to check the map (you saved the time it would have taken him to check the map), otherwise you will just turn back.</p>
<p>While flushing pipelines is super fast, nowadays taking this gamble is worth it. Predicting sorted data or a data that changes slowly is always easier and better than predicting fast changes.</p>
<pre><code> O      Route 1  /-------------------------------
/|\             /
 |  ---------##/
/ \            \
                \
        Route 2  \--------------------------------
</code></pre>
    </div>
    <div class="mt24">
        <div class="d-flex fw-wrap ai-start jc-end gs8 gsy">

            <time itemprop="dateCreated" datetime="2017-08-04 10:07:12Z"></time>
            <div class="flex--item mr16" style="flex: 1 1 100px;">
                


<div class="js-post-menu pt2" data-post-id="45503985" data-post-type-id="2">

    <div class="d-flex gs8 s-anchors s-anchors__muted fw-wrap">

        <div class="flex--item">
            <a href="/a/45503985"
               rel="nofollow"
               itemprop="url"
               class="js-share-link js-gps-track"
               title="Short permalink to this answer"
               data-gps-track="post.click({ item: 2, priv: 0, post_type: 2 })"
               data-controller="se-share-sheet"
               data-se-share-sheet-title="Share a link to this answer"
               data-se-share-sheet-subtitle=""
               data-se-share-sheet-post-type="answer"
               data-se-share-sheet-social="facebook twitter devto"
               data-se-share-sheet-location="2"
               data-se-share-sheet-license-url="https%3a%2f%2fcreativecommons.org%2flicenses%2fby-sa%2f3.0%2f"
               data-se-share-sheet-license-name="CC BY-SA 3.0"
               data-s-popover-placement="bottom-start">Share</a>
        </div>


                    <div class="flex--item">
                        <a href="/posts/45503985/edit" class="js-suggest-edit-post js-gps-track" data-gps-track="post.click({ item: 6, priv: 0, post_type: 2 })" title="">Improve this answer</a>
                    </div>

                <div class="flex--item">
                    <button type="button"
                            id="btnFollowPost-45503985" class="s-btn s-btn__link js-follow-post js-follow-answer js-gps-track"
                            data-gps-track="post.click({ item: 14, priv: 0, post_type: 2 })"
                            data-controller="s-tooltip " data-s-tooltip-placement="bottom"
                            data-s-popover-placement="bottom" aria-controls=""
                            title="Follow this answer to receive notifications">
                        Follow
                        <input type="hidden" id="voteFollowHash" value="70:3:31e,16:e81487e53befceb2,10:1771427630,16:4a06c8a1f34c8827,8:45503985,d62fc4a5648d62668617fd8e1da2e2603327a9496a5aac26c5baa2c7140c3ab6" />
                    </button>
                </div>






    </div>
    <div class="js-menu-popup-container"></div>
</div>
            </div>
            <div class="post-signature flex--item fl0">
<div class="user-info user-hover ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            <a href="/posts/45503985/revisions" title="show all edits to this post"
                         class="js-gps-track"
                         data-gps-track="post.click({ item: 4, priv: 0, post_type: 2 })">edited <span title='2020-06-20 09:12:55Z' class='relativetime'>Jun 20, 2020 at 9:12</span></a>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/-1/community"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/a007be5a61f6aa8f3e85ae2fc18dd66e?s=64&amp;d=identicon&amp;r=PG" alt="Community&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/-1/community" dir="auto">Community</a><span class="flex--item s-badge ml2  s-badge__xs mtn2" title="Community Bot  not a real person. Replies to this bot are not monitored.">Bot</span>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">1</span><span title="1 silver badge" aria-hidden="true"><span class="badge2"></span><span class="badgecount">1</span></span><span class="v-visible-sr">1 silver badge</span>
        </div>
    </div>
</div>
            </div>


                <div class="post-signature flex--item fl0">
                    <div class="user-info ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            answered <span title='2017-08-04 10:07:12Z' class='relativetime'>Aug 4, 2017 at 10:07</span>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/6530695/tony-tannous"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/5df7e18b6795bfc96a32d6dc03b71e5e?s=64&amp;d=identicon&amp;r=PG&amp;f=y&amp;so-version=2" alt="Tony Tannous&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <a href="/users/6530695/tony-tannous" itemprop="url" dir="auto">Tony Tannous</a><meta itemprop="name" content="Tony Tannous"/>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 15,024" dir="ltr">15k</span><span title="12 gold badges" aria-hidden="true"><span class="badge1"></span><span class="badgecount">12</span></span><span class="v-visible-sr">12 gold badges</span><span title="59 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">59</span></span><span class="v-visible-sr">59 silver badges</span><span title="93 bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">93</span></span><span class="v-visible-sr">93 bronze badges</span>
        </div>
    </div>
</div>


                </div>
        </div>
        
    
    </div>
    
</div>




                

    <div class="post-layout--right">
        

<div id="follow-ups-container-45503985">
    <!--[--><div class="mt16"><div class="mb8 d-flex ai-center g8 c-pointer" role="button" tabindex="0"><h2 class="mb0">1 Comment</h2> <!--[--><!--[--><!----><svg aria-hidden="true" class="svg-icon iconArrowDownAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m16.01 7.43-1.4-1.41L9 11.6 3.42 6l-1.4 1.42 7 7z"/></svg><!----><!--]--><!--]--></div> <div class="mb12"><!--[!--><button type="button" class="s-btn s-btn__muted s-btn__outlined w100 d-flex ai-center p8 comments-link" data-so-test="parent-answer-45503985"><!--[!--><!--]--> <div class="flex--item ml8"><p class="mb0">Add a comment</p></div></button><!--]--></div> <!--[--><div role="list"><!--[--><div id="follow-up-106374699" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/224132/peter-cordes" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://i.sstatic.net/N4ivW.png?s=64" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Peter Cordes</div> <div class="s-user-card--awards"><!--[--><a href="/users/224132/peter-cordes" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Peter Cordes</a><!--]--> <a class="comment-link" href="#comment106374699_45503985"><time title="2020-02-10T04:07:48.667Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!----><i>While flushing pipelines is super fast</i>  Not really.  It&#39;s fast compared to a cache miss all the way to DRAM, but on a modern high-performance x86 (like Intel Sandybridge-family) it&#39;s about a dozen cycles.  Although fast recovery does allow it to avoid waiting for all older independent instructions to reach retirement before starting recovery, you still lose a lot of front-end cycles on a mispredict.  <a href="//stackoverflow.com/q/50984007">What exactly happens when a skylake CPU mispredicts a branch?</a>.  (And each cycle can be about 4 instructions of work.)  Bad for high-throughput code.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2020-02-10T04:07:48.667Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-106374699"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">3</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-106374699"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-106374699" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-106374699"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-106374699" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><!--]--></div> <!--[!--><!--]--><!----><!--]--> <!--[!--><!--]--></div><!--]-->
</div>

<script type="application/json" data-role="module-args" data-module-name="islands/follow-ups/index.mod">{"replies":[{"id":106374699,"user":{"userId":224132,"isDeleted":false,"displayName":"Peter Cordes","url":"/users/224132/peter-cordes","profileImageUrl":"https://i.sstatic.net/N4ivW.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"PeterCordes","noSpacesUserName":"PeterCordes","reputationDisplayText":"0"},"postedAt":"2020-02-10T04:07:48.667Z","postedAtRelative":"Over a year ago","body":"*While flushing pipelines is super fast*  Not really.  It\u0027s fast compared to a cache miss all the way to DRAM, but on a modern high-performance x86 (like Intel Sandybridge-family) it\u0027s about a dozen cycles.  Although fast recovery does allow it to avoid waiting for all older independent instructions to reach retirement before starting recovery, you still lose a lot of front-end cycles on a mispredict.  [What exactly happens when a skylake CPU mispredicts a branch?](//stackoverflow.com/q/50984007).  (And each cycle can be about 4 instructions of work.)  Bad for high-throughput code.","htmlBody":"\u003Ci\u003EWhile flushing pipelines is super fast\u003C/i\u003E  Not really.  It\u0026#39;s fast compared to a cache miss all the way to DRAM, but on a modern high-performance x86 (like Intel Sandybridge-family) it\u0026#39;s about a dozen cycles.  Although fast recovery does allow it to avoid waiting for all older independent instructions to reach retirement before starting recovery, you still lose a lot of front-end cycles on a mispredict.  \u003Ca href=\u0022//stackoverflow.com/q/50984007\u0022\u003EWhat exactly happens when a skylake CPU mispredicts a branch?\u003C/a\u003E.  (And each cycle can be about 4 instructions of work.)  Bad for high-throughput code.","score":3,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":true,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true}],"postId":45503985,"currentUserIsMod":false,"currentUserIsAnonymous":true,"commentFlagsRemainingToday":10,"maxNestingLevel":3,"hasOptedOut":false,"showCtaUnderComments":false,"containerElementId":"follow-ups-container-45503985","fKey":"d09ecbbe5140a7c1439a7e4020cdd7d76b52d28795a889bb24233842877804f3","questionId":11227809,"questionAuthorId":87234,"answerId":45503985,"answerPositionOnPage":0,"newUiSettings":{"largerFontSize":false},"showFirstTimeCommentingModal":false,"isMentionEnabled":false,"showSpamFlag":true,"mergeUnfriendlyAndRudeFlags":true,"allowRetractingCommentFlags":true,"commentMinLength":15}</script>
    </div>

        </div>
</div>
                                        
<a name="47942152"></a>
<div id="answer-47942152" class="answer js-answer " data-answerid="47942152"
     data-parentid="11227809" data-score="281" data-position-on-page="18"
     data-highest-scored="0"
     data-question-has-accepted-highest-score="1"
     data-author-username="Luke Hutchison"
     data-author-reputation="9340"
     data-should-show-copy-button=True
     data-se-share-sheet-license-name="CC BY-SA 4.0"
     data-is-edited="True"
      itemprop="suggestedAnswer"
     itemscope itemtype="https://schema.org/Answer">
        <div class="post-layout ">
                <div class="votecell post-layout--left">
                    
<div class="js-voting-container d-flex jc-center fd-column ai-center gs4 fc-black-300" data-post-id="47942152" data-referrer="None">
        <button class="js-vote-up-btn flex--item s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
                id="upvote-btn-47942152"
                data-controller="s-tooltip"
                data-s-tooltip-placement="right"
                title="This answer is useful"
                aria-pressed="false"
                aria-label="Up vote"
                data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
                data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">
            <svg aria-hidden="true" class="svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg>
        </button>
        <input type="hidden" id="voteUpHash" value="70:3:31e,16:39013059a1874be0,10:1771427630,16:16de8a50e68b50c4,8:47942152,fd873c9c411618ee25894911f91646723acdf3488e41222f35afb1b022eb69cf" />
        <div class="js-vote-count flex--item d-flex fd-column ai-center fc-theme-body-font fw-bold fs-subheading py4"
             itemprop="upvoteCount"
             data-value="281">
281        </div>
        <button
            class="js-vote-down-btn flex--item mb8 s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
            id=downvote-btn-47942152
            title="This answer is not useful"
            aria-pressed="false"
            aria-label="Down vote"
            data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
            data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">

            <svg aria-hidden="true" class="svg-icon iconArrowDown" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 6h16l-8 8z"/></svg>
        </button>
        <input type="hidden" id="voteDownHash" value="70:3:31e,16:62e8e77882d67cce,10:1771427630,16:adb1cb4d48c09c9d,8:47942152,c5dfa247138cb85a716fbbb645b151040189f6c6d39e8c3b5360046550b0fc04" />


        
<button class="js-saves-btn s-btn s-btn__unset c-pointer py4"
        type="button"
        id="saves-btn-47942152"
        data-controller="s-tooltip"
        data-s-tooltip-placement="right"
        data-s-popover-placement=""
        title="Save this answer."
        data-is-saved="false"
        aria-label="Save"
        data-post-id="47942152"
        data-post-type-id="2"
        data-user-privilege-for-post-click="0"
        aria-controls=""
        data-s-popover-auto-show="false"
>
    <svg aria-hidden="true" class="fc-theme-primary-400 js-saves-btn-selected d-none svg-icon iconBookmark" width="18" height="18"  viewBox="0 0 18 18"><path  d="M3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
    <svg aria-hidden="true" class="js-saves-btn-unselected svg-icon iconBookmarkAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m9 10.6 4 2.66V3H5v10.26zM3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
</button>







            <div class="js-accepted-answer-indicator flex--item fc-green-400 py6 mtn8 d-none" data-s-tooltip-placement="right" title="Loading when this answer was accepted&#x2026;" tabindex="0" role="note" aria-label="Accepted">
                <div class="ta-center">
                    <svg aria-hidden="true" class="svg-icon iconCheckmarkLg" width="36" height="36"  viewBox="0 0 36 36"><path  d="m6 14 8 8L30 6v8L14 30l-8-8z"/></svg>
                </div>
            </div>

    
    <a class="js-post-issue flex--item s-btn s-btn__unset c-pointer py6 mx-auto" href="/posts/47942152/timeline" data-shortcut="T" data-ks-title="timeline" data-controller="s-tooltip" data-s-tooltip-placement="right" title="Show activity on this post." aria-label="Timeline"><svg aria-hidden="true" class="mln2 mr0 svg-icon iconHistory" width="19" height="18"  viewBox="0 0 19 18"><path  d="M3 9a8 8 0 1 1 3.73 6.77L8.2 14.3A6 6 0 1 0 5 9l3.01-.01-4 4-4-4zm7-4h1.01L11 9.36l3.22 2.1-.6.93L10 10z"/></svg></a>

</div>

                </div>

            

<div class="answercell post-layout--right">
    


    <div class="s-prose js-post-body" itemprop="text">
<p>On ARM, there is no branch needed, because every instruction has a 4-bit condition field, which tests (at zero cost) any of <a href="https://community.arm.com/developer/ip-products/processors/b/processors-ip-blog/posts/condition-codes-1-condition-flags-and-codes" rel="noreferrer">16 different different conditions</a> that may arise in the Processor Status Register, and if the condition on an instruction is false, the instruction is skipped. This eliminates the need for short branches, and there would be no branch prediction hit for this algorithm. <b>Therefore, the sorted version of this algorithm would run slower than the unsorted version on ARM, because of the extra overhead of sorting.</b></p>
<p>The inner loop for this algorithm would look something like the following in ARM assembly language:</p>
<pre class="lang-js prettyprint-override"><code>MOV R0, #0   // R0 = sum = 0
MOV R1, #0   // R1 = c = 0
ADR R2, data // R2 = addr of data array (put this instruction outside outer loop)
.inner_loop  // Inner loop branch label
    LDRB R3, [R2, R1]   // R3 = data[c]
    CMP R3, #128        // compare R3 to 128
    ADDGE R0, R0, R3    // if R3 &gt;= 128, then sum += data[c] -- no branch needed!
    ADD R1, R1, #1      // c++
    CMP R1, #arraySize  // compare c to arraySize
    BLT inner_loop      // Branch to inner_loop if c &lt; arraySize
</code></pre>
<p><em><strong>But this is actually part of a bigger picture:</strong></em></p>
<p><code>CMP</code> opcodes always update the status bits in the Processor Status Register (PSR), because that is their purpose, but most other instructions do not touch the PSR unless you add an optional <code>S</code> suffix to the instruction, specifying that the PSR should be updated based on the result of the instruction. <strong>Just like the 4-bit condition suffix, being able to execute instructions without affecting the PSR is a mechanism that reduces the need for branches on ARM, and also facilitates out of order dispatch at the hardware level</strong>, because after performing some operation X that updates the status bits, subsequently (or in parallel) you can do a bunch of other work that explicitly should not affect (or be affected by) the status bits, then you can test the state of the status bits set earlier by X.</p>
<p>The condition testing field and the optional &quot;set status bit&quot; field can be combined, for example:</p>
<ul>
<li><code>ADD R1, R2, R3</code> performs <code>R1 = R2 + R3</code> without updating any status bits.</li>
<li><code>ADDGE R1, R2, R3</code> performs the same operation only if a previous instruction that affected the status bits resulted in a Greater than or Equal condition.</li>
<li><code>ADDS R1, R2, R3</code> performs the addition and then updates the <code>N</code>, <code>Z</code>, <code>C</code> and <code>V</code> flags in the Processor Status Register based on whether the result was Negative, Zero, Carried (for unsigned addition), or oVerflowed (for signed addition).</li>
<li><code>ADDSGE R1, R2, R3</code> performs the addition only if the <code>GE</code> test is true, and then subsequently updates the status bits based on the result of the addition.</li>
</ul>
<p>Most processor architectures do not have this ability to specify whether or not the status bits should be updated for a given operation, which can necessitate writing additional code to save and later restore status bits, or may require additional branches, or may limit the processor's out of order execution efficiency: one of the side effects of most CPU instruction set architectures forcibly updating status bits after most instructions is that it is much harder to tease apart which instructions can be run in parallel without interfering with each other. Updating status bits has side effects, therefore has a linearizing effect on code. <strong>ARM's ability to mix and match branch-free condition testing on any instruction with the option to either update or not update the status bits after any instruction is extremely powerful, for both assembly language programmers and compilers, and produces very efficient code.</strong></p>
<p>When you don't have to branch, you can avoid the time cost of flushing the pipeline for what would otherwise be short branches, and you can avoid the design complexity of many forms of speculative evalution. The performance impact of the initial naive imlementations of the mitigations for many recently discovered processor vulnerabilities (Spectre etc.) shows you just how much the performance of modern processors depends upon complex speculative evaluation logic. With a short pipeline and the dramatically reduced need for branching, ARM just doesn't need to rely on speculative evaluation as much as CISC processors. (Of course high-end ARM implementations do include speculative evaluation, but it's a smaller part of the performance story.)</p>
<p>If you have ever wondered why ARM has been so phenomenally successful, the brilliant effectiveness and interplay of these two mechanisms (combined with another mechanism that lets you &quot;barrel shift&quot; left or right one of the two arguments of any arithmetic operator or offset memory access operator at zero additional cost) are a big part of the story, because they are some of the greatest sources of the ARM architecture's efficiency. The brilliance of the original designers of the ARM ISA back in 1983, Steve Furber and Roger (now Sophie) Wilson, cannot be overstated.</p>
    </div>
    <div class="mt24">
        <div class="d-flex fw-wrap ai-start jc-end gs8 gsy">

            <time itemprop="dateCreated" datetime="2017-12-22 13:13:05Z"></time>
            <div class="flex--item mr16" style="flex: 1 1 100px;">
                


<div class="js-post-menu pt2" data-post-id="47942152" data-post-type-id="2">

    <div class="d-flex gs8 s-anchors s-anchors__muted fw-wrap">

        <div class="flex--item">
            <a href="/a/47942152"
               rel="nofollow"
               itemprop="url"
               class="js-share-link js-gps-track"
               title="Short permalink to this answer"
               data-gps-track="post.click({ item: 2, priv: 0, post_type: 2 })"
               data-controller="se-share-sheet"
               data-se-share-sheet-title="Share a link to this answer"
               data-se-share-sheet-subtitle=""
               data-se-share-sheet-post-type="answer"
               data-se-share-sheet-social="facebook twitter devto"
               data-se-share-sheet-location="2"
               data-se-share-sheet-license-url="https%3a%2f%2fcreativecommons.org%2flicenses%2fby-sa%2f4.0%2f"
               data-se-share-sheet-license-name="CC BY-SA 4.0"
               data-s-popover-placement="bottom-start">Share</a>
        </div>


                    <div class="flex--item">
                        <a href="/posts/47942152/edit" class="js-suggest-edit-post js-gps-track" data-gps-track="post.click({ item: 6, priv: 0, post_type: 2 })" title="">Improve this answer</a>
                    </div>

                <div class="flex--item">
                    <button type="button"
                            id="btnFollowPost-47942152" class="s-btn s-btn__link js-follow-post js-follow-answer js-gps-track"
                            data-gps-track="post.click({ item: 14, priv: 0, post_type: 2 })"
                            data-controller="s-tooltip " data-s-tooltip-placement="bottom"
                            data-s-popover-placement="bottom" aria-controls=""
                            title="Follow this answer to receive notifications">
                        Follow
                        <input type="hidden" id="voteFollowHash" value="70:3:31e,16:ee67be19bcb78a58,10:1771427630,16:9cb0f555385e617a,8:47942152,24c1f0bfa66d4e320a3992a0639caa7ab7efc47a6a7a4825a89cea7bd01285a0" />
                    </button>
                </div>






    </div>
    <div class="js-menu-popup-container"></div>
</div>
            </div>
            <div class="post-signature flex--item fl0">
<div class="user-info ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            <a href="/posts/47942152/revisions" title="show all edits to this post"
                         class="js-gps-track"
                         data-gps-track="post.click({ item: 4, priv: 0, post_type: 2 })">edited <span title='2020-10-20 22:33:32Z' class='relativetime'>Oct 20, 2020 at 22:33</span></a>
        </div>
        
    </div>
    <div class="user-gravatar32">
        
    </div>
    <div class="user-details">
        
        <div class="-flair">
            
        </div>
    </div>
</div>
            </div>


                <div class="post-signature flex--item fl0">
                    <div class="user-info ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            answered <span title='2017-12-22 13:13:05Z' class='relativetime'>Dec 22, 2017 at 13:13</span>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/3950982/luke-hutchison"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/7491f45ae073ed6bfe01b1e63fb06bf0?s=64&amp;d=identicon&amp;r=PG" alt="Luke Hutchison&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <a href="/users/3950982/luke-hutchison" itemprop="url" dir="auto">Luke Hutchison</a><meta itemprop="name" content="Luke Hutchison"/>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">9,340</span><span title="3 gold badges" aria-hidden="true"><span class="badge1"></span><span class="badgecount">3</span></span><span class="v-visible-sr">3 gold badges</span><span title="57 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">57</span></span><span class="v-visible-sr">57 silver badges</span><span title="53 bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">53</span></span><span class="v-visible-sr">53 bronze badges</span>
        </div>
    </div>
</div>


                </div>
        </div>
        
    
    </div>
    
</div>




                

    <div class="post-layout--right">
        

<div id="follow-ups-container-47942152">
    <!--[--><div class="mt16"><div class="mb8 d-flex ai-center g8 c-pointer" role="button" tabindex="0"><h2 class="mb0">7 Comments</h2> <!--[--><!--[--><!----><svg aria-hidden="true" class="svg-icon iconArrowDownAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m16.01 7.43-1.4-1.41L9 11.6 3.42 6l-1.4 1.42 7 7z"/></svg><!----><!--]--><!--]--></div> <div class="mb12"><!--[!--><button type="button" class="s-btn s-btn__muted s-btn__outlined w100 d-flex ai-center p8" data-so-test="parent-answer-47942152"><!--[!--><!--]--> <div class="flex--item ml8"><p class="mb0">Add a comment</p></div></button><!--]--></div> <!--[--><div role="list"><!--[--><div id="follow-up-87727753" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/3950982/luke-hutchison" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://www.gravatar.com/avatar/7491f45ae073ed6bfe01b1e63fb06bf0?s=48&amp;d=identicon&amp;r=PG" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Luke Hutchison</div> <div class="s-user-card--awards"><!--[--><a href="/users/3950982/luke-hutchison" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Luke Hutchison</a><!--]--> <a class="comment-link" href="#comment87727753_47942152"><time title="2018-05-15T17:06:54.8Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->The other innovation in ARM is the addition of the S instruction suffix, also optional on (almost) all instructions, which if absent, prevents instructions from changing status bits (with the exception of the CMP instruction, whose job is to set status bits, so it doesn&#39;t need the S suffix). This allows you to avoid CMP instructions in many cases, as long as the comparison is with zero or similar (eg. SUBS R0, R0, #1 will set the Z (Zero) bit when R0 reaches zero). Conditionals and the S suffix incur zero overhead. It&#39;s quite a beautiful ISA.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2018-05-15T17:06:54.8Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-87727753"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">5</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-87727753"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-87727753" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-87727753"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-87727753" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-87727802" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/3950982/luke-hutchison" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://www.gravatar.com/avatar/7491f45ae073ed6bfe01b1e63fb06bf0?s=48&amp;d=identicon&amp;r=PG" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Luke Hutchison</div> <div class="s-user-card--awards"><!--[--><a href="/users/3950982/luke-hutchison" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Luke Hutchison</a><!--]--> <a class="comment-link" href="#comment87727802_47942152"><time title="2018-05-15T17:08:22.713Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[--><span class="o50" title="Edited 2 times"><!----><svg aria-hidden="true" class="svg-icon iconPencilSm" width="14" height="14"  viewBox="0 0 14 14"><path fill="#F1B600" d="m2 10.12 6.37-6.43 1.88 1.88L3.88 12H2z"/><path fill="#E87C87" d="m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0"/></svg><!----><!----></span><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->Not adding the S suffix allows you to have several conditional instructions in a row without worrying that one of them might change the status bits, which might otherwise have the side effect of skipping the rest of the conditional instructions.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2018-05-15T17:08:22.713Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-87727802"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">5</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-87727802"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-87727802" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-87727802"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-87727802" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-106733423" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/224132/peter-cordes" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://i.sstatic.net/N4ivW.png?s=64" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Peter Cordes</div> <div class="s-user-card--awards"><!--[--><a href="/users/224132/peter-cordes" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Peter Cordes</a><!--]--> <a class="comment-link" href="#comment106733423_47942152"><time title="2020-02-21T11:34:19.763Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->Note that the OP is <i>not</i> including the time to sort in their measurement.  It&#39;s probably an overall loss to sort first before running a branch x86 loop, too, even though the non-sorted case makes the loop run a lot slower.  But sorting a big array requires a <i>lot</i> of work.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2020-02-21T11:34:19.763Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-106733423"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">3</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-106733423"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-106733423" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-106733423"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-106733423" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-106733504" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/224132/peter-cordes" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://i.sstatic.net/N4ivW.png?s=64" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Peter Cordes</div> <div class="s-user-card--awards"><!--[--><a href="/users/224132/peter-cordes" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Peter Cordes</a><!--]--> <a class="comment-link" href="#comment106733504_47942152"><time title="2020-02-21T11:36:48.707Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[--><span class="o50" title="Edited 2 times"><!----><svg aria-hidden="true" class="svg-icon iconPencilSm" width="14" height="14"  viewBox="0 0 14 14"><path fill="#F1B600" d="m2 10.12 6.37-6.43 1.88 1.88L3.88 12H2z"/><path fill="#E87C87" d="m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0"/></svg><!----><!----></span><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->BTW, you could save an instruction in the loop by indexing relative to the end of the array.  Before the loop, set up <code>R2 = data + arraySize</code>, then start with <code>R1 = -arraySize</code>.  The bottom of the loop becomes <code>adds r1, r1, #1</code> / <code>bnz inner_loop</code>.  Compilers don&#39;t use this optimization for some reason :/  But anyway, predicated execution of the add is not fundamentally different in this case from what you can do with branchless code on other ISAs, like x86 <code>cmov</code>.  Although it&#39;s not as nice: <a href="//stackoverflow.com/q/28875325">gcc optimization flag -O3 makes code slower than -O2</a><!----><!--]--></div> <time class="d-none" itemprop="datePublished">2020-02-21T11:36:48.707Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-106733504"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">4</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-106733504"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-106733504" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-106733504"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-106733504" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-106733620" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/224132/peter-cordes" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://i.sstatic.net/N4ivW.png?s=64" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Peter Cordes</div> <div class="s-user-card--awards"><!--[--><a href="/users/224132/peter-cordes" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Peter Cordes</a><!--]--> <a class="comment-link" href="#comment106733620_47942152"><time title="2020-02-21T11:40:20.84Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[--><span class="o50" title="Edited 1 time"><!----><svg aria-hidden="true" class="svg-icon iconPencilSm" width="14" height="14"  viewBox="0 0 14 14"><path fill="#F1B600" d="m2 10.12 6.37-6.43 1.88 1.88L3.88 12H2z"/><path fill="#E87C87" d="m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0"/></svg><!----><!----></span><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->(ARM predicated execution truly NOPs the instruction, so you can even use it on loads or stores that would fault, unlike x86 <code>cmov</code> with a memory source operand.  Most ISAs, including AArch64, only have ALU select operations.  So ARM predication can be powerful, and usable more efficiently than branchless code on most ISAs.)<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2020-02-21T11:40:20.84Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-106733620"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">4</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-106733620"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-106733620" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-106733620"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-106733620" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><!--]--></div> <!--[--><div class="d-flex g8 my8"><!--[--><button class="s-link s-btn__muted s-btn__outlined comments-link" data-so-test="parent-answer-47942152">Add a comment</button> <!--[--><span>|</span><!--]--><!--]--> <!--[--><button class="s-link s-btn__muted s-btn__outlined comments-link">Show 2 more comments</button><!--]--></div><!--]--><!----><!--]--> <!--[!--><!--]--></div><!--]-->
</div>

<script type="application/json" data-role="module-args" data-module-name="islands/follow-ups/index.mod">{"replies":[{"id":87727753,"user":{"userId":3950982,"isDeleted":false,"displayName":"Luke Hutchison","url":"/users/3950982/luke-hutchison","profileImageUrl":"https://www.gravatar.com/avatar/7491f45ae073ed6bfe01b1e63fb06bf0?s=48\u0026d=identicon\u0026r=PG","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"LukeHutchison","noSpacesUserName":"LukeHutchison","reputationDisplayText":"0"},"postedAt":"2018-05-15T17:06:54.8Z","postedAtRelative":"Over a year ago","body":"The other innovation in ARM is the addition of the S instruction suffix, also optional on (almost) all instructions, which if absent, prevents instructions from changing status bits (with the exception of the CMP instruction, whose job is to set status bits, so it doesn\u0027t need the S suffix). This allows you to avoid CMP instructions in many cases, as long as the comparison is with zero or similar (eg. SUBS R0, R0, #1 will set the Z (Zero) bit when R0 reaches zero). Conditionals and the S suffix incur zero overhead. It\u0027s quite a beautiful ISA.","htmlBody":"The other innovation in ARM is the addition of the S instruction suffix, also optional on (almost) all instructions, which if absent, prevents instructions from changing status bits (with the exception of the CMP instruction, whose job is to set status bits, so it doesn\u0026#39;t need the S suffix). This allows you to avoid CMP instructions in many cases, as long as the comparison is with zero or similar (eg. SUBS R0, R0, #1 will set the Z (Zero) bit when R0 reaches zero). Conditionals and the S suffix incur zero overhead. It\u0026#39;s quite a beautiful ISA.","score":5,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":87727802,"user":{"userId":3950982,"isDeleted":false,"displayName":"Luke Hutchison","url":"/users/3950982/luke-hutchison","profileImageUrl":"https://www.gravatar.com/avatar/7491f45ae073ed6bfe01b1e63fb06bf0?s=48\u0026d=identicon\u0026r=PG","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"LukeHutchison","noSpacesUserName":"LukeHutchison","reputationDisplayText":"0"},"postedAt":"2018-05-15T17:08:22.713Z","postedAtRelative":"Over a year ago","body":"Not adding the S suffix allows you to have several conditional instructions in a row without worrying that one of them might change the status bits, which might otherwise have the side effect of skipping the rest of the conditional instructions.","htmlBody":"Not adding the S suffix allows you to have several conditional instructions in a row without worrying that one of them might change the status bits, which might otherwise have the side effect of skipping the rest of the conditional instructions.","score":5,"editCount":2,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":106733423,"user":{"userId":224132,"isDeleted":false,"displayName":"Peter Cordes","url":"/users/224132/peter-cordes","profileImageUrl":"https://i.sstatic.net/N4ivW.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"PeterCordes","noSpacesUserName":"PeterCordes","reputationDisplayText":"0"},"postedAt":"2020-02-21T11:34:19.763Z","postedAtRelative":"Over a year ago","body":"Note that the OP is *not* including the time to sort in their measurement.  It\u0027s probably an overall loss to sort first before running a branch x86 loop, too, even though the non-sorted case makes the loop run a lot slower.  But sorting a big array requires a *lot* of work.","htmlBody":"Note that the OP is \u003Ci\u003Enot\u003C/i\u003E including the time to sort in their measurement.  It\u0026#39;s probably an overall loss to sort first before running a branch x86 loop, too, even though the non-sorted case makes the loop run a lot slower.  But sorting a big array requires a \u003Ci\u003Elot\u003C/i\u003E of work.","score":3,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":106733504,"user":{"userId":224132,"isDeleted":false,"displayName":"Peter Cordes","url":"/users/224132/peter-cordes","profileImageUrl":"https://i.sstatic.net/N4ivW.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"PeterCordes","noSpacesUserName":"PeterCordes","reputationDisplayText":"0"},"postedAt":"2020-02-21T11:36:48.707Z","postedAtRelative":"Over a year ago","body":"BTW, you could save an instruction in the loop by indexing relative to the end of the array.  Before the loop, set up \u0060R2 = data \u002B arraySize\u0060, then start with \u0060R1 = -arraySize\u0060.  The bottom of the loop becomes \u0060adds r1, r1, #1\u0060 / \u0060bnz inner_loop\u0060.  Compilers don\u0027t use this optimization for some reason :/  But anyway, predicated execution of the add is not fundamentally different in this case from what you can do with branchless code on other ISAs, like x86 \u0060cmov\u0060.  Although it\u0027s not as nice: [gcc optimization flag -O3 makes code slower than -O2](//stackoverflow.com/q/28875325)","htmlBody":"BTW, you could save an instruction in the loop by indexing relative to the end of the array.  Before the loop, set up \u003Ccode\u003ER2 = data \u002B arraySize\u003C/code\u003E, then start with \u003Ccode\u003ER1 = -arraySize\u003C/code\u003E.  The bottom of the loop becomes \u003Ccode\u003Eadds r1, r1, #1\u003C/code\u003E / \u003Ccode\u003Ebnz inner_loop\u003C/code\u003E.  Compilers don\u0026#39;t use this optimization for some reason :/  But anyway, predicated execution of the add is not fundamentally different in this case from what you can do with branchless code on other ISAs, like x86 \u003Ccode\u003Ecmov\u003C/code\u003E.  Although it\u0026#39;s not as nice: \u003Ca href=\u0022//stackoverflow.com/q/28875325\u0022\u003Egcc optimization flag -O3 makes code slower than -O2\u003C/a\u003E","score":4,"editCount":2,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":106733620,"user":{"userId":224132,"isDeleted":false,"displayName":"Peter Cordes","url":"/users/224132/peter-cordes","profileImageUrl":"https://i.sstatic.net/N4ivW.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"PeterCordes","noSpacesUserName":"PeterCordes","reputationDisplayText":"0"},"postedAt":"2020-02-21T11:40:20.84Z","postedAtRelative":"Over a year ago","body":"(ARM predicated execution truly NOPs the instruction, so you can even use it on loads or stores that would fault, unlike x86 \u0060cmov\u0060 with a memory source operand.  Most ISAs, including AArch64, only have ALU select operations.  So ARM predication can be powerful, and usable more efficiently than branchless code on most ISAs.)","htmlBody":"(ARM predicated execution truly NOPs the instruction, so you can even use it on loads or stores that would fault, unlike x86 \u003Ccode\u003Ecmov\u003C/code\u003E with a memory source operand.  Most ISAs, including AArch64, only have ALU select operations.  So ARM predication can be powerful, and usable more efficiently than branchless code on most ISAs.)","score":4,"editCount":1,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":129938412,"user":{"userId":224132,"isDeleted":false,"displayName":"Peter Cordes","url":"/users/224132/peter-cordes","profileImageUrl":"https://i.sstatic.net/N4ivW.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"PeterCordes","noSpacesUserName":"PeterCordes","reputationDisplayText":"0"},"postedAt":"2022-09-02T12:11:51.077Z","postedAtRelative":"Over a year ago","body":"Also, all modern ISAs except maybe RISC-V have ways to do this branchlessly, and even  RISC-V without extension B can do an ALU select with compare / sub 1 / AND to zero an element or not.  And many ISAs have SIMD instructions, like ARM NEON or x86 SSE2, that can do this branchlessly 4 elements at a time.  *[Why is processing an unsorted array the same speed as processing a sorted array with modern x86-64 clang?](https://stackoverflow.com/q/66521344)* shows clang vectorizes, unlike Java or the compiler used when this question was posted.","htmlBody":"Also, all modern ISAs except maybe RISC-V have ways to do this branchlessly, and even  RISC-V without extension B can do an ALU select with compare / sub 1 / AND to zero an element or not.  And many ISAs have SIMD instructions, like ARM NEON or x86 SSE2, that can do this branchlessly 4 elements at a time.  \u003Ci\u003E\u003Ca href=\u0022https://stackoverflow.com/q/66521344\u0022\u003EWhy is processing an unsorted array the same speed as processing a sorted array with modern x86-64 clang?\u003C/a\u003E\u003C/i\u003E shows clang vectorizes, unlike Java or the compiler used when this question was posted.","score":1,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false},{"id":129960944,"user":{"userId":3950982,"isDeleted":false,"displayName":"Luke Hutchison","url":"/users/3950982/luke-hutchison","profileImageUrl":"https://www.gravatar.com/avatar/7491f45ae073ed6bfe01b1e63fb06bf0?s=48\u0026d=identicon\u0026r=PG","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"LukeHutchison","noSpacesUserName":"LukeHutchison","reputationDisplayText":"0"},"postedAt":"2022-09-03T19:49:06.837Z","postedAtRelative":"Over a year ago","body":"@PeterCordes thanks, good info. Although that does require a powerful compiler to rewrite the code into vectorized form, as you point out -- and as I understand it, even if the compiler can do this successfully in a wide range of useful cases, it\u0027s uncomputable in the general case to find all valid vectorization transforms, since it\u0027s a code equivalence problem.","htmlBody":"@PeterCordes thanks, good info. Although that does require a powerful compiler to rewrite the code into vectorized form, as you point out -- and as I understand it, even if the compiler can do this successfully in a wide range of useful cases, it\u0026#39;s uncomputable in the general case to find all valid vectorization transforms, since it\u0026#39;s a code equivalence problem.","score":0,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":true,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false}],"postId":47942152,"currentUserIsMod":false,"currentUserIsAnonymous":true,"commentFlagsRemainingToday":10,"maxNestingLevel":3,"hasOptedOut":false,"showCtaUnderComments":true,"containerElementId":"follow-ups-container-47942152","fKey":"d09ecbbe5140a7c1439a7e4020cdd7d76b52d28795a889bb24233842877804f3","questionId":11227809,"questionAuthorId":87234,"answerId":47942152,"answerPositionOnPage":0,"newUiSettings":{"largerFontSize":false},"showFirstTimeCommentingModal":false,"isMentionEnabled":false,"showSpamFlag":true,"mergeUnfriendlyAndRudeFlags":true,"allowRetractingCommentFlags":true,"commentMinLength":15}</script>
    </div>

        </div>
</div>
                                        
<a name="47457772"></a>
<div id="answer-47457772" class="answer js-answer " data-answerid="47457772"
     data-parentid="11227809" data-score="232" data-position-on-page="19"
     data-highest-scored="0"
     data-question-has-accepted-highest-score="1"
     data-author-username="Yochai Timmer"
     data-author-reputation="49639"
     data-should-show-copy-button=True
     data-se-share-sheet-license-name="CC BY-SA 4.0"
     data-is-edited="True"
      itemprop="suggestedAnswer"
     itemscope itemtype="https://schema.org/Answer">
        <div class="post-layout ">
                <div class="votecell post-layout--left">
                    
<div class="js-voting-container d-flex jc-center fd-column ai-center gs4 fc-black-300" data-post-id="47457772" data-referrer="None">
        <button class="js-vote-up-btn flex--item s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
                id="upvote-btn-47457772"
                data-controller="s-tooltip"
                data-s-tooltip-placement="right"
                title="This answer is useful"
                aria-pressed="false"
                aria-label="Up vote"
                data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
                data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">
            <svg aria-hidden="true" class="svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg>
        </button>
        <input type="hidden" id="voteUpHash" value="70:3:31e,16:5607b7b35ae4204d,10:1771427630,16:f41d1c3e17776a04,8:47457772,79ec7ab641e273ec03036a9abdbb4a8031251042f21b3795c92654cef2ea17e3" />
        <div class="js-vote-count flex--item d-flex fd-column ai-center fc-theme-body-font fw-bold fs-subheading py4"
             itemprop="upvoteCount"
             data-value="232">
232        </div>
        <button
            class="js-vote-down-btn flex--item mb8 s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
            id=downvote-btn-47457772
            title="This answer is not useful"
            aria-pressed="false"
            aria-label="Down vote"
            data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
            data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">

            <svg aria-hidden="true" class="svg-icon iconArrowDown" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 6h16l-8 8z"/></svg>
        </button>
        <input type="hidden" id="voteDownHash" value="70:3:31e,16:e646a6c39ec6258e,10:1771427630,16:7d3287589054fe92,8:47457772,cde49960df724beb0bbc8f9447ce21652b2f822fd0d60d2c31068e240d5458fe" />


        
<button class="js-saves-btn s-btn s-btn__unset c-pointer py4"
        type="button"
        id="saves-btn-47457772"
        data-controller="s-tooltip"
        data-s-tooltip-placement="right"
        data-s-popover-placement=""
        title="Save this answer."
        data-is-saved="false"
        aria-label="Save"
        data-post-id="47457772"
        data-post-type-id="2"
        data-user-privilege-for-post-click="0"
        aria-controls=""
        data-s-popover-auto-show="false"
>
    <svg aria-hidden="true" class="fc-theme-primary-400 js-saves-btn-selected d-none svg-icon iconBookmark" width="18" height="18"  viewBox="0 0 18 18"><path  d="M3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
    <svg aria-hidden="true" class="js-saves-btn-unselected svg-icon iconBookmarkAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m9 10.6 4 2.66V3H5v10.26zM3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
</button>







            <div class="js-accepted-answer-indicator flex--item fc-green-400 py6 mtn8 d-none" data-s-tooltip-placement="right" title="Loading when this answer was accepted&#x2026;" tabindex="0" role="note" aria-label="Accepted">
                <div class="ta-center">
                    <svg aria-hidden="true" class="svg-icon iconCheckmarkLg" width="36" height="36"  viewBox="0 0 36 36"><path  d="m6 14 8 8L30 6v8L14 30l-8-8z"/></svg>
                </div>
            </div>

    
    <a class="js-post-issue flex--item s-btn s-btn__unset c-pointer py6 mx-auto" href="/posts/47457772/timeline" data-shortcut="T" data-ks-title="timeline" data-controller="s-tooltip" data-s-tooltip-placement="right" title="Show activity on this post." aria-label="Timeline"><svg aria-hidden="true" class="mln2 mr0 svg-icon iconHistory" width="19" height="18"  viewBox="0 0 19 18"><path  d="M3 9a8 8 0 1 1 3.73 6.77L8.2 14.3A6 6 0 1 0 5 9l3.01-.01-4 4-4-4zm7-4h1.01L11 9.36l3.22 2.1-.6.93L10 10z"/></svg></a>

</div>

                </div>

            

<div class="answercell post-layout--right">
    


    <div class="s-prose js-post-body" itemprop="text">
<p>Besides the fact that the branch prediction may slow you down, a sorted array has another advantage:   </p>

<p>You can have a stop condition instead of just checking the value, this way you only loop over the relevant data, and ignore the rest.<br>
The branch prediction will miss only once.</p>

<pre><code> // sort backwards (higher values first), may be in some other part of the code
 std::sort(data, data + arraySize, std::greater&lt;int&gt;());

 for (unsigned c = 0; c &lt; arraySize; ++c) {
       if (data[c] &lt; 128) {
              break;
       }
       sum += data[c];               
 }
</code></pre>
    </div>
    <div class="mt24">
        <div class="d-flex fw-wrap ai-start jc-end gs8 gsy">

            <time itemprop="dateCreated" datetime="2017-11-23 14:28:29Z"></time>
            <div class="flex--item mr16" style="flex: 1 1 100px;">
                


<div class="js-post-menu pt2" data-post-id="47457772" data-post-type-id="2">

    <div class="d-flex gs8 s-anchors s-anchors__muted fw-wrap">

        <div class="flex--item">
            <a href="/a/47457772"
               rel="nofollow"
               itemprop="url"
               class="js-share-link js-gps-track"
               title="Short permalink to this answer"
               data-gps-track="post.click({ item: 2, priv: 0, post_type: 2 })"
               data-controller="se-share-sheet"
               data-se-share-sheet-title="Share a link to this answer"
               data-se-share-sheet-subtitle=""
               data-se-share-sheet-post-type="answer"
               data-se-share-sheet-social="facebook twitter devto"
               data-se-share-sheet-location="2"
               data-se-share-sheet-license-url="https%3a%2f%2fcreativecommons.org%2flicenses%2fby-sa%2f4.0%2f"
               data-se-share-sheet-license-name="CC BY-SA 4.0"
               data-s-popover-placement="bottom-start">Share</a>
        </div>


                    <div class="flex--item">
                        <a href="/posts/47457772/edit" class="js-suggest-edit-post js-gps-track" data-gps-track="post.click({ item: 6, priv: 0, post_type: 2 })" title="">Improve this answer</a>
                    </div>

                <div class="flex--item">
                    <button type="button"
                            id="btnFollowPost-47457772" class="s-btn s-btn__link js-follow-post js-follow-answer js-gps-track"
                            data-gps-track="post.click({ item: 14, priv: 0, post_type: 2 })"
                            data-controller="s-tooltip " data-s-tooltip-placement="bottom"
                            data-s-popover-placement="bottom" aria-controls=""
                            title="Follow this answer to receive notifications">
                        Follow
                        <input type="hidden" id="voteFollowHash" value="70:3:31e,16:53e57957c13e7f44,10:1771427630,16:2ce63de6b7da0c26,8:47457772,73b9061d91182e8e5fe25864879b5e55cf42b5ad6d211df54071b5e60a87b690" />
                    </button>
                </div>






    </div>
    <div class="js-menu-popup-container"></div>
</div>
            </div>
            <div class="post-signature flex--item fl0">
<div class="user-info ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            <a href="/posts/47457772/revisions" title="show all edits to this post"
                         class="js-gps-track"
                         data-gps-track="post.click({ item: 4, priv: 0, post_type: 2 })">edited <span title='2019-03-05 09:58:40Z' class='relativetime'>Mar 5, 2019 at 9:58</span></a>
        </div>
        
    </div>
    <div class="user-gravatar32">
        
    </div>
    <div class="user-details">
        
        <div class="-flair">
            
        </div>
    </div>
</div>
            </div>


                <div class="post-signature flex--item fl0">
                    <div class="user-info user-hover ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            answered <span title='2017-11-23 14:28:29Z' class='relativetime'>Nov 23, 2017 at 14:28</span>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/536086/yochai-timmer"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/75d228bb162b779392a94d9364969208?s=64&amp;d=identicon&amp;r=PG" alt="Yochai Timmer&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <a href="/users/536086/yochai-timmer" itemprop="url" dir="auto">Yochai Timmer</a><meta itemprop="name" content="Yochai Timmer"/>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 49,639" dir="ltr">49.6k</span><span title="25 gold badges" aria-hidden="true"><span class="badge1"></span><span class="badgecount">25</span></span><span class="v-visible-sr">25 gold badges</span><span title="155 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">155</span></span><span class="v-visible-sr">155 silver badges</span><span title="191 bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">191</span></span><span class="v-visible-sr">191 bronze badges</span>
        </div>
    </div>
</div>


                </div>
        </div>
        
    
    </div>
    
</div>




                

    <div class="post-layout--right">
        

<div id="follow-ups-container-47457772">
    <!--[--><div class="mt16"><div class="mb8 d-flex ai-center g8 c-pointer" role="button" tabindex="0"><h2 class="mb0">5 Comments</h2> <!--[--><!--[--><!----><svg aria-hidden="true" class="svg-icon iconArrowDownAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m16.01 7.43-1.4-1.41L9 11.6 3.42 6l-1.4 1.42 7 7z"/></svg><!----><!--]--><!--]--></div> <div class="mb12"><!--[!--><button type="button" class="s-btn s-btn__muted s-btn__outlined w100 d-flex ai-center p8 comments-link" data-so-test="parent-answer-47457772"><!--[!--><!--]--> <div class="flex--item ml8"><p class="mb0">Add a comment</p></div></button><!--]--></div> <!--[--><div role="list"><!--[--><div id="follow-up-93233390" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/3950982/luke-hutchison" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://www.gravatar.com/avatar/7491f45ae073ed6bfe01b1e63fb06bf0?s=48&amp;d=identicon&amp;r=PG" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Luke Hutchison</div> <div class="s-user-card--awards"><!--[--><a href="/users/3950982/luke-hutchison" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Luke Hutchison</a><!--]--> <a class="comment-link" href="#comment93233390_47457772"><time title="2018-11-06T12:28:29.85Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->Right, but the setup cost of sorting the array is O(N log N), so breaking early doesn&#39;t help you if the only reason you are sorting the array is to be able to break early. If, however, you have other reasons to pre-sort the array, then yes, this is valuable.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2018-11-06T12:28:29.85Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-93233390"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">4</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-93233390"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-93233390" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-93233390"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-93233390" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-96577845" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/536086/yochai-timmer" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://www.gravatar.com/avatar/75d228bb162b779392a94d9364969208?s=48&amp;d=identicon&amp;r=PG" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Yochai Timmer</div> <div class="s-user-card--awards"><!--[--><a href="/users/536086/yochai-timmer" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Yochai Timmer</a><!--]--> <a class="comment-link" href="#comment96577845_47457772"><time title="2019-02-27T12:23:22.107Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[--><span class="o50" title="Edited 1 time"><!----><svg aria-hidden="true" class="svg-icon iconPencilSm" width="14" height="14"  viewBox="0 0 14 14"><path fill="#F1B600" d="m2 10.12 6.37-6.43 1.88 1.88L3.88 12H2z"/><path fill="#E87C87" d="m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0"/></svg><!----><!----></span><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->Depends how many times you sort the data compared to how many times you loop on it. The sort in this example is just an example, it doesn&#39;t have to be just before the loop<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2019-02-27T12:23:22.107Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-96577845"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">2</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-96577845"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-96577845" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-96577845"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-96577845" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-96616030" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/3950982/luke-hutchison" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://www.gravatar.com/avatar/7491f45ae073ed6bfe01b1e63fb06bf0?s=48&amp;d=identicon&amp;r=PG" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Luke Hutchison</div> <div class="s-user-card--awards"><!--[--><a href="/users/3950982/luke-hutchison" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Luke Hutchison</a><!--]--> <a class="comment-link" href="#comment96616030_47457772"><time title="2019-02-28T12:28:14.437Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->Yes, that&#39;s exactly the point I made in my first comment :-) You say &quot;The branch prediction will miss only once.&quot; But you are not counting the O(N log N) branch prediction misses inside the sort algorithm, which is actually greater than the O(N) branch prediction misses in the unsorted case. So you would need to use the entirety of the sorted data O(log N) times to break even (probably actually closer to O(10 log N), depending on the sort algorithm, e.g. for quicksort, due to cache misses -- mergesort is more cache-coherent, so you would need closer to O(2 log N) usages to break even.)<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2019-02-28T12:28:14.437Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-96616030"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">4</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-96616030"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-96616030" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-96616030"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-96616030" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-96616273" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/3950982/luke-hutchison" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://www.gravatar.com/avatar/7491f45ae073ed6bfe01b1e63fb06bf0?s=48&amp;d=identicon&amp;r=PG" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Luke Hutchison</div> <div class="s-user-card--awards"><!--[--><a href="/users/3950982/luke-hutchison" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Luke Hutchison</a><!--]--> <a class="comment-link" href="#comment96616273_47457772"><time title="2019-02-28T12:34:48.137Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->One significant optimization though would be to do only &quot;half a quicksort&quot;, sorting only items less than the target pivot value of 127 (assuming everything less than <i>or equal to</i> the pivot is sorted after the pivot). Once you reach the pivot, sum the elements before the pivot. This would run in O(N) startup time rather than O(N log N), although there will still be a lot of branch prediction misses, probably of the order of O(5 N) based on the numbers I gave before, since it&#39;s half a quicksort.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2019-02-28T12:34:48.137Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-96616273"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">2</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-96616273"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-96616273" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-96616273"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-96616273" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-128714705" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/19974/jason-short" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://www.gravatar.com/avatar/1e1d9c504e0f6efe146938295a8ca59a?s=48&amp;d=identicon&amp;r=PG" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Jason Short</div> <div class="s-user-card--awards"><!--[--><a href="/users/19974/jason-short" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Jason Short</a><!--]--> <a class="comment-link" href="#comment128714705_47457772"><time title="2022-07-05T18:23:38.753Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->Came here looking for this exact answer.  Early abort is the main reason to sort.  Limit the search space entirely.  In my testing it was 2x faster again by being able to stop looking much earlier in the loop.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2022-07-05T18:23:38.753Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-128714705"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">0</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-128714705"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-128714705" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-128714705"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-128714705" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><!--]--></div> <!--[--><div class="d-flex g8 my8"><!--[--><button class="s-link s-btn__muted s-btn__outlined comments-link" data-so-test="parent-answer-47457772">Add a comment</button> <!--[!--><!--]--><!--]--> <!--[!--><!--]--></div><!--]--><!----><!--]--> <!--[!--><!--]--></div><!--]-->
</div>

<script type="application/json" data-role="module-args" data-module-name="islands/follow-ups/index.mod">{"replies":[{"id":93233390,"user":{"userId":3950982,"isDeleted":false,"displayName":"Luke Hutchison","url":"/users/3950982/luke-hutchison","profileImageUrl":"https://www.gravatar.com/avatar/7491f45ae073ed6bfe01b1e63fb06bf0?s=48\u0026d=identicon\u0026r=PG","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"LukeHutchison","noSpacesUserName":"LukeHutchison","reputationDisplayText":"0"},"postedAt":"2018-11-06T12:28:29.85Z","postedAtRelative":"Over a year ago","body":"Right, but the setup cost of sorting the array is O(N log N), so breaking early doesn\u0027t help you if the only reason you are sorting the array is to be able to break early. If, however, you have other reasons to pre-sort the array, then yes, this is valuable.","htmlBody":"Right, but the setup cost of sorting the array is O(N log N), so breaking early doesn\u0026#39;t help you if the only reason you are sorting the array is to be able to break early. If, however, you have other reasons to pre-sort the array, then yes, this is valuable.","score":4,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":96577845,"user":{"userId":536086,"isDeleted":false,"displayName":"Yochai Timmer","url":"/users/536086/yochai-timmer","profileImageUrl":"https://www.gravatar.com/avatar/75d228bb162b779392a94d9364969208?s=48\u0026d=identicon\u0026r=PG","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"YochaiTimmer","noSpacesUserName":"YochaiTimmer","reputationDisplayText":"0"},"postedAt":"2019-02-27T12:23:22.107Z","postedAtRelative":"Over a year ago","body":"Depends how many times you sort the data compared to how many times you loop on it. The sort in this example is just an example, it doesn\u0027t have to be just before the loop","htmlBody":"Depends how many times you sort the data compared to how many times you loop on it. The sort in this example is just an example, it doesn\u0026#39;t have to be just before the loop","score":2,"editCount":1,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":96616030,"user":{"userId":3950982,"isDeleted":false,"displayName":"Luke Hutchison","url":"/users/3950982/luke-hutchison","profileImageUrl":"https://www.gravatar.com/avatar/7491f45ae073ed6bfe01b1e63fb06bf0?s=48\u0026d=identicon\u0026r=PG","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"LukeHutchison","noSpacesUserName":"LukeHutchison","reputationDisplayText":"0"},"postedAt":"2019-02-28T12:28:14.437Z","postedAtRelative":"Over a year ago","body":"Yes, that\u0027s exactly the point I made in my first comment :-) You say \u0022The branch prediction will miss only once.\u0022 But you are not counting the O(N log N) branch prediction misses inside the sort algorithm, which is actually greater than the O(N) branch prediction misses in the unsorted case. So you would need to use the entirety of the sorted data O(log N) times to break even (probably actually closer to O(10 log N), depending on the sort algorithm, e.g. for quicksort, due to cache misses -- mergesort is more cache-coherent, so you would need closer to O(2 log N) usages to break even.)","htmlBody":"Yes, that\u0026#39;s exactly the point I made in my first comment :-) You say \u0026quot;The branch prediction will miss only once.\u0026quot; But you are not counting the O(N log N) branch prediction misses inside the sort algorithm, which is actually greater than the O(N) branch prediction misses in the unsorted case. So you would need to use the entirety of the sorted data O(log N) times to break even (probably actually closer to O(10 log N), depending on the sort algorithm, e.g. for quicksort, due to cache misses -- mergesort is more cache-coherent, so you would need closer to O(2 log N) usages to break even.)","score":4,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":96616273,"user":{"userId":3950982,"isDeleted":false,"displayName":"Luke Hutchison","url":"/users/3950982/luke-hutchison","profileImageUrl":"https://www.gravatar.com/avatar/7491f45ae073ed6bfe01b1e63fb06bf0?s=48\u0026d=identicon\u0026r=PG","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"LukeHutchison","noSpacesUserName":"LukeHutchison","reputationDisplayText":"0"},"postedAt":"2019-02-28T12:34:48.137Z","postedAtRelative":"Over a year ago","body":"One significant optimization though would be to do only \u0022half a quicksort\u0022, sorting only items less than the target pivot value of 127 (assuming everything less than *or equal to* the pivot is sorted after the pivot). Once you reach the pivot, sum the elements before the pivot. This would run in O(N) startup time rather than O(N log N), although there will still be a lot of branch prediction misses, probably of the order of O(5 N) based on the numbers I gave before, since it\u0027s half a quicksort.","htmlBody":"One significant optimization though would be to do only \u0026quot;half a quicksort\u0026quot;, sorting only items less than the target pivot value of 127 (assuming everything less than \u003Ci\u003Eor equal to\u003C/i\u003E the pivot is sorted after the pivot). Once you reach the pivot, sum the elements before the pivot. This would run in O(N) startup time rather than O(N log N), although there will still be a lot of branch prediction misses, probably of the order of O(5 N) based on the numbers I gave before, since it\u0026#39;s half a quicksort.","score":2,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":128714705,"user":{"userId":19974,"isDeleted":false,"displayName":"Jason Short","url":"/users/19974/jason-short","profileImageUrl":"https://www.gravatar.com/avatar/1e1d9c504e0f6efe146938295a8ca59a?s=48\u0026d=identicon\u0026r=PG","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"JasonShort","noSpacesUserName":"JasonShort","reputationDisplayText":"0"},"postedAt":"2022-07-05T18:23:38.753Z","postedAtRelative":"Over a year ago","body":"Came here looking for this exact answer.  Early abort is the main reason to sort.  Limit the search space entirely.  In my testing it was 2x faster again by being able to stop looking much earlier in the loop.","htmlBody":"Came here looking for this exact answer.  Early abort is the main reason to sort.  Limit the search space entirely.  In my testing it was 2x faster again by being able to stop looking much earlier in the loop.","score":0,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":true,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true}],"postId":47457772,"currentUserIsMod":false,"currentUserIsAnonymous":true,"commentFlagsRemainingToday":10,"maxNestingLevel":3,"hasOptedOut":false,"showCtaUnderComments":true,"containerElementId":"follow-ups-container-47457772","fKey":"d09ecbbe5140a7c1439a7e4020cdd7d76b52d28795a889bb24233842877804f3","questionId":11227809,"questionAuthorId":87234,"answerId":47457772,"answerPositionOnPage":0,"newUiSettings":{"largerFontSize":false},"showFirstTimeCommentingModal":false,"isMentionEnabled":false,"showSpamFlag":true,"mergeUnfriendlyAndRudeFlags":true,"allowRetractingCommentFlags":true,"commentMinLength":15}</script>
    </div>

        </div>
</div>
                                        
<a name="47700573"></a>
<div id="answer-47700573" class="answer js-answer " data-answerid="47700573"
     data-parentid="11227809" data-score="217" data-position-on-page="20"
     data-highest-scored="0"
     data-question-has-accepted-highest-score="1"
     data-author-username="omkaartg"
     data-author-reputation="2797"
     data-should-show-copy-button=True
     data-se-share-sheet-license-name="CC BY-SA 4.0"
     data-is-edited="True"
      itemprop="suggestedAnswer"
     itemscope itemtype="https://schema.org/Answer">
        <div class="post-layout ">
                <div class="votecell post-layout--left">
                    
<div class="js-voting-container d-flex jc-center fd-column ai-center gs4 fc-black-300" data-post-id="47700573" data-referrer="None">
        <button class="js-vote-up-btn flex--item s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
                id="upvote-btn-47700573"
                data-controller="s-tooltip"
                data-s-tooltip-placement="right"
                title="This answer is useful"
                aria-pressed="false"
                aria-label="Up vote"
                data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
                data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">
            <svg aria-hidden="true" class="svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg>
        </button>
        <input type="hidden" id="voteUpHash" value="70:3:31e,16:3450fd37d1f11175,10:1771427630,16:daec635eb4073786,8:47700573,676b9af25b6588684e558648de45eb95072679965b0df86dfecf4c75746fb4c0" />
        <div class="js-vote-count flex--item d-flex fd-column ai-center fc-theme-body-font fw-bold fs-subheading py4"
             itemprop="upvoteCount"
             data-value="217">
217        </div>
        <button
            class="js-vote-down-btn flex--item mb8 s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
            id=downvote-btn-47700573
            title="This answer is not useful"
            aria-pressed="false"
            aria-label="Down vote"
            data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
            data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">

            <svg aria-hidden="true" class="svg-icon iconArrowDown" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 6h16l-8 8z"/></svg>
        </button>
        <input type="hidden" id="voteDownHash" value="70:3:31e,16:7782dcf187048d0e,10:1771427630,16:d34e5b726b3a71a3,8:47700573,25e11271b4cb0bceebb18ce200715c4b83ec57a3862cab187ae6f752573a4a83" />


        
<button class="js-saves-btn s-btn s-btn__unset c-pointer py4"
        type="button"
        id="saves-btn-47700573"
        data-controller="s-tooltip"
        data-s-tooltip-placement="right"
        data-s-popover-placement=""
        title="Save this answer."
        data-is-saved="false"
        aria-label="Save"
        data-post-id="47700573"
        data-post-type-id="2"
        data-user-privilege-for-post-click="0"
        aria-controls=""
        data-s-popover-auto-show="false"
>
    <svg aria-hidden="true" class="fc-theme-primary-400 js-saves-btn-selected d-none svg-icon iconBookmark" width="18" height="18"  viewBox="0 0 18 18"><path  d="M3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
    <svg aria-hidden="true" class="js-saves-btn-unselected svg-icon iconBookmarkAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m9 10.6 4 2.66V3H5v10.26zM3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
</button>







            <div class="js-accepted-answer-indicator flex--item fc-green-400 py6 mtn8 d-none" data-s-tooltip-placement="right" title="Loading when this answer was accepted&#x2026;" tabindex="0" role="note" aria-label="Accepted">
                <div class="ta-center">
                    <svg aria-hidden="true" class="svg-icon iconCheckmarkLg" width="36" height="36"  viewBox="0 0 36 36"><path  d="m6 14 8 8L30 6v8L14 30l-8-8z"/></svg>
                </div>
            </div>

    
    <a class="js-post-issue flex--item s-btn s-btn__unset c-pointer py6 mx-auto" href="/posts/47700573/timeline" data-shortcut="T" data-ks-title="timeline" data-controller="s-tooltip" data-s-tooltip-placement="right" title="Show activity on this post." aria-label="Timeline"><svg aria-hidden="true" class="mln2 mr0 svg-icon iconHistory" width="19" height="18"  viewBox="0 0 19 18"><path  d="M3 9a8 8 0 1 1 3.73 6.77L8.2 14.3A6 6 0 1 0 5 9l3.01-.01-4 4-4-4zm7-4h1.01L11 9.36l3.22 2.1-.6.93L10 10z"/></svg></a>

</div>

                </div>

            

<div class="answercell post-layout--right">
    


    <div class="s-prose js-post-body" itemprop="text">
<p>Sorted arrays are processed faster than an unsorted array, due to a phenomena called branch prediction.</p>
<p>The branch predictor is a digital circuit (in computer architecture) trying to predict which way a branch will go, improving the flow in the instruction pipeline. The circuit/computer predicts the next step and executes it.</p>
<p>Making a wrong prediction leads to going back to the previous step, and executing with another prediction. Assuming the prediction is correct, the code will continue to the next step. A wrong prediction results in repeating the same step, until a correct prediction occurs.</p>
<p>The answer to your question is very simple.</p>
<p>In an unsorted array, the computer makes multiple predictions, leading to an increased chance of errors.
Whereas, in a sorted array, the computer makes fewer predictions, reducing the chance of errors.
Making more predictions requires more time.</p>
<p>Sorted Array: Straight Road</p>
<pre class="lang-none prettyprint-override"><code>____________________________________________________________________________________
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT
</code></pre>
<p>Unsorted Array: Curved Road</p>
<pre><code>______   ________
|     |__|
</code></pre>
<p>Branch prediction: Guessing/predicting which road is straight and following it without checking</p>
<pre><code>___________________________________________ Straight road
 |_________________________________________|Longer road
</code></pre>
<p>Although both the roads reach the same destination, the straight road is shorter, and the other is longer. If then you choose the other by mistake, there is no turning back, and so you will waste some extra time if you choose the longer road. This is similar to what happens in the computer, and I hope this helped you understand better.</p>
<hr />
<p>Also I want to cite <a href="/u/16940">@Simon_Weaver</a> from the comments:</p>
<blockquote>
<p>It doesnt make fewer predictions - it makes fewer incorrect predictions. It still has to predict for each time through the loop...</p>
</blockquote>
    </div>
    <div class="mt24">
        <div class="d-flex fw-wrap ai-start jc-end gs8 gsy">

            <time itemprop="dateCreated" datetime="2017-12-07 17:28:29Z"></time>
            <div class="flex--item mr16" style="flex: 1 1 100px;">
                


<div class="js-post-menu pt2" data-post-id="47700573" data-post-type-id="2">

    <div class="d-flex gs8 s-anchors s-anchors__muted fw-wrap">

        <div class="flex--item">
            <a href="/a/47700573"
               rel="nofollow"
               itemprop="url"
               class="js-share-link js-gps-track"
               title="Short permalink to this answer"
               data-gps-track="post.click({ item: 2, priv: 0, post_type: 2 })"
               data-controller="se-share-sheet"
               data-se-share-sheet-title="Share a link to this answer"
               data-se-share-sheet-subtitle=""
               data-se-share-sheet-post-type="answer"
               data-se-share-sheet-social="facebook twitter devto"
               data-se-share-sheet-location="2"
               data-se-share-sheet-license-url="https%3a%2f%2fcreativecommons.org%2flicenses%2fby-sa%2f4.0%2f"
               data-se-share-sheet-license-name="CC BY-SA 4.0"
               data-s-popover-placement="bottom-start">Share</a>
        </div>


                    <div class="flex--item">
                        <a href="/posts/47700573/edit" class="js-suggest-edit-post js-gps-track" data-gps-track="post.click({ item: 6, priv: 0, post_type: 2 })" title="">Improve this answer</a>
                    </div>

                <div class="flex--item">
                    <button type="button"
                            id="btnFollowPost-47700573" class="s-btn s-btn__link js-follow-post js-follow-answer js-gps-track"
                            data-gps-track="post.click({ item: 14, priv: 0, post_type: 2 })"
                            data-controller="s-tooltip " data-s-tooltip-placement="bottom"
                            data-s-popover-placement="bottom" aria-controls=""
                            title="Follow this answer to receive notifications">
                        Follow
                        <input type="hidden" id="voteFollowHash" value="70:3:31e,16:b28a4a2e17d9cf5c,10:1771427630,16:9b903dd6d77f9230,8:47700573,c39af0e9f3157d89a14acebcb0c991fa1a814b0b54c4410f34e638bba59a35b4" />
                    </button>
                </div>






    </div>
    <div class="js-menu-popup-container"></div>
</div>
            </div>
            <div class="post-signature flex--item fl0">
<div class="user-info ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            <a href="/posts/47700573/revisions" title="show all edits to this post"
                         class="js-gps-track"
                         data-gps-track="post.click({ item: 4, priv: 0, post_type: 2 })">edited <span title='2021-01-10 15:59:02Z' class='relativetime'>Jan 10, 2021 at 15:59</span></a>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/3204551/deduplicator"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/0a3ee6bc4b5927b369b8c8220586913a?s=64&amp;d=identicon&amp;r=PG&amp;f=y&amp;so-version=2" alt="Deduplicator&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/3204551/deduplicator" dir="auto">Deduplicator</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 45,989" dir="ltr">46k</span><span title="7 gold badges" aria-hidden="true"><span class="badge1"></span><span class="badgecount">7</span></span><span class="v-visible-sr">7 gold badges</span><span title="75 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">75</span></span><span class="v-visible-sr">75 silver badges</span><span title="125 bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">125</span></span><span class="v-visible-sr">125 bronze badges</span>
        </div>
    </div>
</div>
            </div>


                <div class="post-signature flex--item fl0">
                    <div class="user-info user-hover ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            answered <span title='2017-12-07 17:28:29Z' class='relativetime'>Dec 7, 2017 at 17:28</span>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/8459055/omkaartg"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/f9da673d4e6441f527e33cf42a2176b9?s=64&amp;d=identicon&amp;r=PG&amp;f=y&amp;so-version=2" alt="omkaartg&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <a href="/users/8459055/omkaartg" itemprop="url" dir="auto">omkaartg</a><meta itemprop="name" content="omkaartg"/>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">2,797</span><span title="1 gold badge" aria-hidden="true"><span class="badge1"></span><span class="badgecount">1</span></span><span class="v-visible-sr">1 gold badge</span><span title="12 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">12</span></span><span class="v-visible-sr">12 silver badges</span><span title="22 bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">22</span></span><span class="v-visible-sr">22 bronze badges</span>
        </div>
    </div>
</div>


                </div>
        </div>
        
    
    </div>
    
</div>




                

    <div class="post-layout--right">
        

<div id="follow-ups-container-47700573">
    <!--[--><div class="mt16"><div class="mb8 d-flex ai-center g8" role="button" tabindex="0"><h2 class="mb0">Comments</h2> <!--[!--><!--]--></div> <div class="mb12"><!--[!--><button type="button" class="s-btn s-btn__muted s-btn__outlined w100 d-flex ai-center p8 comments-link" data-so-test="parent-answer-47700573"><!--[!--><!--]--> <div class="flex--item ml8"><p class="mb0">Add a comment</p></div></button><!--]--></div> <!--[--><div role="list"><!--[--><!--]--></div> <!--[!--><!--]--><!----><!--]--> <!--[!--><!--]--></div><!--]-->
</div>

<script type="application/json" data-role="module-args" data-module-name="islands/follow-ups/index.mod">{"replies":[],"postId":47700573,"currentUserIsMod":false,"currentUserIsAnonymous":true,"commentFlagsRemainingToday":10,"maxNestingLevel":3,"hasOptedOut":false,"showCtaUnderComments":false,"containerElementId":"follow-ups-container-47700573","fKey":"d09ecbbe5140a7c1439a7e4020cdd7d76b52d28795a889bb24233842877804f3","questionId":11227809,"questionAuthorId":87234,"answerId":47700573,"answerPositionOnPage":0,"newUiSettings":{"largerFontSize":false},"showFirstTimeCommentingModal":false,"isMentionEnabled":false,"showSpamFlag":true,"mergeUnfriendlyAndRudeFlags":true,"allowRetractingCommentFlags":true,"commentMinLength":15}</script>
    </div>

        </div>
</div>
                                        
<a name="14092288"></a>
<div id="answer-14092288" class="answer js-answer " data-answerid="14092288"
     data-parentid="11227809" data-score="195" data-position-on-page="21"
     data-highest-scored="0"
     data-question-has-accepted-highest-score="1"
     data-author-username="Shan"
     data-author-reputation="5252"
     data-should-show-copy-button=True
     data-se-share-sheet-license-name="CC BY-SA 3.0"
     data-is-edited="True"
      itemprop="suggestedAnswer"
     itemscope itemtype="https://schema.org/Answer">
        <div class="post-layout ">
                <div class="votecell post-layout--left">
                    
<div class="js-voting-container d-flex jc-center fd-column ai-center gs4 fc-black-300" data-post-id="14092288" data-referrer="None">
        <button class="js-vote-up-btn flex--item s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
                id="upvote-btn-14092288"
                data-controller="s-tooltip"
                data-s-tooltip-placement="right"
                title="This answer is useful"
                aria-pressed="false"
                aria-label="Up vote"
                data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
                data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">
            <svg aria-hidden="true" class="svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg>
        </button>
        <input type="hidden" id="voteUpHash" value="70:3:31e,16:0bde9a3d05f603aa,10:1771427630,16:3a56c54ccc276bf6,8:14092288,7ab6a767b2707481e65c3821712c90a7b1e4edf1a1fc8016811a29bfbd022503" />
        <div class="js-vote-count flex--item d-flex fd-column ai-center fc-theme-body-font fw-bold fs-subheading py4"
             itemprop="upvoteCount"
             data-value="195">
195        </div>
        <button
            class="js-vote-down-btn flex--item mb8 s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
            id=downvote-btn-14092288
            title="This answer is not useful"
            aria-pressed="false"
            aria-label="Down vote"
            data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
            data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">

            <svg aria-hidden="true" class="svg-icon iconArrowDown" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 6h16l-8 8z"/></svg>
        </button>
        <input type="hidden" id="voteDownHash" value="70:3:31e,16:a49ff1a2cf6f7f83,10:1771427630,16:eec3a5166fe3dfc0,8:14092288,01120147b9c9d355d83c894c299678900a8f2d5bacf5363adc060e68856d2206" />


        
<button class="js-saves-btn s-btn s-btn__unset c-pointer py4"
        type="button"
        id="saves-btn-14092288"
        data-controller="s-tooltip"
        data-s-tooltip-placement="right"
        data-s-popover-placement=""
        title="Save this answer."
        data-is-saved="false"
        aria-label="Save"
        data-post-id="14092288"
        data-post-type-id="2"
        data-user-privilege-for-post-click="0"
        aria-controls=""
        data-s-popover-auto-show="false"
>
    <svg aria-hidden="true" class="fc-theme-primary-400 js-saves-btn-selected d-none svg-icon iconBookmark" width="18" height="18"  viewBox="0 0 18 18"><path  d="M3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
    <svg aria-hidden="true" class="js-saves-btn-unselected svg-icon iconBookmarkAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m9 10.6 4 2.66V3H5v10.26zM3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
</button>







            <div class="js-accepted-answer-indicator flex--item fc-green-400 py6 mtn8 d-none" data-s-tooltip-placement="right" title="Loading when this answer was accepted&#x2026;" tabindex="0" role="note" aria-label="Accepted">
                <div class="ta-center">
                    <svg aria-hidden="true" class="svg-icon iconCheckmarkLg" width="36" height="36"  viewBox="0 0 36 36"><path  d="m6 14 8 8L30 6v8L14 30l-8-8z"/></svg>
                </div>
            </div>

    
    <a class="js-post-issue flex--item s-btn s-btn__unset c-pointer py6 mx-auto" href="/posts/14092288/timeline" data-shortcut="T" data-ks-title="timeline" data-controller="s-tooltip" data-s-tooltip-placement="right" title="Show activity on this post." aria-label="Timeline"><svg aria-hidden="true" class="mln2 mr0 svg-icon iconHistory" width="19" height="18"  viewBox="0 0 19 18"><path  d="M3 9a8 8 0 1 1 3.73 6.77L8.2 14.3A6 6 0 1 0 5 9l3.01-.01-4 4-4-4zm7-4h1.01L11 9.36l3.22 2.1-.6.93L10 10z"/></svg></a>

</div>

                </div>

            

<div class="answercell post-layout--right">
    


    <div class="s-prose js-post-body" itemprop="text">
<p>I tried the same code with MATLAB 2011b with my MacBook Pro (Intel i7, 64 bit, 2.4 GHz) for the following MATLAB code:</p>

<pre><code>% Processing time with Sorted data vs unsorted data
%==========================================================================
% Generate data
arraySize = 32768
sum = 0;
% Generate random integer data from range 0 to 255
data = randi(256, arraySize, 1);


%Sort the data
data1= sort(data); % data1= data  when no sorting done


%Start a stopwatch timer to measure the execution time
tic;

for i=1:100000

    for j=1:arraySize

        if data1(j)&gt;=128
            sum=sum + data1(j);
        end
    end
end

toc;

ExeTimeWithSorting = toc - tic;
</code></pre>

<p>The results for the above MATLAB code are as follows:</p>

<pre><code>  a: Elapsed time (without sorting) = 3479.880861 seconds.
  b: Elapsed time (with sorting ) = 2377.873098 seconds.
</code></pre>

<p>The results of the C code as in @GManNickG I get:</p>

<pre><code>  a: Elapsed time (without sorting) = 19.8761 sec.
  b: Elapsed time (with sorting ) = 7.37778 sec.
</code></pre>

<p>Based on this, it looks MATLAB is almost <em>175 times</em> slower than the C implementation without sorting and <em>350 times</em> slower with sorting. In other words, the effect (of branch prediction) is <em>1.46x</em> for MATLAB implementation and <em>2.7x</em> for the C implementation.</p>
    </div>
    <div class="mt24">
        <div class="d-flex fw-wrap ai-start jc-end gs8 gsy">

            <time itemprop="dateCreated" datetime="2012-12-30 16:16:46Z"></time>
            <div class="flex--item mr16" style="flex: 1 1 100px;">
                


<div class="js-post-menu pt2" data-post-id="14092288" data-post-type-id="2">

    <div class="d-flex gs8 s-anchors s-anchors__muted fw-wrap">

        <div class="flex--item">
            <a href="/a/14092288"
               rel="nofollow"
               itemprop="url"
               class="js-share-link js-gps-track"
               title="Short permalink to this answer"
               data-gps-track="post.click({ item: 2, priv: 0, post_type: 2 })"
               data-controller="se-share-sheet"
               data-se-share-sheet-title="Share a link to this answer"
               data-se-share-sheet-subtitle=""
               data-se-share-sheet-post-type="answer"
               data-se-share-sheet-social="facebook twitter devto"
               data-se-share-sheet-location="2"
               data-se-share-sheet-license-url="https%3a%2f%2fcreativecommons.org%2flicenses%2fby-sa%2f3.0%2f"
               data-se-share-sheet-license-name="CC BY-SA 3.0"
               data-s-popover-placement="bottom-start">Share</a>
        </div>


                    <div class="flex--item">
                        <a href="/posts/14092288/edit" class="js-suggest-edit-post js-gps-track" data-gps-track="post.click({ item: 6, priv: 0, post_type: 2 })" title="">Improve this answer</a>
                    </div>

                <div class="flex--item">
                    <button type="button"
                            id="btnFollowPost-14092288" class="s-btn s-btn__link js-follow-post js-follow-answer js-gps-track"
                            data-gps-track="post.click({ item: 14, priv: 0, post_type: 2 })"
                            data-controller="s-tooltip " data-s-tooltip-placement="bottom"
                            data-s-popover-placement="bottom" aria-controls=""
                            title="Follow this answer to receive notifications">
                        Follow
                        <input type="hidden" id="voteFollowHash" value="70:3:31e,16:c7338e2dacd4a052,10:1771427630,16:bd6ddc87c8b8a559,8:14092288,c7011096f655531885ce5e897ce3ddb4a7fa7a866e1421377855b88aad2d3e58" />
                    </button>
                </div>






    </div>
    <div class="js-menu-popup-container"></div>
</div>
            </div>
            <div class="post-signature flex--item fl0">
<div class="user-info user-hover ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            <a href="/posts/14092288/revisions" title="show all edits to this post"
                         class="js-gps-track"
                         data-gps-track="post.click({ item: 4, priv: 0, post_type: 2 })">edited <span title='2018-03-16 12:45:34Z' class='relativetime'>Mar 16, 2018 at 12:45</span></a>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/63550/peter-mortensen"><div class="gravatar-wrapper-32"><img src="https://i.sstatic.net/RIZKi.png?s=64" alt="Peter Mortensen&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/63550/peter-mortensen" dir="auto">Peter Mortensen</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 31,210" dir="ltr">31.2k</span><span title="22 gold badges" aria-hidden="true"><span class="badge1"></span><span class="badgecount">22</span></span><span class="v-visible-sr">22 gold badges</span><span title="111 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">111</span></span><span class="v-visible-sr">111 silver badges</span><span title="134 bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">134</span></span><span class="v-visible-sr">134 bronze badges</span>
        </div>
    </div>
</div>
            </div>


                <div class="post-signature flex--item fl0">
                    <div class="user-info user-hover ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            answered <span title='2012-12-30 16:16:46Z' class='relativetime'>Dec 30, 2012 at 16:16</span>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/1020149/shan"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/911f564e95671ac04ec1841524d76171?s=64&amp;d=identicon&amp;r=PG" alt="Shan&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <a href="/users/1020149/shan" itemprop="url" dir="auto">Shan</a><meta itemprop="name" content="Shan"/>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">5,252</span><span title="13 gold badges" aria-hidden="true"><span class="badge1"></span><span class="badgecount">13</span></span><span class="v-visible-sr">13 gold badges</span><span title="47 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">47</span></span><span class="v-visible-sr">47 silver badges</span><span title="59 bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">59</span></span><span class="v-visible-sr">59 bronze badges</span>
        </div>
    </div>
</div>


                </div>
        </div>
        
    
    </div>
    
</div>




                

    <div class="post-layout--right">
        

<div id="follow-ups-container-14092288">
    <!--[--><div class="mt16"><div class="mb8 d-flex ai-center g8 c-pointer" role="button" tabindex="0"><h2 class="mb0">3 Comments</h2> <!--[--><!--[--><!----><svg aria-hidden="true" class="svg-icon iconArrowDownAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m16.01 7.43-1.4-1.41L9 11.6 3.42 6l-1.4 1.42 7 7z"/></svg><!----><!--]--><!--]--></div> <div class="mb12"><!--[!--><button type="button" class="s-btn s-btn__muted s-btn__outlined w100 d-flex ai-center p8 comments-link" data-so-test="parent-answer-14092288"><!--[!--><!--]--> <div class="flex--item ml8"><p class="mb0">Add a comment</p></div></button><!--]--></div> <!--[--><div role="list"><!--[--><div id="follow-up-23890444" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/274579/ysap" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://www.gravatar.com/avatar/745415fffcdea46caf03c90534a4c7fa?s=48&amp;d=identicon&amp;r=PG" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">ysap</div> <div class="s-user-card--awards"><!--[--><a href="/users/274579/ysap" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">ysap</a><!--]--> <a class="comment-link" href="#comment23890444_14092288"><time title="2013-05-17T19:53:00.383Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->Just for the sake of completeness, this is probably not how you&#39;d implement that in Matlab. I bet it&#39;d be much faster if done after vectorizing the problem.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2013-05-17T19:53:00.383Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-23890444"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">11</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-23890444"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-23890444" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-23890444"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-23890444" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-23895018" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/1020149/shan" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://www.gravatar.com/avatar/911f564e95671ac04ec1841524d76171?s=48&amp;d=identicon&amp;r=PG" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Shan</div> <div class="s-user-card--awards"><!--[--><a href="/users/1020149/shan" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Shan</a><!--]--> <a class="comment-link" href="#comment23895018_14092288"><time title="2013-05-17T23:50:24.44Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[--><span class="o50" title="Edited 1 time"><!----><svg aria-hidden="true" class="svg-icon iconPencilSm" width="14" height="14"  viewBox="0 0 14 14"><path fill="#F1B600" d="m2 10.12 6.37-6.43 1.88 1.88L3.88 12H2z"/><path fill="#E87C87" d="m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0"/></svg><!----><!----></span><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->Matlab does automatic parallelization / vectorization in many situations but the issue here is to check the effect of branch prediction. Matlab is not immune in anyway!<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2013-05-17T23:50:24.44Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-23895018"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">3</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-23895018"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-23895018" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-23895018"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-23895018" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-27061346" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/53897/thorbj%c3%b8rn-ravn-andersen" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://i.sstatic.net/enNdg.jpg?s=64" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Thorbjrn Ravn Andersen</div> <div class="s-user-card--awards"><!--[--><a href="/users/53897/thorbj%c3%b8rn-ravn-andersen" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Thorbjrn Ravn Andersen</a><!--]--> <a class="comment-link" href="#comment27061346_14092288"><time title="2013-08-24T16:34:32.777Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->Does matlab use native numbers or a mat lab specific implementation (infinite amount of digits or so?)<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2013-08-24T16:34:32.777Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-27061346"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">3</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-27061346"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-27061346" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-27061346"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-27061346" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><!--]--></div> <!--[--><div class="d-flex g8 my8"><!--[--><button class="s-link s-btn__muted s-btn__outlined comments-link" data-so-test="parent-answer-14092288">Add a comment</button> <!--[!--><!--]--><!--]--> <!--[!--><!--]--></div><!--]--><!----><!--]--> <!--[!--><!--]--></div><!--]-->
</div>

<script type="application/json" data-role="module-args" data-module-name="islands/follow-ups/index.mod">{"replies":[{"id":23890444,"user":{"userId":274579,"isDeleted":false,"displayName":"ysap","url":"/users/274579/ysap","profileImageUrl":"https://www.gravatar.com/avatar/745415fffcdea46caf03c90534a4c7fa?s=48\u0026d=identicon\u0026r=PG","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"ysap","noSpacesUserName":"ysap","reputationDisplayText":"0"},"postedAt":"2013-05-17T19:53:00.383Z","postedAtRelative":"Over a year ago","body":"Just for the sake of completeness, this is probably not how you\u0027d implement that in Matlab. I bet it\u0027d be much faster if done after vectorizing the problem.","htmlBody":"Just for the sake of completeness, this is probably not how you\u0026#39;d implement that in Matlab. I bet it\u0026#39;d be much faster if done after vectorizing the problem.","score":11,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":23895018,"user":{"userId":1020149,"isDeleted":false,"displayName":"Shan","url":"/users/1020149/shan","profileImageUrl":"https://www.gravatar.com/avatar/911f564e95671ac04ec1841524d76171?s=48\u0026d=identicon\u0026r=PG","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"Shan","noSpacesUserName":"Shan","reputationDisplayText":"0"},"postedAt":"2013-05-17T23:50:24.44Z","postedAtRelative":"Over a year ago","body":"Matlab does automatic parallelization / vectorization in many situations but the issue here is to check the effect of branch prediction. Matlab is not immune in anyway!","htmlBody":"Matlab does automatic parallelization / vectorization in many situations but the issue here is to check the effect of branch prediction. Matlab is not immune in anyway!","score":3,"editCount":1,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":27061346,"user":{"userId":53897,"isDeleted":false,"displayName":"Thorbj\u00F8rn Ravn Andersen","url":"/users/53897/thorbj%c3%b8rn-ravn-andersen","profileImageUrl":"https://i.sstatic.net/enNdg.jpg?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"Thorbj\u0026#248;rnRavnAndersen","noSpacesUserName":"Thorbj\u00F8rnRavnAndersen","reputationDisplayText":"0"},"postedAt":"2013-08-24T16:34:32.777Z","postedAtRelative":"Over a year ago","body":"Does matlab use native numbers or a mat lab specific implementation (infinite amount of digits or so?)","htmlBody":"Does matlab use native numbers or a mat lab specific implementation (infinite amount of digits or so?)","score":3,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":true,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true}],"postId":14092288,"currentUserIsMod":false,"currentUserIsAnonymous":true,"commentFlagsRemainingToday":10,"maxNestingLevel":3,"hasOptedOut":false,"showCtaUnderComments":true,"containerElementId":"follow-ups-container-14092288","fKey":"d09ecbbe5140a7c1439a7e4020cdd7d76b52d28795a889bb24233842877804f3","questionId":11227809,"questionAuthorId":87234,"answerId":14092288,"answerPositionOnPage":0,"newUiSettings":{"largerFontSize":false},"showFirstTimeCommentingModal":false,"isMentionEnabled":false,"showSpamFlag":true,"mergeUnfriendlyAndRudeFlags":true,"allowRetractingCommentFlags":true,"commentMinLength":15}</script>
    </div>

        </div>
</div>
                                        
<a name="53689911"></a>
<div id="answer-53689911" class="answer js-answer " data-answerid="53689911"
     data-parentid="11227809" data-score="126" data-position-on-page="22"
     data-highest-scored="0"
     data-question-has-accepted-highest-score="1"
     data-author-username="user2297550"
     data-author-reputation="3404"
     data-should-show-copy-button=True
     data-se-share-sheet-license-name="CC BY-SA 4.0"
     data-is-edited="True"
      itemprop="suggestedAnswer"
     itemscope itemtype="https://schema.org/Answer">
        <div class="post-layout ">
                <div class="votecell post-layout--left">
                    
<div class="js-voting-container d-flex jc-center fd-column ai-center gs4 fc-black-300" data-post-id="53689911" data-referrer="None">
        <button class="js-vote-up-btn flex--item s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
                id="upvote-btn-53689911"
                data-controller="s-tooltip"
                data-s-tooltip-placement="right"
                title="This answer is useful"
                aria-pressed="false"
                aria-label="Up vote"
                data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
                data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">
            <svg aria-hidden="true" class="svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg>
        </button>
        <input type="hidden" id="voteUpHash" value="70:3:31e,16:9fc4ad3a30203c9f,10:1771427630,16:7ca777e7d884d825,8:53689911,1cc47c08e4a443a29eee635dcd8261739e8398fed97f75cbb39180ac0b780d0b" />
        <div class="js-vote-count flex--item d-flex fd-column ai-center fc-theme-body-font fw-bold fs-subheading py4"
             itemprop="upvoteCount"
             data-value="126">
126        </div>
        <button
            class="js-vote-down-btn flex--item mb8 s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
            id=downvote-btn-53689911
            title="This answer is not useful"
            aria-pressed="false"
            aria-label="Down vote"
            data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
            data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">

            <svg aria-hidden="true" class="svg-icon iconArrowDown" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 6h16l-8 8z"/></svg>
        </button>
        <input type="hidden" id="voteDownHash" value="70:3:31e,16:930a6287f779927e,10:1771427630,16:eda216fe0bb9d1b7,8:53689911,052597bc85cc7f32cfb055d939a63cbaf8c04ee878516d8d0f2acccc87d69cf4" />


        
<button class="js-saves-btn s-btn s-btn__unset c-pointer py4"
        type="button"
        id="saves-btn-53689911"
        data-controller="s-tooltip"
        data-s-tooltip-placement="right"
        data-s-popover-placement=""
        title="Save this answer."
        data-is-saved="false"
        aria-label="Save"
        data-post-id="53689911"
        data-post-type-id="2"
        data-user-privilege-for-post-click="0"
        aria-controls=""
        data-s-popover-auto-show="false"
>
    <svg aria-hidden="true" class="fc-theme-primary-400 js-saves-btn-selected d-none svg-icon iconBookmark" width="18" height="18"  viewBox="0 0 18 18"><path  d="M3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
    <svg aria-hidden="true" class="js-saves-btn-unselected svg-icon iconBookmarkAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m9 10.6 4 2.66V3H5v10.26zM3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
</button>







            <div class="js-accepted-answer-indicator flex--item fc-green-400 py6 mtn8 d-none" data-s-tooltip-placement="right" title="Loading when this answer was accepted&#x2026;" tabindex="0" role="note" aria-label="Accepted">
                <div class="ta-center">
                    <svg aria-hidden="true" class="svg-icon iconCheckmarkLg" width="36" height="36"  viewBox="0 0 36 36"><path  d="m6 14 8 8L30 6v8L14 30l-8-8z"/></svg>
                </div>
            </div>

    
    <a class="js-post-issue flex--item s-btn s-btn__unset c-pointer py6 mx-auto" href="/posts/53689911/timeline" data-shortcut="T" data-ks-title="timeline" data-controller="s-tooltip" data-s-tooltip-placement="right" title="Show activity on this post." aria-label="Timeline"><svg aria-hidden="true" class="mln2 mr0 svg-icon iconHistory" width="19" height="18"  viewBox="0 0 19 18"><path  d="M3 9a8 8 0 1 1 3.73 6.77L8.2 14.3A6 6 0 1 0 5 9l3.01-.01-4 4-4-4zm7-4h1.01L11 9.36l3.22 2.1-.6.93L10 10z"/></svg></a>

</div>

                </div>

            

<div class="answercell post-layout--right">
    


    <div class="s-prose js-post-body" itemprop="text">
<p>The assumption by other answers that one needs to sort the data is not correct.</p>

<p>The following code does not sort the entire array, but only 200-element segments of it, and thereby runs the fastest.</p>

<p>Sorting only k-element sections completes the pre-processing in linear time, <code>O(n)</code>, rather than the <code>O(n.log(n))</code> time needed to sort the entire array.</p>

<pre><code>#include &lt;algorithm&gt;
#include &lt;ctime&gt;
#include &lt;iostream&gt;

int main() {
    int data[32768]; const int l = sizeof data / sizeof data[0];

    for (unsigned c = 0; c &lt; l; ++c)
        data[c] = std::rand() % 256;

    // sort 200-element segments, not the whole array
    for (unsigned c = 0; c + 200 &lt;= l; c += 200)
        std::sort(&amp;data[c], &amp;data[c + 200]);

    clock_t start = clock();
    long long sum = 0;

    for (unsigned i = 0; i &lt; 100000; ++i) {
        for (unsigned c = 0; c &lt; sizeof data / sizeof(int); ++c) {
            if (data[c] &gt;= 128)
                sum += data[c];
        }
    }

    std::cout &lt;&lt; static_cast&lt;double&gt;(clock() - start) / CLOCKS_PER_SEC &lt;&lt; std::endl;
    std::cout &lt;&lt; "sum = " &lt;&lt; sum &lt;&lt; std::endl;
}
</code></pre>

<p>This also "proves" that it has nothing to do with any algorithmic issue such as sort order, and it is indeed branch prediction.</p>
    </div>
    <div class="mt24">
        <div class="d-flex fw-wrap ai-start jc-end gs8 gsy">

            <time itemprop="dateCreated" datetime="2018-12-09 06:18:17Z"></time>
            <div class="flex--item mr16" style="flex: 1 1 100px;">
                


<div class="js-post-menu pt2" data-post-id="53689911" data-post-type-id="2">

    <div class="d-flex gs8 s-anchors s-anchors__muted fw-wrap">

        <div class="flex--item">
            <a href="/a/53689911"
               rel="nofollow"
               itemprop="url"
               class="js-share-link js-gps-track"
               title="Short permalink to this answer"
               data-gps-track="post.click({ item: 2, priv: 0, post_type: 2 })"
               data-controller="se-share-sheet"
               data-se-share-sheet-title="Share a link to this answer"
               data-se-share-sheet-subtitle=""
               data-se-share-sheet-post-type="answer"
               data-se-share-sheet-social="facebook twitter devto"
               data-se-share-sheet-location="2"
               data-se-share-sheet-license-url="https%3a%2f%2fcreativecommons.org%2flicenses%2fby-sa%2f4.0%2f"
               data-se-share-sheet-license-name="CC BY-SA 4.0"
               data-s-popover-placement="bottom-start">Share</a>
        </div>


                    <div class="flex--item">
                        <a href="/posts/53689911/edit" class="js-suggest-edit-post js-gps-track" data-gps-track="post.click({ item: 6, priv: 0, post_type: 2 })" title="">Improve this answer</a>
                    </div>

                <div class="flex--item">
                    <button type="button"
                            id="btnFollowPost-53689911" class="s-btn s-btn__link js-follow-post js-follow-answer js-gps-track"
                            data-gps-track="post.click({ item: 14, priv: 0, post_type: 2 })"
                            data-controller="s-tooltip " data-s-tooltip-placement="bottom"
                            data-s-popover-placement="bottom" aria-controls=""
                            title="Follow this answer to receive notifications">
                        Follow
                        <input type="hidden" id="voteFollowHash" value="70:3:31e,16:c1a6d37faa091a65,10:1771427630,16:13b8283347cb52eb,8:53689911,577af118e793229a59647bdd388584f23ed82131dacaa98a6b09af51552140a9" />
                    </button>
                </div>






    </div>
    <div class="js-menu-popup-container"></div>
</div>
            </div>
            <div class="post-signature flex--item fl0">
<div class="user-info ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            <a href="/posts/53689911/revisions" title="show all edits to this post"
                         class="js-gps-track"
                         data-gps-track="post.click({ item: 4, priv: 0, post_type: 2 })">edited <span title='2019-07-02 04:08:17Z' class='relativetime'>Jul 2, 2019 at 4:08</span></a>
        </div>
        
    </div>
    <div class="user-gravatar32">
        
    </div>
    <div class="user-details">
        
        <div class="-flair">
            
        </div>
    </div>
</div>
            </div>


                <div class="post-signature flex--item fl0">
                    <div class="user-info ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            answered <span title='2018-12-09 06:18:17Z' class='relativetime'>Dec 9, 2018 at 6:18</span>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/2297550/user2297550"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/20092a7b6e8eebf36a9c28951bd2261f?s=64&amp;d=identicon&amp;r=PG" alt="user2297550&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <a href="/users/2297550/user2297550" itemprop="url" dir="auto">user2297550</a><meta itemprop="name" content="user2297550"/>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">3,404</span><span title="3 gold badges" aria-hidden="true"><span class="badge1"></span><span class="badgecount">3</span></span><span class="v-visible-sr">3 gold badges</span><span title="30 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">30</span></span><span class="v-visible-sr">30 silver badges</span><span title="44 bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">44</span></span><span class="v-visible-sr">44 bronze badges</span>
        </div>
    </div>
</div>


                </div>
        </div>
        
    
    </div>
    
</div>




                

    <div class="post-layout--right">
        

<div id="follow-ups-container-53689911">
    <!--[--><div class="mt16"><div class="mb8 d-flex ai-center g8 c-pointer" role="button" tabindex="0"><h2 class="mb0">9 Comments</h2> <!--[--><!--[--><!----><svg aria-hidden="true" class="svg-icon iconArrowDownAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m16.01 7.43-1.4-1.41L9 11.6 3.42 6l-1.4 1.42 7 7z"/></svg><!----><!--]--><!--]--></div> <div class="mb12"><!--[!--><button type="button" class="s-btn s-btn__muted s-btn__outlined w100 d-flex ai-center p8" data-so-test="parent-answer-53689911"><!--[!--><!--]--> <div class="flex--item ml8"><p class="mb0">Add a comment</p></div></button><!--]--></div> <!--[--><div role="list"><!--[--><div id="follow-up-96615671" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/3950982/luke-hutchison" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://www.gravatar.com/avatar/7491f45ae073ed6bfe01b1e63fb06bf0?s=48&amp;d=identicon&amp;r=PG" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Luke Hutchison</div> <div class="s-user-card--awards"><!--[--><a href="/users/3950982/luke-hutchison" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Luke Hutchison</a><!--]--> <a class="comment-link" href="#comment96615671_53689911"><time title="2019-02-28T12:18:29.557Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[--><span class="o50" title="Edited 1 time"><!----><svg aria-hidden="true" class="svg-icon iconPencilSm" width="14" height="14"  viewBox="0 0 14 14"><path fill="#F1B600" d="m2 10.12 6.37-6.43 1.88 1.88L3.88 12H2z"/><path fill="#E87C87" d="m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0"/></svg><!----><!----></span><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->I don&#39;t really see how this proves anything? The only thing you have shown is that &quot;not doing all the work of sorting the whole array takes less time than sorting the whole array&quot;. Your claim that this &quot;also runs fastest&quot; is very architecture-dependent. See my answer about how this works on ARM. PS you could make your code faster on non-ARM architectures by putting the summation inside the 200-element block loop, sorting in reverse, and then using Yochai Timmer&#39;s suggestion of breaking once you get an out-of range value. That way each 200-element block summation can be terminated early.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2019-02-28T12:18:29.557Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-96615671"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">9</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-96615671"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-96615671" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-96615671"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-96615671" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-104848977" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/224132/peter-cordes" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://i.sstatic.net/N4ivW.png?s=64" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Peter Cordes</div> <div class="s-user-card--awards"><!--[--><a href="/users/224132/peter-cordes" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Peter Cordes</a><!--]--> <a class="comment-link" href="#comment104848977_53689911"><time title="2019-12-13T14:44:53.957Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[--><span class="o50" title="Edited 1 time"><!----><svg aria-hidden="true" class="svg-icon iconPencilSm" width="14" height="14"  viewBox="0 0 14 14"><path fill="#F1B600" d="m2 10.12 6.37-6.43 1.88 1.88L3.88 12H2z"/><path fill="#E87C87" d="m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0"/></svg><!----><!----></span><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->If you just want to implement the algorithm efficiently over unsorted data, you would do that operation branchlessly (and with SIMD, e.g. with x86 <code>pcmpgtb</code> to find elements with their high bit set, then AND to zero smaller elements).  Spending any time actually sorting chunks would be slower.  A branchless version would have data-independent performance, also proving that the cost came from branch misprediction.  Or just use performance counters to observe that directly, like Skylake <code>int_misc.clear_resteer_cycles</code> or <code>int_misc.recovery_cycles</code> to count front-end idle cycles from mispredicts<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2019-12-13T14:44:53.957Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-104848977"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">2</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-104848977"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-104848977" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-104848977"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-104848977" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-107930122" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/2297550/user2297550" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://www.gravatar.com/avatar/20092a7b6e8eebf36a9c28951bd2261f?s=48&amp;d=identicon&amp;r=PG" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">user2297550</div> <div class="s-user-card--awards"><!--[--><a href="/users/2297550/user2297550" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">user2297550</a><!--]--> <a class="comment-link" href="#comment107930122_53689911"><time title="2020-04-03T06:44:26.627Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->Both comments above seem to ignore the general algorithmic issues and complexity, in favor of advocating specialized hardware with special machine instructions. I find the first one particularly petty in that it blithely dismisses the important general insights in this answer in blind favor of specialized machine instructions.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2020-04-03T06:44:26.627Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-107930122"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">3</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-107930122"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-107930122" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-107930122"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-107930122" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-120275132" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/2297550/user2297550" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://www.gravatar.com/avatar/20092a7b6e8eebf36a9c28951bd2261f?s=48&amp;d=identicon&amp;r=PG" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">user2297550</div> <div class="s-user-card--awards"><!--[--><a href="/users/2297550/user2297550" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">user2297550</a><!--]--> <a class="comment-link" href="#comment120275132_53689911"><time title="2021-06-19T17:50:55.273Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->Also note that specialized hardware instructions do not help if the computation within the <code>if</code> is more complicated than an simple addition, which is quite likely in the general case. Therefore, this answer is unique in offering a general solution that is still <code>O(n)</code><!----><!--]--></div> <time class="d-none" itemprop="datePublished">2021-06-19T17:50:55.273Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-120275132"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">2</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-120275132"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-120275132" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-120275132"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-120275132" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-127160594" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/224132/peter-cordes" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://i.sstatic.net/N4ivW.png?s=64" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Peter Cordes</div> <div class="s-user-card--awards"><!--[--><a href="/users/224132/peter-cordes" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Peter Cordes</a><!--]--> <a class="comment-link" href="#comment127160594_53689911"><time title="2022-04-22T01:45:12.513Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->Just for the record, since our previous comments have been nuked, I don&#39;t think there&#39;s anything to gain in <i>overall</i> performance by spending time (partially) sorting, unless you&#39;re artificially repeating the loop over the array like in this microbenchmark.  Then yes, this piecewise sort gets close to the benefit of a full sort (e.g. 2.4s for this vs. 1.7s for a full sort on Skylake, vs. 10.9s for no sort before doing 100k passes.  If you use <code>g++ -Os -Wa,-mbranches-within-32B-boundaries</code> to make branchy asm in the first place instead of a normal build).<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2022-04-22T01:45:12.513Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-127160594"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">2</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-127160594"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-127160594" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-127160594"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-127160594" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><!--]--></div> <!--[--><div class="d-flex g8 my8"><!--[--><button class="s-link s-btn__muted s-btn__outlined comments-link" data-so-test="parent-answer-53689911">Add a comment</button> <!--[--><span>|</span><!--]--><!--]--> <!--[--><button class="s-link s-btn__muted s-btn__outlined comments-link">Show 4 more comments</button><!--]--></div><!--]--><!----><!--]--> <!--[!--><!--]--></div><!--]-->
</div>

<script type="application/json" data-role="module-args" data-module-name="islands/follow-ups/index.mod">{"replies":[{"id":96615671,"user":{"userId":3950982,"isDeleted":false,"displayName":"Luke Hutchison","url":"/users/3950982/luke-hutchison","profileImageUrl":"https://www.gravatar.com/avatar/7491f45ae073ed6bfe01b1e63fb06bf0?s=48\u0026d=identicon\u0026r=PG","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"LukeHutchison","noSpacesUserName":"LukeHutchison","reputationDisplayText":"0"},"postedAt":"2019-02-28T12:18:29.557Z","postedAtRelative":"Over a year ago","body":"I don\u0027t really see how this proves anything? The only thing you have shown is that \u0022not doing all the work of sorting the whole array takes less time than sorting the whole array\u0022. Your claim that this \u0022also runs fastest\u0022 is very architecture-dependent. See my answer about how this works on ARM. PS you could make your code faster on non-ARM architectures by putting the summation inside the 200-element block loop, sorting in reverse, and then using Yochai Timmer\u0027s suggestion of breaking once you get an out-of range value. That way each 200-element block summation can be terminated early.","htmlBody":"I don\u0026#39;t really see how this proves anything? The only thing you have shown is that \u0026quot;not doing all the work of sorting the whole array takes less time than sorting the whole array\u0026quot;. Your claim that this \u0026quot;also runs fastest\u0026quot; is very architecture-dependent. See my answer about how this works on ARM. PS you could make your code faster on non-ARM architectures by putting the summation inside the 200-element block loop, sorting in reverse, and then using Yochai Timmer\u0026#39;s suggestion of breaking once you get an out-of range value. That way each 200-element block summation can be terminated early.","score":9,"editCount":1,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":104848977,"user":{"userId":224132,"isDeleted":false,"displayName":"Peter Cordes","url":"/users/224132/peter-cordes","profileImageUrl":"https://i.sstatic.net/N4ivW.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"PeterCordes","noSpacesUserName":"PeterCordes","reputationDisplayText":"0"},"postedAt":"2019-12-13T14:44:53.957Z","postedAtRelative":"Over a year ago","body":"If you just want to implement the algorithm efficiently over unsorted data, you would do that operation branchlessly (and with SIMD, e.g. with x86 \u0060pcmpgtb\u0060 to find elements with their high bit set, then AND to zero smaller elements).  Spending any time actually sorting chunks would be slower.  A branchless version would have data-independent performance, also proving that the cost came from branch misprediction.  Or just use performance counters to observe that directly, like Skylake \u0060int_misc.clear_resteer_cycles\u0060 or \u0060int_misc.recovery_cycles\u0060 to count front-end idle cycles from mispredicts","htmlBody":"If you just want to implement the algorithm efficiently over unsorted data, you would do that operation branchlessly (and with SIMD, e.g. with x86 \u003Ccode\u003Epcmpgtb\u003C/code\u003E to find elements with their high bit set, then AND to zero smaller elements).  Spending any time actually sorting chunks would be slower.  A branchless version would have data-independent performance, also proving that the cost came from branch misprediction.  Or just use performance counters to observe that directly, like Skylake \u003Ccode\u003Eint_misc.clear_resteer_cycles\u003C/code\u003E or \u003Ccode\u003Eint_misc.recovery_cycles\u003C/code\u003E to count front-end idle cycles from mispredicts","score":2,"editCount":1,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":107930122,"user":{"userId":2297550,"isDeleted":false,"displayName":"user2297550","url":"/users/2297550/user2297550","profileImageUrl":"https://www.gravatar.com/avatar/20092a7b6e8eebf36a9c28951bd2261f?s=48\u0026d=identicon\u0026r=PG","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"user2297550","noSpacesUserName":"user2297550","reputationDisplayText":"0"},"postedAt":"2020-04-03T06:44:26.627Z","postedAtRelative":"Over a year ago","body":"Both comments above seem to ignore the general algorithmic issues and complexity, in favor of advocating specialized hardware with special machine instructions. I find the first one particularly petty in that it blithely dismisses the important general insights in this answer in blind favor of specialized machine instructions.","htmlBody":"Both comments above seem to ignore the general algorithmic issues and complexity, in favor of advocating specialized hardware with special machine instructions. I find the first one particularly petty in that it blithely dismisses the important general insights in this answer in blind favor of specialized machine instructions.","score":3,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":120275132,"user":{"userId":2297550,"isDeleted":false,"displayName":"user2297550","url":"/users/2297550/user2297550","profileImageUrl":"https://www.gravatar.com/avatar/20092a7b6e8eebf36a9c28951bd2261f?s=48\u0026d=identicon\u0026r=PG","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"user2297550","noSpacesUserName":"user2297550","reputationDisplayText":"0"},"postedAt":"2021-06-19T17:50:55.273Z","postedAtRelative":"Over a year ago","body":"Also note that specialized hardware instructions do not help if the computation within the \u0060if\u0060 is more complicated than an simple addition, which is quite likely in the general case. Therefore, this answer is unique in offering a general solution that is still \u0060O(n)\u0060","htmlBody":"Also note that specialized hardware instructions do not help if the computation within the \u003Ccode\u003Eif\u003C/code\u003E is more complicated than an simple addition, which is quite likely in the general case. Therefore, this answer is unique in offering a general solution that is still \u003Ccode\u003EO(n)\u003C/code\u003E","score":2,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":127160594,"user":{"userId":224132,"isDeleted":false,"displayName":"Peter Cordes","url":"/users/224132/peter-cordes","profileImageUrl":"https://i.sstatic.net/N4ivW.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"PeterCordes","noSpacesUserName":"PeterCordes","reputationDisplayText":"0"},"postedAt":"2022-04-22T01:45:12.513Z","postedAtRelative":"Over a year ago","body":"Just for the record, since our previous comments have been nuked, I don\u0027t think there\u0027s anything to gain in *overall* performance by spending time (partially) sorting, unless you\u0027re artificially repeating the loop over the array like in this microbenchmark.  Then yes, this piecewise sort gets close to the benefit of a full sort (e.g. 2.4s for this vs. 1.7s for a full sort on Skylake, vs. 10.9s for no sort before doing 100k passes.  If you use \u0060g\u002B\u002B -Os -Wa,-mbranches-within-32B-boundaries\u0060 to make branchy asm in the first place instead of a normal build).","htmlBody":"Just for the record, since our previous comments have been nuked, I don\u0026#39;t think there\u0026#39;s anything to gain in \u003Ci\u003Eoverall\u003C/i\u003E performance by spending time (partially) sorting, unless you\u0026#39;re artificially repeating the loop over the array like in this microbenchmark.  Then yes, this piecewise sort gets close to the benefit of a full sort (e.g. 2.4s for this vs. 1.7s for a full sort on Skylake, vs. 10.9s for no sort before doing 100k passes.  If you use \u003Ccode\u003Eg\u002B\u002B -Os -Wa,-mbranches-within-32B-boundaries\u003C/code\u003E to make branchy asm in the first place instead of a normal build).","score":2,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":127160613,"user":{"userId":224132,"isDeleted":false,"displayName":"Peter Cordes","url":"/users/224132/peter-cordes","profileImageUrl":"https://i.sstatic.net/N4ivW.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"PeterCordes","noSpacesUserName":"PeterCordes","reputationDisplayText":"0"},"postedAt":"2022-04-22T01:47:36.423Z","postedAtRelative":"Over a year ago","body":"For *one* pass of the inner loop over the array, it would be even faster to just do it, not to sort first.  Even partial sorting is only worth it if you can amortize the benefit over multiple passes over the array.  That is O(n), but still costs significant time to do comparison-based sorting even in small chunks, branching on each element multiple times.  As this says, *The assumption by other answers that one needs to sort the data is not correct.* - you don\u0027t *need* to do any sorting at all if you care about *overall* time taken, without being able to do sorting outside the timed region.","htmlBody":"For \u003Ci\u003Eone\u003C/i\u003E pass of the inner loop over the array, it would be even faster to just do it, not to sort first.  Even partial sorting is only worth it if you can amortize the benefit over multiple passes over the array.  That is O(n), but still costs significant time to do comparison-based sorting even in small chunks, branching on each element multiple times.  As this says, \u003Ci\u003EThe assumption by other answers that one needs to sort the data is not correct.\u003C/i\u003E - you don\u0026#39;t \u003Ci\u003Eneed\u003C/i\u003E to do any sorting at all if you care about \u003Ci\u003Eoverall\u003C/i\u003E time taken, without being able to do sorting outside the timed region.","score":0,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false},{"id":127165904,"user":{"userId":2297550,"isDeleted":false,"displayName":"user2297550","url":"/users/2297550/user2297550","profileImageUrl":"https://www.gravatar.com/avatar/20092a7b6e8eebf36a9c28951bd2261f?s=48\u0026d=identicon\u0026r=PG","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"user2297550","noSpacesUserName":"user2297550","reputationDisplayText":"0"},"postedAt":"2022-04-22T08:42:51.827Z","postedAtRelative":"Over a year ago","body":"For any users reading this, the above two comments add nothing material beyond the first four, and constitute persistent trolling by a user whose numerous earlier comments on this same answer were thankfully deleted by mods. This is the **only** answer with an \u0060O(n)\u0060 solution that works **in general** on any machine architecture and for any computation not just summation. Apparently, this simple fact cannot be digested or comprehended despite Herculean earlier attempts.","htmlBody":"For any users reading this, the above two comments add nothing material beyond the first four, and constitute persistent trolling by a user whose numerous earlier comments on this same answer were thankfully deleted by mods. This is the \u003Cb\u003Eonly\u003C/b\u003E answer with an \u003Ccode\u003EO(n)\u003C/code\u003E solution that works \u003Cb\u003Ein general\u003C/b\u003E on any machine architecture and for any computation not just summation. Apparently, this simple fact cannot be digested or comprehended despite Herculean earlier attempts.","score":0,"editCount":2,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false},{"id":127170686,"user":{"userId":224132,"isDeleted":false,"displayName":"Peter Cordes","url":"/users/224132/peter-cordes","profileImageUrl":"https://i.sstatic.net/N4ivW.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"PeterCordes","noSpacesUserName":"PeterCordes","reputationDisplayText":"0"},"postedAt":"2022-04-22T12:29:54.35Z","postedAtRelative":"Over a year ago","body":"Commenting out the sorting entirely keeps the whole thing O(n).  *That\u0027s* the appropriate comparison baseline for an O(n) approach that spends time preprocessing the array to make one pass of a branchy loop faster, of course not an O(n log n) sort.","htmlBody":"Commenting out the sorting entirely keeps the whole thing O(n).  \u003Ci\u003EThat\u0026#39;s\u003C/i\u003E the appropriate comparison baseline for an O(n) approach that spends time preprocessing the array to make one pass of a branchy loop faster, of course not an O(n log n) sort.","score":0,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false},{"id":127171845,"user":{"userId":2297550,"isDeleted":false,"displayName":"user2297550","url":"/users/2297550/user2297550","profileImageUrl":"https://www.gravatar.com/avatar/20092a7b6e8eebf36a9c28951bd2261f?s=48\u0026d=identicon\u0026r=PG","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"user2297550","noSpacesUserName":"user2297550","reputationDisplayText":"0"},"postedAt":"2022-04-22T13:20:02.197Z","postedAtRelative":"Over a year ago","body":"For any users reading this, the above **three and counting** comments add nothing material beyond the first four comments on this answer, and constitute persistent trolling by a user whose numerous earlier comments on this same answer were thankfully deleted by mods. This is the **only** answer with an \u0060O(n)\u0060 solution that works **in general** on any machine architecture and for any computation not just summation. Apparently, this simple fact cannot be digested or comprehended despite Herculean earlier attempts.","htmlBody":"For any users reading this, the above \u003Cb\u003Ethree and counting\u003C/b\u003E comments add nothing material beyond the first four comments on this answer, and constitute persistent trolling by a user whose numerous earlier comments on this same answer were thankfully deleted by mods. This is the \u003Cb\u003Eonly\u003C/b\u003E answer with an \u003Ccode\u003EO(n)\u003C/code\u003E solution that works \u003Cb\u003Ein general\u003C/b\u003E on any machine architecture and for any computation not just summation. Apparently, this simple fact cannot be digested or comprehended despite Herculean earlier attempts.","score":0,"editCount":3,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":true,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false}],"postId":53689911,"currentUserIsMod":false,"currentUserIsAnonymous":true,"commentFlagsRemainingToday":10,"maxNestingLevel":3,"hasOptedOut":false,"showCtaUnderComments":true,"containerElementId":"follow-ups-container-53689911","fKey":"d09ecbbe5140a7c1439a7e4020cdd7d76b52d28795a889bb24233842877804f3","questionId":11227809,"questionAuthorId":87234,"answerId":53689911,"answerPositionOnPage":0,"newUiSettings":{"largerFontSize":false},"showFirstTimeCommentingModal":false,"isMentionEnabled":false,"showSpamFlag":true,"mergeUnfriendlyAndRudeFlags":true,"allowRetractingCommentFlags":true,"commentMinLength":15}</script>
    </div>

        </div>
</div>
                                        
<a name="58385294"></a>
<div id="answer-58385294" class="answer js-answer " data-answerid="58385294"
     data-parentid="11227809" data-score="116" data-position-on-page="23"
     data-highest-scored="0"
     data-question-has-accepted-highest-score="1"
     data-author-username="Selcuk"
     data-author-reputation="60189"
     data-should-show-copy-button=True
     data-se-share-sheet-license-name="CC BY-SA 4.0"
     data-is-edited="True"
      itemprop="suggestedAnswer"
     itemscope itemtype="https://schema.org/Answer">
        <div class="post-layout ">
                <div class="votecell post-layout--left">
                    
<div class="js-voting-container d-flex jc-center fd-column ai-center gs4 fc-black-300" data-post-id="58385294" data-referrer="None">
        <button class="js-vote-up-btn flex--item s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
                id="upvote-btn-58385294"
                data-controller="s-tooltip"
                data-s-tooltip-placement="right"
                title="This answer is useful"
                aria-pressed="false"
                aria-label="Up vote"
                data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
                data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">
            <svg aria-hidden="true" class="svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg>
        </button>
        <input type="hidden" id="voteUpHash" value="70:3:31e,16:092c9dcb767ef8b9,10:1771427630,16:194035707f2d884b,8:58385294,ae77dea07fe057e9df847233799dfb723bfd1168e4af1077e636180b7df8fa93" />
        <div class="js-vote-count flex--item d-flex fd-column ai-center fc-theme-body-font fw-bold fs-subheading py4"
             itemprop="upvoteCount"
             data-value="116">
116        </div>
        <button
            class="js-vote-down-btn flex--item mb8 s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
            id=downvote-btn-58385294
            title="This answer is not useful"
            aria-pressed="false"
            aria-label="Down vote"
            data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
            data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">

            <svg aria-hidden="true" class="svg-icon iconArrowDown" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 6h16l-8 8z"/></svg>
        </button>
        <input type="hidden" id="voteDownHash" value="70:3:31e,16:502d8e8cd7b1ae87,10:1771427630,16:5d1d7617e8d0f859,8:58385294,ef6df7658d17aad45a758e446cf4a86c5aecac7ba73f55b887b52e7bcae81cbe" />


        
<button class="js-saves-btn s-btn s-btn__unset c-pointer py4"
        type="button"
        id="saves-btn-58385294"
        data-controller="s-tooltip"
        data-s-tooltip-placement="right"
        data-s-popover-placement=""
        title="Save this answer."
        data-is-saved="false"
        aria-label="Save"
        data-post-id="58385294"
        data-post-type-id="2"
        data-user-privilege-for-post-click="0"
        aria-controls=""
        data-s-popover-auto-show="false"
>
    <svg aria-hidden="true" class="fc-theme-primary-400 js-saves-btn-selected d-none svg-icon iconBookmark" width="18" height="18"  viewBox="0 0 18 18"><path  d="M3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
    <svg aria-hidden="true" class="js-saves-btn-unselected svg-icon iconBookmarkAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m9 10.6 4 2.66V3H5v10.26zM3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
</button>







            <div class="js-accepted-answer-indicator flex--item fc-green-400 py6 mtn8 d-none" data-s-tooltip-placement="right" title="Loading when this answer was accepted&#x2026;" tabindex="0" role="note" aria-label="Accepted">
                <div class="ta-center">
                    <svg aria-hidden="true" class="svg-icon iconCheckmarkLg" width="36" height="36"  viewBox="0 0 36 36"><path  d="m6 14 8 8L30 6v8L14 30l-8-8z"/></svg>
                </div>
            </div>

    
    <a class="js-post-issue flex--item s-btn s-btn__unset c-pointer py6 mx-auto" href="/posts/58385294/timeline" data-shortcut="T" data-ks-title="timeline" data-controller="s-tooltip" data-s-tooltip-placement="right" title="Show activity on this post." aria-label="Timeline"><svg aria-hidden="true" class="mln2 mr0 svg-icon iconHistory" width="19" height="18"  viewBox="0 0 19 18"><path  d="M3 9a8 8 0 1 1 3.73 6.77L8.2 14.3A6 6 0 1 0 5 9l3.01-.01-4 4-4-4zm7-4h1.01L11 9.36l3.22 2.1-.6.93L10 10z"/></svg></a>

</div>

                </div>

            

<div class="answercell post-layout--right">
    


    <div class="s-prose js-post-body" itemprop="text">
<p><em><a href="//stackoverflow.blog/2019/10/11/c-creator-bjarne-stroustrup-answers-our-top-five-c-questions/">Bjarne Stroustrup's Answer</a> to this question:</em></p>
<p>That sounds like an interview question. Is it true? How would you know? It is a bad idea to answer questions about efficiency without first doing some measurements, so it is important to know how to measure.</p>
<p>So, I tried with a vector of a million integers and got:</p>
<pre class="lang-none prettyprint-override"><code>Already sorted    32995 milliseconds
Shuffled          125944 milliseconds

Already sorted    18610 milliseconds
Shuffled          133304 milliseconds

Already sorted    17942 milliseconds
Shuffled          107858 milliseconds
</code></pre>
<p>I ran that a few times to be sure. Yes, the phenomenon is real. My key code was:</p>
<pre class="lang-cpp prettyprint-override"><code>void run(vector&lt;int&gt;&amp; v, const string&amp; label)
{
    auto t0 = system_clock::now();
    sort(v.begin(), v.end());
    auto t1 = system_clock::now();
    cout &lt;&lt; label
         &lt;&lt; duration_cast&lt;microseconds&gt;(t1  t0).count()
         &lt;&lt; &quot; milliseconds\n&quot;;
}

void tst()
{
    vector&lt;int&gt; v(1'000'000);
    iota(v.begin(), v.end(), 0);
    run(v, &quot;already sorted &quot;);
    std::shuffle(v.begin(), v.end(), std::mt19937{ std::random_device{}() });
    run(v, &quot;shuffled    &quot;);
}
</code></pre>
<p>At least the phenomenon is real with this compiler, standard library, and optimizer settings. Different implementations can and do give different answers. In fact, someone did do a more systematic study (a quick web search will find it) and most implementations show that effect.</p>
<p>One reason is branch prediction: the key operation in the sort algorithm is <code>if(v[i] &lt; pivot]) </code> or equivalent. For a sorted sequence that test is always true whereas, for a random sequence, the branch chosen varies randomly.</p>
<p>Another reason is that when the vector is already sorted, we never need to move elements to their correct position. The effect of these little details is the factor of five or six that we saw.</p>
<p>Quicksort (and sorting in general) is a complex study that has attracted some of the greatest minds of computer science. A good sort function is a result of both choosing a good algorithm and paying attention to hardware performance in its implementation.</p>
<p>If you want to write efficient code, you need to know a bit about machine architecture.</p>
    </div>
    <div class="mt24">
        <div class="d-flex fw-wrap ai-start jc-end gs8 gsy">

            <time itemprop="dateCreated" datetime="2019-10-14 23:34:40Z"></time>
            <div class="flex--item mr16" style="flex: 1 1 100px;">
                


<div class="js-post-menu pt2" data-post-id="58385294" data-post-type-id="2">

    <div class="d-flex gs8 s-anchors s-anchors__muted fw-wrap">

        <div class="flex--item">
            <a href="/a/58385294"
               rel="nofollow"
               itemprop="url"
               class="js-share-link js-gps-track"
               title="Short permalink to this answer"
               data-gps-track="post.click({ item: 2, priv: 0, post_type: 2 })"
               data-controller="se-share-sheet"
               data-se-share-sheet-title="Share a link to this answer"
               data-se-share-sheet-subtitle=""
               data-se-share-sheet-post-type="answer"
               data-se-share-sheet-social="facebook twitter devto"
               data-se-share-sheet-location="2"
               data-se-share-sheet-license-url="https%3a%2f%2fcreativecommons.org%2flicenses%2fby-sa%2f4.0%2f"
               data-se-share-sheet-license-name="CC BY-SA 4.0"
               data-s-popover-placement="bottom-start">Share</a>
        </div>


                    <div class="flex--item">
                        <a href="/posts/58385294/edit" class="js-suggest-edit-post js-gps-track" data-gps-track="post.click({ item: 6, priv: 0, post_type: 2 })" title="">Improve this answer</a>
                    </div>

                <div class="flex--item">
                    <button type="button"
                            id="btnFollowPost-58385294" class="s-btn s-btn__link js-follow-post js-follow-answer js-gps-track"
                            data-gps-track="post.click({ item: 14, priv: 0, post_type: 2 })"
                            data-controller="s-tooltip " data-s-tooltip-placement="bottom"
                            data-s-popover-placement="bottom" aria-controls=""
                            title="Follow this answer to receive notifications">
                        Follow
                        <input type="hidden" id="voteFollowHash" value="70:3:31e,16:a93083ea411efd32,10:1771427630,16:75f233affe1a2d61,8:58385294,48a08cd454e5167e75b818426edafa24d8cef3eabf532de4179d807b1b628a8c" />
                    </button>
                </div>






    </div>
    <div class="js-menu-popup-container"></div>
</div>
            </div>
            <div class="post-signature flex--item fl0">
<div class="user-info ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            <a href="/posts/58385294/revisions" title="show all edits to this post"
                         class="js-gps-track"
                         data-gps-track="post.click({ item: 4, priv: 0, post_type: 2 })">edited <span title='2021-01-10 16:02:55Z' class='relativetime'>Jan 10, 2021 at 16:02</span></a>
        </div>
        
    </div>
    <div class="user-gravatar32">
        
    </div>
    <div class="user-details">
        
        <div class="-flair">
            
        </div>
    </div>
</div>
            </div>


                <div class="post-signature flex--item fl0">
                    <div class="user-info">
    <div class="user-details">
        <span class="community-wiki" title="This post is community owned as of Oct 14, 2019 at 23:34. Votes do not generate reputation, and it can be edited by users with 100 rep">
            community wiki
        </span>
    </div><br>
    <div class="user-details">
        <a id="history-58385294" href="/posts/58385294/revisions" title="show revision history for this post">
        2 revs, 2 users 75%<br><a href="/users/2011147">Selcuk</a>
        </a>
    </div>
</div>

                </div>
        </div>
        
    
    </div>
    
</div>




                

    <div class="post-layout--right">
        

<div id="follow-ups-container-58385294">
    <!--[--><div class="mt16"><div class="mb8 d-flex ai-center g8 c-pointer" role="button" tabindex="0"><h2 class="mb0">2 Comments</h2> <!--[--><!--[--><!----><svg aria-hidden="true" class="svg-icon iconArrowDownAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m16.01 7.43-1.4-1.41L9 11.6 3.42 6l-1.4 1.42 7 7z"/></svg><!----><!--]--><!--]--></div> <div class="mb12"><!--[!--><button type="button" class="s-btn s-btn__muted s-btn__outlined w100 d-flex ai-center p8 comments-link" data-so-test="parent-answer-58385294"><!--[!--><!--]--> <div class="flex--item ml8"><p class="mb0">Add a comment</p></div></button><!--]--></div> <!--[--><div role="list"><!--[--><div id="follow-up-118605070" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/224132/peter-cordes" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://i.sstatic.net/N4ivW.png?s=64" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Peter Cordes</div> <div class="s-user-card--awards"><!--[--><a href="/users/224132/peter-cordes" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Peter Cordes</a><!--]--> <a class="comment-link" href="#comment118605070_58385294"><time title="2021-04-14T22:29:55.897Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[--><span class="o50" title="Edited 2 times"><!----><svg aria-hidden="true" class="svg-icon iconPencilSm" width="14" height="14"  viewBox="0 0 14 14"><path fill="#F1B600" d="m2 10.12 6.37-6.43 1.88 1.88L3.88 12H2z"/><path fill="#E87C87" d="m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0"/></svg><!----><!----></span><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4 bg-black-200" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->This seems to be missing the point of the question, and is answering whether sorting itself is faster with already-sorted arrays.  This is less surprising because as this answer points out, there&#39;s less work to be done (with most sort algorithms other than merge-sort), on top of the branch-prediction effect.  The actual question factors out this effect and is only timing a conditional increment.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2021-04-14T22:29:55.897Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-118605070"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">3</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-118605070"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-118605070" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-118605070"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-118605070" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[--><!--[--><!--[!--><div class="d-flex"><div class="flex--item w32 fc-black-200 ml12 mrn12 fl-shrink0"><div class="bl bb w16 h12 bblr-lg"></div> <!--[!--><!--]--></div> <div class="flex--item fl-grow1"><div id="follow-up-140928238" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-118605070"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/14672114/rare-kpop-manifesto" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://lh3.googleusercontent.com/a-/AOh14Gh77XbK_ZXsqVwrM6a6K6g2DNN4_XD_K1wOopWCVA=k-s48" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">RARE Kpop Manifesto</div> <div class="s-user-card--awards"><!--[--><a href="/users/14672114/rare-kpop-manifesto" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">RARE Kpop Manifesto</a><!--]--> <a class="comment-link" href="#comment140928238_58385294"><time title="2026-01-05T02:45:41.79Z" class="s-user-card--time ws-nowrap truncate">Jan 5 at 2:45</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->which is still 2 different questions - most algos still have major speed differences between perfectly ascending-order sorted arrays and perfectly reverse-sorted arrays (the same reason <code>tail -n</code> is always much harder than <code>head -n</code> cuz it needs to deal with input rows perfectly sorted by row number, which is same as being perfectly reverse-sorted from <code>tail</code>&#39;s perspective)<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2026-01-05T02:45:41.79Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-140928238"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">0</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-140928238"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-140928238" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-140928238"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-140928238" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><!----></div></div><!--]--><!--]--><!--]--><!--]--></div> <!--[!--><!--]--><!----><!--]--> <!--[!--><!--]--></div><!--]-->
</div>

<script type="application/json" data-role="module-args" data-module-name="islands/follow-ups/index.mod">{"replies":[{"id":118605070,"user":{"userId":224132,"isDeleted":false,"displayName":"Peter Cordes","url":"/users/224132/peter-cordes","profileImageUrl":"https://i.sstatic.net/N4ivW.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"PeterCordes","noSpacesUserName":"PeterCordes","reputationDisplayText":"0"},"postedAt":"2021-04-14T22:29:55.897Z","postedAtRelative":"Over a year ago","body":"This seems to be missing the point of the question, and is answering whether sorting itself is faster with already-sorted arrays.  This is less surprising because as this answer points out, there\u0027s less work to be done (with most sort algorithms other than merge-sort), on top of the branch-prediction effect.  The actual question factors out this effect and is only timing a conditional increment.","htmlBody":"This seems to be missing the point of the question, and is answering whether sorting itself is faster with already-sorted arrays.  This is less surprising because as this answer points out, there\u0026#39;s less work to be done (with most sort algorithms other than merge-sort), on top of the branch-prediction effect.  The actual question factors out this effect and is only timing a conditional increment.","score":3,"editCount":2,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[{"id":140928238,"user":{"userId":14672114,"isDeleted":false,"displayName":"RARE Kpop Manifesto","url":"/users/14672114/rare-kpop-manifesto","profileImageUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh77XbK_ZXsqVwrM6a6K6g2DNN4_XD_K1wOopWCVA=k-s48","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"RAREKpopManifesto","noSpacesUserName":"RAREKpopManifesto","reputationDisplayText":"0"},"postedAt":"2026-01-05T02:45:41.79Z","postedAtRelative":"Jan 5 at 2:45","body":"which is still 2 different questions - most algos still have major speed differences between perfectly ascending-order sorted arrays and perfectly reverse-sorted arrays (the same reason \u0060tail -n\u0060 is always much harder than \u0060head -n\u0060 cuz it needs to deal with input rows perfectly sorted by row number, which is same as being perfectly reverse-sorted from \u0060tail\u0060\u0027s perspective)","htmlBody":"which is still 2 different questions - most algos still have major speed differences between perfectly ascending-order sorted arrays and perfectly reverse-sorted arrays (the same reason \u003Ccode\u003Etail -n\u003C/code\u003E is always much harder than \u003Ccode\u003Ehead -n\u003C/code\u003E cuz it needs to deal with input rows perfectly sorted by row number, which is same as being perfectly reverse-sorted from \u003Ccode\u003Etail\u003C/code\u003E\u0026#39;s perspective)","score":0,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":true,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"PeterCordes","noSpacesReplyToUserName":"PeterCordes","isTopScored":false,"parentCommentId":118605070}],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":true,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true}],"postId":58385294,"currentUserIsMod":false,"currentUserIsAnonymous":true,"commentFlagsRemainingToday":10,"maxNestingLevel":3,"hasOptedOut":false,"showCtaUnderComments":false,"containerElementId":"follow-ups-container-58385294","fKey":"d09ecbbe5140a7c1439a7e4020cdd7d76b52d28795a889bb24233842877804f3","questionId":11227809,"questionAuthorId":87234,"answerId":58385294,"answerPositionOnPage":0,"newUiSettings":{"largerFontSize":false},"showFirstTimeCommentingModal":false,"isMentionEnabled":false,"showSpamFlag":true,"mergeUnfriendlyAndRudeFlags":true,"allowRetractingCommentFlags":true,"commentMinLength":15}</script>
    </div>

        </div>
</div>
                                        
<a name="58531294"></a>
<div id="answer-58531294" class="answer js-answer " data-answerid="58531294"
     data-parentid="11227809" data-score="110" data-position-on-page="24"
     data-highest-scored="0"
     data-question-has-accepted-highest-score="1"
     data-author-username="hatirlatici"
     data-author-reputation="1715"
     data-should-show-copy-button=True
     data-se-share-sheet-license-name="CC BY-SA 4.0"
     data-is-edited="True"
      itemprop="suggestedAnswer"
     itemscope itemtype="https://schema.org/Answer">
        <div class="post-layout ">
                <div class="votecell post-layout--left">
                    
<div class="js-voting-container d-flex jc-center fd-column ai-center gs4 fc-black-300" data-post-id="58531294" data-referrer="None">
        <button class="js-vote-up-btn flex--item s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
                id="upvote-btn-58531294"
                data-controller="s-tooltip"
                data-s-tooltip-placement="right"
                title="This answer is useful"
                aria-pressed="false"
                aria-label="Up vote"
                data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
                data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">
            <svg aria-hidden="true" class="svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg>
        </button>
        <input type="hidden" id="voteUpHash" value="70:3:31e,16:8acbe1c330740b55,10:1771427630,16:d891321a6a4f163d,8:58531294,a78708fd8fb304a6586a7bef2b4e802913bf4edf967b3183d0c3712444c393a8" />
        <div class="js-vote-count flex--item d-flex fd-column ai-center fc-theme-body-font fw-bold fs-subheading py4"
             itemprop="upvoteCount"
             data-value="110">
110        </div>
        <button
            class="js-vote-down-btn flex--item mb8 s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
            id=downvote-btn-58531294
            title="This answer is not useful"
            aria-pressed="false"
            aria-label="Down vote"
            data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
            data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">

            <svg aria-hidden="true" class="svg-icon iconArrowDown" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 6h16l-8 8z"/></svg>
        </button>
        <input type="hidden" id="voteDownHash" value="70:3:31e,16:92ddd76c300d222b,10:1771427630,16:d5bfb9835a658bd4,8:58531294,b5c932c243da064ef992b975a37954220eea59992021bee7985d3feff04dfd30" />


        
<button class="js-saves-btn s-btn s-btn__unset c-pointer py4"
        type="button"
        id="saves-btn-58531294"
        data-controller="s-tooltip"
        data-s-tooltip-placement="right"
        data-s-popover-placement=""
        title="Save this answer."
        data-is-saved="false"
        aria-label="Save"
        data-post-id="58531294"
        data-post-type-id="2"
        data-user-privilege-for-post-click="0"
        aria-controls=""
        data-s-popover-auto-show="false"
>
    <svg aria-hidden="true" class="fc-theme-primary-400 js-saves-btn-selected d-none svg-icon iconBookmark" width="18" height="18"  viewBox="0 0 18 18"><path  d="M3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
    <svg aria-hidden="true" class="js-saves-btn-unselected svg-icon iconBookmarkAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m9 10.6 4 2.66V3H5v10.26zM3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
</button>







            <div class="js-accepted-answer-indicator flex--item fc-green-400 py6 mtn8 d-none" data-s-tooltip-placement="right" title="Loading when this answer was accepted&#x2026;" tabindex="0" role="note" aria-label="Accepted">
                <div class="ta-center">
                    <svg aria-hidden="true" class="svg-icon iconCheckmarkLg" width="36" height="36"  viewBox="0 0 36 36"><path  d="m6 14 8 8L30 6v8L14 30l-8-8z"/></svg>
                </div>
            </div>

    
    <a class="js-post-issue flex--item s-btn s-btn__unset c-pointer py6 mx-auto" href="/posts/58531294/timeline" data-shortcut="T" data-ks-title="timeline" data-controller="s-tooltip" data-s-tooltip-placement="right" title="Show activity on this post." aria-label="Timeline"><svg aria-hidden="true" class="mln2 mr0 svg-icon iconHistory" width="19" height="18"  viewBox="0 0 19 18"><path  d="M3 9a8 8 0 1 1 3.73 6.77L8.2 14.3A6 6 0 1 0 5 9l3.01-.01-4 4-4-4zm7-4h1.01L11 9.36l3.22 2.1-.6.93L10 10z"/></svg></a>

</div>

                </div>

            

<div class="answercell post-layout--right">
    


    <div class="s-prose js-post-body" itemprop="text">
<p>This question is rooted in <em>branch prediction models</em> on CPUs. I'd recommend reading this paper:</p>
<p><a href="https://pdfs.semanticscholar.org/5634/4be375cfed0f79cb9d009ac838682e1bace3.pdf" rel="noreferrer"><strong>Increasing the Instruction Fetch Rate via Multiple Branch Prediction and a Branch Address Cache</strong></a>  (But real CPUs these days still don't make multiple taken branch-predictions per clock cycle, except for Haswell and later <a href="https://stackoverflow.com/questions/39311872/is-performance-reduced-when-executing-loops-whose-uop-count-is-not-a-multiple-of">effectively unrolling tiny loops in its loop buffer</a>.  Modern CPUs can predict multiple branches not-taken to make use of their fetches in large contiguous blocks.)</p>
<p>When you have sorted elements, branch prediction easily predicts correctly except right at the boundary, letting instructions flow through the CPU pipeline efficiently, without having to rewind and take the correct path on mispredictions.</p>
    </div>
    <div class="mt24">
        <div class="d-flex fw-wrap ai-start jc-end gs8 gsy">

            <time itemprop="dateCreated" datetime="2019-10-23 21:35:40Z"></time>
            <div class="flex--item mr16" style="flex: 1 1 100px;">
                


<div class="js-post-menu pt2" data-post-id="58531294" data-post-type-id="2">

    <div class="d-flex gs8 s-anchors s-anchors__muted fw-wrap">

        <div class="flex--item">
            <a href="/a/58531294"
               rel="nofollow"
               itemprop="url"
               class="js-share-link js-gps-track"
               title="Short permalink to this answer"
               data-gps-track="post.click({ item: 2, priv: 0, post_type: 2 })"
               data-controller="se-share-sheet"
               data-se-share-sheet-title="Share a link to this answer"
               data-se-share-sheet-subtitle=""
               data-se-share-sheet-post-type="answer"
               data-se-share-sheet-social="facebook twitter devto"
               data-se-share-sheet-location="2"
               data-se-share-sheet-license-url="https%3a%2f%2fcreativecommons.org%2flicenses%2fby-sa%2f4.0%2f"
               data-se-share-sheet-license-name="CC BY-SA 4.0"
               data-s-popover-placement="bottom-start">Share</a>
        </div>


                    <div class="flex--item">
                        <a href="/posts/58531294/edit" class="js-suggest-edit-post js-gps-track" data-gps-track="post.click({ item: 6, priv: 0, post_type: 2 })" title="">Improve this answer</a>
                    </div>

                <div class="flex--item">
                    <button type="button"
                            id="btnFollowPost-58531294" class="s-btn s-btn__link js-follow-post js-follow-answer js-gps-track"
                            data-gps-track="post.click({ item: 14, priv: 0, post_type: 2 })"
                            data-controller="s-tooltip " data-s-tooltip-placement="bottom"
                            data-s-popover-placement="bottom" aria-controls=""
                            title="Follow this answer to receive notifications">
                        Follow
                        <input type="hidden" id="voteFollowHash" value="70:3:31e,16:52182d2ad43f19f5,10:1771427630,16:1bccbbc7d5f52e6f,8:58531294,3e6afc0efaae4b96c1a9cd2965149bb03b7311f760ed91edf1aa3bdea8196d97" />
                    </button>
                </div>






    </div>
    <div class="js-menu-popup-container"></div>
</div>
            </div>
            <div class="post-signature flex--item fl0">
<div class="user-info user-hover ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            <a href="/posts/58531294/revisions" title="show all edits to this post"
                         class="js-gps-track"
                         data-gps-track="post.click({ item: 4, priv: 0, post_type: 2 })">edited <span title='2024-11-14 15:48:34Z' class='relativetime'>Nov 14, 2024 at 15:48</span></a>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/224132/peter-cordes"><div class="gravatar-wrapper-32"><img src="https://i.sstatic.net/N4ivW.png?s=64" alt="Peter Cordes&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/224132/peter-cordes" dir="auto">Peter Cordes</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 379,441" dir="ltr">379k</span><span title="52 gold badges" aria-hidden="true"><span class="badge1"></span><span class="badgecount">52</span></span><span class="v-visible-sr">52 gold badges</span><span title="754 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">754</span></span><span class="v-visible-sr">754 silver badges</span><span title="1k bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">1k</span></span><span class="v-visible-sr">1k bronze badges</span>
        </div>
    </div>
</div>
            </div>


                <div class="post-signature flex--item fl0">
                    <div class="user-info user-hover ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            answered <span title='2019-10-23 21:35:40Z' class='relativetime'>Oct 23, 2019 at 21:35</span>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/3821643/hatirlatici"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/30be8fe66a44a7ddd51dfbd813356157?s=64&amp;d=identicon&amp;r=PG&amp;f=y&amp;so-version=2" alt="hatirlatici&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <a href="/users/3821643/hatirlatici" itemprop="url" dir="auto">hatirlatici</a><meta itemprop="name" content="hatirlatici"/>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">1,715</span><span title="2 gold badges" aria-hidden="true"><span class="badge1"></span><span class="badgecount">2</span></span><span class="v-visible-sr">2 gold badges</span><span title="13 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">13</span></span><span class="v-visible-sr">13 silver badges</span><span title="26 bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">26</span></span><span class="v-visible-sr">26 bronze badges</span>
        </div>
    </div>
</div>


                </div>
        </div>
        
    
    </div>
    
</div>




                

    <div class="post-layout--right">
        

<div id="follow-ups-container-58531294">
    <!--[--><div class="mt16"><div class="mb8 d-flex ai-center g8 c-pointer" role="button" tabindex="0"><h2 class="mb0">4 Comments</h2> <!--[--><!--[--><!----><svg aria-hidden="true" class="svg-icon iconArrowDownAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m16.01 7.43-1.4-1.41L9 11.6 3.42 6l-1.4 1.42 7 7z"/></svg><!----><!--]--><!--]--></div> <div class="mb12"><!--[!--><button type="button" class="s-btn s-btn__muted s-btn__outlined w100 d-flex ai-center p8 comments-link" data-so-test="parent-answer-58531294"><!--[!--><!--]--> <div class="flex--item ml8"><p class="mb0">Add a comment</p></div></button><!--]--></div> <!--[--><div role="list"><!--[--><div id="follow-up-104848500" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/224132/peter-cordes" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://i.sstatic.net/N4ivW.png?s=64" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Peter Cordes</div> <div class="s-user-card--awards"><!--[--><a href="/users/224132/peter-cordes" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Peter Cordes</a><!--]--> <a class="comment-link" href="#comment104848500_58531294"><time title="2019-12-13T14:29:22.603Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->The instructions stay hot in the CPU&#39;s L1 instruction cache regardless of mispredicts.  The problem is fetching them into the <i>pipeline</i> in the right order, before the immediately-previous instructions have decoded and finished executing.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2019-12-13T14:29:22.603Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-104848500"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">5</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-104848500"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-104848500" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-104848500"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-104848500" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-126421814" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/224132/peter-cordes" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://i.sstatic.net/N4ivW.png?s=64" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Peter Cordes</div> <div class="s-user-card--awards"><!--[--><a href="/users/224132/peter-cordes" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Peter Cordes</a><!--]--> <a class="comment-link" href="#comment126421814_58531294"><time title="2022-03-18T14:38:45.863Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->Also, in a simple CPU that has an &quot;instruction register&quot;, it definitely always needs to read each instruction into the IR as part of executing it.  The last paragraph of this answer is very distorted from how CPUs really work.  Some CPUs with a loop buffer may be able to lock a sequence of instructions down into a loop to avoid even re-fetching from L1i cache, as long as they continue to execute the same way, but that&#39;s usually minor (e.g. in Intel Skylake the microcode update disabling the LSD didn&#39;t hurt much), just getting a little bit more value out of correct branch prediction.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2022-03-18T14:38:45.863Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-126421814"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">3</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-126421814"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-126421814" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-126421814"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-126421814" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-126483396" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/3821643/hatirlatici" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://www.gravatar.com/avatar/30be8fe66a44a7ddd51dfbd813356157?s=48&amp;d=identicon&amp;r=PG&amp;f=y&amp;so-version=2" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">hatirlatici</div> <div class="s-user-card--awards"><!--[--><a href="/users/3821643/hatirlatici" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">hatirlatici</a><!--]--> <a class="comment-link" href="#comment126483396_58531294"><time title="2022-03-21T22:04:04.02Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[--><span class="o50" title="Edited 1 time"><!----><svg aria-hidden="true" class="svg-icon iconPencilSm" width="14" height="14"  viewBox="0 0 14 14"><path fill="#F1B600" d="m2 10.12 6.37-6.43 1.88 1.88L3.88 12H2z"/><path fill="#E87C87" d="m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0"/></svg><!----><!----></span><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->The paper gives a general idea of how it handles fetching coordinated data as instruction from the o(n) perspective, also it was written in the early 90s so none of the cutting-edge memory/register designs did not exist at that time. The modern CPU cache designs and algorithms can be found in multiple papers for a benchmark, one of them might be  <a href="https://ieeexplore.ieee.org/document/1027060?arnumber=1027060" rel="nofollow noreferrer">ieeexplore.ieee.org/document/1027060?arnumber=1027060</a><!----><!--]--></div> <time class="d-none" itemprop="datePublished">2022-03-21T22:04:04.02Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-126483396"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">2</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-126483396"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-126483396" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-126483396"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-126483396" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-126485018" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/224132/peter-cordes" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://i.sstatic.net/N4ivW.png?s=64" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Peter Cordes</div> <div class="s-user-card--awards"><!--[--><a href="/users/224132/peter-cordes" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Peter Cordes</a><!--]--> <a class="comment-link" href="#comment126485018_58531294"><time title="2022-03-22T00:24:44.45Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->I&#39;m not talking about what the linked paper says, I&#39;m talking about the sentences in your actual answer, specifically the final paragraph.  (The paper in your answer was published in 1993, and mentions superscalar CPUs and future directions of cpu architecture, so out-of-order exec was on the horizon, and it&#39;s definitely assuming parallel fetch and decode of multiple instructions.  In fact that&#39;s the whole point of their proposal; seeing through multiple branches per clock cycle in a wider design, fetching them from L1i cache into the pipeline.  Current CPUs still don&#39;t do that.)<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2022-03-22T00:24:44.45Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-126485018"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">2</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-126485018"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-126485018" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-126485018"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-126485018" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><!--]--></div> <!--[--><div class="d-flex g8 my8"><!--[--><button class="s-link s-btn__muted s-btn__outlined comments-link" data-so-test="parent-answer-58531294">Add a comment</button> <!--[!--><!--]--><!--]--> <!--[!--><!--]--></div><!--]--><!----><!--]--> <!--[!--><!--]--></div><!--]-->
</div>

<script type="application/json" data-role="module-args" data-module-name="islands/follow-ups/index.mod">{"replies":[{"id":104848500,"user":{"userId":224132,"isDeleted":false,"displayName":"Peter Cordes","url":"/users/224132/peter-cordes","profileImageUrl":"https://i.sstatic.net/N4ivW.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"PeterCordes","noSpacesUserName":"PeterCordes","reputationDisplayText":"0"},"postedAt":"2019-12-13T14:29:22.603Z","postedAtRelative":"Over a year ago","body":"The instructions stay hot in the CPU\u0027s L1 instruction cache regardless of mispredicts.  The problem is fetching them into the *pipeline* in the right order, before the immediately-previous instructions have decoded and finished executing.","htmlBody":"The instructions stay hot in the CPU\u0026#39;s L1 instruction cache regardless of mispredicts.  The problem is fetching them into the \u003Ci\u003Epipeline\u003C/i\u003E in the right order, before the immediately-previous instructions have decoded and finished executing.","score":5,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":126421814,"user":{"userId":224132,"isDeleted":false,"displayName":"Peter Cordes","url":"/users/224132/peter-cordes","profileImageUrl":"https://i.sstatic.net/N4ivW.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"PeterCordes","noSpacesUserName":"PeterCordes","reputationDisplayText":"0"},"postedAt":"2022-03-18T14:38:45.863Z","postedAtRelative":"Over a year ago","body":"Also, in a simple CPU that has an \u0022instruction register\u0022, it definitely always needs to read each instruction into the IR as part of executing it.  The last paragraph of this answer is very distorted from how CPUs really work.  Some CPUs with a loop buffer may be able to lock a sequence of instructions down into a loop to avoid even re-fetching from L1i cache, as long as they continue to execute the same way, but that\u0027s usually minor (e.g. in Intel Skylake the microcode update disabling the LSD didn\u0027t hurt much), just getting a little bit more value out of correct branch prediction.","htmlBody":"Also, in a simple CPU that has an \u0026quot;instruction register\u0026quot;, it definitely always needs to read each instruction into the IR as part of executing it.  The last paragraph of this answer is very distorted from how CPUs really work.  Some CPUs with a loop buffer may be able to lock a sequence of instructions down into a loop to avoid even re-fetching from L1i cache, as long as they continue to execute the same way, but that\u0026#39;s usually minor (e.g. in Intel Skylake the microcode update disabling the LSD didn\u0026#39;t hurt much), just getting a little bit more value out of correct branch prediction.","score":3,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":126483396,"user":{"userId":3821643,"isDeleted":false,"displayName":"hatirlatici","url":"/users/3821643/hatirlatici","profileImageUrl":"https://www.gravatar.com/avatar/30be8fe66a44a7ddd51dfbd813356157?s=48\u0026d=identicon\u0026r=PG\u0026f=y\u0026so-version=2","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"hatirlatici","noSpacesUserName":"hatirlatici","reputationDisplayText":"0"},"postedAt":"2022-03-21T22:04:04.02Z","postedAtRelative":"Over a year ago","body":"The paper gives a general idea of how it handles fetching coordinated data as instruction from the o(n) perspective, also it was written in the early 90s so none of the cutting-edge memory/register designs did not exist at that time. The modern CPU cache designs and algorithms can be found in multiple papers for a benchmark, one of them might be \nhttps://ieeexplore.ieee.org/document/1027060?arnumber=1027060","htmlBody":"The paper gives a general idea of how it handles fetching coordinated data as instruction from the o(n) perspective, also it was written in the early 90s so none of the cutting-edge memory/register designs did not exist at that time. The modern CPU cache designs and algorithms can be found in multiple papers for a benchmark, one of them might be  \u003Ca href=\u0022https://ieeexplore.ieee.org/document/1027060?arnumber=1027060\u0022 rel=\u0022nofollow noreferrer\u0022\u003Eieeexplore.ieee.org/document/1027060?arnumber=1027060\u003C/a\u003E","score":2,"editCount":1,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":126485018,"user":{"userId":224132,"isDeleted":false,"displayName":"Peter Cordes","url":"/users/224132/peter-cordes","profileImageUrl":"https://i.sstatic.net/N4ivW.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"PeterCordes","noSpacesUserName":"PeterCordes","reputationDisplayText":"0"},"postedAt":"2022-03-22T00:24:44.45Z","postedAtRelative":"Over a year ago","body":"I\u0027m not talking about what the linked paper says, I\u0027m talking about the sentences in your actual answer, specifically the final paragraph.  (The paper in your answer was published in 1993, and mentions superscalar CPUs and future directions of cpu architecture, so out-of-order exec was on the horizon, and it\u0027s definitely assuming parallel fetch and decode of multiple instructions.  In fact that\u0027s the whole point of their proposal; seeing through multiple branches per clock cycle in a wider design, fetching them from L1i cache into the pipeline.  Current CPUs still don\u0027t do that.)","htmlBody":"I\u0026#39;m not talking about what the linked paper says, I\u0026#39;m talking about the sentences in your actual answer, specifically the final paragraph.  (The paper in your answer was published in 1993, and mentions superscalar CPUs and future directions of cpu architecture, so out-of-order exec was on the horizon, and it\u0026#39;s definitely assuming parallel fetch and decode of multiple instructions.  In fact that\u0026#39;s the whole point of their proposal; seeing through multiple branches per clock cycle in a wider design, fetching them from L1i cache into the pipeline.  Current CPUs still don\u0026#39;t do that.)","score":2,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":true,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true}],"postId":58531294,"currentUserIsMod":false,"currentUserIsAnonymous":true,"commentFlagsRemainingToday":10,"maxNestingLevel":3,"hasOptedOut":false,"showCtaUnderComments":true,"containerElementId":"follow-ups-container-58531294","fKey":"d09ecbbe5140a7c1439a7e4020cdd7d76b52d28795a889bb24233842877804f3","questionId":11227809,"questionAuthorId":87234,"answerId":58531294,"answerPositionOnPage":0,"newUiSettings":{"largerFontSize":false},"showFirstTimeCommentingModal":false,"isMentionEnabled":false,"showSpamFlag":true,"mergeUnfriendlyAndRudeFlags":true,"allowRetractingCommentFlags":true,"commentMinLength":15}</script>
    </div>

        </div>
</div>
                                        
<a name="69851522"></a>
<div id="answer-69851522" class="answer js-answer " data-answerid="69851522"
     data-parentid="11227809" data-score="37" data-position-on-page="25"
     data-highest-scored="0"
     data-question-has-accepted-highest-score="1"
     data-author-username="Geek26"
     data-author-reputation="529"
     data-should-show-copy-button=True
     data-se-share-sheet-license-name="CC BY-SA 4.0"
     data-is-edited="True"
      itemprop="suggestedAnswer"
     itemscope itemtype="https://schema.org/Answer">
        <div class="post-layout ">
                <div class="votecell post-layout--left">
                    
<div class="js-voting-container d-flex jc-center fd-column ai-center gs4 fc-black-300" data-post-id="69851522" data-referrer="None">
        <button class="js-vote-up-btn flex--item s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
                id="upvote-btn-69851522"
                data-controller="s-tooltip"
                data-s-tooltip-placement="right"
                title="This answer is useful"
                aria-pressed="false"
                aria-label="Up vote"
                data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
                data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">
            <svg aria-hidden="true" class="svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg>
        </button>
        <input type="hidden" id="voteUpHash" value="70:3:31e,16:96b1f3f0238b33ed,10:1771427630,16:cb3156a7b60faa12,8:69851522,bff6c9357f3ebb7a5513f2733d09437202be958caa08a75acf88cdfd934d1379" />
        <div class="js-vote-count flex--item d-flex fd-column ai-center fc-theme-body-font fw-bold fs-subheading py4"
             itemprop="upvoteCount"
             data-value="37">
37        </div>
        <button
            class="js-vote-down-btn flex--item mb8 s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
            id=downvote-btn-69851522
            title="This answer is not useful"
            aria-pressed="false"
            aria-label="Down vote"
            data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
            data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">

            <svg aria-hidden="true" class="svg-icon iconArrowDown" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 6h16l-8 8z"/></svg>
        </button>
        <input type="hidden" id="voteDownHash" value="70:3:31e,16:39103bae8f42667e,10:1771427630,16:9b773e258b7d0449,8:69851522,a894f7857146b67f7a64e7ae36856ce54fb3275689f2afc744ec96419318adf3" />


        
<button class="js-saves-btn s-btn s-btn__unset c-pointer py4"
        type="button"
        id="saves-btn-69851522"
        data-controller="s-tooltip"
        data-s-tooltip-placement="right"
        data-s-popover-placement=""
        title="Save this answer."
        data-is-saved="false"
        aria-label="Save"
        data-post-id="69851522"
        data-post-type-id="2"
        data-user-privilege-for-post-click="0"
        aria-controls=""
        data-s-popover-auto-show="false"
>
    <svg aria-hidden="true" class="fc-theme-primary-400 js-saves-btn-selected d-none svg-icon iconBookmark" width="18" height="18"  viewBox="0 0 18 18"><path  d="M3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
    <svg aria-hidden="true" class="js-saves-btn-unselected svg-icon iconBookmarkAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m9 10.6 4 2.66V3H5v10.26zM3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
</button>







            <div class="js-accepted-answer-indicator flex--item fc-green-400 py6 mtn8 d-none" data-s-tooltip-placement="right" title="Loading when this answer was accepted&#x2026;" tabindex="0" role="note" aria-label="Accepted">
                <div class="ta-center">
                    <svg aria-hidden="true" class="svg-icon iconCheckmarkLg" width="36" height="36"  viewBox="0 0 36 36"><path  d="m6 14 8 8L30 6v8L14 30l-8-8z"/></svg>
                </div>
            </div>

    
    <a class="js-post-issue flex--item s-btn s-btn__unset c-pointer py6 mx-auto" href="/posts/69851522/timeline" data-shortcut="T" data-ks-title="timeline" data-controller="s-tooltip" data-s-tooltip-placement="right" title="Show activity on this post." aria-label="Timeline"><svg aria-hidden="true" class="mln2 mr0 svg-icon iconHistory" width="19" height="18"  viewBox="0 0 19 18"><path  d="M3 9a8 8 0 1 1 3.73 6.77L8.2 14.3A6 6 0 1 0 5 9l3.01-.01-4 4-4-4zm7-4h1.01L11 9.36l3.22 2.1-.6.93L10 10z"/></svg></a>

</div>

                </div>

            

<div class="answercell post-layout--right">
    


    <div class="s-prose js-post-body" itemprop="text">
<p><em>An answer for quick and simple understanding (read the others for more details)</em></p>
<p>This concept is called <strong>branch prediction</strong></p>
<p>Branch prediction is an optimization technique that predicts the path the code will take before it is known with certainty. This is important because during the code execution, the machine prefetches several code statements and stores them in the pipeline.</p>
<p>The problem arises in conditional branching, where there are two possible paths or parts of the code that can be executed.</p>
<p>When the prediction was true, the optimization technique worked out.</p>
<p>When the prediction was false, to explain it in a simple way, the code statement stored in the pipeline gets proved wrong and the actual code has to be completely reloaded, which takes up a lot of time.</p>
<p>As common sense suggests, predictions of something sorted are way more accurate than predictions of something unsorted.</p>
<p>branch prediction visualisation:</p>
<p>sorted<br />
<a href="https://i.sstatic.net/BhphM.png" rel="noreferrer"><img src="https://i.sstatic.net/BhphM.png" alt="sorted" /></a>
unsorted
<a href="https://i.sstatic.net/2Z7Ct.png" rel="noreferrer"><img src="https://i.sstatic.net/2Z7Ct.png" alt="unsorted" /></a></p>
    </div>
    <div class="mt24">
        <div class="d-flex fw-wrap ai-start jc-end gs8 gsy">

            <time itemprop="dateCreated" datetime="2021-11-05 10:05:03Z"></time>
            <div class="flex--item mr16" style="flex: 1 1 100px;">
                


<div class="js-post-menu pt2" data-post-id="69851522" data-post-type-id="2">

    <div class="d-flex gs8 s-anchors s-anchors__muted fw-wrap">

        <div class="flex--item">
            <a href="/a/69851522"
               rel="nofollow"
               itemprop="url"
               class="js-share-link js-gps-track"
               title="Short permalink to this answer"
               data-gps-track="post.click({ item: 2, priv: 0, post_type: 2 })"
               data-controller="se-share-sheet"
               data-se-share-sheet-title="Share a link to this answer"
               data-se-share-sheet-subtitle=""
               data-se-share-sheet-post-type="answer"
               data-se-share-sheet-social="facebook twitter devto"
               data-se-share-sheet-location="2"
               data-se-share-sheet-license-url="https%3a%2f%2fcreativecommons.org%2flicenses%2fby-sa%2f4.0%2f"
               data-se-share-sheet-license-name="CC BY-SA 4.0"
               data-s-popover-placement="bottom-start">Share</a>
        </div>


                    <div class="flex--item">
                        <a href="/posts/69851522/edit" class="js-suggest-edit-post js-gps-track" data-gps-track="post.click({ item: 6, priv: 0, post_type: 2 })" title="">Improve this answer</a>
                    </div>

                <div class="flex--item">
                    <button type="button"
                            id="btnFollowPost-69851522" class="s-btn s-btn__link js-follow-post js-follow-answer js-gps-track"
                            data-gps-track="post.click({ item: 14, priv: 0, post_type: 2 })"
                            data-controller="s-tooltip " data-s-tooltip-placement="bottom"
                            data-s-popover-placement="bottom" aria-controls=""
                            title="Follow this answer to receive notifications">
                        Follow
                        <input type="hidden" id="voteFollowHash" value="70:3:31e,16:0028cbe7fe3f1217,10:1771427630,16:7d22c6d689cc088e,8:69851522,a081397fb796d4b9f817eeebbfa6a9145bb87babf874be3f3e3f899769f7a17c" />
                    </button>
                </div>






    </div>
    <div class="js-menu-popup-container"></div>
</div>
            </div>
            <div class="post-signature flex--item fl0">
<div class="user-info user-hover ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            <a href="/posts/69851522/revisions" title="show all edits to this post"
                         class="js-gps-track"
                         data-gps-track="post.click({ item: 4, priv: 0, post_type: 2 })">edited <span title='2022-03-18 05:43:24Z' class='relativetime'>Mar 18, 2022 at 5:43</span></a>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/217408/g%c3%bcnter-z%c3%b6chbauer"><div class="gravatar-wrapper-32"><img src="https://i.sstatic.net/IlnZm.jpg?s=64" alt="G&#252;nter Z&#246;chbauer&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/217408/g%c3%bcnter-z%c3%b6chbauer" dir="auto">G&#252;nter Z&#246;chbauer</a>
        <div class="-flair">
            <span class="reputation-score" title="reputation score 661,896" dir="ltr">662k</span><span title="235 gold badges" aria-hidden="true"><span class="badge1"></span><span class="badgecount">235</span></span><span class="v-visible-sr">235 gold badges</span><span title="2.1k silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">2.1k</span></span><span class="v-visible-sr">2.1k silver badges</span><span title="1.6k bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">1.6k</span></span><span class="v-visible-sr">1.6k bronze badges</span>
        </div>
    </div>
</div>
            </div>


                <div class="post-signature flex--item fl0">
                    <div class="user-info user-hover ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            answered <span title='2021-11-05 10:05:03Z' class='relativetime'>Nov 5, 2021 at 10:05</span>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/17311156/geek26"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/8094043d27cd10a891c561c077853312?s=64&amp;d=identicon&amp;r=PG" alt="Geek26&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <a href="/users/17311156/geek26" itemprop="url" dir="auto">Geek26</a><meta itemprop="name" content="Geek26"/>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">529</span><span title="6 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">6</span></span><span class="v-visible-sr">6 silver badges</span><span title="11 bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">11</span></span><span class="v-visible-sr">11 bronze badges</span>
        </div>
    </div>
</div>


                </div>
        </div>
        
    
    </div>
    
</div>




                

    <div class="post-layout--right">
        

<div id="follow-ups-container-69851522">
    <!--[--><div class="mt16"><div class="mb8 d-flex ai-center g8 c-pointer" role="button" tabindex="0"><h2 class="mb0">1 Comment</h2> <!--[--><!--[--><!----><svg aria-hidden="true" class="svg-icon iconArrowDownAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m16.01 7.43-1.4-1.41L9 11.6 3.42 6l-1.4 1.42 7 7z"/></svg><!----><!--]--><!--]--></div> <div class="mb12"><!--[!--><button type="button" class="s-btn s-btn__muted s-btn__outlined w100 d-flex ai-center p8 comments-link" data-so-test="parent-answer-69851522"><!--[!--><!--]--> <div class="flex--item ml8"><p class="mb0">Add a comment</p></div></button><!--]--></div> <!--[--><div role="list"><!--[--><div id="follow-up-123474693" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/224132/peter-cordes" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://i.sstatic.net/N4ivW.png?s=64" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Peter Cordes</div> <div class="s-user-card--awards"><!--[--><a href="/users/224132/peter-cordes" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Peter Cordes</a><!--]--> <a class="comment-link" href="#comment123474693_69851522"><time title="2021-11-05T10:50:04.727Z" class="s-user-card--time ws-nowrap truncate">Over a year ago</time></a> <!--[--><span class="o50" title="Edited 1 time"><!----><svg aria-hidden="true" class="svg-icon iconPencilSm" width="14" height="14"  viewBox="0 0 14 14"><path fill="#F1B600" d="m2 10.12 6.37-6.43 1.88 1.88L3.88 12H2z"/><path fill="#E87C87" d="m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0"/></svg><!----><!----></span><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->The should be a change near the middle of the sorted train-track / path of execution, as the branch inside the loop is taken for the first ~half, not-taken for the last ~half of the elements.  (Or vice versa.)  Also, what do the 5 different levels in the unsorted case mean?  It&#39;s a 2-way branch.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2021-11-05T10:50:04.727Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-123474693"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">6</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-123474693"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-123474693" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-123474693"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-123474693" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><!--]--></div> <!--[!--><!--]--><!----><!--]--> <!--[!--><!--]--></div><!--]-->
</div>

<script type="application/json" data-role="module-args" data-module-name="islands/follow-ups/index.mod">{"replies":[{"id":123474693,"user":{"userId":224132,"isDeleted":false,"displayName":"Peter Cordes","url":"/users/224132/peter-cordes","profileImageUrl":"https://i.sstatic.net/N4ivW.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"PeterCordes","noSpacesUserName":"PeterCordes","reputationDisplayText":"0"},"postedAt":"2021-11-05T10:50:04.727Z","postedAtRelative":"Over a year ago","body":"The should be a change near the middle of the sorted train-track / path of execution, as the branch inside the loop is taken for the first ~half, not-taken for the last ~half of the elements.  (Or vice versa.)  Also, what do the 5 different levels in the unsorted case mean?  It\u0027s a 2-way branch.","htmlBody":"The should be a change near the middle of the sorted train-track / path of execution, as the branch inside the loop is taken for the first ~half, not-taken for the last ~half of the elements.  (Or vice versa.)  Also, what do the 5 different levels in the unsorted case mean?  It\u0026#39;s a 2-way branch.","score":6,"editCount":1,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":true,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true}],"postId":69851522,"currentUserIsMod":false,"currentUserIsAnonymous":true,"commentFlagsRemainingToday":10,"maxNestingLevel":3,"hasOptedOut":false,"showCtaUnderComments":false,"containerElementId":"follow-ups-container-69851522","fKey":"d09ecbbe5140a7c1439a7e4020cdd7d76b52d28795a889bb24233842877804f3","questionId":11227809,"questionAuthorId":87234,"answerId":69851522,"answerPositionOnPage":0,"newUiSettings":{"largerFontSize":false},"showFirstTimeCommentingModal":false,"isMentionEnabled":false,"showSpamFlag":true,"mergeUnfriendlyAndRudeFlags":true,"allowRetractingCommentFlags":true,"commentMinLength":15}</script>
    </div>

        </div>
</div>
                                        
<a name="79860452"></a>
<div id="answer-79860452" class="answer js-answer " data-answerid="79860452"
     data-parentid="11227809" data-score="0" data-position-on-page="26"
     data-highest-scored="0"
     data-question-has-accepted-highest-score="1"
     data-author-username="RARE Kpop Manifesto"
     data-author-reputation="3085"
     data-should-show-copy-button=True
     data-se-share-sheet-license-name="CC BY-SA 4.0"
     data-is-edited="True"
      itemprop="suggestedAnswer"
     itemscope itemtype="https://schema.org/Answer">
        <div class="post-layout ">
                <div class="votecell post-layout--left">
                    
<div class="js-voting-container d-flex jc-center fd-column ai-center gs4 fc-black-300" data-post-id="79860452" data-referrer="None">
        <button class="js-vote-up-btn flex--item s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
                id="upvote-btn-79860452"
                data-controller="s-tooltip"
                data-s-tooltip-placement="right"
                title="This answer is useful"
                aria-pressed="false"
                aria-label="Up vote"
                data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
                data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">
            <svg aria-hidden="true" class="svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg>
        </button>
        <input type="hidden" id="voteUpHash" value="70:3:31e,16:73cef5267888b4dc,10:1771427630,16:a983ee7583b8ddc3,8:79860452,be31e73de9e95ff7621b889dc572445a31dfaf72f6270c674eb179939c971494" />
        <div class="js-vote-count flex--item d-flex fd-column ai-center fc-theme-body-font fw-bold fs-subheading py4"
             itemprop="upvoteCount"
             data-value="0">
0        </div>
        <button
            class="js-vote-down-btn flex--item mb8 s-btn s-btn__muted s-btn__outlined bar-pill bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200"
            id=downvote-btn-79860452
            title="This answer is not useful"
            aria-pressed="false"
            aria-label="Down vote"
            data-selected-classes="fc-theme-primary bc-theme-primary bg-theme-primary-100"
            data-unselected-classes="bc-black-225 f:bc-theme-secondary-400 f:bg-theme-secondary-400 f:fc-black-050 h:bg-theme-primary-200">

            <svg aria-hidden="true" class="svg-icon iconArrowDown" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 6h16l-8 8z"/></svg>
        </button>
        <input type="hidden" id="voteDownHash" value="70:3:31e,16:e217baf268d2be52,10:1771427630,16:3edd4ec2450fd0d8,8:79860452,5dffa0754775dfd424481028f350316e3705273657675dd113207ec6e85b79a5" />


        
<button class="js-saves-btn s-btn s-btn__unset c-pointer py4"
        type="button"
        id="saves-btn-79860452"
        data-controller="s-tooltip"
        data-s-tooltip-placement="right"
        data-s-popover-placement=""
        title="Save this answer."
        data-is-saved="false"
        aria-label="Save"
        data-post-id="79860452"
        data-post-type-id="2"
        data-user-privilege-for-post-click="0"
        aria-controls=""
        data-s-popover-auto-show="false"
>
    <svg aria-hidden="true" class="fc-theme-primary-400 js-saves-btn-selected d-none svg-icon iconBookmark" width="18" height="18"  viewBox="0 0 18 18"><path  d="M3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
    <svg aria-hidden="true" class="js-saves-btn-unselected svg-icon iconBookmarkAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m9 10.6 4 2.66V3H5v10.26zM3 17V3c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v14l-6-4z"/></svg>
</button>







            <div class="js-accepted-answer-indicator flex--item fc-green-400 py6 mtn8 d-none" data-s-tooltip-placement="right" title="Loading when this answer was accepted&#x2026;" tabindex="0" role="note" aria-label="Accepted">
                <div class="ta-center">
                    <svg aria-hidden="true" class="svg-icon iconCheckmarkLg" width="36" height="36"  viewBox="0 0 36 36"><path  d="m6 14 8 8L30 6v8L14 30l-8-8z"/></svg>
                </div>
            </div>

    
    <a class="js-post-issue flex--item s-btn s-btn__unset c-pointer py6 mx-auto" href="/posts/79860452/timeline" data-shortcut="T" data-ks-title="timeline" data-controller="s-tooltip" data-s-tooltip-placement="right" title="Show activity on this post." aria-label="Timeline"><svg aria-hidden="true" class="mln2 mr0 svg-icon iconHistory" width="19" height="18"  viewBox="0 0 19 18"><path  d="M3 9a8 8 0 1 1 3.73 6.77L8.2 14.3A6 6 0 1 0 5 9l3.01-.01-4 4-4-4zm7-4h1.01L11 9.36l3.22 2.1-.6.93L10 10z"/></svg></a>

</div>

                </div>

            

<div class="answercell post-layout--right">
    


    <div class="s-prose js-post-body" itemprop="text">
<p>Or perhaps instead of using bit-wise ops, just completely prune away the filtering condition by converting it to a matter of counter frequencies, and doing a dot-product against byte ordinals (pre-requisite being <code>data[i]</code> can only have values in the <code>uint8</code> range). A major advantage of this approach is that whether array is sorted or not makes no difference, since no meaningful branch prediction is occurring anywhere in the core loop to iterate the input. The index capping filter at the summation is essentially immaterial in any grand scheme of things.</p>
<p>pre-make a counter array one for each byte's ordinal, convert the loop to a mindless one that tracks occurrence of each byte.</p>
<blockquote>
<pre class="lang-hs prettyprint-override"><code>++counter_array[data[i]]
</code></pre>
</blockquote>
<p>If a handy <code>foreach()</code> type construct is available in your particular language, then this can even be iterated through without manually incrementing <code>++i</code> in the 3rd part of the vanilla <code>for()</code> loop. e.g. if this were in <code>awk</code> instead of <code>C++</code>, then something like</p>
<blockquote>
<pre><code>for (_ in data)
    ++counter_array[data[_]]
</code></pre>
</blockquote>
<p>After iterating the input input, just start at <code>128</code>, and iterate it to the highest index</p>
<blockquote>
<pre class="lang-swift prettyprint-override"><code>for (_ = 128; _ &lt; 256; ++_)
    __ += counter_array[_] * _
</code></pre>
</blockquote>
<p>And scale it by the <code>100,000</code> only once at the <code>return</code> statement. In order to bypass the filtering condition altogether, the summation loop has to be manually incremented (unless you wanna opt for some new age map-reduce construct).</p>
    </div>
    <div class="mt24">
        <div class="d-flex fw-wrap ai-start jc-end gs8 gsy">

            <time itemprop="dateCreated" datetime="2026-01-05 02:21:12Z"></time>
            <div class="flex--item mr16" style="flex: 1 1 100px;">
                


<div class="js-post-menu pt2" data-post-id="79860452" data-post-type-id="2">

    <div class="d-flex gs8 s-anchors s-anchors__muted fw-wrap">

        <div class="flex--item">
            <a href="/a/79860452"
               rel="nofollow"
               itemprop="url"
               class="js-share-link js-gps-track"
               title="Short permalink to this answer"
               data-gps-track="post.click({ item: 2, priv: 0, post_type: 2 })"
               data-controller="se-share-sheet"
               data-se-share-sheet-title="Share a link to this answer"
               data-se-share-sheet-subtitle=""
               data-se-share-sheet-post-type="answer"
               data-se-share-sheet-social="facebook twitter devto"
               data-se-share-sheet-location="2"
               data-se-share-sheet-license-url="https%3a%2f%2fcreativecommons.org%2flicenses%2fby-sa%2f4.0%2f"
               data-se-share-sheet-license-name="CC BY-SA 4.0"
               data-s-popover-placement="bottom-start">Share</a>
        </div>


                    <div class="flex--item">
                        <a href="/posts/79860452/edit" class="js-suggest-edit-post js-gps-track" data-gps-track="post.click({ item: 6, priv: 0, post_type: 2 })" title="">Improve this answer</a>
                    </div>

                <div class="flex--item">
                    <button type="button"
                            id="btnFollowPost-79860452" class="s-btn s-btn__link js-follow-post js-follow-answer js-gps-track"
                            data-gps-track="post.click({ item: 14, priv: 0, post_type: 2 })"
                            data-controller="s-tooltip " data-s-tooltip-placement="bottom"
                            data-s-popover-placement="bottom" aria-controls=""
                            title="Follow this answer to receive notifications">
                        Follow
                        <input type="hidden" id="voteFollowHash" value="70:3:31e,16:3d88b080ea194dac,10:1771427630,16:681ef05a3558a6b2,8:79860452,c70cd7b43e979ea36b99d140ec0b4b8219c923d0a492eac6670a7de7251b816a" />
                    </button>
                </div>






    </div>
    <div class="js-menu-popup-container"></div>
</div>
            </div>
            <div class="post-signature flex--item fl0">
<div class="user-info ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            <a href="/posts/79860452/revisions" title="show all edits to this post"
                         class="js-gps-track"
                         data-gps-track="post.click({ item: 4, priv: 0, post_type: 2 })">edited <span title='2026-01-05 02:31:42Z' class='relativetime'>Jan 5 at 2:31</span></a>
        </div>
        
    </div>
    <div class="user-gravatar32">
        
    </div>
    <div class="user-details">
        
        <div class="-flair">
            
        </div>
    </div>
</div>
            </div>


                <div class="post-signature flex--item fl0">
                    <div class="user-info ">
    <div class="d-flex ">
        <div class="user-action-time fl-grow1">
            answered <span title='2026-01-05 02:21:12Z' class='relativetime'>Jan 5 at 2:21</span>
        </div>
        
    </div>
    <div class="user-gravatar32">
        <a href="/users/14672114/rare-kpop-manifesto"><div class="gravatar-wrapper-32"><img src="https://lh3.googleusercontent.com/a-/AOh14Gh77XbK_ZXsqVwrM6a6K6g2DNN4_XD_K1wOopWCVA=k-s64" alt="RARE Kpop Manifesto&#39;s user avatar" width="32" height="32" class="bar-sm"></div></a>
    </div>
    <div class="user-details" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <a href="/users/14672114/rare-kpop-manifesto" itemprop="url" dir="auto">RARE Kpop Manifesto</a><meta itemprop="name" content="RARE Kpop Manifesto"/>
        <div class="-flair">
            <span class="reputation-score" title="reputation score " dir="ltr">3,085</span><span title="6 silver badges" aria-hidden="true"><span class="badge2"></span><span class="badgecount">6</span></span><span class="v-visible-sr">6 silver badges</span><span title="15 bronze badges" aria-hidden="true"><span class="badge3"></span><span class="badgecount">15</span></span><span class="v-visible-sr">15 bronze badges</span>
        </div>
    </div>
</div>


                </div>
        </div>
        
    
    </div>
    
</div>




                

    <div class="post-layout--right">
        

<div id="follow-ups-container-79860452">
    <!--[--><div class="mt16"><div class="mb8 d-flex ai-center g8 c-pointer" role="button" tabindex="0"><h2 class="mb0">6 Comments</h2> <!--[--><!--[--><!----><svg aria-hidden="true" class="svg-icon iconArrowDownAlt" width="18" height="18"  viewBox="0 0 18 18"><path  d="m16.01 7.43-1.4-1.41L9 11.6 3.42 6l-1.4 1.42 7 7z"/></svg><!----><!--]--><!--]--></div> <div class="mb12"><!--[!--><button type="button" class="s-btn s-btn__muted s-btn__outlined w100 d-flex ai-center p8 comments-link" data-so-test="parent-answer-79860452"><!--[!--><!--]--> <div class="flex--item ml8"><p class="mb0">Add a comment</p></div></button><!--]--></div> <!--[--><div role="list"><!--[--><div id="follow-up-140928231" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/224132/peter-cordes" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://i.sstatic.net/N4ivW.png?s=64" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Peter Cordes</div> <div class="s-user-card--awards"><!--[--><a href="/users/224132/peter-cordes" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Peter Cordes</a><!--]--> <a class="comment-link" href="#comment140928231_79860452"><time title="2026-01-05T02:40:49.147Z" class="s-user-card--time ws-nowrap truncate">Jan 5 at 2:40</time></a> <!--[--><span class="o50" title="Edited 1 time"><!----><svg aria-hidden="true" class="svg-icon iconPencilSm" width="14" height="14"  viewBox="0 0 14 14"><path fill="#F1B600" d="m2 10.12 6.37-6.43 1.88 1.88L3.88 12H2z"/><path fill="#E87C87" d="m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0"/></svg><!----><!----></span><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->The 100k outer loop is a repeat loop for benchmarking, to make the time easy to measure without having to make the array gigantic. A real use-case wouldn&#39;t scale at all, but yes you could manually defeat it with loop-interchange to get the same result.  And yes, a histogram is one way to make the main loop branchless.  Certainly not the most efficient way if you have a compiler capable of doing a good job with <code>sum += x &gt;= 128 ? x : 0;</code>, but is portable.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2026-01-05T02:40:49.147Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-140928231"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">0</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-140928231"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-140928231" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-140928231"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-140928231" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-140928233" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/224132/peter-cordes" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://i.sstatic.net/N4ivW.png?s=64" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Peter Cordes</div> <div class="s-user-card--awards"><!--[--><a href="/users/224132/peter-cordes" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Peter Cordes</a><!--]--> <a class="comment-link" href="#comment140928233_79860452"><time title="2026-01-05T02:41:30.853Z" class="s-user-card--time ws-nowrap truncate">Jan 5 at 2:41</time></a> <!--[--><span class="o50" title="Edited 3 times"><!----><svg aria-hidden="true" class="svg-icon iconPencilSm" width="14" height="14"  viewBox="0 0 14 14"><path fill="#F1B600" d="m2 10.12 6.37-6.43 1.88 1.88L3.88 12H2z"/><path fill="#E87C87" d="m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0"/></svg><!----><!----></span><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->C++ does have <code>for (auto x : data)</code> to iterate over values of a container.  An array (not just pointer) is a valid container, as are STL containers like <code>std::vector</code>. (Often people make <code>x</code> a reference with <code>auto &amp;&amp;x</code>, but value works here.)  <a href="https://en.cppreference.com/w/cpp/language/range-for.html" rel="nofollow noreferrer">en.cppreference.com/w/cpp/language/range-for.html</a> has some examples and documentation.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2026-01-05T02:41:30.853Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-140928233"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">0</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-140928233"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-140928233" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-140928233"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-140928233" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><div id="follow-up-140928236" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-0"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/224132/peter-cordes" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://i.sstatic.net/N4ivW.png?s=64" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Peter Cordes</div> <div class="s-user-card--awards"><!--[--><a href="/users/224132/peter-cordes" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Peter Cordes</a><!--]--> <a class="comment-link" href="#comment140928236_79860452"><time title="2026-01-05T02:45:15.54Z" class="s-user-card--time ws-nowrap truncate">Jan 5 at 2:45</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4 bg-black-200" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->A histogram is obviously ideal for answering multiple queries, like sum of values &gt;= 127, &gt;= 128, &gt;=129 etc.  Otherwise wouldn&#39;t be worth constructing, unless using an implementation that can&#39;t make branchless code and suffers a lot from branch mispredicts.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2026-01-05T02:45:15.54Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-140928236"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">0</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-140928236"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-140928236" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-140928236"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-140928236" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[--><!--[--><!--[!--><div class="d-flex"><div class="flex--item w32 fc-black-200 ml12 mrn12 fl-shrink0"><div class="bl bb w16 h12 bblr-lg"></div> <!--[--><div class="bg-black-200 h100 mr12 mtn8" style="width: 1px"></div><!--]--></div> <div class="flex--item fl-grow1"><div id="follow-up-140929557" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-140928236"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/14672114/rare-kpop-manifesto" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://lh3.googleusercontent.com/a-/AOh14Gh77XbK_ZXsqVwrM6a6K6g2DNN4_XD_K1wOopWCVA=k-s48" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">RARE Kpop Manifesto</div> <div class="s-user-card--awards"><!--[--><a href="/users/14672114/rare-kpop-manifesto" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">RARE Kpop Manifesto</a><!--]--> <a class="comment-link" href="#comment140929557_79860452"><time title="2026-01-05T21:43:43.797Z" class="s-user-card--time ws-nowrap truncate">Jan 5 at 21:43</time></a> <!--[--><span class="o50" title="Edited 1 time"><!----><svg aria-hidden="true" class="svg-icon iconPencilSm" width="14" height="14"  viewBox="0 0 14 14"><path fill="#F1B600" d="m2 10.12 6.37-6.43 1.88 1.88L3.88 12H2z"/><path fill="#E87C87" d="m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0"/></svg><!----><!----></span><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4 bg-black-200" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->would something like this make it faster <code>sum += (x &gt;= 128) * x</code> - at least by any <code>CPU</code> with any brain since the boolean outcome is used no matter what, esp since your version is still doing <code>sum += </code> regardless. There&#39;s always <code>x &gt;= 128 ? (sum += x) : 0</code> but somehow people (for rather baffling reasons) dislike putting both <code>lhs</code> and <code>rhs</code> into the middle of a ternary (i&#39;m guessing that&#39;s also part of the contrived rationale mentioned by the Fascist Dictator for Life when he imposed the most bloated and counter-intuitive ternary syntax upon others)<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2026-01-05T21:43:43.797Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-140929557"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">0</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-140929557"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-140929557" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-140929557"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-140929557" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[--><!--[--><!--[!--><div class="d-flex"><div class="flex--item w32 fc-black-200 ml12 mrn12 fl-shrink0"><div class="bl bb w16 h12 bblr-lg"></div> <!--[!--><!--]--></div> <div class="flex--item fl-grow1"><div id="follow-up-140929711" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-140929557"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/224132/peter-cordes" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://i.sstatic.net/N4ivW.png?s=64" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">Peter Cordes</div> <div class="s-user-card--awards"><!--[--><a href="/users/224132/peter-cordes" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">Peter Cordes</a><!--]--> <a class="comment-link" href="#comment140929711_79860452"><time title="2026-01-06T01:22:13.957Z" class="s-user-card--time ws-nowrap truncate">Jan 6 at 1:22</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->Putting <code>sum += x</code> in the middle of the ternary makes it logically identical to an <code>if</code>, requiring the compiler to do if-conversion optimization to make branchless asm.  Having the <code>sum+=</code> part happen unconditionally (in the abstract machine) encourages compilers to make branchless code, adding 0 or x.  <code>(x&gt;=128)*x</code> compiled naively would require materializing an actual <code>0</code> or <code>1</code> and then multiplying, which isn&#39;t a disaster on modern CPUs, but isn&#39;t the asm you actually want except possibly on RISC-V without the extension that adds <code>cmov</code>.  Good compilers can often optimize that multiply.<!----><!--]--></div> <time class="d-none" itemprop="datePublished">2026-01-06T01:22:13.957Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-140929711"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">0</span></div></button><!--]--> <!--[!--><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-140929711" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-140929711"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-140929711" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><!----></div></div><!--]--><!--]--><!--]--><!----></div></div><!--]--><!--[!--><div class="d-flex"><div class="flex--item w32 fc-black-200 ml12 mrn12 fl-shrink0"><div class="bl bb w16 h12 bblr-lg"></div> <!--[!--><!--]--></div> <div class="flex--item fl-grow1"><div id="follow-up-140929640" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment" role="listitem" data-so-test="reply-parent-comment-140928236"><!--[--><div class="d-flex fd-column"><!--[--><div class="d-flex g6"><div class="flex--item w24"><!--[--><a href="/users/14672114/rare-kpop-manifesto" class="s-avatar s-avatar__24 s-user-card--avatar" aria-label="User profile"><img class="s-avatar--image" src="https://lh3.googleusercontent.com/a-/AOh14Gh77XbK_ZXsqVwrM6a6K6g2DNN4_XD_K1wOopWCVA=k-s48" alt=""/></a><!--]--><!----></div> <div class="flex--item d-flex fd-column g8 fl-grow1 overflow-hidden"><div class="d-flex jc-space-between"><div class="flex--item h24 ai-center s-user-card s-user-card__small lh-md"><div class="s-user-card--info" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="d-none" itemprop="name">RARE Kpop Manifesto</div> <div class="s-user-card--awards"><!--[--><a href="/users/14672114/rare-kpop-manifesto" class="s-user-card--link truncate wmx2 comment-user lh-xs" itemprop="url">RARE Kpop Manifesto</a><!--]--> <a class="comment-link" href="#comment140929640_79860452"><time title="2026-01-05T23:22:16.66Z" class="s-user-card--time ws-nowrap truncate">Jan 5 at 23:22</time></a> <!--[!--><!--]--> <!--[!--><!--]--></div></div></div><!----></div></div></div><!--]--> <div class="flex--item d-flex g6 fl-grow1"><div class="flex--item d-flex fd-column ai-center pt4"><div class="h100 ml12 mr12 pt4" style="width: 1px"></div></div> <div class="flex--item d-flex fd-column g4 fl-grow1"><div itemprop="text" class="flex--item fw-normal fs-body1 mb4 ow-anywhere"><!--[--><!---->Thank god Yoda doesn&#39;t speak syntax jargon. Otherwise he&#39;d be like ::::::::::::: ::::::::::::::::: :::::::::::::::::: ::::::: <code>do while || do while not. there is no try catch.</code><!----><!--]--></div> <time class="d-none" itemprop="datePublished">2026-01-05T23:22:16.66Z+00:00</time> <!--[--><div class="d-flex g16 pb8"><div class="flex--item d-flex ai-center g16 fl-grow1"><div class="d-flex jc-space-between fl-grow1"><div class="flex--item d-flex ai-center g8"><!--[!--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted s-btn__icon h24 py2" type="button" data-so-test="vote-button-comment-140929640"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 va-middle w16 svg-icon iconArrowUp" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 12h16L9 4z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">0</span></div></button><!--]--> <!--[--><button class="s-btn s-btn__xs s-btn__outlined s-btn__muted h24 py2" type="button" data-so-test="reply-button-comment-140929640"><div class="d-flex ai-center g6"><span class="s-btn--icon"><!----><svg aria-hidden="true" class="fc-black-400 w16 svg-icon iconMessage" width="18" height="18"  viewBox="0 0 18 18"><path  d="M1 4v14l3-3h11c1.09 0 2-.91 2-2V4c0-1.09-.91-2-2-2H3a2 2 0 0 0-2 2m3 9-1 1V4h12v9zm1-6a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m1 2a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2z"/></svg><!----><!----></span> <span class="fw-normal fs-caption fc-black-500">Reply</span></div></button><!--]--> <!--[--><button class="flex--item s-btn s-btn__xs s-btn__outlined s-btn__muted py2 h24" type="button" aria-controls="popover-menu-140929640" aria-expanded="false" aria-label="Open menu" data-controller="s-popover" data-action="s-popover#toggle" data-s-popover-placement="bottom-start" data-s-popover-toggle-class="is-selected" data-so-test="actions-button-comment-140929640"><!----><svg aria-hidden="true" class="fc-black-400 svg-icon iconEllipsisHorizontal" width="17" height="18"  viewBox="0 0 17 18"><path  d="M3.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3M12 8.5a1.5 1.5 0 1 0 3 0 1.5 1.5 0 0 0-3 0"/></svg><!----><!----></button> <div id="popover-menu-140929640" class="s-popover s-popover__tooltip" role="menu"><div class="s-popover--arrow"></div> <div class="s-popover--content"><ul class="s-menu" role="menu"><li role="menuitem"><button class="s-block-link h:bg-black-100 js-follow-up-copy-link">Copy link</button></li> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--></ul></div></div><!--]--></div> <!--[!--><!--]--></div></div></div><!--]--> <!--[!--><!--]--></div></div></div><!--]--></div> <!--[!--><!--]--> <!--[!--><!--]--><!----></div></div><!--]--><!--]--><!--]--><!--]--></div> <!--[--><div class="d-flex g8 my8"><!--[--><button class="s-link s-btn__muted s-btn__outlined comments-link" data-so-test="parent-answer-79860452">Add a comment</button> <!--[!--><!--]--><!--]--> <!--[!--><!--]--></div><!--]--><!----><!--]--> <!--[!--><!--]--></div><!--]-->
</div>

<script type="application/json" data-role="module-args" data-module-name="islands/follow-ups/index.mod">{"replies":[{"id":140928231,"user":{"userId":224132,"isDeleted":false,"displayName":"Peter Cordes","url":"/users/224132/peter-cordes","profileImageUrl":"https://i.sstatic.net/N4ivW.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"PeterCordes","noSpacesUserName":"PeterCordes","reputationDisplayText":"0"},"postedAt":"2026-01-05T02:40:49.147Z","postedAtRelative":"Jan 5 at 2:40","body":"The 100k outer loop is a repeat loop for benchmarking, to make the time easy to measure without having to make the array gigantic. A real use-case wouldn\u0027t scale at all, but yes you could manually defeat it with loop-interchange to get the same result.  And yes, a histogram is one way to make the main loop branchless.  Certainly not the most efficient way if you have a compiler capable of doing a good job with \u0060sum \u002B= x \u003E= 128 ? x : 0;\u0060, but is portable.","htmlBody":"The 100k outer loop is a repeat loop for benchmarking, to make the time easy to measure without having to make the array gigantic. A real use-case wouldn\u0026#39;t scale at all, but yes you could manually defeat it with loop-interchange to get the same result.  And yes, a histogram is one way to make the main loop branchless.  Certainly not the most efficient way if you have a compiler capable of doing a good job with \u003Ccode\u003Esum \u002B= x \u0026gt;= 128 ? x : 0;\u003C/code\u003E, but is portable.","score":0,"editCount":1,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":140928233,"user":{"userId":224132,"isDeleted":false,"displayName":"Peter Cordes","url":"/users/224132/peter-cordes","profileImageUrl":"https://i.sstatic.net/N4ivW.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"PeterCordes","noSpacesUserName":"PeterCordes","reputationDisplayText":"0"},"postedAt":"2026-01-05T02:41:30.853Z","postedAtRelative":"Jan 5 at 2:41","body":"C\u002B\u002B does have \u0060for (auto x : data)\u0060 to iterate over values of a container.  An array (not just pointer) is a valid container, as are STL containers like \u0060std::vector\u0060. (Often people make \u0060x\u0060 a reference with \u0060auto \u0026\u0026x\u0060, but value works here.)  https://en.cppreference.com/w/cpp/language/range-for.html has some examples and documentation.","htmlBody":"C\u002B\u002B does have \u003Ccode\u003Efor (auto x : data)\u003C/code\u003E to iterate over values of a container.  An array (not just pointer) is a valid container, as are STL containers like \u003Ccode\u003Estd::vector\u003C/code\u003E. (Often people make \u003Ccode\u003Ex\u003C/code\u003E a reference with \u003Ccode\u003Eauto \u0026amp;\u0026amp;x\u003C/code\u003E, but value works here.)  \u003Ca href=\u0022https://en.cppreference.com/w/cpp/language/range-for.html\u0022 rel=\u0022nofollow noreferrer\u0022\u003Een.cppreference.com/w/cpp/language/range-for.html\u003C/a\u003E has some examples and documentation.","score":0,"editCount":3,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true},{"id":140928236,"user":{"userId":224132,"isDeleted":false,"displayName":"Peter Cordes","url":"/users/224132/peter-cordes","profileImageUrl":"https://i.sstatic.net/N4ivW.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"PeterCordes","noSpacesUserName":"PeterCordes","reputationDisplayText":"0"},"postedAt":"2026-01-05T02:45:15.54Z","postedAtRelative":"Jan 5 at 2:45","body":"A histogram is obviously ideal for answering multiple queries, like sum of values \u003E= 127, \u003E= 128, \u003E=129 etc.  Otherwise wouldn\u0027t be worth constructing, unless using an implementation that can\u0027t make branchless code and suffers a lot from branch mispredicts.","htmlBody":"A histogram is obviously ideal for answering multiple queries, like sum of values \u0026gt;= 127, \u0026gt;= 128, \u0026gt;=129 etc.  Otherwise wouldn\u0026#39;t be worth constructing, unless using an implementation that can\u0026#39;t make branchless code and suffers a lot from branch mispredicts.","score":0,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[{"id":140929557,"user":{"userId":14672114,"isDeleted":false,"displayName":"RARE Kpop Manifesto","url":"/users/14672114/rare-kpop-manifesto","profileImageUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh77XbK_ZXsqVwrM6a6K6g2DNN4_XD_K1wOopWCVA=k-s48","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"RAREKpopManifesto","noSpacesUserName":"RAREKpopManifesto","reputationDisplayText":"0"},"postedAt":"2026-01-05T21:43:43.797Z","postedAtRelative":"Jan 5 at 21:43","body":"would something like this make it faster \u0060sum \u002B= (x \u003E= 128) * x\u0060 - at least by any \u0060CPU\u0060 with any brain since the boolean outcome is used no matter what, esp since your version is still doing \u0060sum \u002B= \u0060 regardless. There\u0027s always \u0060x \u003E= 128 ? (sum \u002B= x) : 0\u0060 but somehow people (for rather baffling reasons) dislike putting both \u0060lhs\u0060 and \u0060rhs\u0060 into the middle of a ternary (i\u0027m guessing that\u0027s also part of the contrived rationale mentioned by the Fascist Dictator for Life when he imposed the most bloated and counter-intuitive ternary syntax upon others)","htmlBody":"would something like this make it faster \u003Ccode\u003Esum \u002B= (x \u0026gt;= 128) * x\u003C/code\u003E - at least by any \u003Ccode\u003ECPU\u003C/code\u003E with any brain since the boolean outcome is used no matter what, esp since your version is still doing \u003Ccode\u003Esum \u002B= \u003C/code\u003E regardless. There\u0026#39;s always \u003Ccode\u003Ex \u0026gt;= 128 ? (sum \u002B= x) : 0\u003C/code\u003E but somehow people (for rather baffling reasons) dislike putting both \u003Ccode\u003Elhs\u003C/code\u003E and \u003Ccode\u003Erhs\u003C/code\u003E into the middle of a ternary (i\u0026#39;m guessing that\u0026#39;s also part of the contrived rationale mentioned by the Fascist Dictator for Life when he imposed the most bloated and counter-intuitive ternary syntax upon others)","score":0,"editCount":1,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[{"id":140929711,"user":{"userId":224132,"isDeleted":false,"displayName":"Peter Cordes","url":"/users/224132/peter-cordes","profileImageUrl":"https://i.sstatic.net/N4ivW.png?s=64","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"PeterCordes","noSpacesUserName":"PeterCordes","reputationDisplayText":"0"},"postedAt":"2026-01-06T01:22:13.957Z","postedAtRelative":"Jan 6 at 1:22","body":"Putting \u0060sum \u002B= x\u0060 in the middle of the ternary makes it logically identical to an \u0060if\u0060, requiring the compiler to do if-conversion optimization to make branchless asm.  Having the \u0060sum\u002B=\u0060 part happen unconditionally (in the abstract machine) encourages compilers to make branchless code, adding 0 or x.  \u0060(x\u003E=128)*x\u0060 compiled naively would require materializing an actual \u00600\u0060 or \u00601\u0060 and then multiplying, which isn\u0027t a disaster on modern CPUs, but isn\u0027t the asm you actually want except possibly on RISC-V without the extension that adds \u0060cmov\u0060.  Good compilers can often optimize that multiply.","htmlBody":"Putting \u003Ccode\u003Esum \u002B= x\u003C/code\u003E in the middle of the ternary makes it logically identical to an \u003Ccode\u003Eif\u003C/code\u003E, requiring the compiler to do if-conversion optimization to make branchless asm.  Having the \u003Ccode\u003Esum\u002B=\u003C/code\u003E part happen unconditionally (in the abstract machine) encourages compilers to make branchless code, adding 0 or x.  \u003Ccode\u003E(x\u0026gt;=128)*x\u003C/code\u003E compiled naively would require materializing an actual \u003Ccode\u003E0\u003C/code\u003E or \u003Ccode\u003E1\u003C/code\u003E and then multiplying, which isn\u0026#39;t a disaster on modern CPUs, but isn\u0026#39;t the asm you actually want except possibly on RISC-V without the extension that adds \u003Ccode\u003Ecmov\u003C/code\u003E.  Good compilers can often optimize that multiply.","score":0,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":false,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":true,"exceedsNestingLimit":true,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":false,"parentCommentId":140929557}],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":false,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"PeterCordes","noSpacesReplyToUserName":"PeterCordes","isTopScored":false,"parentCommentId":140928236},{"id":140929640,"user":{"userId":14672114,"isDeleted":false,"displayName":"RARE Kpop Manifesto","url":"/users/14672114/rare-kpop-manifesto","profileImageUrl":"https://lh3.googleusercontent.com/a-/AOh14Gh77XbK_ZXsqVwrM6a6K6g2DNN4_XD_K1wOopWCVA=k-s48","reputation":0,"goldBadges":0,"silverBadges":0,"bronzeBadges":0,"isStaff":false,"isModerator":false,"htmlFriendlyName":"RAREKpopManifesto","noSpacesUserName":"RAREKpopManifesto","reputationDisplayText":"0"},"postedAt":"2026-01-05T23:22:16.66Z","postedAtRelative":"Jan 5 at 23:22","body":"Thank god Yoda doesn\u0027t speak syntax jargon. Otherwise he\u0027d be like ::::::::::::: ::::::::::::::::: :::::::::::::::::: ::::::: \u0060do while || do while not. there is no try catch.\u0060","htmlBody":"Thank god Yoda doesn\u0026#39;t speak syntax jargon. Otherwise he\u0026#39;d be like ::::::::::::: ::::::::::::::::: :::::::::::::::::: ::::::: \u003Ccode\u003Edo while || do while not. there is no try catch.\u003C/code\u003E","score":0,"showVoteInsteadOfZero":false,"showVoteWording":false,"replies":[],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":true,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"PeterCordes","noSpacesReplyToUserName":"PeterCordes","isTopScored":false,"parentCommentId":140928236}],"userCanFlag":false,"userCanVote":false,"isCommentOwner":false,"userCanReply":true,"userCanEdit":false,"userCanDelete":false,"userCanUndelete":false,"userCanRedact":false,"userCanViewHistory":false,"userHasFlagged":false,"userHasVoted":false,"isDeleted":false,"isLastReply":true,"exceedsNestingLimit":false,"isDeletedAndReadOnly":false,"showOwnPostTooltip":false,"voteButtonTooltipText":"Thanks for participating. Your votes will count once you\u0027ve earned enough reputation.","htmlFriendlyReplyToUserName":"","noSpacesReplyToUserName":"","isTopScored":true}],"postId":79860452,"currentUserIsMod":false,"currentUserIsAnonymous":true,"commentFlagsRemainingToday":10,"maxNestingLevel":3,"hasOptedOut":false,"showCtaUnderComments":true,"containerElementId":"follow-ups-container-79860452","fKey":"d09ecbbe5140a7c1439a7e4020cdd7d76b52d28795a889bb24233842877804f3","questionId":11227809,"questionAuthorId":87234,"answerId":79860452,"answerPositionOnPage":0,"newUiSettings":{"largerFontSize":false},"showFirstTimeCommentingModal":false,"isMentionEnabled":false,"showSpamFlag":true,"mergeUnfriendlyAndRudeFlags":true,"allowRetractingCommentFlags":true,"commentMinLength":15}</script>
    </div>

        </div>
</div>
                                        <aside class="s-notice s-notice__info post-notice js-post-notice mb16" role="status">
        <div class="d-flex fd-column fw-nowrap">
            <div class="d-flex fw-nowrap">
                    <div class="flex--item mr8">
                        <svg aria-hidden="true" class="svg-icon iconShield" width="18" height="18"  viewBox="0 0 18 18"><path  d="m2 4 7-3 7 3v5.02C16 13.69 10.69 17 9 17s-7-3.31-7-7.98zm6.14 5.2L7 12h4L9.86 9.2a.6.6 0 0 1 .25-.59c.56-.36.89-.95.89-1.61 0-1.09-.94-2-2.02-2A2 2 0 0 0 7 7c0 .66.33 1.25.89 1.61.2.13.3.36.25.59"/></svg>
                    </div>
                <div class="flex--item wmn0 fl1 lh-lg">
                    <div class="flex--item fl1 lh-lg">
                            <div>
                                <b><a href="/help/privileges/protect-questions">Protected question</a></b>. To answer this question, you need to have at least 10 reputation on this site (not counting the <a href="https://meta.stackexchange.com/questions/141648/what-is-the-association-bonus-and-how-does-it-work">association bonus</a>). The reputation requirement helps protect this question from spam and non-answer activity.
                                
                            </div>
                    </div>
                </div>
            </div>
        </div>
</aside>

                                <div class="js-bottom-notice d-flex w100 md:mb12 md:fd-column ac-stretch" data-loc="1">
                                    <div class="flex--item ba bc-black-200 bar-md p24 md:p16 mr12 md:mb12 md:mr0 w50 md:w100">
                                        <div class="d-flex fd-column">
                                            <p class="flex--item fs-body2 fw-bold fc-black-500 mb8">Start asking to get answers</p>
                                            <p class="flex--item fs-body1 fc-black-400 mb16">Find the answer to your question by asking.</p>
                                            <a class="flex--item s-btn s-btn__outlined as-start px32 md:px16" href="/questions/ask">Ask question</a>
                                        </div>
                                    </div>
                                    <div class="flex--item ba bc-black-200 bar-md p24 md:p16 w50 md:w100">
                                        <div class="d-flex fd-column gsy g16">
                                            <p class="flex--item fs-body2 fw-bold fc-black-500 mb0">Explore related questions</p>
                                            <div class="flex--item mb0"><ul class='ml0 list-ls-none js-post-tag-list-wrapper d-inline'><li class='d-inline mr4 js-post-tag-list-item'><a href="/questions/tagged/java" class="s-tag post-tag" title="show questions tagged &#39;java&#39;" aria-label="show questions tagged &#39;java&#39;" rel="tag" aria-labelledby="tag-java-tooltip-container" data-tag-menu-origin="Unknown">java</a></li><li class='d-inline mr4 js-post-tag-list-item'><a href="/questions/tagged/c%2b%2b" class="s-tag post-tag" title="show questions tagged &#39;c++&#39;" aria-label="show questions tagged &#39;c++&#39;" rel="tag" aria-labelledby="tag-c++-tooltip-container" data-tag-menu-origin="Unknown">c++</a></li><li class='d-inline mr4 js-post-tag-list-item'><a href="/questions/tagged/performance" class="s-tag post-tag" title="show questions tagged &#39;performance&#39;" aria-label="show questions tagged &#39;performance&#39;" rel="tag" aria-labelledby="tag-performance-tooltip-container" data-tag-menu-origin="Unknown">performance</a></li><li class='d-inline mr4 js-post-tag-list-item'><a href="/questions/tagged/cpu-architecture" class="s-tag post-tag" title="show questions tagged &#39;cpu-architecture&#39;" aria-label="show questions tagged &#39;cpu-architecture&#39;" rel="tag" aria-labelledby="tag-cpu-architecture-tooltip-container" data-tag-menu-origin="Unknown">cpu-architecture</a></li><li class='d-inline mr4 js-post-tag-list-item'><a href="/questions/tagged/branch-prediction" class="s-tag post-tag" title="show questions tagged &#39;branch-prediction&#39;" aria-label="show questions tagged &#39;branch-prediction&#39;" rel="tag" aria-labelledby="tag-branch-prediction-tooltip-container" data-tag-menu-origin="Unknown">branch-prediction</a></li></ul></div>
                                            <p class="flex--item fs-body1 fc-black-400 mb0">See similar questions with these tags.</p>
                                        </div>
                                    </div>
                                </div>
                </div>
            </div>

        

            
<div id="sidebar" class="show-votes" role="complementary" aria-label="sidebar">
        


    <div class="s-sidebarwidget s-sidebarwidget__yellow s-anchors s-anchors__grayscale mb16" data-tracker="cb=1">
            <ul class="s-sidebarwidget--content s-sidebarwidget__items p0">
                        <li class="s-sidebarwidget--header">
                            The Overflow Blog
                        </li>
        <li class="s-sidebarwidget--item d-flex px16">
            <div class="flex--item1 fl-shrink0">
<svg aria-hidden="true" class="va-text-top svg-icon iconPencilSm" width="14" height="14"  viewBox="0 0 14 14"><path fill="#F1B600" d="m2 10.12 6.37-6.43 1.88 1.88L3.88 12H2z"/><path fill="#E87C87" d="m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0"/></svg>            </div>
            <div class="flex--item wmn0 ow-break-word">
                <a href="https://stackoverflow.blog/2026/02/13/even-your-voice-is-a-data-problem/" class="js-gps-track" data-ga="[&quot;community bulletin board&quot;,&quot;The Overflow Blog&quot;,&quot;https://stackoverflow.blog/2026/02/13/even-your-voice-is-a-data-problem/&quot;,null,null]" data-gps-track="communitybulletin.click({ priority: 1, position: 0, location: questionpage })">Even your voice is a data problem</a>
            </div>
        </li>
        <li class="s-sidebarwidget--item d-flex px16">
            <div class="flex--item1 fl-shrink0">
<svg aria-hidden="true" class="va-text-top svg-icon iconPencilSm" width="14" height="14"  viewBox="0 0 14 14"><path fill="#F1B600" d="m2 10.12 6.37-6.43 1.88 1.88L3.88 12H2z"/><path fill="#E87C87" d="m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0"/></svg>            </div>
            <div class="flex--item wmn0 ow-break-word">
                <a href="https://stackoverflow.blog/2026/02/17/data-is-the-new-oil/" class="js-gps-track" data-ga="[&quot;community bulletin board&quot;,&quot;The Overflow Blog&quot;,&quot;https://stackoverflow.blog/2026/02/17/data-is-the-new-oil/&quot;,null,null]" data-gps-track="communitybulletin.click({ priority: 1, position: 1, location: questionpage })">Data is the new oil, and your database is the only way to extract it</a>
            </div>
        </li>
                        <li class="s-sidebarwidget--header">
                            Featured on Meta
                        </li>
        <li class="s-sidebarwidget--item d-flex px16">
            <div class="flex--item1 fl-shrink0">
<div class="favicon favicon-stackexchangemeta" title="Meta Stack Exchange"></div>            </div>
            <div class="flex--item wmn0 ow-break-word">
                <a href="https://meta.stackexchange.com/questions/416985/community-engagement-across-the-network-focus-for-2026" class="js-gps-track" data-ga="[&quot;community bulletin board&quot;,&quot;Featured on Meta&quot;,&quot;https://meta.stackexchange.com/questions/416985/community-engagement-across-the-network-focus-for-2026&quot;,null,null]" data-gps-track="communitybulletin.click({ priority: 3, position: 2, location: questionpage })">Community Engagement Across the Network: Focus for 2026</a>
            </div>
        </li>
        <li class="s-sidebarwidget--item d-flex px16">
            <div class="flex--item1 fl-shrink0">
<div class="favicon favicon-stackexchangemeta" title="Meta Stack Exchange"></div>            </div>
            <div class="flex--item wmn0 ow-break-word">
                <a href="https://meta.stackexchange.com/questions/417109/all-users-on-stack-exchange-can-now-participate-in-chat" class="js-gps-track" data-ga="[&quot;community bulletin board&quot;,&quot;Featured on Meta&quot;,&quot;https://meta.stackexchange.com/questions/417109/all-users-on-stack-exchange-can-now-participate-in-chat&quot;,null,null]" data-gps-track="communitybulletin.click({ priority: 3, position: 3, location: questionpage })">All users on Stack Exchange can now participate in chat</a>
            </div>
        </li>
        <li class="s-sidebarwidget--item d-flex px16">
            <div class="flex--item1 fl-shrink0">
<div class="favicon favicon-stackoverflowmeta" title="Meta Stack Overflow"></div>            </div>
            <div class="flex--item wmn0 ow-break-word">
                <a href="https://meta.stackoverflow.com/questions/421831/policy-generative-ai-e-g-chatgpt-is-banned" class="js-gps-track" data-ga="[&quot;community bulletin board&quot;,&quot;Featured on Meta&quot;,&quot;https://meta.stackoverflow.com/questions/421831/policy-generative-ai-e-g-chatgpt-is-banned&quot;,null,null]" data-gps-track="communitybulletin.click({ priority: 6, position: 4, location: questionpage })">Policy: Generative AI (e.g., ChatGPT) is banned</a>
            </div>
        </li>
        </ul>
    </div>

<div class="js-zone-container zone-container-sidebar">
    <div id="dfp-tsb" class="everyonelovesstackoverflow everyoneloves__top-sidebar"></div>
		<div class="js-report-ad-button-container " style="width: 300px"></div>
</div>
<div class="js-zone-container zone-container-sidebar">
    <div id="dfp-msb" class="everyonelovesstackoverflow everyoneloves__mid-sidebar"></div>
		<div class="js-report-ad-button-container " style="width: 300px"></div>
</div>
<div id="hireme"></div>            
<div id="fragment-container-612-391" class="s-anchors mb24"></div><script defer src="https://stackoverflow.com/Content/Js/webpack-chunks/svelte.en.js?v=e94edf603d8c"></script><script defer src="https://stackoverflow.com/Content/Js/islands/fragment-proxy.en.js?v=fd7796282235"></script><script type="application/json" data-role="module-args" data-module-name="islands/fragment-proxy/index.mod">{"ContainerElementId":"fragment-container-612-391","FragmentAddress":"/stackheartbeat/heartbeat","TraceHeaders":[]}</script>

            <div class="module sidebar-linked">
	<h4 id="h-linked">Linked</h4>
	    <div class="linked" data-tracker="lq=1">
            <div class="spacer js-gps-track" data-gps-track="linkedquestion.click({ source_post_id: 11227809, target_question_id: 32063235, position: 0 })">
				<a href="/questions/32063235/is-in-sorted-array-not-faster-than-unsorted-array" title="Question score (upvotes - downvotes)">
					<div class="answer-votes answered-accepted default">63</div>
				</a>
				<a href="/questions/32063235/is-in-sorted-array-not-faster-than-unsorted-array?noredirect=1" class="question-hyperlink">Is &quot;==&quot; in sorted array not faster than unsorted array?</a>
			</div>
            <div class="spacer js-gps-track" data-gps-track="linkedquestion.click({ source_post_id: 11227809, target_question_id: 29259466, position: 1 })">
				<a href="/questions/29259466/complexity-of-comparison-operators" title="Question score (upvotes - downvotes)">
					<div class="answer-votes  default">22</div>
				</a>
				<a href="/questions/29259466/complexity-of-comparison-operators?noredirect=1" class="question-hyperlink">Complexity of comparison operators</a>
			</div>
            <div class="spacer js-gps-track" data-gps-track="linkedquestion.click({ source_post_id: 11227809, target_question_id: 58002047, position: 2 })">
				<a href="/questions/58002047/processing-an-array-of-overridden-methods-depends-if-it-is-arbitrary-or-in-alter" title="Question score (upvotes - downvotes)">
					<div class="answer-votes  default">6</div>
				</a>
				<a href="/questions/58002047/processing-an-array-of-overridden-methods-depends-if-it-is-arbitrary-or-in-alter?noredirect=1" class="question-hyperlink">Processing an array of overridden methods depends if it is arbitrary or in alternance</a>
			</div>
            <div class="spacer js-gps-track" data-gps-track="linkedquestion.click({ source_post_id: 11227809, target_question_id: 53794928, position: 3 })">
				<a href="/questions/53794928/when-will-dynamic-branch-prediction-be-useful" title="Question score (upvotes - downvotes)">
					<div class="answer-votes answered-accepted default">3</div>
				</a>
				<a href="/questions/53794928/when-will-dynamic-branch-prediction-be-useful?noredirect=1" class="question-hyperlink">When will dynamic branch prediction be useful?</a>
			</div>
            <div class="spacer js-gps-track" data-gps-track="linkedquestion.click({ source_post_id: 11227809, target_question_id: 62693256, position: 4 })">
				<a href="/questions/62693256/why-is-sorting-in-worst-case-is-taking-less-time-than-average-case" title="Question score (upvotes - downvotes)">
					<div class="answer-votes  default">5</div>
				</a>
				<a href="/questions/62693256/why-is-sorting-in-worst-case-is-taking-less-time-than-average-case?noredirect=1" class="question-hyperlink">Why is sorting in worst case is taking less time than average case</a>
			</div>
            <div class="spacer js-gps-track" data-gps-track="linkedquestion.click({ source_post_id: 11227809, target_question_id: 51223895, position: 5 })">
				<a href="/questions/51223895/sql-server-dynamic-columns-based-on-row-values-date" title="Question score (upvotes - downvotes)">
					<div class="answer-votes  default">-1</div>
				</a>
				<a href="/questions/51223895/sql-server-dynamic-columns-based-on-row-values-date?noredirect=1" class="question-hyperlink">SQL Server: dynamic columns based on row values (Date)</a>
			</div>
            <div class="spacer js-gps-track" data-gps-track="linkedquestion.click({ source_post_id: 11227809, target_question_id: 14415881, position: 6 })">
				<a href="/questions/14415881/how-can-i-pair-socks-from-a-pile-efficiently" title="Question score (upvotes - downvotes)">
					<div class="answer-votes answered-accepted extra-large">4210</div>
				</a>
				<a href="/questions/14415881/how-can-i-pair-socks-from-a-pile-efficiently?noredirect=1" class="question-hyperlink">How can I pair socks from a pile efficiently?</a>
			</div>
            <div class="spacer js-gps-track" data-gps-track="linkedquestion.click({ source_post_id: 11227809, target_question_id: 47981, position: 7 })">
				<a href="/questions/47981/how-to-set-clear-and-toggle-a-single-bit" title="Question score (upvotes - downvotes)">
					<div class="answer-votes answered-accepted extra-large">3175</div>
				</a>
				<a href="/questions/47981/how-to-set-clear-and-toggle-a-single-bit?noredirect=1" class="question-hyperlink">How to set, clear, and toggle a single bit</a>
			</div>
            <div class="spacer js-gps-track" data-gps-track="linkedquestion.click({ source_post_id: 11227809, target_question_id: 21947452, position: 8 })">
				<a href="/questions/21947452/why-is-printing-b-dramatically-slower-than-printing" title="Question score (upvotes - downvotes)">
					<div class="answer-votes answered-accepted extra-large">3006</div>
				</a>
				<a href="/questions/21947452/why-is-printing-b-dramatically-slower-than-printing?noredirect=1" class="question-hyperlink">Why is printing &quot;B&quot; dramatically slower than printing &quot;#&quot;?</a>
			</div>
            <div class="spacer js-gps-track" data-gps-track="linkedquestion.click({ source_post_id: 11227809, target_question_id: 7820683, position: 9 })">
				<a href="/questions/7820683/convert-boolean-result-into-number-integer" title="Question score (upvotes - downvotes)">
					<div class="answer-votes answered-accepted large">472</div>
				</a>
				<a href="/questions/7820683/convert-boolean-result-into-number-integer?noredirect=1" class="question-hyperlink">Convert boolean result into number/integer</a>
			</div>
		    <div class="spacer more ml32 pl16 pt8">
                <a href="/questions/linked/11227809">See more linked questions</a>
            </div>
	</div>
</div>

        


        <div class="module sidebar-related">
            <h4 id="h-related">Related</h4>
            <div class="related js-gps-related-questions" data-tracker="rq=3">
                    <div class="spacer" data-question-id="14023988">
                        <a href="/questions/14023988/why-is-processing-a-sorted-array-slower-than-an-unsorted-array" title="Question score (upvotes - downvotes)" >
                            <div class="answer-votes answered-accepted large">250</div>
                        </a>
                        <a href="/questions/14023988/why-is-processing-a-sorted-array-slower-than-an-unsorted-array" class="question-hyperlink">Why is processing a sorted array slower than an unsorted array?</a>
                    </div>
                    <div class="spacer" data-question-id="19989751">
                        <a href="/questions/19989751/why-is-my-heapsort-faster-than-javas-and-cs-sort-functions" title="Question score (upvotes - downvotes)" >
                            <div class="answer-votes default">0</div>
                        </a>
                        <a href="/questions/19989751/why-is-my-heapsort-faster-than-javas-and-cs-sort-functions" class="question-hyperlink">Why is my heapsort faster than Javas and C++s sort functions?</a>
                    </div>
                    <div class="spacer" data-question-id="23456752">
                        <a href="/questions/23456752/quicksort-slower-on-sorted-arrays" title="Question score (upvotes - downvotes)" >
                            <div class="answer-votes answered-accepted default">4</div>
                        </a>
                        <a href="/questions/23456752/quicksort-slower-on-sorted-arrays" class="question-hyperlink">Quicksort - slower on sorted arrays?</a>
                    </div>
                    <div class="spacer" data-question-id="28869451">
                        <a href="/questions/28869451/sorting-is-this-performance-difference-for-real-or-am-i-doing-something-wrong" title="Question score (upvotes - downvotes)" >
                            <div class="answer-votes answered-accepted default">4</div>
                        </a>
                        <a href="/questions/28869451/sorting-is-this-performance-difference-for-real-or-am-i-doing-something-wrong" class="question-hyperlink">Sorting : Is this performance difference for real or am I doing something wrong?</a>
                    </div>
                    <div class="spacer" data-question-id="35018999">
                        <a href="/questions/35018999/why-is-processing-a-sorted-array-slower-than-an-unsorted-array-javas-arrayl" title="Question score (upvotes - downvotes)" >
                            <div class="answer-votes answered-accepted default">85</div>
                        </a>
                        <a href="/questions/35018999/why-is-processing-a-sorted-array-slower-than-an-unsorted-array-javas-arrayl" class="question-hyperlink">Why is processing a sorted array *slower* than an unsorted array? (Java&#39;s ArrayList.indexOf)</a>
                    </div>
                    <div class="spacer" data-question-id="41441506">
                        <a href="/questions/41441506/why-is-my-java-merge-sort-faster-than-my-c-implementation" title="Question score (upvotes - downvotes)" >
                            <div class="answer-votes answered-accepted default">4</div>
                        </a>
                        <a href="/questions/41441506/why-is-my-java-merge-sort-faster-than-my-c-implementation" class="question-hyperlink">Why is my Java Merge-Sort faster than my C++ implementation?</a>
                    </div>
                    <div class="spacer" data-question-id="51415133">
                        <a href="/questions/51415133/why-is-arraylists-sort-method-faster-than-arrays-in-java" title="Question score (upvotes - downvotes)" >
                            <div class="answer-votes answered-accepted default">5</div>
                        </a>
                        <a href="/questions/51415133/why-is-arraylists-sort-method-faster-than-arrays-in-java" class="question-hyperlink">Why is ArrayList&#39;s sort method faster than Arrays&#39; in Java?</a>
                    </div>
                    <div class="spacer" data-question-id="61419699">
                        <a href="/questions/61419699/why-does-sorting-make-this-branchless-code-faster" title="Question score (upvotes - downvotes)" >
                            <div class="answer-votes default">6</div>
                        </a>
                        <a href="/questions/61419699/why-does-sorting-make-this-branchless-code-faster" class="question-hyperlink">Why does sorting make this branchless code faster?</a>
                    </div>
                    <div class="spacer" data-question-id="66521344">
                        <a href="/questions/66521344/why-is-processing-an-unsorted-array-the-same-speed-as-processing-a-sorted-array" title="Question score (upvotes - downvotes)" >
                            <div class="answer-votes answered-accepted large">191</div>
                        </a>
                        <a href="/questions/66521344/why-is-processing-an-unsorted-array-the-same-speed-as-processing-a-sorted-array" class="question-hyperlink">Why is processing an unsorted array the same speed as processing a sorted array with modern x86-64 clang?</a>
                    </div>
                    <div class="spacer" data-question-id="70500827">
                        <a href="/questions/70500827/runtime-of-sorting-algorithms-gets-faster-in-java" title="Question score (upvotes - downvotes)" >
                            <div class="answer-votes default">2</div>
                        </a>
                        <a href="/questions/70500827/runtime-of-sorting-algorithms-gets-faster-in-java" class="question-hyperlink">Runtime of Sorting-Algorithms gets faster (in Java)</a>
                    </div>
            </div>
        </div>
        <script type="text/javascript">
                 $(function() {
                     $(".js-gps-related-questions .spacer").on("click", function () {
                        fireRelatedEvent($(this).index() + 1, $(this).data('question-id'));
                     });

                 function fireRelatedEvent(position, questionId) {
                     StackExchange.using("gps", function() {
                         StackExchange.gps.track('related_questions.click',
                         {
                             position: position,
                             originQuestionId: 11227809,
                             relatedQuestionId: +questionId,
                             location: 'sidebar',
                             source: 'Baseline'
                         });    
                     });
                 }
             });
         </script>

<div id="hot-network-questions" class="module tex2jax_ignore">
    <h4>
        <a href="https://stackexchange.com/questions?tab=hot"
           class="js-gps-track s-link s-link__inherit" 
           data-gps-track="posts_hot_network.click({ item_type:1, location:11 })">
            Hot Network Questions
        </a>
    </h4>
    <ul>
            <li >
                <div class="favicon favicon-gaming" title="Arqade"></div><a href="https://gaming.stackexchange.com/questions/417867/what-are-the-visual-tells-of-wands" class="js-gps-track question-hyperlink mb0" data-gps-track="site.switch({ item_type:11, target_site:41 }); posts_hot_network.click({ item_type:2, location:11 })">
                    What are the visual tells of wands?
                </a>

            </li>
            <li >
                <div class="favicon favicon-cooking" title="Seasoned Advice"></div><a href="https://cooking.stackexchange.com/questions/136731/how-to-wash-produce-to-remove-pathogens-including-fecal-contamination" class="js-gps-track question-hyperlink mb0" data-gps-track="site.switch({ item_type:11, target_site:49 }); posts_hot_network.click({ item_type:2, location:11 })">
                    How to wash produce to remove pathogens (including fecal-contamination)
                </a>

            </li>
            <li >
                <div class="favicon favicon-aviation" title="Aviation Stack Exchange"></div><a href="https://aviation.stackexchange.com/questions/114970/does-the-airbus-really-lack-control-feel" class="js-gps-track question-hyperlink mb0" data-gps-track="site.switch({ item_type:11, target_site:528 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Does the Airbus really lack control feel?
                </a>

            </li>
            <li >
                <div class="favicon favicon-english" title="English Language &amp; Usage Stack Exchange"></div><a href="https://english.stackexchange.com/questions/639020/would-you-like-a-some-meat-is-using-a-an-exception-to-the-rule" class="js-gps-track question-hyperlink mb0" data-gps-track="site.switch({ item_type:11, target_site:97 }); posts_hot_network.click({ item_type:2, location:11 })">
                    &#x201D;Would you like a/some meat?&#x201C; Is using &quot;a&quot; an exception to the rule?
                </a>

            </li>
            <li >
                <div class="favicon favicon-judaism" title="Mi Yodeya"></div><a href="https://judaism.stackexchange.com/questions/155163/ptij-need-help-picking-a-topic-for-a-halacha-shiur" class="js-gps-track question-hyperlink mb0" data-gps-track="site.switch({ item_type:11, target_site:248 }); posts_hot_network.click({ item_type:2, location:11 })">
                    PTIJ: Need help picking a topic for a halacha shiur
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-worldbuilding" title="Worldbuilding Stack Exchange"></div><a href="https://worldbuilding.stackexchange.com/questions/272700/what-is-the-best-way-for-a-19th-century-equivalent-society-transport-high-amount" class="js-gps-track question-hyperlink mb0" data-gps-track="site.switch({ item_type:11, target_site:579 }); posts_hot_network.click({ item_type:2, location:11 })">
                    What is the best way for a 19th century equivalent society transport high amounts of fat on expeditions into large cave systems
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-money" title="Personal Finance &amp; Money Stack Exchange"></div><a href="https://money.stackexchange.com/questions/169282/can-i-recover-this-money" class="js-gps-track question-hyperlink mb0" data-gps-track="site.switch({ item_type:11, target_site:93 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Can I recover this money?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-math" title="Mathematics Stack Exchange"></div><a href="https://math.stackexchange.com/questions/5125063/what-is-the-name-of-this-polyhedron-formed-from-six-squares-and-eight-equilatera" class="js-gps-track question-hyperlink mb0" data-gps-track="site.switch({ item_type:11, target_site:69 }); posts_hot_network.click({ item_type:2, location:11 })">
                    What is the name of this polyhedron formed from six squares and eight equilateral triangles?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-music" title="Music: Practice &amp; Theory Stack Exchange"></div><a href="https://music.stackexchange.com/questions/143223/whats-the-best-explanation-that-e-is-not-the-same-as-f" class="js-gps-track question-hyperlink mb0" data-gps-track="site.switch({ item_type:11, target_site:240 }); posts_hot_network.click({ item_type:2, location:11 })">
                    What&#x27;s the best explanation that E# is not the same as F?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-judaism" title="Mi Yodeya"></div><a href="https://judaism.stackexchange.com/questions/155121/ptij-serving-with-oy" class="js-gps-track question-hyperlink mb0" data-gps-track="site.switch({ item_type:11, target_site:248 }); posts_hot_network.click({ item_type:2, location:11 })">
                    PTIJ: Serving With Oy
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-french" title="French Language Stack Exchange"></div><a href="https://french.stackexchange.com/questions/58695/how-do-different-prepositions-affect-meaning-when-adding-an-adjective-to-je-sui" class="js-gps-track question-hyperlink mb0" data-gps-track="site.switch({ item_type:11, target_site:299 }); posts_hot_network.click({ item_type:2, location:11 })">
                    How do different prepositions affect meaning when adding an adjective to &quot;Je suis venu en voiture&quot;?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-unix" title="Unix &amp; Linux Stack Exchange"></div><a href="https://unix.stackexchange.com/questions/804528/apt-remove-does-not-fail-upon-removing-a-package-that-is-a-dependency-of-another" class="js-gps-track question-hyperlink mb0" data-gps-track="site.switch({ item_type:11, target_site:106 }); posts_hot_network.click({ item_type:2, location:11 })">
                    apt remove does not fail upon removing a package that is a dependency of another
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-stackoverflow" title="Stack Overflow"></div><a href="https://stackoverflow.com/questions/79890659/python-cast-byte-array-to-c-void-pointer" class="js-gps-track question-hyperlink mb0" data-gps-track="site.switch({ item_type:11, target_site:1 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Python cast byte array to C void pointer
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-rpg" title="Role-playing Games Stack Exchange"></div><a href="https://rpg.stackexchange.com/questions/218800/does-the-recuperating-downtime-activity-remove-max-hp-reduction" class="js-gps-track question-hyperlink mb0" data-gps-track="site.switch({ item_type:11, target_site:122 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Does the &quot;Recuperating&quot; downtime activity remove max HP reduction?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-superuser" title="Super User"></div><a href="https://superuser.com/questions/1935006/is-there-a-way-that-some-devices-can-share-in-local-network-but-not-going-online" class="js-gps-track question-hyperlink mb0" data-gps-track="site.switch({ item_type:11, target_site:3 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Is there a way that some devices can share in local network but not going online?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-math" title="Mathematics Stack Exchange"></div><a href="https://math.stackexchange.com/questions/5125043/prove-this-integral-transform-identity-involving-a-rational-kernel" class="js-gps-track question-hyperlink mb0" data-gps-track="site.switch({ item_type:11, target_site:69 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Prove this integral transform identity involving a rational kernel
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-mathoverflow" title="MathOverflow"></div><a href="https://mathoverflow.net/questions/508141/some-books-recommendation-by-which-i-can-know-about-whats-happening-in-current" class="js-gps-track question-hyperlink mb0" data-gps-track="site.switch({ item_type:11, target_site:504 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Some books recommendation by which I can know about what&#x27;s happening in current mathematics research in Pure mathematics?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-electronics" title="Electrical Engineering Stack Exchange"></div><a href="https://electronics.stackexchange.com/questions/765927/identify-this-ics-manufacturer-logo-with-stylised-m" class="js-gps-track question-hyperlink mb0" data-gps-track="site.switch({ item_type:11, target_site:135 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Identify this IC&#x27;s manufacturer logo with stylised &#x27;m&#x27;
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-gis" title="Geographic Information Systems Stack Exchange"></div><a href="https://gis.stackexchange.com/questions/499999/select-clients-where-they-have-one-feature-type-but-not-another-arcgis-pro" class="js-gps-track question-hyperlink mb0" data-gps-track="site.switch({ item_type:11, target_site:79 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Select clients where they have one feature type but not another - ArcGIS Pro
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-law" title="Law Stack Exchange"></div><a href="https://law.stackexchange.com/questions/114174/what-circumstances-could-make-kidnapping-and-murder-of-nancy-guthrie-a-federal-c" class="js-gps-track question-hyperlink mb0" data-gps-track="site.switch({ item_type:11, target_site:617 }); posts_hot_network.click({ item_type:2, location:11 })">
                    What circumstances could make kidnapping and murder of Nancy Guthrie a federal crime?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-politics" title="Politics Stack Exchange"></div><a href="https://politics.stackexchange.com/questions/94245/what-becomes-of-seized-tankers-and-their-oil-cargo" class="js-gps-track question-hyperlink mb0" data-gps-track="site.switch({ item_type:11, target_site:475 }); posts_hot_network.click({ item_type:2, location:11 })">
                    What becomes of seized tankers and their oil cargo?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-diy" title="Home Improvement Stack Exchange"></div><a href="https://diy.stackexchange.com/questions/329281/bathroom-fan-grounding-with-bx-and-metal-framing" class="js-gps-track question-hyperlink mb0" data-gps-track="site.switch({ item_type:11, target_site:73 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Bathroom fan grounding with BX and metal framing
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-math" title="Mathematics Stack Exchange"></div><a href="https://math.stackexchange.com/questions/5125017/question-14-from-section-3-6-of-topology-and-groupoids" class="js-gps-track question-hyperlink mb0" data-gps-track="site.switch({ item_type:11, target_site:69 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Question 14 from section 3.6 of Topology And Groupoids
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-chess" title="Chess Stack Exchange"></div><a href="https://chess.stackexchange.com/questions/47657/sicilian-defense-yates-variation-straight-up-hangs-a-piece" class="js-gps-track question-hyperlink mb0" data-gps-track="site.switch({ item_type:11, target_site:435 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Sicilian Defense Yates Variation straight up hangs a piece
                </a>

            </li>
    </ul>

        <a href="#" 
           class="show-more js-show-more js-gps-track" 
           data-gps-track="posts_hot_network.click({ item_type:3, location:11 })">
            more hot questions
        </a>
</div>                    <div id="feed-link" class="js-feed-link">
        <a href="/feeds/question/11227809" title="Feed of this question and its answers">
            <svg aria-hidden="true" class="fc-orange-400 svg-icon iconRss" width="18" height="18"  viewBox="0 0 18 18"><path  d="M3 1a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2zm0 1.5c6.9 0 12.5 5.6 12.5 12.5H13C13 9.55 8.45 5 3 5zm0 5c4.09 0 7.5 3.41 7.5 7.5H8c0-2.72-2.28-5-5-5zm0 5c1.36 0 2.5 1.14 2.5 2.5H3z"/></svg>
            Question feed
        </a>
    </div>
    <aside class="s-modal js-feed-link-modal" tabindex="-1" role="dialog" aria-labelledby="feed-modal-title" aria-describedby="feed-modal-description" aria-hidden="true">
        <div class="s-modal--dialog js-modal-dialog wmx4" role="document"  data-controller="se-draggable">
            <h1 class="s-modal--header fw-bold js-first-tabbable" id="feed-modal-title" data-se-draggable-target="handle" tabindex="0">
                Subscribe to RSS
            </h1>
            <div class="d-flex gs4 gsy fd-column">
                <div class="flex--item">
                    <label class="d-block s-label c-default" for="feed-url">
                        Question feed
                        <p class="s-description mt2" id="feed-modal-description">To subscribe to this RSS feed, copy and paste this URL into your RSS reader.</p>
                    </label>
                </div>
                <div class="d-flex ps-relative">
                    <input class="s-input" type="text" name="feed-url" id="feed-url" readonly="readonly" value="https://stackoverflow.com/feeds/question/11227809" />
                    <svg aria-hidden="true" class="s-input-icon fc-orange-400 svg-icon iconRss" width="18" height="18"  viewBox="0 0 18 18"><path  d="M3 1a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2zm0 1.5c6.9 0 12.5 5.6 12.5 12.5H13C13 9.55 8.45 5 3 5zm0 5c4.09 0 7.5 3.41 7.5 7.5H8c0-2.72-2.28-5-5-5zm0 5c1.36 0 2.5 1.14 2.5 2.5H3z"/></svg>
                </div>
            </div>
            <a class="s-modal--close s-btn s-btn__muted js-modal-close js-last-tabbable" href="#" aria-label="Close">
                <svg aria-hidden="true" class="svg-icon iconClearSm" width="14" height="14"  viewBox="0 0 14 14"><path  d="M12 3.41 10.59 2 7 5.59 3.41 2 2 3.41 5.59 7 2 10.59 3.41 12 7 8.41 10.59 12 12 10.59 8.41 7z"/></svg>
            </a>
        </div>
    </aside>

</div>

    </div>

<script>StackExchange.ready(function(){$.get('/posts/11227809/ivc/9596?prg=a5c0c20a-152f-4e07-aa1c-0737a188328f');});</script>
<noscript><div><img src="/posts/11227809/ivc/9596?prg=a5c0c20a-152f-4e07-aa1c-0737a188328f" class="dno" alt="" width="0" height="0"></div></noscript><div style="display:none" id="js-codeblock-lang">default</div>
    <div id="js-follow-ups-flag-modal"></div>
    <div id="js-follow-ups-mention"></div>
</div>




<script defer src="https://stackoverflow.com/Content/Js/questions/show.en.js?v=d15b41efd982"></script>
<script type="application/json" data-role="module-args" data-module-name="entry-points/questions/show.mod">{"doMarkObsolete":false,"doTimeOnPage":false,"sendAnswerEditorEventsToAEH":true,"sendAnswerEditorEventsToPrizm":true,"questionId":11227809,"sendAuthQuestionVisitToAEH":false,"sendAuthQuestionVisitToPrizm":false,"answerCount":26,"followUpsUIExperimentGroup":"excluded","tags":["java","c++","performance","cpu-architecture","branch-prediction"]}</script>




<script defer src="https://stackoverflow.com/Content/Js/webpack-chunks/svelte.en.js?v=e94edf603d8c"></script><script defer src="https://stackoverflow.com/Content/Js/webpack-chunks/stacks-svelte.en.js?v=fdea6766026e"></script><script defer src="https://stackoverflow.com/Content/Js/webpack-chunks/stacks-svelte-labs.en.js?v=68ceaee5e6e4"></script><script defer src="https://stackoverflow.com/Content/Js/webpack-chunks/1130.en.js?v=8bb363934465"></script><script defer src="https://stackoverflow.com/Content/Js/webpack-chunks/89.en.js?v=30b0d7500f94"></script><script defer src="https://stackoverflow.com/Content/Js/webpack-chunks/316.en.js?v=2109fa72f6e3"></script><script defer src="https://stackoverflow.com/Content/Js/webpack-chunks/6122.en.js?v=d80cfb92f185"></script><script defer src="https://stackoverflow.com/Content/Js/webpack-chunks/8167.en.js?v=d157e568935a"></script><script defer src="https://stackoverflow.com/Content/Js/webpack-chunks/5886.en.js?v=069356cc6708"></script><script defer src="https://stackoverflow.com/Content/Js/islands/follow-ups.en.js?v=d19df611665e"></script>

<script defer src="https://stackoverflow.com/Content/Js/webpack-chunks/svelte.en.js?v=e94edf603d8c"></script><script defer src="https://stackoverflow.com/Content/Js/webpack-chunks/stacks-svelte.en.js?v=fdea6766026e"></script><script defer src="https://stackoverflow.com/Content/Js/islands/follow-ups-flag-modal.en.js?v=46926568a212"></script>
<script type="application/json" data-role="module-args" data-module-name="islands/follow-ups-flag-modal/index.mod">{"ContainerElementId":"js-follow-ups-flag-modal","FKey":"d09ecbbe5140a7c1439a7e4020cdd7d76b52d28795a889bb24233842877804f3","ShowSpamFlag":true,"MergeUnfriendlyAndRudeFlags":true,"EnableCodeOfConduct":true}</script>


<div id="js-follow-ups-experiment-group" data-value="test" class="d-none" data-site-url=""></div>



<div id="redirect-action-modal-container"></div>
<script type="application/json" data-role="module-args" data-module-name="islands/redirect-action-modal/index.mod">{"ContainerElementId":"redirect-action-modal-container","FKey":"d09ecbbe5140a7c1439a7e4020cdd7d76b52d28795a889bb24233842877804f3","UpvoteHeaderImageUrl":"https://stackoverflow.com/Content/Img/modal/img-upvote.png?v=fce73bd9724d","DownvoteHeaderImageUrl":"https://stackoverflow.com/Content/Img/modal/img-downvote.png?v=d15b4e291f8c","EnableUpvoteModal":true,"SuggestEditAvailable":true,"PostTagNames":["java","c++","performance","cpu-architecture","branch-prediction"],"EnableFreeVotesModal":false,"FreeVotesHeaderImageUrl":"https://stackoverflow.com/Content/Img/modal/img-free-votes.png?v=1c5aa3dac50b","FreeVotesEarnReputationHelpCenterUrl":"https://stackoverflow.com/help/whats-reputation","FreeVotesLearnMoreHelpCenterUrl":"https://stackoverflow.com/help/whats-free-votes","HasUpvotePrivilege":false,"EnableDownVoteRepRequiredRedirectActionPopover":true,"AnswerDownVoteRepChange":1}</script>
<script defer src="https://stackoverflow.com/Content/Js/webpack-chunks/svelte.en.js?v=e94edf603d8c"></script><script defer src="https://stackoverflow.com/Content/Js/webpack-chunks/stacks-svelte.en.js?v=fdea6766026e"></script><script defer src="https://stackoverflow.com/Content/Js/islands/redirect-action-modal.en.js?v=9d264bb3bb1c"></script>

        </div>
    </div>

    

        
    <footer id="footer" class="site-footer js-footer theme-light__forced" role="contentinfo">
        <div class="site-footer--container">
                <div class="site-footer--logo">

                    <a href="https://stackoverflow.com" aria-label="Stack Overflow"><svg aria-hidden="true" class="native svg-icon iconGlyphMd" width="32" height="37"  viewBox="0 0 32 37"><path fill="#BCBBBB" d="M26 33v-9h4v13H0V24h4v9z"/><path fill="#F48024" d="m21.5 0-2.7 2 9.9 13.3 2.7-2zM26 18.4 13.3 7.8l2.1-2.5 12.7 10.6zM9.1 15.2l15 7 1.4-3-15-7zm14 10.79.68-2.95-16.1-3.35L7 23zM23 30H7v-3h16z"/></svg></a>
                </div>
            <nav class="site-footer--nav" aria-label="Footer">
                    <div class="site-footer--col">
                        <h5 class="-title"><a href="https://stackoverflow.com" class="js-gps-track" data-gps-track="footer.click({ location: 2, link: 15})">Stack Overflow</a></h5>
                        <ul class="-list js-primary-footer-links">
                            <li><a href="/questions" class="js-gps-track -link" data-gps-track="footer.click({ location: 2, link: 16})">Questions</a></li>
                                <li><a href="/help" class="js-gps-track -link" data-gps-track="footer.click({ location: 2, link: 3 })">Help</a></li>
                                <li><a class="js-gps-track -link" data-gps-track="footer.click({ location: 2, link: 5 })" href="https://chat.stackoverflow.com/?tab=explore">Chat</a></li>
                        </ul>
                    </div>
                    <div class="site-footer--col">
                        <h5 class="-title"><a href="https://stackoverflow.co/" class="js-gps-track" data-gps-track="footer.click({ location: 2, link: 19 })">Business</a></h5>
                        <ul class="-list">
                            <li><a href="https://stackoverflow.co/internal/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=footer&utm_content=teams" class="js-gps-track -link" data-ga="[&quot;teams traffic&quot;,&quot;footer - site nav&quot;,&quot;stackoverflow.com/teams&quot;,null,{&quot;dimension4&quot;:&quot;teams&quot;}]" data-gps-track="footer.click({ location: 2, link: 29 })">Stack Internal</a></li>
                            <li><a href="https://stackoverflow.co/data-licensing/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=footer&utm_content=data-licensing" class="js-gps-track -link" data-gps-track="footer.click({ location: 2, link: 44 })">Stack Data Licensing</a></li>
                            <li><a href="https://stackoverflow.co/advertising/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=footer&utm_content=advertising" class="js-gps-track -link" data-gps-track="footer.click({ location: 2, link: 21 })">Stack Ads</a></li>
                        </ul>
                    </div>
                <div class="site-footer--col">
                    <h5 class="-title"><a class="js-gps-track" data-gps-track="footer.click({ location: 2, link: 1 })" href="https://stackoverflow.co/">Company</a></h5>
                    <ul class="-list">
                            <li><a class="js-gps-track -link" data-gps-track="footer.click({ location: 2, link: 1 })" href="https://stackoverflow.co/">About</a></li>
                        <li><a class="js-gps-track -link" data-gps-track="footer.click({ location: 2, link: 27 })" href="https://stackoverflow.co/company/press/">Press</a></li>
                            <li><a class="js-gps-track -link" data-gps-track="footer.click({ location: 2, link: 9 })" href="https://stackoverflow.co/company/work-here/">Work Here</a></li>
                        <li><a class="js-gps-track -link" data-gps-track="footer.click({ location: 2, link: 7 })" href="https://stackoverflow.com/legal">Legal</a></li>
                        <li><a class="js-gps-track -link" data-gps-track="footer.click({ location: 2, link: 8 })" href="https://stackoverflow.com/legal/privacy-policy">Privacy Policy</a></li>
                        <li><a class="js-gps-track -link" data-gps-track="footer.click({ location: 2, link: 37 })" href="https://stackoverflow.com/legal/terms-of-service/public">Terms of Service</a></li>
                            <li><a class="js-gps-track -link" data-gps-track="footer.click({ location: 2, link: 13 })" href="/contact">Contact Us</a></li>
        <li id="consent-footer-link"><button type="button" data-controller="cookie-settings" data-action="click->cookie-settings#toggle" class="s-btn s-btn__link py4 js-gps-track -link" data-gps-track="footer.click({ location: 2, link: 38 })" data-consent-popup-loader="footer">
Cookie Settings        </button></li>
                        <li><a class="js-gps-track -link" data-gps-track="footer.click({ location: 2, link: 39 })" href="https://policies.stackoverflow.co/stack-overflow/cookie-policy">Cookie Policy</a></li>
                    </ul>
                </div>
                <div class="site-footer--col site-footer--categories-nav">
                    <div>
                        <h5 class="-title"><a href="https://stackexchange.com" data-gps-track="footer.click({ location: 2, link: 30 })">Stack Exchange Network</a></h5>
                        <ul class="-list">
                            <li>
                                <a href="https://stackexchange.com/sites#technology" class="-link js-gps-track" data-gps-track="footer.click({ location: 2, link: 24 })">
                                    Technology
                                </a>
                            </li>
                            <li>
                                <a href="https://stackexchange.com/sites#culturerecreation" class="-link js-gps-track" data-gps-track="footer.click({ location: 2, link: 24 })">
                                    Culture &amp; recreation
                                </a>
                            </li>
                            <li>
                                <a href="https://stackexchange.com/sites#lifearts" class="-link js-gps-track" data-gps-track="footer.click({ location: 2, link: 24 })">
                                    Life &amp; arts
                                </a>
                            </li>
                            <li>
                                <a href="https://stackexchange.com/sites#science" class="-link js-gps-track" data-gps-track="footer.click({ location: 2, link: 24 })">
                                    Science
                                </a>
                            </li>
                            <li>
                                <a href="https://stackexchange.com/sites#professional" class="-link js-gps-track" data-gps-track="footer.click({ location: 2, link: 24 })">
                                    Professional
                                </a>
                            </li>
                            <li>
                                <a href="https://stackexchange.com/sites#business" class="-link js-gps-track" data-gps-track="footer.click({ location: 2, link: 24 })">
                                    Business
                                </a>
                            </li>

                            <li class="mt16 md:mt0">
                                <a href="https://api.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 2, link: 24 })">
                                    API
                                </a>
                            </li>

                            <li>
                                <a href="https://data.stackexchange.com/" class="-link js-gps-track" data-gps-track="footer.click({ location: 2, link: 24 })">
                                    Data
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>
            <div class="site-footer--copyright fs-fine md:mt24">
                <ul class="-list -social md:mb8">
                    <li><a class="js-gps-track -link" data-gps-track="footer.click({ location: 2, link:4 })" href="https://stackoverflow.blog?blb=1">Blog</a></li>
                    <li><a href="https://www.facebook.com/officialstackoverflow/" class="-link js-gps-track" data-gps-track="footer.click({ location: 2, link: 31 })">Facebook</a></li>
                    <li><a href="https://twitter.com/stackoverflow" class="-link js-gps-track" data-gps-track="footer.click({ location: 2, link: 32 })">Twitter</a></li>
                    <li><a href="https://linkedin.com/company/stack-overflow" class="-link js-gps-track" data-gps-track="footer.click({ location: 2, link: 33 })">LinkedIn</a></li>
                    <li><a href="https://www.instagram.com/thestackoverflow" class="-link js-gps-track" data-gps-track="footer.click({ location: 2, link: 36 })">Instagram</a></li>
                </ul>

                <p class="md:mb0">
                    <span>Site design / logo  2026 Stack Exchange Inc; </span>
                    <span>user contributions licensed under </span>
                    <a class="-link s-link td-underline" href="https://stackoverflow.com/help/licensing">CC BY-SA</a>
                    <span>. </span>
                    <span id="svnrev">rev&nbsp;2026.2.13.39790</span>
                </p>
            </div>
        </div>

    </footer>


    



    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }

        gtag('consent', 'default', {
            'ad_storage': 'denied',
            'analytics_storage': 'denied',
            'ad_user_data': 'denied',
            'ad_personalization': 'denied'
        });
    </script>
            <!-- Google tag (gtag.js) -->
            <script async src="https://www.googletagmanager.com/gtag/js?id=G-WCZ03SZFCQ"></script>
            <script>
                window.dataLayer = window.dataLayer || [];
                function gtag() { dataLayer.push(arguments); }
            </script>
        <script>
            StackExchange.ready(function() {
                var customGA4Dimensions = {};


                customGA4Dimensions["requestid"] = "a5c0c20a-152f-4e07-aa1c-0737a188328f";

                    customGA4Dimensions["routename"] = "Questions/Show";


                    customGA4Dimensions["post_id"] = "11227809";


                    customGA4Dimensions["tags"] = "|java|c&#x2B;&#x2B;|performance|cpu-architecture|branch-prediction|";


                var ga4Settings = {
                    tracker: gtag,
                    trackingCodes: [
                        'G-WCZ03SZFCQ'
                    ],
                    consentsToPerformanceCookies: "denied",
                    consentsToTargetingCookies: "denied",
                    eventParameters: customGA4Dimensions,
                    checkForAdBlock: true,
                    sendTitles: true,
                    trackClicks: false,
                };

                StackExchange.ga.init({ GA4: ga4Settings });
            });
        </script>

            <script src="https://cdn.cookielaw.org/scripttemplates/gpp.stub.js"></script>
    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" charset="UTF-8" data-document-language="true" data-domain-script="c3d9f1e3-55f3-4eba-b268-46cee4c6789c"></script>
<script defer src="https://stackoverflow.com/Content/Js/sprinkles/cookie-consent.en.js?v=7ee6963139c5"></script>

    
    <script type="text/javascript">
    var cam = cam || { opt: {} };
    var clcGamLoaderOptions = cam || { opt: {} };
    var opt = clcGamLoaderOptions.opt;

    opt.omni = 'BwoLCPin-6jLwvc-EAUYoaWtBSACKAI6OXxqYXZhfGMrK3xwZXJmb3JtYW5jZXxjcHUtYXJjaGl0ZWN0dXJlfGJyYW5jaC1wcmVkaWN0aW9ufEgAO7DTC2Ws_7_CMA';
    opt.refresh = !1;
    opt.refreshInterval = 30;
    opt.sf = !0;
    opt.hb = !1;
    opt.ll = !0;
    opt.tlb_position = 0;

    opt.personalization_consent = false;
    opt.targeting_consent_set = false;
    opt.performance_consent_set = false;
    opt.targeting_consent = false;
    opt.performance_consent = false;

    opt.targeting = {Registered:['false'],Reputation:['new'],'so-tag':['java','c_plus_plus','performance','cpu-architecture','branch-prediction'],'tag-reportable':['java','c_plus_plus','performance','cpu-architecture','branch-prediction'],NumberOfAnswers:['20-plus'],cf_bot_score:'2 - 29'};
    opt.acceptableAdsEnabled = !0;
    opt.adReportEnabled = !0;
    opt.adReportUrl = '/ads/report-ad';
    opt.adReportText = 'Report this ad';
	opt.adReportFileTypeErrorMessage = 'Please select a PNG or JPG file.';
    opt.adReportFileSizeErrorMessage = 'The file must be under 2 MiB.';
	opt.adReportErrorText = 'Error uploading ad report.';
	opt.adReportThanksText = 'Thanks for your feedback. Well review this against our code of conduct and take action if necessary.';
    opt.adReportLoginExpiredMessage = 'Your login session has expired, please login and try again.';
    opt.adReportLoginErrorMessage = 'An error occurred when loading the report form - please try again';
	opt.adReportModalClass = 'js-ad-report';
    opt.countryCode = 'JP';
    opt.qualtricsSurveyData = '{"isRegistered":"False","repBucket":"new","referrer":"https%3a%2f%2fstackoverflow.com%2fquestions%2f11227809%2fwhy-is-processing-a-sorted-array-faster-than-processing-an-unsorted-array","accountAge":"0"}';

    opt.perRequestGuid = 'a5c0c20a-152f-4e07-aa1c-0737a188328f';
    opt.responseHash = '74htAobWXMI1EUZtCHIyEpgsqYq/0H2YPKopyN&#x2B;1GFQ=';


    opt.targeting.TargetingConsent = ['False_Passive'];
    opt.allowAccountTargetingForThisRequest = !1;

    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.has('dfptestads')) {
        const dfptestads = urlParams.get('dfptestads');
        opt.targeting.DfpTestAds = dfptestads;
    }

</script>
<script>;(()=>{"use strict";var __webpack_modules__={23:(e,t,s)=>{s.d(t,{Z7:()=>g,eq:()=>l,kG:()=>d,z0:()=>c});const n="248424177",r=(o=location.pathname,/^\/tags\//.test(o)||/^\/questions\/tagged\//.test(o)?"tag-pages":/^\/discussions\//.test(o)||/^\/beta\/discussions/.test(o)?"discussions":/^\/$/.test(o)||/^\/home/.test(o)?"home-page":/^\/ai-assist/.test(o)?"ai-assist":/^\/jobs$/.test(o)||/^\/jobs\//.test(o)?"jobs":"question-pages");var o;let a=location.hostname;const i={slots:{lb:[[728,90]],mlb:[[728,90]],smlb:[[728,90]],bmlb:[[728,90]],sb:e=>"dfp-tsb"===e?[[300,250],[300,600]]:[[300,250]],"tag-sponsorship":[[730,135]],"mobile-below-question":[[320,50],[300,250]],msb:[[300,250],[300,600]],"talent-conversion-tracking":[[1,1]],"site-sponsorship":[[230,60]],"native-question":["fluid"]},ids:{"dfp-tlb":"lb","dfp-mlb":"mlb","dfp-smlb":"smlb","dfp-bmlb":"bmlb","dfp-tsb":"sb","dfp-isb":"sb","dfp-tag":"tag-sponsorship","dfp-msb":"msb","dfp-sspon":"site-sponsorship","dfp-nativequestion-*":"native-question","dfp-m-aq":"mobile-below-question"},idsToExcludeFromAdReports:["dfp-sspon"]};function d(){return Object.keys(i.ids)}function l(e){return i.idsToExcludeFromAdReports.indexOf(e)<0}function c(e){return e.indexOf("/native-question/")>=0}function g(e,t){var s=e.split("_")[0],o=i.ids[s];if(!o)for(var d=Object.keys(i.ids),l=0;l<d.length;l++)if(d[l].indexOf("*")>=0){var c=d[l].substring(0,d[l].length-1);s.indexOf(c)>=0&&(o=i.ids[d[l]])}let g=i.slots[o];"function"==typeof g&&(g=g(s));var p=t||a;return"beta.stackoverflow.com"===p&&(p="stackoverflow.com"),{path:`/${n}/${p}/${o}/${r}`,sizes:g,zone:o}}},865:(e,t,s)=>{function n(e){return"string"==typeof e?document.getElementById(e):e}function r(e){return!!(e=n(e))&&"none"===getComputedStyle(e).display}function o(e){return!r(e)}function a(e){return!!e}function i(e){return/^\s*$/.test(n(e).innerHTML)}function d(e){const{style:t}=e;t.height=t.maxHeight=t.minHeight="auto",t.display="none",[].forEach.call(e.children,d)}function l(e){const t=document.createElement("script");t.src=e,document.body.appendChild(t)}function c(e){return s=e,(t=[]).push=function(e){return s(),delete this.push,this.push(e)},t;var t,s}function g(e){let t="function"==typeof HTMLTemplateElement;var s=document.createElement(t?"template":"div");return e=e.trim(),s.innerHTML=e,t?s.content.firstChild:s.firstChild}s.d(t,{Bv:()=>g,Gx:()=>l,Nj:()=>n,QZ:()=>c,pn:()=>o,wo:()=>d,xb:()=>i,xj:()=>r,yb:()=>a})},147:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{t:()=>AdReports});var _common_helper__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(865),_console__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(406),_ad_units__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(23);window.googletag=window.googletag||{cmd:[]};class AdReports{constructor(e){this.cam=e,this.allowedFileTypes=["image/png","image/jpg","image/jpeg"],this.ignoreValidation=!1,_console__WEBPACK_IMPORTED_MODULE_1__.cM("Ad reporting init"),googletag.cmd.push(()=>{if(this.cam=e,this.callOnButtonClick=e=>this.onButtonClick(e),googletag.pubads().addEventListener("slotRenderEnded",e=>this.handleSlotRendered(e)),Array.isArray(e.slotsRenderedEvents)){_console__WEBPACK_IMPORTED_MODULE_1__.cM("Adding report button to "+e.slotsRenderedEvents.length+" events that have transpired");for(var t=0;t<e.slotsRenderedEvents.length;t++)this.handleSlotRendered(e.slotsRenderedEvents[t])}})}handleSlotRendered(e){if(e&&e.slot&&!e.isEmpty&&(e.creativeId||e.lineItemId||!e.isEmpty)){var t=e.slot.getSlotElementId(),s=e.slot.getAdUnitPath();if(t){var n=document.getElementById(t);if(n)if((0,_ad_units__WEBPACK_IMPORTED_MODULE_0__.eq)(t)){var r=n?.closest(".js-zone-container"),o=n?.closest(".js-zone-container")?.querySelector(".js-report-ad-button-container");o?(o.innerHTML="",o.append(this.createButton(e)),o.style.height="24px",_console__WEBPACK_IMPORTED_MODULE_1__.cM("Added report button to the bottom of "+t)):_console__WEBPACK_IMPORTED_MODULE_1__.cM("Ad report button not found, may be intentional, element: "+t),r&&(0,_ad_units__WEBPACK_IMPORTED_MODULE_0__.z0)(s)&&(r.classList.add("bb"),r.classList.add("mt24"))}else _console__WEBPACK_IMPORTED_MODULE_1__.cM("Not adding report button to the bottom of "+t+": shouldHaveReportButton = false");else _console__WEBPACK_IMPORTED_MODULE_1__.cM("Not adding report button to the bottom of "+t+": resolved invalid adUnit element")}else _console__WEBPACK_IMPORTED_MODULE_1__.cM("Not adding report button to the bottom of element: invalid adUnitElementId")}else _console__WEBPACK_IMPORTED_MODULE_1__.cM("Not adding report button to the bottom of element: invalid SlotRenderEndedEvent")}async onButtonClick(e){e.preventDefault();let t=e.target;const s=t.dataset.modalUrl,n=t.dataset.googleEventData;return await this.loadModal(s,t,n),!1}createButton(e){let t=document.createElement("button");var s=JSON.stringify(e);return t.dataset.googleEventData=s,t.dataset.modalUrl=this.cam.opt.adReportUrl,t.dataset.adUnit=e.slot.getSlotElementId(),t.classList.add("js-report-ad","s-btn","s-btn__link","fs-fine","mt2","float-right"),t.append(document.createTextNode(this.cam.opt.adReportText)),t.removeEventListener("click",this.callOnButtonClick),t.addEventListener("click",this.callOnButtonClick),t}async loadModal(url,$link,googleEventData){try{await window.StackExchange.helpers.loadModal(url,{returnElements:window.$($link)}),this.initForm(googleEventData)}catch(e){var message="",response=e.responseText?eval(`(${e.responseText})`):null;message=response&&response.isLoggedOut?this.cam.opt.adReportLoginExpiredMessage:this.cam.opt.adReportLoginErrorMessage,window.StackExchange.helpers.showToast(message,{type:"danger"})}}removeModal(){window.StackExchange.helpers.closePopups(document.querySelectorAll("."+this.cam.opt.adReportModalClass),"dismiss")}initForm(e,t=!1){this.ignoreValidation=t,this.$form=document.querySelector(".js-ad-report-form"),this.$googleEventData=this.$form.querySelector(".js-json-data"),this.$adReportReasons=this.$form.querySelectorAll(".js-ad-report-reason"),this.$adReportReasonOther=this.$form.querySelector(".js-ad-report-reason-other"),this.$fileUploaderInput=this.$form.querySelector(".js-file-uploader-input"),this.$imageUploader=this.$form.querySelector(".js-image-uploader"),this.$clearImageUpload=this.$form.querySelector(".js-clear-image-upload"),this.$imageUploaderText=this.$form.querySelector(".js-image-uploader-text"),this.$imageUploaderPreview=this.$form.querySelector(".js-image-uploader-preview"),this.$fileErrorMessage=this.$form.querySelector(".js-file-error");const s=this.$form.querySelector(".js-drag-drop-enabled"),n=this.$form.querySelector(".js-drag-drop-disabled");this.$googleEventData.value=e,this.$adReportReasons.forEach((e,t)=>e.addEventListener("change",e=>{this.$adReportReasonOther.classList.toggle("d-none","3"!==e.target.value)})),this.$fileUploaderInput.addEventListener("change",()=>{this.validateFileInput()&&this.updateImagePreview(this.$fileUploaderInput.files)}),this.$clearImageUpload.addEventListener("click",e=>{e.preventDefault(),this.clearImageUpload()});try{this.$fileUploaderInput[0].value="",this.$imageUploader.addEventListener("dragenter dragover dragleave drop",this.preventDefaults),this.$imageUploader.addEventListener("dragenter dragover",this.handleDragStart),this.$imageUploader.addEventListener("dragleave drop",this.handleDragEnd),this.$imageUploader.addEventListener("drop",this.handleDrop)}catch(e){s.classList.add("d-none"),n.classList.remove("d-none")}this.$form.removeEventListener("",this.handleDragEnd),this.$form.addEventListener("submit",async e=>(e.preventDefault(),this.submitForm(),!1))}clearImageUpload(){this.$fileUploaderInput.value="",this.$imageUploaderPreview.setAttribute("src",""),this.$imageUploaderPreview.classList.add("d-none"),this.$clearImageUpload.classList.add("d-none"),this.$imageUploaderText.classList.remove("d-none"),this.$imageUploader.classList.add("p16","ba","bas-dashed","bc-black-100")}preventDefaults(e){e.preventDefault(),e.stopPropagation()}handleDragStart(e){this.$imageUploader.classList.remove("bas-dashed"),this.$imageUploader.classList.add("bas-solid","bc-black-100")}handleDragEnd(e){this.$imageUploader.classList.remove("bas-solid","bc-black-100"),this.$imageUploader.classList.add("bas-dashed")}handleDrop(e){var t=e.originalEvent.dataTransfer.files;FileReader&&t&&1===t.length&&(this.$fileUploaderInput.files=t,this.validateFileInput()&&this.updateImagePreview(t))}setError(e){this.$fileErrorMessage.parentElement.classList.toggle("has-error",e)}updateImagePreview(e){this.$imageUploader.classList.remove("p16","ba","bas-dashed","bc-black-100"),this.$clearImageUpload.classList.remove("d-none"),this.$imageUploaderText.classList.add("d-none");var t=new FileReader;t.onload=e=>{null!=e.target&&(this.$imageUploaderPreview.setAttribute("src",e.target.result),this.$imageUploaderPreview.classList.remove("d-none"))},t.readAsDataURL(e[0])}validateFileInput(){if(this.ignoreValidation)return!0;const e=this.cam.opt.adReportFileTypeErrorMessage,t=this.cam.opt.adReportFileSizeErrorMessage;if(null==this.$fileUploaderInput.files)return!1;var s=this.$fileUploaderInput.files[0];return null==s?(this.setError(!0),!1):this.allowedFileTypes.indexOf(s.type)<0?(this.$fileErrorMessage.textContent=e,this.$fileErrorMessage.classList.remove("d-none"),this.setError(!0),!1):s.size>2097152?(this.$fileErrorMessage.textContent=t,this.$fileErrorMessage.classList.remove("d-none"),this.setError(!0),!1):(this.$fileErrorMessage.classList.add("d-none"),this.setError(!1),!0)}async gatherDiagnosticInfo(){return{BrowserVersion:await this.getBrowserVersion()}}getElementSource(e){return e.outerHTML}getNestedIFrameElement(e){var t=e.querySelector("iframe");return t.contentDocument?t.contentDocument.documentElement:t.contentWindow.document.documentElement}async getBrowserVersion(){try{return await window.navigator.userAgentData.getHighEntropyValues(["fullVersionList"]).then(e=>JSON.stringify(e.fullVersionList))}catch(e){return""}}async submitForm(){if(!this.validateFileInput())return!1;this.$form.querySelector("[type=submit]").setAttribute("disabled","true");var e=JSON.parse(this.$googleEventData.value||"{}");e.Reason=parseInt(this.$form.querySelector(".js-ad-report-reason:checked").value,10),e.Description=this.$adReportReasonOther.value,this.$googleEventData.value=JSON.stringify(e);var t=new FormData(this.$form);if("1"===t.get("shareDiagnosticInfo")){var s=await this.gatherDiagnosticInfo();Object.keys(s).forEach(e=>t.append(e,s[e]))}try{const e=await window.fetch(this.$form.getAttribute("action"),{method:this.$form.getAttribute("method"),body:t,cache:"no-cache"}),s=e.headers.get("content-type")||"",r=await e.text();if(!e.ok)throw new Error("response not valid");if(0===s.indexOf("text/html")){var n=(0,_common_helper__WEBPACK_IMPORTED_MODULE_2__.Bv)(r);const e=n?n.querySelector(".js-modal-content"):null;if(_console__WEBPACK_IMPORTED_MODULE_1__.cM("$popupContent"),_console__WEBPACK_IMPORTED_MODULE_1__.cM(e),!e)throw new Error(`Could not find .js-modal-content in response from ${this.$form.getAttribute("action")}`);document.querySelector(".js-modal-content").replaceWith(e)}else window.StackExchange.helpers.showToast(this.cam.opt.adReportThanksText,{type:"success"}),this.removeModal()}catch(e){window.StackExchange.helpers.showToast(this.cam.opt.adReportErrorText,{type:"danger"})}finally{let e=this.$form.querySelector("[type=submit]");e&&e.removeAttribute("disabled")}}}},406:(e,t,s)=>{function n(...e){}function r(...e){}s.d(t,{cM:()=>n,vU:()=>r})}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var s=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](s,s.exports,__webpack_require__),s.exports}__webpack_require__.d=(e,t)=>{for(var s in t)__webpack_require__.o(t,s)&&!__webpack_require__.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var __webpack_exports__={};(()=>{var e=__webpack_require__(406),t=(e=>(e[e.Above=0]="Above",e[e.Below=1]="Below",e))(t||{});const s=Object.assign({},{"lib":"https://clc.stackoverflow.com/Content/bundles/js/longitude_loader_script.bundle.435.01f098e1922cf433ca51.js?v=10c730d57cc2","style":null,"u":null,"wa":true,"kt":2000,"tto":true,"h":"clc.stackoverflow.com","allowed":"^(((talent\\.)?stackoverflow)|(blog\\.codinghorror)|(serverfault|askubuntu)|([^\\.]+\\.stackexchange))\\.com$","wv":true,"al":false,"abd":true,"cpa_liid":[5882654614],"cpa_cid":[138377597667],"dp":false,"tgt_to":1000,"tgt_u":"http://clc.stackoverflow.com/get-user-acct-tgt","tgt_e":true,"tgt_p":100,"dv_enabled":false,"gpt_enabled":true,"upo":""});var n=__webpack_require__(23),r=__webpack_require__(865);window.googletag=window.googletag||{cmd:[]};class o{constructor(t){this.cam=t,e.cM("AcceptableAds init"),window.googletag.cmd.push(()=>{if(this.cam=t,window.googletag.pubads().addEventListener("slotRenderEnded",e=>this.handleSlotRendered(e)),Array.isArray(t.slotsRenderedEvents)){e.cM("Adding report button to "+t.slotsRenderedEvents.length+" events that have transpired");for(var s=0;s<t.slotsRenderedEvents.length;s++)this.handleSlotRendered(t.slotsRenderedEvents[s])}})}handleSlotRendered(t){if(!window.abp)return;if(!function(e){return!(!e||!e.slot)}(t))return void e.cM("Not adding Acceptable Ads overlay: invalid SlotRenderEndedEvent... no event and/or slot");if(!function(t){const s=t.slot.getSlotElementId();if(!s)return e.cM("Not adding report button to the bottom of element: invalid adUnitElementId"),!1;const n=document.getElementById(s);return n?!((t.isEmpty||!t.creativeId&&!t.lineItemId&&t.isEmpty)&&0===n.innerHTML.trim().length):(e.cM("Not adding report button to the bottom of "+s+": adUnit element not found"),!1)}(t))return void e.cM("Not adding Acceptable Ads overlay: No ad rendered");const s=t.slot.getSlotElementId(),n=document.getElementById(s);e.cM("Adding Acceptable Ads overlay to "+s),this.createAcceptableAdsOverlayDiv(n)}createAcceptableAdsOverlayDiv(e){let t=document.createElement("div");return t.append(document.createTextNode("AD")),t.style.position="absolute",t.style.top="1px",t.style.left="1px",t.style.padding="6px",t.style.background="rgba(255,255,255,0.7)",t.style.color="#444",t.style.fontSize="10px",t.style.fontWeight="bold",t.style.fontFamily="sans-serif",t.style.zIndex="4000",e.parentElement.appendChild(t),e.parentElement.style.isolation="isolate",e.parentElement.style.position="relative",t}}var a=__webpack_require__(147),i=(e=>(e.Off="Off",e.PreSurvey="PreSurvey",e.Collect="Collect",e.PostSurvey="PostSurvey",e))(i||{});class d{constructor(e,t){this.lineItemImpressions=[],this.surveysIdsCompleted=[],this.lineItemImpressions=e,this.surveysIdsCompleted=t}addImpression(e,t){let s={brandId:e,lineItemId:t,timestamp:new Date};this.lineItemImpressions.push(s)}addBrandSurveyCompleted(e){-1===this.surveysIdsCompleted.indexOf(e)&&this.surveysIdsCompleted.push(e)}getTotalBrandImpressions(){let e=new Map;for(let t of this.lineItemImpressions)if(e.has(t.brandId)){let s=e.get(t.brandId);e.set(t.brandId,s+1)}else e.set(t.brandId,1);return e}getBrandLineItemImpressions(e){let t={};for(let s of this.lineItemImpressions)if(s.brandId==e)if(void 0!==t[s.lineItemId]){let e=t[s.lineItemId];t[s.lineItemId]=e+1}else t[s.lineItemId]=1;return t}}class l{constructor(){this.surveyEngagementLocalStorageKey="clc-survey-engagement"}getBrandSurveyEngagement(){let e=localStorage.getItem(this.surveyEngagementLocalStorageKey);if(null===e)return new d([],[]);let t=JSON.parse(e);return new d(t.lineItemImpressions,t.surveysIdsCompleted)}saveBrandSurveyEngagement(e){let t=JSON.stringify(e);localStorage.setItem(this.surveyEngagementLocalStorageKey,t)}}class c{constructor(){this.surveyRepository=new l}getBrandSurveyEngagement(){return this.surveyRepository.getBrandSurveyEngagement()}recordImpression(e,t){let s=this.getBrandSurveyEngagement();s.addImpression(e,t),this.surveyRepository.saveBrandSurveyEngagement(s)}recordBrandSurveyCompleted(e){let t=this.getBrandSurveyEngagement();t.addBrandSurveyCompleted(e),this.surveyRepository.saveBrandSurveyEngagement(t)}}window.googletag=window.googletag||{cmd:[]};class g{constructor(t){this.brandSettings=t,this.brandSlotMap=new Map,this.brandSurveyEngagementService=new c,e.cM("Brand Survey init: "+JSON.stringify(t)),void 0!==t?googletag.cmd.push(()=>{googletag.pubads().addEventListener("slotRenderEnded",e=>this.handleSlotRendered(e)),googletag.pubads().addEventListener("impressionViewable",e=>this.onImpressionViewable(e)),e.cM("done enabling Brand Survey")}):e.cM("Brand Survey init: brandSettings is undefined, not initializing")}handleSlotRendered(t){e.cM("Brand Survey - slot rendered - slot:"+JSON.stringify(t.slot.getSlotElementId())+" lineItem: "+t.lineItemId);let s=this.findItemWithId(t.lineItemId);if(null===s||s.mode!==i.Collect)this.brandSlotMap.delete(t.slot.getSlotElementId());else{let e={brandId:s.brandId,lineItemId:t.lineItemId};this.brandSlotMap.set(t.slot.getSlotElementId(),e)}}onImpressionViewable(t){let s=t.slot;if(e.cM("ad - Brand Survey - impression viewable.  Details: "+JSON.stringify(s.getSlotElementId())),e.cM("ad - Brand Survey - slot "+s.getSlotElementId()+" is viewable"),this.brandSlotMap.has(s.getSlotElementId())){let t=this.brandSlotMap.get(s.getSlotElementId());e.cM("Brand Survey - brand "+t.brandId+" is viewable"),this.recordImpression(this.brandSlotMap.get(s.getSlotElementId()))}}recordImpression(t){e.cM("ad - Brand Survey - recording impression for brand "+t.brandId),this.brandSurveyEngagementService.recordImpression(t.brandId,t.lineItemId)}findItemWithId(t){return e.cM("brand settings: "+JSON.stringify(this.brandSettings)),this.brandSettings.find(e=>e.lineItemIds.includes(t))||null}}const p="response-brand-survey-submit|",m="request-brand-survey-metadata|",h="record-metric-on-server|",u="request-dsp-tags",v="response-dsp-tags|";window.googletag=window.googletag||{cmd:[]};class f{constructor(t){this.interval=t,e.cM("Ad refresh init. interval: "+t),googletag.cmd.push(()=>{googletag.pubads().addEventListener("impressionViewable",e=>this.onImpressionViewable(e)),e.cM("done enabling ad refresh")})}onImpressionViewable(t){var s=t.slot,r=s.getAdUnitPath();e.cM("Should we refresh ad slot "+s.getSlotElementId()+"  "+s.getAdUnitPath()+"?"),(0,n.z0)(r)?e.cM("Not scheduling refresh for slot "+s.getSlotElementId()+", path "+r):(e.cM("ad refresh - slot "+s.getSlotElementId()+" is viewable, initializing refresh"),this.scheduleRefresh(s))}scheduleRefresh(e){setTimeout(()=>this.refreshAdSlot(e),1e3*this.interval)}static refreshMyAd(t){googletag.cmd.push(()=>{let s=googletag.pubads().getSlots().find(e=>e.getSlotElementId()===t);s&&(e.cM("refreshMyAd - refreshing ad slot "+t),googletag.pubads().refresh([s]))})}static removeMyAd(t){googletag.cmd.push(()=>{let s=googletag.pubads().getSlots().find(e=>e.getSlotElementId()===t);s&&(e.cM("removeMyAd - destroying ad slot "+t),googletag.destroySlots([s]))})}refreshAdSlot(t){var s=t.getSlotElementId();this.isElementVisibleInBrowser(s)?(e.cM("refreshing ad slot "+s),t.setTargeting("Refresh","true"),googletag.pubads().refresh([t])):(e.cM("refresh skipped this time; ad slot not viewable:"+s),this.scheduleRefresh(t))}isElementVisibleInBrowser(e){var t=document.getElementById(e);if(null!==t){var s=t.getBoundingClientRect();if(s.top>=0&&s.left>=0&&s.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&s.right<=(window.innerWidth||document.documentElement.clientWidth))return!0}return!1}}class _{static refreshAdIfBrandSurveyIsDuplicated(e,t){if(this.alreadyCompletedThisBrandSurvey(e)){var s=document.getElementById(t).closest(".js-zone-container");f.removeMyAd(t),s&&s.remove()}}static alreadyCompletedThisBrandSurvey(e){return(new c).getBrandSurveyEngagement().surveysIdsCompleted.includes(e)}}window.googletag=window.googletag||{cmd:[]};window.cam=new class{constructor(t=null){if(this.gptImported=!1,this.slotsRenderedEvents=[],this.collapsed={},e.cM("constructor"),this.clc_options=s,window.clcGamLoaderOptions)Object.assign(this,window.clcGamLoaderOptions);else if(void 0===this.opt){let e=window.opt;e&&(this.opt=e)}}init(){if(e.cM("init"),void 0===this.opt)throw new Error("opt not set, required by GAM Loader");e.cM("init brand survey service"),this.getUserMetaPromise=this.getUserMeta(),e.cM("setup message handler"),window.addEventListener("message",e=>{this.onmessage(e)})}handleSlotRenderedNoAdReport(){googletag.cmd.push(()=>{if(googletag.pubads().addEventListener("slotRenderEnded",e=>this.applyExtraMarginBottom(e)),Array.isArray(this.slotsRenderedEvents))for(var e=0;e<this.slotsRenderedEvents.length;e++)this.applyExtraMarginBottom(this.slotsRenderedEvents[e])})}onmessage(t){let s="omni";if(t.data&&("string"==typeof t.data||t.data instanceof String))if(0===t.data.indexOf("get-omni-")){e.cM("Recevied get-omni message, sending back omni");var n=t.source,o=this.opt.omni,a="string"==typeof o?o:"";n.postMessage([s,a,this.opt.perRequestGuid].join("|"),"*")}else if(0===t.data.indexOf("collapse-")){e.cM("Recevied collapse message, collapse ad iframe"),e.cM(t);for(var i=t.source.window,d=document.getElementsByTagName("IFRAME"),l=0;l<d.length;l++){var g=d[l];if(g.contentWindow==i)return void(0,r.wo)(g.parentElement.parentElement.parentElement)}}else if(0===t.data.indexOf("resize|")){e.cM("Recevied resize message, resize ad iframe"),e.cM(t);let s=this._getFrameByEvent(t),n=t.data.indexOf("|")+1,r=t.data.slice(n),o=parseFloat(r)+.5;e.cM("New iframe height "+o),s.height=o.toString(),s.parentElement.style.height=o.toString()+"px"}else if(0===t.data.indexOf("getmarkup|")){let s=t.data.indexOf("|")+1,n=t.data.slice(s);e.cM("Recevied get markup message: "+n);let r=this._getFrameByEvent(t).closest(".everyonelovesstackoverflow");const o=document.createElement("script");o.dataset.adZoneId=r.id,o.src=n,document.body.appendChild(o)}else if(0===t.data.indexOf("window-location|")){let s=t.data.indexOf("|")+1,n=t.data.slice(s);e.cM("Recevied window location message: "+n),n.startsWith("/")||(n="/"+n),window.open(window.location.protocol+"//"+window.location.host+n,"_blank")}else if(0===t.data.indexOf("request-brand-survey-submit|")){let s=t.data.split("|"),n=s[1],r=s[2],o=s[3],a=JSON.parse(o);e.cM(n),e.cM(r),e.cM(o),e.cM("Received brand survey "+n+" response message: "+r);var f=new FormData;for(var b in a)f.append(b,a[b]);let i=this._getFrameByEvent(t);if(_.alreadyCompletedThisBrandSurvey(+n))return e.cM("Already completed this brand survey.  Not submitting duplicate to server."),void i.contentWindow.postMessage("response-brand-survey-submit-duplicate|","*");e.cM("Send the brand survey to the server"),fetch(r,{method:"POST",body:f}).then(e=>e.json()).then(e=>i.contentWindow.postMessage({messageType:p},"*")).catch(e=>i.contentWindow.postMessage({messageType:p},"*"))}else if(0===t.data.indexOf("brand-survey-completed-store|")){let s=t.data.split("|"),n=(s[1],s[2]);if(e.cM("Received brand survey completed store message for survey ID "+n),_.alreadyCompletedThisBrandSurvey(+n))return void e.cM("Already completed this brand survey.  Not recording duplicate locally.");e.cM("Record brand survey completion locally"),(new c).recordBrandSurveyCompleted(+n)}else if(0===t.data.indexOf(m)){let s=t.data.split("|"),n=s[1],r=s[2];e.cM("Received message: "+m+" with Brand Survey ID "+r);let o=(new c).getBrandSurveyEngagement().getBrandLineItemImpressions(+n),a=JSON.stringify(o),i=this._getFrameByEvent(t);e.cM("sending impression data: "+a),i.contentWindow.postMessage("response-brand-survey-metadata|"+this.opt.responseHash+"|"+this.opt.perRequestGuid+"|"+a+"|"+this.opt.countryCode+"|"+this.opt.qualtricsSurveyData,"*")}else if(0===t.data.indexOf("refresh-if-duplicate-brand-survey|")){let e=t.data.split("|")[1],s=this.getSlotElementIdByEvent(t);_.refreshAdIfBrandSurveyIsDuplicated(+e,s)}else if(0===t.data.indexOf(h)){e.cM("Received message: "+h+" with args: "+t.data);let s=t.data.split("|"),n=s[1],r=s[2],o=s[3],a=s[4],i=new FormData;i.append("brandSurveyId",o.toString()),i.append("responseHash",this.opt.responseHash),i.append("perRequestGuid",this.opt.perRequestGuid),i.append("questionNumber",n.toString()),i.append("metricType",a.toString()),fetch(r,{method:"POST",body:i}).then(e=>e.ok).catch(t=>{e.cM("SendMetricToServer: Error sending metric to server: "+t)})}else if(0===t.data.indexOf(u)){e.cM("Received message: "+u+" with args: "+t.data);let s=this._getFrameByEvent(t);if(!this.opt.targeting["so-tag"])return void s.contentWindow.postMessage(v,"*");const n=this.opt.targeting["so-tag"].join(",");e.cM("sending targeting tags: "+n),s.contentWindow.postMessage(v+n,"*")}else e.cM("Received unhandled message")}getSlotElementIdByEvent(e){let t=this._getFrameByEvent(e),s=t.parentElement?.parentElement?.id;return s||""}_getFrameByEvent(e){return Array.from(document.getElementsByTagName("iframe")).filter(t=>t.contentWindow===e.source)[0]}classifyZoneIds(e){const t=e.map(r.Nj).filter(r.yb);return{eligible:t.filter(r.xb).filter(r.pn),ineligible:t.filter(r.xj)}}applyExtraMarginBottom(t){if(t&&t.slot&&!t.isEmpty&&(t.creativeId||t.lineItemId||!t.isEmpty)){var s=t.slot.getSlotElementId();if(s){var r=document.getElementById(s);if(r)if((0,n.eq)(s)){var o=r?.closest(".js-zone-container");o.style.marginBottom="24px",e.cM("Applied extra margin to the bottom of "+s)}else e.cM("Not applying extra margin to the bottom of "+s+": shouldHaveReportButton = false");else e.cM("Not applying extra margin to the bottom of "+s+": resolved invalid adUnit element")}else e.cM("Not applying extra margin to the bottom of element: invalid adUnitElementId")}else e.cM("Not applying extra margin to the bottom of element: invalid SlotRenderEndedEvent")}async load(s=(0,n.kG)()){if(this.opt.tlb_position,t.Above,!this.isGptReady())return e.cM("Initializing..."),this.initGpt(),void googletag.cmd.push(()=>this.load(s));this.opt.acceptableAdsEnabled&&(e.cM("Acceptable Ads enabled"),this.acceptableAds=new o(this)),this.opt.adReportEnabled?(e.cM("Ad reporting enabled"),this.adReports=new a.t(this)):(e.cM("Ad reporting not enabled"),this.handleSlotRenderedNoAdReport()),this.opt.brandSurveyEnabled&&(e.cM("Brand Survey enabled"),this.brandSurvey=new g(this.opt.brandSurveySettings)),e.cM("Attempting to load ads into ids: ",s);const{eligible:r,ineligible:i}=this.classifyZoneIds(s);this.initDebugPanel(googletag,r.concat(i)),e.cM("Eligible ids:",r),this.opt.abd&&this.appendAdblockDetector(),cam.sreEvent||(googletag.pubads().addEventListener("slotRenderEnded",e=>this.onSlotRendered(e)),cam.sreEvent=!0),await this.setTargeting()}async setTargeting(){cam.targetingParams={};let t=this.opt.targeting;if(!t)throw new Error("Targeting not defined (is "+typeof t+")");Object.keys(t).forEach(s=>{e.cM(`-> targeting - ${s}: ${t[s]}`),cam.targetingParams[s]=t[s]});let s=(new c).getBrandSurveyEngagement();if(s.getTotalBrandImpressions().forEach((t,s)=>{e.cM(`-> targeting - BrandImpressions: ${s}: ${t}`),cam.targetingParams["brand_"+s.toString()+"_impressions"]=t.toString()}),s.surveysIdsCompleted.forEach(t=>{e.cM(`-> targeting - SurveysTaken: ${t}`),cam.targetingParams["survey_"+t+"_taken"]="true"}),this.clc_options.tgt_e&&this.getUserMetaPromise){let t=await this.getUserMetaPromise;t&&t.tgt_acct?(e.cM("-> targeting - User Account: "+t.tgt_acct),cam.targetingParams["user-acct"]=t.tgt_acct.company_name,cam.targetingParams.user_acct_top=t.tgt_acct.company_name,cam.targetingParams.user_industry=t.tgt_acct.industry,cam.targetingParams.user_employee_count=t.tgt_acct.employee_range):e.cM("-> targeting - User Account: Not Found"),t&&Object.prototype.hasOwnProperty.call(t,"is_high_rep_earner")?(e.cM("-> targeting - High Rep Earner: "+t.is_high_rep_earner),cam.targetingParams.IsHighRepEarner=t.is_high_rep_earner?"true":"false"):e.cM("-> targeting - High Rep Earner: not found")}cam.targetingParams.aa=window.abp?"true":"false"}appendAdblockDetector(){const e=document.createElement("div");e.className="adsbox",e.id="clc-abd",e.style.position="absolute",e.style.pointerEvents="none",e.innerHTML="&nbsp;",document.body.appendChild(e)}onSlotRendered(s){try{const a=s.slot.getSlotElementId();let i=[];a||i.push("id=0");const d=document.getElementById(a);if(a&&!d&&i.push("el=0"),0!==i.length)return void this.stalled(i.join("&"));const{path:l,sizes:c,zone:g}=(0,n.Z7)(a,this.clc_options.upo);if(this.collapsed[g]&&s.isEmpty)return e.cM(`No line item for the element #${d.id}... collapsing.`),void(0,r.wo)(d);if(this.slotsRenderedEvents.push(s),s.lineItemId||s.creativeId||!s.isEmpty){e.cM(`Rendered ad for element #${d.id} [line item #${s.lineItemId}]`),e.cM(s);var o=d.parentElement;if(o.classList.contains("js-zone-container"))switch(a){case"dfp-tlb":this.opt.tlb_position===t.Above?o.classList.add("mb8"):o.classList.add("mt16");break;case"dfp-tag":o.classList.add("mb8");break;case"dfp-msb":o.classList.add("mt16");break;case"dfp-mlb":case"dfp-smlb":case"dfp-bmlb":o.classList.add("my8");break;case"dfp-isb":o.classList.add("mt24");break;case"dfp-m-aq":o.classList.add("my12"),o.classList.add("mx-auto")}else e.cM(`No ad for element #${d.id}`),e.cM(s)}}catch(t){e.cM("Exception thrown onSlotRendered"),e.cM(t),this.stalled("e=1")}}stalled(e){(new Image).src=`https://${this.clc_options.h}/stalled.gif?${e}`}importGptLibrary(){if(!this.gptImported){this.gptImported=!0;var e=["AT","BE","BG","HR","CY","CZ","DK","EE","FI","FR","DE","GB","GR","HU","IS","IE","IT","LV","LT","LU","MT","NL","NO","PL","PT","RO","SK","SI","ES","SE"].indexOf(this.opt.countryCode)>=0;this.opt.targeting_consent||!this.opt.targeting_consent_set&&!e?(0,r.Gx)("https://securepubads.g.doubleclick.net/tag/js/gpt.js"):(0,r.Gx)("https://pagead2.googlesyndication.com/tag/js/gpt.js")}}importDvLibrary(){this.clc_options.dv_enabled&&(e.cM("Adding DoubleVerify library"),(0,r.Gx)("https://pub.doubleverify.com/dvtag/21569774/DV1289064/pub.js"),e.cM("Adding DoubleVerify onDvtagReady handler"),window.onDvtagReady=function(t,s=750){e.cM("DoubleVerify onDvtagReady called"),window.dvtag=window.dvtag||{},dvtag.cmd=dvtag.cmd||[];const n={callback:t,timeout:s,timestamp:(new Date).getTime()};dvtag.cmd.push(function(){dvtag.queueAdRequest(n)}),setTimeout(function(){const e=n.callback;n.callback=null,e&&e()},s)})}isGptReady(){return"undefined"!=typeof googletag&&!!googletag.apiReady}initGpt(){"undefined"==typeof googletag?window.googletag={cmd:(0,r.QZ)(()=>{this.clc_options.gpt_enabled&&this.importGptLibrary(),this.importDvLibrary()})}:(this.clc_options.gpt_enabled&&this.importGptLibrary(),this.importDvLibrary())}getUserMeta(){if(this.opt.allowAccountTargetingForThisRequest&&this.clc_options.tgt_e&&this.clc_options.tgt_p>0){if(e.cM("Targeting enabled."),this.clc_options.tgt_p<100){e.cM("Targeting rate limit enabled.  Rolling the dice...");const t=Math.floor(100*Math.random())+1;if(e.cM("Rolled "+t+" and the max is "+this.clc_options.tgt_p),t>this.clc_options.tgt_p)return void e.cM("Will not request targeting.")}return e.cM("Will request targeting."),function(e,t,s,n){if(t){const t=new Headers;return t.append("Accept","application/json"),async function(e,t={},s=5e3){if("number"!=typeof s&&null!=s&&!1!==s){if("string"!=typeof s)throw new Error("fetchWithTimeout: timeout must be a number");if(s=parseInt(s),isNaN(s))throw new Error("fetchWithTimeout: timeout must be a number (or string that can be parsed to a number)")}const n=new AbortController,{signal:r}=n,o=fetch(e,{...t,signal:r}),a=setTimeout(()=>n.abort(),s);try{const e=await o;return clearTimeout(a),e}catch(e){throw clearTimeout(a),e}}(s+"?"+new URLSearchParams({omni:e}),{method:"GET",mode:"cors",headers:t},n).then(e=>e.json())}return Promise.reject("No consent")}(this.opt.omni,this.opt.targeting_consent,this.clc_options.tgt_u,this.clc_options.tgt_to).catch(t=>{e.vU("Error fetching user account targeting"),e.vU(t)})}e.cM("Targeting disabled.  Will not request account targeting data.")}initDebugPanel(t,s){e.cM("initDebugPanel"),e.cM("Not showing debug panel.")}},window.clcGamLoaderOptions&&(cam.init(),cam.load())})()})();</script>    <script type="text/javascript" src="https://lngtd.com/stackoverflow.js"></script>





    
    <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9cfe78817a213c03',t:'MTc3MTQyNzYzMC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
    </html>

